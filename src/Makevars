# -*- Makefile -*-  vim : ft = make
# This file is derived from Rmpi package

PKG_CFLAGS   = $(ARCHCFLAGS)

PKG_FCFLAGS  = -DPACKAGE_NAME=\"\" -DPACKAGE_TARNAME=\"\" -DPACKAGE_VERSION=\"\" -DPACKAGE_STRING=\"\" -DPACKAGE_BUGREPORT=\"\" -DPACKAGE_URL=\"\" -I/opt/ohpc/pub/mpi/openmpi/3.1.0/include -pthread -I/opt/ohpc/pub/mpi/openmpi/3.1.0/lib/ -I -DMPI2 -DOPENMPI -Wl,-rpath  $(ARCHCFLAGS)

PKG_LIBS     = -pthread -I/opt/ohpc/pub/mpi/openmpi/3.1.0/lib/ -Wl,-rpath -Wl,/opt/ohpc/pub/mpi/openmpi/3.1.0/lib/ -Wl,--enable-new-dtags -L/opt/ohpc/pub/mpi/openmpi/3.1.0/lib/ -lmpi_usempif08 -lmpi_usempi_ignore_tkr -lmpi_mpifh -lmpi  -lutil -lpthread $(ARCHLIB) $(BLAS_LIBS) $(FLIBS)



CSRC = init.c
FMODSRC = AOptim.f90
FSRC =  hetmixOrd.f90 hetmixlin.f90 hetmixCont.f90 hetmixContMult.f90 Jointhet.f90 calculusTransfo.f90 predictCont.f90 predictMult.f90 postprob2.f90 cvpl.f90 predictYcond.f90 mpjhet.f90 hetmixMult.f90 mpjord.f90 irtsre.f90

# Define order of compilation
OBJECTS = $(CSRC:.c=.o) $(FMODSRC:.f90=.o) $(FSRC:.f90=.o) 

$(SHLIB): $(OBJECTS)


#Setup dependencies for parallel make
hetmixCont.o: AOptim.o hetmixOrd.o
hetmixContMult.o: AOptim.o hetmixCont.o
hetmixlin.o: AOptim.o
hetmixOrd.o: AOptim.o
Jointhet.o: AOptim.o hetmixCont.o
predictCont.o: AOptim.o
predictMult.o: AOptim.o predictCont.o
predictYcond.o: AOptim.o predictCont.o
postprob2.o: AOptim.o Jointhet.o hetmixCont.o
cvpl.o: AOptim.o Jointhet.o
calculusTransfo.o: hetmixCont.o
mpjhet.o: AOptim.o hetmixCont.o
hetmixMult.o: AOptim.o hetmixCont.o hetmixOrd.o predictCont.o
mpjord.o: AOptim.o hetmixCont.o hetmixOrd.o predictCont.o
irtsre.o: AOptim.o hetmixOrd.o 

