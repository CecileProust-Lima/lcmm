<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>How to estimate a latent class mixed model using hlme function • lcmm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to estimate a latent class mixed model using hlme function">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lcmm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/lcmm.html">GET STARTED</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">VIGNETTES</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/latent_class_model_with_hlme.html">How to estimate a latent class mixed model using hlme function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_lcmm.html">How to estimate a latent process mixed model using lcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm.html">How to estimate a latent process mixed model for multivariate markers using multlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm_IRT.html">Continuous-time longitudinal IRT model</a></li>
    <li><a class="dropdown-item" href="../articles/joint_latent_class_model_with_Jointlcmm.html">How to estimate a joint latent class mixed model using Jointlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/multivariate_latent_class_model_with_mpjlcmm.html">How to estimate a multivariate latent class mixed model using mpjlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/secondary_model_with_externVar.html">Accounting for latent class assignment uncertainty in subsequent analyses</a></li>
    <li><a class="dropdown-item" href="../articles/pre_normalizing.html">Pre-normalizing a dependent variable using lcmm</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/usual_problems.html">FAQ</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">REFERENCE</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">CHANGELOG</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CecileProust-Lima/lcmm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>How to estimate a latent class mixed model using hlme function</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CecileProust-Lima/lcmm/blob/HEAD/vignettes/latent_class_model_with_hlme.Rmd" class="external-link"><code>vignettes/latent_class_model_with_hlme.Rmd</code></a></small>
      <div class="d-none name"><code>latent_class_model_with_hlme.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background-and-definitions">Background and definitions<a class="anchor" aria-label="anchor" href="#background-and-definitions"></a>
</h2>
<p align="justify">
The linear mixed model assumes that the population of N subjects is
homogeneous and described at the population level by a unique profile
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">X_{i}(t)\beta</annotation></semantics></math>.
In contrast, the latent class mixed model consists in assuming that the
population is heterogeneous and composed of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
latent classes of subjects characterized by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
mean profiles of trajectories.
</p>
<div class="section level3">
<h3 id="the-latent-class-mixed-model">The latent class mixed model<a class="anchor" aria-label="anchor" href="#the-latent-class-mixed-model"></a>
</h3>
<p align="justify">
</p>
<p>Latent class membership is defined by a discrete random variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>i</mi></msub><annotation encoding="application/x-tex">c_{i}</annotation></semantics></math>
that equals
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
if subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
belongs to latent class
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
= 1,
…,<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>).
The variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>i</mi></msub><annotation encoding="application/x-tex">c_{i}</annotation></semantics></math>
is latent; its probability is described using a multinomial logistic
model according to covariates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>c</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">X_{ci}</annotation></semantics></math>:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mrow><mi>i</mi><mi>g</mi></mrow></msub><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><mi>g</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mrow><mi>c</mi><mi>i</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ξ</mi><mrow><mn>0</mn><mi>g</mi></mrow></msub><mo>+</mo><msub><mi>X</mi><mrow><mi>c</mi><mi>i</mi></mrow></msub><msub><mi>ξ</mi><mrow><mn>1</mn><mi>g</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msubsup><mo>∑</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></msubsup><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ξ</mi><mrow><mn>0</mn><mi>l</mi></mrow></msub><mo>+</mo><msub><mi>X</mi><mrow><mi>c</mi><mi>i</mi></mrow></msub><msub><mi>ξ</mi><mrow><mn>1</mn><mi>l</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">\pi_{ig}= P(c_{i} = g|X_{ci}) = \frac{\exp(\xi_{0g}+X_{ci}\xi_{1g})}{ \sum_{l=1}^{G}\exp(\xi_{0l}+X_{ci}\xi_{1l})}</annotation></semantics></math></p>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ξ</mi><mrow><mn>0</mn><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">\xi_{0g}</annotation></semantics></math>
is the intercept for class
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ξ</mi><mrow><mn>1</mn><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">\xi_{1g}</annotation></semantics></math>
is the q1-vector of class-specific parameters associated with the
q1-vector of time-independent covariates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>c</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">X_{ci}</annotation></semantics></math>.
For identifiability,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ξ</mi><mrow><mn>0</mn><mi>G</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\xi_{0G} = 0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ξ</mi><mrow><mn>1</mn><mi>G</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\xi_{1G} = 0</annotation></semantics></math>.
When no covariate predicts the latent class membership, this model
reduces to a class-specific probability.

<p align="justify">
For a continuous and Gaussian variable, the trajectories of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
are defined conditionally to the latent class by a linear mixed model.
So, conditional on class
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>,
the model is defined for subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
at occasion
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>:
</p>
<p> </p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mo stretchy="false" form="prefix">|</mo><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><mi>g</mi></mrow></msub><mo>=</mo><msub><mi>X</mi><mrow><mn>2</mn><mi>i</mi><mi>j</mi></mrow></msub><mi>β</mi><mo>+</mo><msub><mi>X</mi><mrow><mn>3</mn><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>γ</mi><mi>g</mi></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>b</mi><mi>i</mi></msub><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Y_{ij}|_{c_{i}=g} = X_{2ij}\beta+X_{3ij}\gamma_{g}+Z_{ij}b_{i}+\epsilon_{ij}</annotation></semantics></math></p>
<p> </p>
<p align="justify">
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mn>2</mn><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">X_{2ij}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mn>3</mn><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">X_{3ij}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">Z_{ij}</annotation></semantics></math>
are vectors of covariates respectively associated with common fixed
effects over classes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>,
class-specific fixed effects
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mi>g</mi></msub><annotation encoding="application/x-tex">\gamma_{g}</annotation></semantics></math>
and with individual random effects
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub><msub><mo stretchy="false" form="prefix">|</mo><mrow><mi>c</mi><mi>i</mi><mo>=</mo><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">b_{i}|_{ci=g}</annotation></semantics></math>
called
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>b</mi><mrow><mi>i</mi><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">b_{ig}</annotation></semantics></math>
whose distributions are now class-specific.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_{2}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>3</mn></msub><annotation encoding="application/x-tex">X_{3}</annotation></semantics></math>
can’t have common variables.
</p>
</div>
<div class="section level3">
<h3 id="posterior-classification">Posterior classification<a class="anchor" aria-label="anchor" href="#posterior-classification"></a>
</h3>
<p align="justify">
In models involving latent classes, a posterior classification of the
subjects in each latent class can be made. It is based on the posterior
calculation of the class-membership probabilities and is used to
characterize the classification of the subjects as well as to evaluate
the goodness-of-fit of the model (Proust-Lima et al. 2014 - <a href="https://doi.org/10.1177/0962280212445839" class="external-link uri">https://doi.org/10.1177/0962280212445839</a> ).
</p>
<p align="justify">
Posterior class-membership probabilities are computed using the Bayes
theorem as the probability of belonging to a latent class given the
information collected. In a longitudinal model, they are defined for
subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and latent class
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
as:
</p>
<p> </p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>π</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mi>g</mi></mrow><mi>Y</mi></msubsup><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><mi>g</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>,</mo><msub><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>G</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\pi}_{ig}^Y=P(c_{i}=g|X_{i},Y_{i},\hat{\theta}_{G})</annotation></semantics></math></p>
<p><em>where :</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>G</mi></msub><annotation encoding="application/x-tex">\hat{\theta}_{G}</annotation></semantics></math>
is the vector of parameters estimated in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
latent class model.</p>
<p> </p>
<p> </p>
</div>
</div>
<div class="section level2">
<h2 id="example-for-gaussian-data">Example for Gaussian Data<a class="anchor" aria-label="anchor" href="#example-for-gaussian-data"></a>
</h2>
<p align="justify">
In this example, we study the quadratic trajectory of a cognitive
marker, the Mini Mental State Examination (<strong>MMSE</strong>)
pre-normalized (to have a Gaussian distribution) in a sample of old
people (aged 65 years old and over at inclusion) followed for up to 15
years with an adjustment on education level. The model does not consider
interactions here although any regression may be considered.
</p>
<div class="section level3">
<h3 id="model-considered">Model considered<a class="anchor" aria-label="anchor" href="#model-considered"></a>
</h3>
<p align="justify">
We consider the following latent class linear mixed model, where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
denotes the class,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
the subject and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
the repeated measurement:
</p>
<p> </p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>M</mi><mi>M</mi><mi>S</mi><msub><mi>E</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mo stretchy="false" form="prefix">|</mo><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><mi>g</mi></mrow></msub><mo>=</mo><msub><mi>β</mi><mrow><mn>0</mn><mi>g</mi></mrow></msub><mo>+</mo><msub><mi>β</mi><mrow><mn>1</mn><mi>g</mi></mrow></msub><mi>a</mi><mi>g</mi><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>β</mi><mrow><mn>2</mn><mi>g</mi></mrow></msub><mi>a</mi><mi>g</mi><msubsup><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><mi>C</mi><mi>E</mi><msub><mi>P</mi><mi>i</mi></msub><mo>+</mo><msub><mi>u</mi><mrow><mn>0</mn><mi>i</mi><mi>g</mi></mrow></msub><mo>+</mo><msub><mi>u</mi><mrow><mn>1</mn><mi>i</mi><mi>g</mi></mrow></msub><mi>a</mi><mi>g</mi><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>u</mi><mrow><mn>2</mn><mi>i</mi><mi>g</mi></mrow></msub><mi>a</mi><mi>g</mi><msubsup><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">normMMSE_{ij}|_{c_{i}=g}=\beta_{0g}+\beta_{1g}age_{ij}+\beta_{2g}age_{ij}^2+\beta_{3}CEP_{i}+u_{0ig}+u_{1ig}age_{ij}+u_{2ig}age_{ij}^2+\epsilon_{ij}</annotation></semantics></math></p>
<p> </p>
<p><em>Where :</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mrow><mi>i</mi><mi>g</mi></mrow></msub><mo>∼</mo><mi>𝒩</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msub><mi>B</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">u_{ig} \sim \mathcal{N}(0,B_{g})</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>∼</mo><mi>𝒩</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\epsilon_{ij} \sim \mathcal{N}(0,\sigma^2)</annotation></semantics></math></p>
<p> </p>
<p>The <em>Fixed part</em> is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mrow><mn>0</mn><mi>g</mi></mrow></msub><mo>+</mo><msub><mi>β</mi><mrow><mn>1</mn><mi>g</mi></mrow></msub><mi>a</mi><mi>g</mi><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>β</mi><mrow><mn>2</mn><mi>g</mi></mrow></msub><mi>a</mi><mi>g</mi><msubsup><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><mi>C</mi><mi>E</mi><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\beta_{0g}+\beta_{1g}age_{ij}+\beta_{2g}age_{ij}^2+\beta_{3}CEP_{i}</annotation></semantics></math>
with a mixture on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>g</mi><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">age_{ij}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>g</mi><msubsup><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">age_{ij}^2</annotation></semantics></math>;
the <em>random part</em> is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mrow><mn>0</mn><mi>i</mi><mi>g</mi></mrow></msub><mo>+</mo><msub><mi>u</mi><mrow><mn>1</mn><mi>i</mi><mi>g</mi></mrow></msub><mi>a</mi><mi>g</mi><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>u</mi><mrow><mn>2</mn><mi>i</mi><mi>g</mi></mrow></msub><mi>a</mi><mi>g</mi><msubsup><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">u_{0ig}+u_{1ig}age_{ij}+u_{2ig}age_{ij}^2</annotation></semantics></math>,</p>
<p> </p>
</div>
<div class="section level3">
<h3 id="dependent-variable-normalized-mmse">Dependent variable: normalized MMSE<a class="anchor" aria-label="anchor" href="#dependent-variable-normalized-mmse"></a>
</h3>
<p> </p>
<p align="justify">
As MMSE has a very skewed distribution, we use its normalized version
easily obtained from NormPsy package (see <a href="lcmm.html">Introduction vignette</a>).
</p>
<p> </p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">NormPsy</span><span class="op">)</span></span>
<span><span class="va">paquid</span><span class="op">$</span><span class="va">normMMSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/NormPsy/man/normMMSE.html" class="external-link">normMMSE</a></span><span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">MMSE</span><span class="op">)</span></span></code></pre></div>
<p> </p>
</div>
<div class="section level3">
<h3 id="estimate-the-model-with-only-one-class-g1">Estimate the model with only one class (G=1)<a class="anchor" aria-label="anchor" href="#estimate-the-model-with-only-one-class-g1"></a>
</h3>
<p>Analysis is done according to age. To avoid any numerical problems,
we recenter and scale age:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paquid</span><span class="op">$</span><span class="va">age65</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">age</span> <span class="op">-</span> <span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span></span></code></pre></div>
<p> </p>
<p>We fit the linear mixed model for normMMSE:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hlme.html">hlme</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">CEP</span>,random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, subject <span class="op">=</span> <span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquid</span><span class="op">)</span> <span class="co"># ng=1</span></span></code></pre></div>
<p>&amp;nbsp</p>
</div>
<div class="section level3">
<h3 id="estimate-the-model-with-more-than-one-class-g-1">Estimate the model with more than one class (G &gt; 1)<a class="anchor" aria-label="anchor" href="#estimate-the-model-with-more-than-one-class-g-1"></a>
</h3>
<p align="justify">
From the model estimated by assuming a single latent class, we can now
search for heterogeneous profiles. The next lines provide the estimation
of the model for 2 latent classes using the automatic specification for
the initial values when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">G&gt;1</annotation></semantics></math>.
</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Estimation considering 2 classes : </span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hlme.html">hlme</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">CEP</span>, random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, subject <span class="op">=</span> <span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquid</span>, ng <span class="op">=</span> <span class="fl">2</span>, mixture<span class="op">=</span><span class="op">~</span><span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, B<span class="op">=</span><span class="va">m1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="be-careful-with-initial-values">Be careful with initial values !<a class="anchor" aria-label="anchor" href="#be-careful-with-initial-values"></a>
</h3>
<p align="justify">
Initial values are specified in argument <code>B</code>. The option
<code>B=m1</code> automatically generates initial values from the
maximum likelihood estimates of a 1-class model (here, <code>m1</code>).
Not specifying <code>B</code> or specifying <code>B=NULL</code> is not
recommended since it induces the internal pre-estimation of the model
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">G = 1</annotation></semantics></math>
(i.e <code>m1</code>) which may substantially increase computational
time.
</p>
<p> </p>
<div class="section level4">
<h4 id="values-pre-specified-by-the-user">Values pre-specified by the user<a class="anchor" aria-label="anchor" href="#values-pre-specified-by-the-user"></a>
</h4>
<p align="justify">
In the following example, the initial values are pre-specified by the
user: parameters of the variance covariance were taken at the estimated
values of the linear mixed model and arbitrary initial values were tried
for the class-specific trajectories:
</p>
<p> </p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m2b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hlme.html">hlme</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">CEP</span>, random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, subject <span class="op">=</span> <span class="st">'ID'</span>,data <span class="op">=</span> <span class="va">paquid</span>, ng <span class="op">=</span> <span class="fl">2</span>, mixture <span class="op">=</span><span class="op">~</span> <span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">60</span>, <span class="fl">40</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">4</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">212.869397</span>, <span class="op">-</span><span class="fl">216.421323</span>,<span class="fl">456.229910</span>, <span class="fl">55.713775</span>, <span class="op">-</span><span class="fl">145.715516</span>, <span class="fl">59.351000</span>, <span class="fl">10.072221</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="values-randomly-generated">Values randomly generated<a class="anchor" aria-label="anchor" href="#values-randomly-generated"></a>
</h4>
<p align="justify">
An alternative is to randomly generate the initial values from the
asymptotic distribution of the estimates of the 1-class model (here,
<code>m1</code>):
</p>
<p> </p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m2c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hlme.html">hlme</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">CEP</span>, random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,subject <span class="op">=</span> <span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquid</span>, ng <span class="op">=</span> <span class="fl">2</span>, mixture <span class="op">=</span><span class="op">~</span> <span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,  B <span class="op">=</span> <span class="fu">random</span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="grid-search">Grid search<a class="anchor" aria-label="anchor" href="#grid-search"></a>
</h4>
<p align="justify">
Finally, gridsearch function can be used to run an automatic grid
search. In the next examples with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">G=2</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">G=3</annotation></semantics></math>
classes (<code>m2d</code> and <code>m3b</code>, respectively),
<code>hlme</code> is run for a maximum of 30 iterations from 100 random
vectors of initial values. The estimation procedure is then finalized
only for the departure that provided the best log-likelihood after 30
iterations.
</p>
<p> </p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m2d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gridsearch.html">gridsearch</a></span><span class="op">(</span><span class="fu"><a href="../reference/hlme.html">hlme</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">CEP</span>,  random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, subject <span class="op">=</span> <span class="st">'ID'</span>, data<span class="op">=</span><span class="va">paquid</span>, ng <span class="op">=</span> <span class="fl">2</span>, mixture<span class="op">=</span><span class="op">~</span><span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, rep<span class="op">=</span><span class="fl">100</span>, maxiter<span class="op">=</span><span class="fl">30</span>, minit<span class="op">=</span><span class="va">m1</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m3g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gridsearch.html">gridsearch</a></span><span class="op">(</span><span class="fu"><a href="../reference/hlme.html">hlme</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">CEP</span>,  random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, subject <span class="op">=</span> <span class="st">'ID'</span>, data<span class="op">=</span><span class="va">paquid</span>, ng <span class="op">=</span> <span class="fl">3</span>, mixture<span class="op">=</span><span class="op">~</span><span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, rep<span class="op">=</span><span class="fl">100</span>, maxiter<span class="op">=</span><span class="fl">30</span>, minit<span class="op">=</span><span class="va">m1</span><span class="op">)</span></span></code></pre></div>
<p>This method is recommended as it enables to better explore the
parameter space when the number of replicates is large enough and the
number of iterations is fairly large.</p>
</div>
</div>
<div class="section level3">
<h3 id="choose-the-best-model">Choose the best model<a class="anchor" aria-label="anchor" href="#choose-the-best-model"></a>
</h3>
<p> </p>
<p align="justify">
The estimation process of a set of models (usually with a varying number
of latent classes) can be summarized with <code>summarytable</code> and
plotted with <code>summaryplot</code>. Different information can be
displayed:
</p>
<p> </p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">summarytable</span>(m1,m2,m2b,m2c, m2d  , m3g, <span class="at">which =</span> <span class="fu">c</span>(<span class="st">"G"</span>, <span class="st">"loglik"</span>, <span class="st">"conv"</span>, <span class="st">"npm"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span>, <span class="st">"SABIC"</span>, <span class="st">"entropy"</span>,<span class="st">"ICL"</span>, <span class="st">"%class"</span>))</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>    G    loglik conv npm      AIC      BIC    SABIC   entropy     ICL1     ICL2</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>m1  <span class="dv">1</span> <span class="sc">-</span><span class="fl">8920.623</span>    <span class="dv">1</span>  <span class="dv">11</span> <span class="fl">17863.25</span> <span class="fl">17909.61</span> <span class="fl">17874.69</span> <span class="fl">1.0000000</span> <span class="fl">17909.61</span> <span class="fl">17909.61</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>m2  <span class="dv">2</span> <span class="sc">-</span><span class="fl">8899.228</span>    <span class="dv">1</span>  <span class="dv">15</span> <span class="fl">17828.46</span> <span class="fl">17891.67</span> <span class="fl">17844.06</span> <span class="fl">0.5504369</span> <span class="fl">18047.48</span> <span class="fl">18050.54</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>m2b <span class="dv">2</span> <span class="sc">-</span><span class="fl">8899.228</span>    <span class="dv">1</span>  <span class="dv">15</span> <span class="fl">17828.46</span> <span class="fl">17891.67</span> <span class="fl">17844.06</span> <span class="fl">0.5504369</span> <span class="fl">18047.48</span> <span class="fl">18050.54</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>m2c <span class="dv">2</span> <span class="sc">-</span><span class="fl">8899.228</span>    <span class="dv">1</span>  <span class="dv">15</span> <span class="fl">17828.46</span> <span class="fl">17891.67</span> <span class="fl">17844.06</span> <span class="fl">0.5504369</span> <span class="fl">18047.48</span> <span class="fl">18050.54</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>m2d <span class="dv">2</span> <span class="sc">-</span><span class="fl">8899.228</span>    <span class="dv">1</span>  <span class="dv">15</span> <span class="fl">17828.46</span> <span class="fl">17891.67</span> <span class="fl">17844.06</span> <span class="fl">0.5504370</span> <span class="fl">18047.48</span> <span class="fl">18050.54</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>m3g <span class="dv">3</span> <span class="sc">-</span><span class="fl">8891.351</span>    <span class="dv">1</span>  <span class="dv">19</span> <span class="fl">17820.70</span> <span class="fl">17900.78</span> <span class="fl">17840.47</span> <span class="fl">0.6240325</span> <span class="fl">18107.30</span> <span class="fl">18089.55</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>    <span class="sc">%class1 %</span>class2 %class3</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>m1    <span class="fl">100.0</span>                </span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>m2     <span class="fl">12.4</span>    <span class="fl">87.6</span>        </span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>m2b    <span class="fl">87.6</span>    <span class="fl">12.4</span>        </span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>m2c    <span class="fl">12.4</span>    <span class="fl">87.6</span>        </span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>m2d    <span class="fl">12.4</span>    <span class="fl">87.6</span>        </span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>m3g    <span class="fl">85.8</span>     <span class="fl">4.0</span>    <span class="fl">10.2</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="fu">summaryplot</span>(m1, m2, m3g, <span class="at">which =</span> <span class="fu">c</span>(<span class="st">"BIC"</span>, <span class="st">"entropy"</span>,<span class="st">"ICL"</span>))</span></code></pre></div>
<p><img src="latent_class_model_with_hlme_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p> </p>
<p align="justify">
</p>
<p>We summarize here the 6 models we previously estimated. We can see
that all the 2-class models converged at the same estimation point. Only
the order of the classes is changed. This phenomenon called “label
switching” often happens. <strong>It is not a problem: this is the exact
same optimum</strong>.</p>
This example illustrates the complexity to define the “optimal number of
latent classes”. Indeed, according to recommended BIC, the 2 class model
should be retained (as it provides the lowest value). But both the AIC
and Size adjusted BIC (which involve smaller penalties) favor the
3-class model. The entropy also favors the 3-class model as having a
better discriminatory power (entropy closer to 1). Finally, the 3-class
model creates a very very small class, which is usually not the kind of
heterogeneity ones searches for and is interested in. In this example,
depending on the statistical and clinical criteria, either the 2- or the
3-class model could be retained. Below, we retained the 2-class model
for the final output description.

<p> </p>
</div>
<div class="section level3">
<h3 id="description-of-the-2-class-linear-mixed-model">Description of the 2-class linear mixed model<a class="anchor" aria-label="anchor" href="#description-of-the-2-class-linear-mixed-model"></a>
</h3>
<div class="section level4">
<h4 id="summary-of-the-model">Summary of the model<a class="anchor" aria-label="anchor" href="#summary-of-the-model"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">summary</span>(m2d)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>Heterogenous linear mixed model </span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>     fitted by maximum likelihood method </span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a> </span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="fu">hlme</span>(<span class="at">fixed =</span> normMMSE <span class="sc">~</span> age65 <span class="sc">+</span> <span class="fu">I</span>(age65<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> CEP, <span class="at">mixture =</span> <span class="sc">~</span>age65 <span class="sc">+</span> </span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>    <span class="fu">I</span>(age65<span class="sc">^</span><span class="dv">2</span>), <span class="at">random =</span> <span class="sc">~</span>age65 <span class="sc">+</span> <span class="fu">I</span>(age65<span class="sc">^</span><span class="dv">2</span>), <span class="at">subject =</span> <span class="st">"ID"</span>, </span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>    <span class="at">ng =</span> <span class="dv">2</span>, <span class="at">data =</span> paquid)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a> </span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>Statistical Model<span class="sc">:</span> </span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>     Dataset<span class="sc">:</span> paquid </span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>     Number of subjects<span class="sc">:</span> <span class="dv">500</span> </span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>     Number of observations<span class="sc">:</span> <span class="dv">2214</span> </span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>     Number of observations deleted<span class="sc">:</span> <span class="dv">36</span> </span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>     Number of latent classes<span class="sc">:</span> <span class="dv">2</span> </span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>     Number of parameters<span class="sc">:</span> <span class="dv">15</span>  </span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a> </span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>Iteration process<span class="sc">:</span> </span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>     Convergence criteria satisfied </span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>     Number of iterations<span class="sc">:</span>  <span class="dv">1</span> </span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>     Convergence criteria<span class="sc">:</span> parameters<span class="ot">=</span> <span class="fl">1.5e-10</span> </span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a>                         <span class="sc">:</span> likelihood<span class="ot">=</span> <span class="fl">2e-11</span> </span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a>                         <span class="sc">:</span> second derivatives<span class="ot">=</span> <span class="fl">1.9e-13</span> </span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a> </span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a>Goodness<span class="sc">-</span>of<span class="sc">-</span>fit statistics<span class="sc">:</span> </span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a>     maximum log<span class="sc">-</span>likelihood<span class="sc">:</span> <span class="sc">-</span><span class="fl">8899.23</span>  </span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a>     AIC<span class="sc">:</span> <span class="fl">17828.46</span>  </span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a>     BIC<span class="sc">:</span> <span class="fl">17891.67</span>  </span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a> </span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a> </span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a>Maximum Likelihood Estimates<span class="sc">:</span> </span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a> </span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a>Fixed effects <span class="cf">in</span> the class<span class="sc">-</span>membership model<span class="sc">:</span></span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a>(the class of reference is the last class) </span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" tabindex="-1"></a>                       coef      Se     Wald p<span class="sc">-</span>value</span>
<span id="cb10-36"><a href="#cb10-36" tabindex="-1"></a>intercept class1   <span class="sc">-</span><span class="fl">1.31806</span> <span class="fl">0.23136</span>   <span class="sc">-</span><span class="fl">5.697</span> <span class="fl">0.00000</span></span>
<span id="cb10-37"><a href="#cb10-37" tabindex="-1"></a></span>
<span id="cb10-38"><a href="#cb10-38" tabindex="-1"></a>Fixed effects <span class="cf">in</span> the longitudinal model<span class="sc">:</span></span>
<span id="cb10-39"><a href="#cb10-39" tabindex="-1"></a></span>
<span id="cb10-40"><a href="#cb10-40" tabindex="-1"></a>                        coef      Se     Wald p<span class="sc">-</span>value</span>
<span id="cb10-41"><a href="#cb10-41" tabindex="-1"></a>intercept class1    <span class="fl">64.03287</span> <span class="fl">5.96887</span>   <span class="fl">10.728</span> <span class="fl">0.00000</span></span>
<span id="cb10-42"><a href="#cb10-42" tabindex="-1"></a>intercept class2    <span class="fl">63.55487</span> <span class="fl">2.34057</span>   <span class="fl">27.154</span> <span class="fl">0.00000</span></span>
<span id="cb10-43"><a href="#cb10-43" tabindex="-1"></a>age65 class1        <span class="fl">17.97202</span> <span class="fl">9.16299</span>    <span class="fl">1.961</span> <span class="fl">0.04984</span></span>
<span id="cb10-44"><a href="#cb10-44" tabindex="-1"></a>age65 class2         <span class="fl">3.55149</span> <span class="fl">3.20467</span>    <span class="fl">1.108</span> <span class="fl">0.26777</span></span>
<span id="cb10-45"><a href="#cb10-45" tabindex="-1"></a><span class="fu">I</span>(age65<span class="sc">^</span><span class="dv">2</span>) class1  <span class="sc">-</span><span class="fl">16.30143</span> <span class="fl">2.63069</span>   <span class="sc">-</span><span class="fl">6.197</span> <span class="fl">0.00000</span></span>
<span id="cb10-46"><a href="#cb10-46" tabindex="-1"></a><span class="fu">I</span>(age65<span class="sc">^</span><span class="dv">2</span>) class2   <span class="sc">-</span><span class="fl">3.81582</span> <span class="fl">1.00282</span>   <span class="sc">-</span><span class="fl">3.805</span> <span class="fl">0.00014</span></span>
<span id="cb10-47"><a href="#cb10-47" tabindex="-1"></a>CEP                 <span class="fl">14.11146</span> <span class="fl">1.33668</span>   <span class="fl">10.557</span> <span class="fl">0.00000</span></span>
<span id="cb10-48"><a href="#cb10-48" tabindex="-1"></a></span>
<span id="cb10-49"><a href="#cb10-49" tabindex="-1"></a></span>
<span id="cb10-50"><a href="#cb10-50" tabindex="-1"></a>Variance<span class="sc">-</span>covariance matrix of the random<span class="sc">-</span>effects<span class="sc">:</span></span>
<span id="cb10-51"><a href="#cb10-51" tabindex="-1"></a>            intercept     age65 <span class="fu">I</span>(age65<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb10-52"><a href="#cb10-52" tabindex="-1"></a>intercept   <span class="fl">221.24245</span>                     </span>
<span id="cb10-53"><a href="#cb10-53" tabindex="-1"></a>age65      <span class="sc">-</span><span class="fl">228.32072</span>  <span class="fl">429.3370</span>           </span>
<span id="cb10-54"><a href="#cb10-54" tabindex="-1"></a><span class="fu">I</span>(age65<span class="sc">^</span><span class="dv">2</span>)   <span class="fl">62.02014</span> <span class="sc">-</span><span class="fl">121.0904</span>   <span class="fl">36.73242</span></span>
<span id="cb10-55"><a href="#cb10-55" tabindex="-1"></a></span>
<span id="cb10-56"><a href="#cb10-56" tabindex="-1"></a>                               coef      Se</span>
<span id="cb10-57"><a href="#cb10-57" tabindex="-1"></a>Residual standard error<span class="sc">:</span>   <span class="fl">10.05486</span> <span class="fl">0.20136</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="predictions-of-the-trajectories">Predictions of the trajectories<a class="anchor" aria-label="anchor" href="#predictions-of-the-trajectories"></a>
</h4>
<p align="justify">
Class-specific predictions can be computed for any data contained in a
dataframe as soon as all the covariates specified in the model are
included in the dataframe. In the next lines, such a dataframe is
created by generating a vector of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>g</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">age</annotation></semantics></math>
values between 65 and 95 and defining
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>E</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">CEP</annotation></semantics></math>
at 1 or 0. The predictions are computed with <code>predictY</code> and
plotted with the associated <code>plot</code> functionality or by using
standard R tools.
</p>
<p> </p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_pred0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">65</span>,<span class="fl">95</span>,length.out<span class="op">=</span><span class="fl">50</span><span class="op">)</span>,CEP<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">data_pred1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">65</span>,<span class="fl">95</span>,length.out<span class="op">=</span><span class="fl">50</span><span class="op">)</span>,CEP<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">data_pred0</span><span class="op">$</span><span class="va">age65</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">data_pred0</span><span class="op">$</span><span class="va">age</span> <span class="op">-</span> <span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span></span>
<span><span class="va">data_pred1</span><span class="op">$</span><span class="va">age65</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">data_pred1</span><span class="op">$</span><span class="va">age</span> <span class="op">-</span> <span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span></span></code></pre></div>
<p> </p>
<p>Predictions are computed for each class at the point estimate:</p>
<p> </p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">m2d</span>, <span class="va">data_pred0</span>, var.time <span class="op">=</span> <span class="st">"age"</span><span class="op">)</span></span>
<span><span class="va">pred1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">m2d</span>, <span class="va">data_pred1</span>, var.time <span class="op">=</span> <span class="st">"age"</span><span class="op">)</span></span></code></pre></div>
<p> </p>
<p>Predictions can then be plotted:</p>
<p> </p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">pred0</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="st">"navy"</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">1</span>,lwd<span class="op">=</span><span class="fl">5</span>,ylab<span class="op">=</span><span class="st">"normMMSE"</span>,legend<span class="op">=</span><span class="cn">NULL</span>,  main<span class="op">=</span><span class="st">"Predicted trajectories for normMMSE "</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">pred1</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="st">"navy"</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">2</span>,lwd<span class="op">=</span><span class="fl">3</span>,legend<span class="op">=</span><span class="cn">NULL</span>,add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"topright"</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"class1 :"</span>,<span class="st">"CEP-"</span>,<span class="st">"CEP+"</span>,<span class="st">"class2:"</span>,<span class="st">"CEP-"</span>,<span class="st">"CEP+"</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"navy"</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fl">2</span>, lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">2</span>, bty<span class="op">=</span><span class="st">"n"</span>, cex <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_class_model_with_hlme_files/figure-html/unnamed-chunk-15-1.png" width="576"></p>
<p> </p>
<p>If we want to have a sense of the variability, we can compute the
predictions with confidence intervals and plot them:</p>
<p> </p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predIC0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">m2d</span>, <span class="va">data_pred0</span>, var.time <span class="op">=</span> <span class="st">"age"</span>,draws<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">predIC1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">m2d</span>, <span class="va">data_pred1</span>, var.time <span class="op">=</span> <span class="st">"age"</span>,draws<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">predIC0</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deeppink"</span>,<span class="st">"deepskyblue"</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span>, ylab<span class="op">=</span><span class="st">"normMMSE"</span>, main<span class="op">=</span><span class="st">"Predicted trajectories for normMMSE"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span>, shades<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">predIC1</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deeppink"</span>,<span class="st">"deepskyblue"</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">2</span>, ylab<span class="op">=</span><span class="st">"normMMSE"</span>, main<span class="op">=</span><span class="st">"Predicted trajectories for normMMSE"</span>, legend<span class="op">=</span><span class="cn">NULL</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span>, shades<span class="op">=</span><span class="cn">TRUE</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_class_model_with_hlme_files/figure-html/unnamed-chunk-16-1.png" width="576"></p>
<p> </p>
<p>Finally, the predicted trajectories for 1-, 2- and 3-class models can
be represented together in the following graph:</p>
<p> </p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predG1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">m1</span>, <span class="va">data_pred0</span>, var.time <span class="op">=</span> <span class="st">"age"</span><span class="op">)</span></span>
<span><span class="va">predG3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">m3g</span>, <span class="va">data_pred0</span>, var.time <span class="op">=</span> <span class="st">"age"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">predG1</span>, col<span class="op">=</span><span class="fl">1</span>, lty<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span>, ylab<span class="op">=</span><span class="st">"normMMSE"</span>, legend<span class="op">=</span><span class="cn">NULL</span>, main<span class="op">=</span><span class="st">"Predicted trajectories G=1"</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">pred0</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="st">"navy"</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span>,ylab<span class="op">=</span><span class="st">"normMMSE"</span>, legend<span class="op">=</span><span class="cn">NULL</span>, main<span class="op">=</span><span class="st">"Predicted trajectories G=2"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">predG3</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, lty<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span>, ylab<span class="op">=</span><span class="st">"normMMSE"</span>, legend<span class="op">=</span><span class="cn">NULL</span>, main<span class="op">=</span><span class="st">"Predicted trajectories G=3"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_class_model_with_hlme_files/figure-html/unnamed-chunk-17-1.png" width="960"></p>
<p> </p>
</div>
</div>
<div class="section level3">
<h3 id="evaluation-of-the-final-latent-class-mixed-model">Evaluation of the final latent class mixed model<a class="anchor" aria-label="anchor" href="#evaluation-of-the-final-latent-class-mixed-model"></a>
</h3>
<div class="section level4">
<h4 id="plot-of-the-residuals">Plot of the residuals<a class="anchor" aria-label="anchor" href="#plot-of-the-residuals"></a>
</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">m2d</span>, cex.main<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="graph-of-the-predictions-versus-observations">Graph of the predictions versus observations<a class="anchor" aria-label="anchor" href="#graph-of-the-predictions-versus-observations"></a>
</h4>
<p> </p>
<p align="justify">
In order to evaluate the fit of the selected model, we plot
simultaneously the observations and the predicted values for each latent
class.
</p>
<p> </p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">m2d</span>, which<span class="op">=</span><span class="st">"fit"</span>, var.time<span class="op">=</span><span class="st">"age"</span>, marg<span class="op">=</span><span class="cn">FALSE</span>, shades <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_class_model_with_hlme_files/figure-html/unnamed-chunk-19-1.png" width="576"></p>
<p>The graph shows here the very good fit to the data.  </p>
</div>
<div class="section level4">
<h4 id="classification">Classification<a class="anchor" aria-label="anchor" href="#classification"></a>
</h4>
<p>The posterior classification of the model is obtained with:</p>
<p> </p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">postprob</span>(m2d) </span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a> </span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>Posterior classification<span class="sc">:</span> </span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>  class1 class2</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>N   <span class="fl">62.0</span>  <span class="fl">438.0</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>%   <span class="fl">12.4</span>   <span class="fl">87.6</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a> </span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>Posterior classification table<span class="sc">:</span> </span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>     <span class="sc">-</span><span class="ot">-&gt;</span> mean of posterior probabilities <span class="cf">in</span> each class </span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>        prob1  prob2</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>class1 <span class="fl">0.8054</span> <span class="fl">0.1946</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>class2 <span class="fl">0.1270</span> <span class="fl">0.8730</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a> </span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>Posterior probabilities above a <span class="fu">threshold</span> (%)<span class="sc">:</span> </span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>         class1 class2</span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>prob<span class="sc">&gt;</span><span class="fl">0.7</span>  <span class="fl">61.29</span>  <span class="fl">90.18</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>prob<span class="sc">&gt;</span><span class="fl">0.8</span>  <span class="fl">58.06</span>  <span class="fl">69.18</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>prob<span class="sc">&gt;</span><span class="fl">0.9</span>  <span class="fl">43.55</span>  <span class="fl">47.95</span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a> </span></code></pre></div>
<p> </p>
<p align="justify">
</p>
<p><code>Class 1</code> is composed of 62 subjects (12.4%), whereas 438
are in the second class.</p>
<p>We can also see information about the discrimination power of the
model with:</p>
<ul>
<li><p>the posterior classification table: subjects classified in
<code>class 1</code> (resp. <code>class 2</code>) have a mean
probability of 0.8054 (resp. 0.8730) to belong to this class. This show
good discrimination of the classes.</p></li>
<li>
<p>the proportion of classified subjects above a threshold: here
90.18% (resp. 61.29%) of subjects in class 1 (resp. 2) are classified in
the class with a posterior probability greater than 70%.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="section level2">
<h2 id="examples-with-other-types-of-dependent-variables">Examples with other types of dependent variables<a class="anchor" aria-label="anchor" href="#examples-with-other-types-of-dependent-variables"></a>
</h2>
<p>Latent class mixed models can be estimated for other types of data
within lcmm R package:</p>
<ul>
<li><p>with lcmm function for not necessarily Gaussian longitudinal
marker</p></li>
<li><p>with multlcmm function for multiple longitudinal markers
measuring the same underlying latent process</p></li>
<li><p>with Jointlcmm (or shortcut jlcmm) function for longitudinal
markers measuring a unique longitudinal dimension and time to event
(possibly with competing risks)</p></li>
<li><p>with mpjlcmm function for multivariate longitudinal dimensions
(i.e., markers or processes measured by several markers) and time to
event (possibly with competing risks)</p></li>
<li><p>with other functions to come … !</p></li>
</ul>
<p>Each time, the same functions (e.g., summarytable, gridsearch,
postprob, predictY) apply exactly in the same way.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cecile Proust-Lima, Viviane Philipps.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
