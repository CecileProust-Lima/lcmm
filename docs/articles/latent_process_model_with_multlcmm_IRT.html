<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Continuous-time longitudinal IRT model • lcmm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Continuous-time longitudinal IRT model">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lcmm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/lcmm.html">GET STARTED</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">VIGNETTES</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/latent_class_model_with_hlme.html">How to estimate a latent class mixed model using hlme function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_lcmm.html">How to estimate a latent process mixed model using lcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm.html">How to estimate a latent process mixed model for multivariate markers using multlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm_IRT.html">Continuous-time longitudinal IRT model</a></li>
    <li><a class="dropdown-item" href="../articles/joint_latent_class_model_with_Jointlcmm.html">How to estimate a joint latent class mixed model using Jointlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/multivariate_latent_class_model_with_mpjlcmm.html">How to estimate a multivariate latent class mixed model using mpjlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/secondary_model_with_externVar.html">Accounting for latent class assignment uncertainty in subsequent analyses</a></li>
    <li><a class="dropdown-item" href="../articles/pre_normalizing.html">Pre-normalizing a dependent variable using lcmm</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/usual_problems.html">FAQ</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">REFERENCE</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">CHANGELOG</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CecileProust-Lima/lcmm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Continuous-time longitudinal IRT model</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CecileProust-Lima/lcmm/blob/HEAD/vignettes/latent_process_model_with_multlcmm_IRT.Rmd" class="external-link"><code>vignettes/latent_process_model_with_multlcmm_IRT.Rmd</code></a></small>
      <div class="d-none name"><code>latent_process_model_with_multlcmm_IRT.Rmd</code></div>
    </div>

    
    
<p>This vignette illustrates how to estimate a longitudinal IRT
following the methodology described in Proust-Lima et al. (2022 - <a href="https://doi.org/10.1016/j.ymeth.2022.01.005" class="external-link uri">https://doi.org/10.1016/j.ymeth.2022.01.005</a>). The model
combines a graded response measurement model to link a series of binary
or ordinal items measured repeatedly over time with their underlying
latent process. Simultaneously, a linear mixed model describes the
trajectory of the underlying latent process over time.</p>
<div class="section level2">
<h2 id="importation">Importation<a class="anchor" aria-label="anchor" href="#importation"></a>
</h2>
<p>The longitudinal IRT model is estimated via multlcmm function of lcmm
R package (Proust-Lima et al. 2017). The following libraries are used in
this vignette:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cecileproust-lima.github.io/lcmm/" class="external-link">lcmm</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">splines</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dataset">Dataset<a class="anchor" aria-label="anchor" href="#dataset"></a>
</h2>
<p>The illustration is on a simulated dataset that mimics the PREDIALA
study described and analyzed in Proust-Lima et al. (2021). The dataset
is called simdataIRT. It contains the following information:</p>
<ul>
<li>grp: group with 0=dialyzed and 1=preemptive</li>
<li>sex: sex with 0=woman and 1=man</li>
<li>age: age at entry in the cohort</li>
<li>hads_2 … hads_14 : 7 items of HADS measuring depression</li>
<li>ID: identification number of the patient</li>
<li>time: time of measurement (months since entry on the waiting
list)</li>
<li>time_entry: time on the waiting list at entry in the cohort (in
months)</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">simdataHADS</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    1140 obs. of  13 variables:</span></span>
<span><span class="co">#&gt;  $ grp       : int  1 0 0 0 0 0 1 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ sex       : int  1 0 0 0 0 0 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ age       : num  59.5 58.2 58.2 58.2 58.2 ...</span></span>
<span><span class="co">#&gt;  $ hads_2    : int  0 3 1 1 1 2 2 3 3 2 ...</span></span>
<span><span class="co">#&gt;  $ hads_4    : int  0 0 0 1 0 1 3 2 2 2 ...</span></span>
<span><span class="co">#&gt;  $ hads_6    : int  0 0 1 1 0 1 1 1 2 2 ...</span></span>
<span><span class="co">#&gt;  $ hads_8    : int  1 0 1 0 1 1 1 2 1 2 ...</span></span>
<span><span class="co">#&gt;  $ hads_10   : int  0 0 2 0 0 1 1 3 1 2 ...</span></span>
<span><span class="co">#&gt;  $ hads_12   : int  0 0 0 0 0 1 2 3 3 2 ...</span></span>
<span><span class="co">#&gt;  $ hads_14   : int  0 0 0 0 0 0 0 0 0 1 ...</span></span>
<span><span class="co">#&gt;  $ ID        : int  1 2 2 2 2 2 3 4 4 4 ...</span></span>
<span><span class="co">#&gt;  $ time      : num  7.74 3.18 8.95 15.08 19.74 ...</span></span>
<span><span class="co">#&gt;  $ time_entry: num  7.74 3.18 3.18 3.18 3.18 ...</span></span></code></pre></div>
<div class="section level3">
<h3 id="description-of-the-sample">Description of the sample<a class="anchor" aria-label="anchor" href="#description-of-the-sample"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">demo</span> <span class="op">&lt;-</span> <span class="va">simdataHADS</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">demo</span><span class="op">)</span></span>
<span><span class="co">#&gt;       grp              sex              age            hads_2      </span></span>
<span><span class="co">#&gt;  Min.   :0.0000   Min.   :0.0000   Min.   :55.92   Min.   :0.0000  </span></span>
<span><span class="co">#&gt;  1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:58.28   1st Qu.:0.0000  </span></span>
<span><span class="co">#&gt;  Median :1.0000   Median :1.0000   Median :59.00   Median :1.0000  </span></span>
<span><span class="co">#&gt;  Mean   :0.5722   Mean   :0.5954   Mean   :58.99   Mean   :0.8806  </span></span>
<span><span class="co">#&gt;  3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:59.62   3rd Qu.:1.0000  </span></span>
<span><span class="co">#&gt;  Max.   :1.0000   Max.   :1.0000   Max.   :61.96   Max.   :3.0000  </span></span>
<span><span class="co">#&gt;      hads_4           hads_6           hads_8         hads_10      </span></span>
<span><span class="co">#&gt;  Min.   :0.0000   Min.   :0.0000   Min.   :0.000   Min.   :0.0000  </span></span>
<span><span class="co">#&gt;  1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:1.000   1st Qu.:0.0000  </span></span>
<span><span class="co">#&gt;  Median :0.0000   Median :1.0000   Median :1.000   Median :0.0000  </span></span>
<span><span class="co">#&gt;  Mean   :0.6613   Mean   :0.6827   Mean   :1.219   Mean   :0.6292  </span></span>
<span><span class="co">#&gt;  3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:2.000   3rd Qu.:1.0000  </span></span>
<span><span class="co">#&gt;  Max.   :3.0000   Max.   :3.0000   Max.   :3.000   Max.   :3.0000  </span></span>
<span><span class="co">#&gt;     hads_12          hads_14             ID           time         </span></span>
<span><span class="co">#&gt;  Min.   :0.0000   Min.   :0.0000   Min.   :  1   Min.   : 0.06557  </span></span>
<span><span class="co">#&gt;  1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:141   1st Qu.: 2.65574  </span></span>
<span><span class="co">#&gt;  Median :0.0000   Median :0.0000   Median :281   Median : 5.14754  </span></span>
<span><span class="co">#&gt;  Mean   :0.6898   Mean   :0.3012   Mean   :281   Mean   : 8.24991  </span></span>
<span><span class="co">#&gt;  3rd Qu.:1.0000   3rd Qu.:0.0000   3rd Qu.:421   3rd Qu.:11.04918  </span></span>
<span><span class="co">#&gt;  Max.   :3.0000   Max.   :3.0000   Max.   :561   Max.   :43.14754  </span></span>
<span><span class="co">#&gt;    time_entry      </span></span>
<span><span class="co">#&gt;  Min.   : 0.06557  </span></span>
<span><span class="co">#&gt;  1st Qu.: 2.65574  </span></span>
<span><span class="co">#&gt;  Median : 5.14754  </span></span>
<span><span class="co">#&gt;  Mean   : 8.24991  </span></span>
<span><span class="co">#&gt;  3rd Qu.:11.04918  </span></span>
<span><span class="co">#&gt;  Max.   :43.14754</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="timescale-of-interest-time-on-the-waiting-list">Timescale of interest: time on the waiting list<a class="anchor" aria-label="anchor" href="#timescale-of-interest-time-on-the-waiting-list"></a>
</h3>
<p>The timescale of interest is the time in months spent on the waiting
list: time. This timescale poses two problems:</p>
<ul>
<li><p>As in many studies, entry in the study occurs for each individual
at different timings in the progression of the disease. this is called
delayed entry. It differs from the usual time in the study where entry
corresponds to time 0. Here entry (variable time_entry) corresponds to
the duration on the waiting list at inclusion, and time 0 is unlikely
observed (i.e., entry in the cohort does not occur as the same time as
entry on waiting list).</p></li>
<li><p>The timescale is continuous per se, with as many values as the
number of total observations. This prevents the use of methods
considering discrete timescales with measurements at the same times for
all the individuals, such as classical longitudinal latent variable
models.</p></li>
</ul>
<p>Distribution of the time at entry and time at follow_ups</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>tempSim <span class="ot">&lt;-</span> simdataHADS <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(time) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Visit=</span><span class="fu">ifelse</span>(time<span class="sc">==</span>time_entry,<span class="st">"Entry"</span>,<span class="st">"Follow-up"</span>))</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tempSim, <span class="fu">aes</span>(<span class="at">x=</span>time,<span class="at">fill=</span>Visit,<span class="at">color=</span>Visit)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">1</span>,<span class="fu">aes</span>(<span class="at">y=</span>..density..)) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Months on the waiting list"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_color_grey</span>(<span class="at">start =</span> <span class="fl">0.1</span>,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="at">end =</span> <span class="fl">0.5</span>)<span class="sc">+</span><span class="fu">scale_fill_grey</span>(<span class="at">start =</span> <span class="fl">0.1</span>,</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  <span class="at">end =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>Warning<span class="sc">:</span>  [<span class="dv">1</span>m [<span class="dv">22</span>mThe dot<span class="sc">-</span>dot <span class="fu">notation</span> (<span class="st">`</span><span class="at">..density..</span><span class="st">`</span>) was deprecated <span class="cf">in</span> ggplot2 <span class="dv">3</span>.<span class="dv">4</span>.<span class="fl">0.</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a> [<span class="dv">36</span>mℹ [<span class="dv">39</span>m Please use <span class="st">`</span><span class="at">after_stat(density)</span><span class="st">`</span> instead.</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a> [<span class="dv">90</span>mThis warning is displayed once every <span class="dv">8</span> hours. [<span class="dv">39</span>m</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a> [<span class="dv">90</span>mCall <span class="st">`</span><span class="at">lifecycle::last_lifecycle_warnings()</span><span class="st">`</span> to see where this warning was [<span class="dv">39</span>m</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a> [<span class="dv">90</span>mgenerated. [<span class="dv">39</span>m</span></code></pre></div>
<p><img src="latent_process_model_with_multlcmm_IRT_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<p>Quantiles of the distribution of measurement times</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">simdataHADS</span><span class="op">$</span><span class="va">time</span>,probs<span class="op">=</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;          0%         10%         20%         30%         40%         50% </span></span>
<span><span class="co">#&gt;  0.06557377  2.29508190  3.90163950  6.64590183  8.84590190 11.57377100 </span></span>
<span><span class="co">#&gt;         60%         70%         80%         90%        100% </span></span>
<span><span class="co">#&gt; 14.30163940 18.33770480 23.52131100 33.91803170 84.95082100</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="continuous-time-longitudinal-irt-model-estimation">Continuous-time longitudinal IRT model estimation<a class="anchor" aria-label="anchor" href="#continuous-time-longitudinal-irt-model-estimation"></a>
</h2>
<p>We consider here a longitudinal IRT model with natural cubic splines
on time on the waiting list to account for a possible nonlinear
trajectory over time, and we adjust the trajectory for the group. We
consider 2 internal knots placed at 7 and 15, and shift the right
boundary at 60 due to the long tail of the distribution. In the main
analysis, we estimate a model with no differential item functioning
(DIF) on the group and no response shift (RS) on time.</p>
<div class="section level3">
<h3 id="estimation-of-the-model-with-no-difrs">Estimation of the model with no DIF/RS<a class="anchor" aria-label="anchor" href="#estimation-of-the-model-with-no-difrs"></a>
</h3>
<p>To reduce the computation time, we first estimate a model with only 1
random-effect, a random intercept. And then, we use the estimates as
initial values for the estimation of the model that also includes
random-effects on the time functions. Estimation involves a numerical
integration approximated by quasi Monte-Carlo (QMC) with 1000 points.
This induces very intensive and long computations but was shown to give
accurate results in simulations.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modIRT_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multlcmm.html">multlcmm</a></span><span class="op">(</span><span class="va">hads_2</span> <span class="op">+</span> <span class="va">hads_4</span> <span class="op">+</span><span class="va">hads_6</span> <span class="op">+</span> <span class="va">hads_8</span> <span class="op">+</span><span class="va">hads_10</span><span class="op">+</span><span class="va">hads_12</span> <span class="op">+</span> <span class="va">hads_14</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">time</span>,knots<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">15</span><span class="op">)</span>,Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">60</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">grp</span>,random<span class="op">=</span><span class="op">~</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">simdataHADS</span>,subject<span class="op">=</span><span class="st">"ID"</span>,link<span class="op">=</span><span class="st">"thresholds"</span>,methInteg<span class="op">=</span><span class="st">"QMC"</span>,nMC<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="co"># use the estimates as initial values - the vector c(0,1,0,0,1,0,0,0,1) initializes the cholesky matrix of the random-effects</span></span>
<span><span class="va">Binit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">modIRT_i</span><span class="op">$</span><span class="va">best</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,<span class="va">modIRT_i</span><span class="op">$</span><span class="va">best</span><span class="op">[</span><span class="fl">8</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">modIRT_i</span><span class="op">$</span><span class="va">best</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">modIRT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multlcmm.html">multlcmm</a></span><span class="op">(</span><span class="va">hads_2</span> <span class="op">+</span> <span class="va">hads_4</span> <span class="op">+</span><span class="va">hads_6</span> <span class="op">+</span> <span class="va">hads_8</span> <span class="op">+</span><span class="va">hads_10</span><span class="op">+</span><span class="va">hads_12</span> <span class="op">+</span> <span class="va">hads_14</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">time</span>,knots<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">15</span><span class="op">)</span>,Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">60</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">grp</span>,random<span class="op">=</span><span class="op">~</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">time</span>,knots<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">15</span><span class="op">)</span>,Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">60</span><span class="op">)</span><span class="op">)</span>,data<span class="op">=</span><span class="va">simdataHADS</span>,subject<span class="op">=</span><span class="st">"ID"</span>,link<span class="op">=</span><span class="st">"thresholds"</span>,methInteg<span class="op">=</span><span class="st">"QMC"</span>,nMC<span class="op">=</span><span class="fl">1000</span>, B<span class="op">=</span><span class="va">Binit</span><span class="op">)</span></span></code></pre></div>
<p>The summary of the estimation:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">modIRT</span><span class="op">)</span></span>
<span><span class="co">#&gt; General latent class mixed model </span></span>
<span><span class="co">#&gt;      fitted by maximum likelihood method </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; multlcmm(fixed = hads_2 + hads_4 + hads_6 + hads_8 + hads_10 + </span></span>
<span><span class="co">#&gt;     hads_12 + hads_14 ~ ns(time, knots = c(7, 15), Boundary.knots = c(0, </span></span>
<span><span class="co">#&gt;     60)) * grp, random = ~1 + ns(time, knots = c(7, 15), Boundary.knots = c(0, </span></span>
<span><span class="co">#&gt;     60)), subject = "ID", link = "thresholds", data = simdataHADS, </span></span>
<span><span class="co">#&gt;     methInteg = "QMC", nMC = 1000, nproc = 20)</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Statistical Model: </span></span>
<span><span class="co">#&gt;      Dataset: simdataHADS </span></span>
<span><span class="co">#&gt;      Number of subjects: 561 </span></span>
<span><span class="co">#&gt;      Number of observations: 7980 </span></span>
<span><span class="co">#&gt;      Number of latent classes: 1 </span></span>
<span><span class="co">#&gt;      Number of parameters: 44  </span></span>
<span><span class="co">#&gt;      Link functions: Thresholds for hads_2 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_4 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_6 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_8 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_10 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_12 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_14 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Iteration process: </span></span>
<span><span class="co">#&gt;      Convergence criteria satisfied </span></span>
<span><span class="co">#&gt;      Number of iterations:  23 </span></span>
<span><span class="co">#&gt;      Convergence criteria: parameters= 1.5e-07 </span></span>
<span><span class="co">#&gt;                          : likelihood= 2.9e-05 </span></span>
<span><span class="co">#&gt;                          : second derivatives= 6e-06 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Goodness-of-fit statistics: </span></span>
<span><span class="co">#&gt;      maximum log-likelihood: -7218.07  </span></span>
<span><span class="co">#&gt;      AIC: 14524.13  </span></span>
<span><span class="co">#&gt;      BIC: 14714.64  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Maximum Likelihood Estimates: </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Fixed effects in the longitudinal model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                               coef      Se   Wald p-value</span></span>
<span><span class="co">#&gt; intercept (not estimated)  0.00000                       </span></span>
<span><span class="co">#&gt; ns(...)1                  -0.12557 0.13637 -0.921 0.35718</span></span>
<span><span class="co">#&gt; ns(...)2                   0.21602 0.22892  0.944 0.34534</span></span>
<span><span class="co">#&gt; ns(...)3                   0.52819 0.17406  3.034 0.00241</span></span>
<span><span class="co">#&gt; grp                       -0.56649 0.15226 -3.721 0.00020</span></span>
<span><span class="co">#&gt; ns(...)1:grp               0.21044 0.20316  1.036 0.30027</span></span>
<span><span class="co">#&gt; ns(...)2:grp               0.46316 0.33009  1.403 0.16058</span></span>
<span><span class="co">#&gt; ns(...)3:grp              -0.00636 0.24646 -0.026 0.97942</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variance-covariance matrix of the random-effects:</span></span>
<span><span class="co">#&gt; (the variance of the first random effect is not estimated)</span></span>
<span><span class="co">#&gt;           intercept ns(...)1 ns(...)2 ns(...)3</span></span>
<span><span class="co">#&gt; intercept   1.00000                           </span></span>
<span><span class="co">#&gt; ns(...)1   -0.46121  0.84470                  </span></span>
<span><span class="co">#&gt; ns(...)2   -1.14421  1.12605  2.66212         </span></span>
<span><span class="co">#&gt; ns(...)3   -0.26878  0.58923  0.66262  0.46238</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                            hads_2   hads_4   hads_6   hads_8  hads_10  hads_12</span></span>
<span><span class="co">#&gt; Residual standard error:  0.79159  0.64076  1.03750  1.00833  1.06157  0.68536</span></span>
<span><span class="co">#&gt;                           hads_14</span></span>
<span><span class="co">#&gt; Residual standard error:  1.63011</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameters of the link functions:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                     coef      Se   Wald p-value</span></span>
<span><span class="co">#&gt; hads_2-Thresh1  -0.53483 0.11863 -4.508 0.00001</span></span>
<span><span class="co">#&gt; hads_2-Thresh2   1.13007 0.05254 21.509 0.00000</span></span>
<span><span class="co">#&gt; hads_2-Thresh3   0.89283 0.04974 17.949 0.00000</span></span>
<span><span class="co">#&gt; hads_4-Thresh1  -0.22854 0.10998 -2.078 0.03770</span></span>
<span><span class="co">#&gt; hads_4-Thresh2   1.01804 0.04766 21.361 0.00000</span></span>
<span><span class="co">#&gt; hads_4-Thresh3   1.04826 0.05791 18.102 0.00000</span></span>
<span><span class="co">#&gt; hads_6-Thresh1  -0.37848 0.11770 -3.216 0.00130</span></span>
<span><span class="co">#&gt; hads_6-Thresh2   1.35627 0.06718 20.188 0.00000</span></span>
<span><span class="co">#&gt; hads_6-Thresh3   1.32585 0.09338 14.198 0.00000</span></span>
<span><span class="co">#&gt; hads_8-Thresh1  -1.37992 0.16595 -8.315 0.00000</span></span>
<span><span class="co">#&gt; hads_8-Thresh2   1.34364 0.06319 21.262 0.00000</span></span>
<span><span class="co">#&gt; hads_8-Thresh3   1.10211 0.05741 19.196 0.00000</span></span>
<span><span class="co">#&gt; hads_10-Thresh1 -0.01232 0.11044 -0.112 0.91115</span></span>
<span><span class="co">#&gt; hads_10-Thresh2  1.00872 0.05355 18.839 0.00000</span></span>
<span><span class="co">#&gt; hads_10-Thresh3  1.10947 0.06459 17.176 0.00000</span></span>
<span><span class="co">#&gt; hads_12-Thresh1 -0.19444 0.11018 -1.765 0.07760</span></span>
<span><span class="co">#&gt; hads_12-Thresh2  0.99923 0.04764 20.973 0.00000</span></span>
<span><span class="co">#&gt; hads_12-Thresh3  1.02758 0.05720 17.966 0.00000</span></span>
<span><span class="co">#&gt; hads_14-Thresh1  0.92540 0.17048  5.428 0.00000</span></span>
<span><span class="co">#&gt; hads_14-Thresh2  1.49075 0.09725 15.330 0.00000</span></span>
<span><span class="co">#&gt; hads_14-Thresh3  0.87089 0.10087  8.634 0.00000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="predicted-underlying-depressive-symptomatolgy-trajectory">Predicted underlying depressive symptomatolgy trajectory<a class="anchor" aria-label="anchor" href="#predicted-underlying-depressive-symptomatolgy-trajectory"></a>
</h3>
<div class="section level4">
<h4 id="plot-of-predicted-mean-trajectories">plot of predicted mean trajectories<a class="anchor" aria-label="anchor" href="#plot-of-predicted-mean-trajectories"></a>
</h4>
<p>The predicted trajectory of the underlying process can be obtained
with predictL function and the associated plot function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datnew</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">75</span>,by<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">grp</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pIRT0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictL.html">predictL</a></span><span class="op">(</span><span class="va">modIRT</span>,<span class="va">datnew</span>,var.time<span class="op">=</span><span class="st">"time"</span>,confint <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">grp</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">pIRT1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictL.html">predictL</a></span><span class="op">(</span><span class="va">modIRT</span>,<span class="va">datnew</span>,var.time<span class="op">=</span><span class="st">"time"</span>,confint <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">pIRT0</span>,col<span class="op">=</span><span class="fl">1</span>,lwd<span class="op">=</span><span class="fl">2</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>,<span class="fl">1.5</span><span class="op">)</span>,legend<span class="op">=</span><span class="cn">NULL</span>,main<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">"latent depressive symptomatology"</span>,xlab<span class="op">=</span><span class="st">"months since entry on the waiting list"</span>,type<span class="op">=</span><span class="st">"l"</span>,bty<span class="op">=</span><span class="st">"l"</span>,shades<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">pIRT1</span>,add<span class="op">=</span><span class="cn">T</span>,col<span class="op">=</span><span class="fl">4</span>,lwd<span class="op">=</span><span class="fl">2</span>,shades<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"topleft"</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dialysed"</span>,<span class="st">"preemptive"</span><span class="op">)</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">2</span>,bty<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_process_model_with_multlcmm_IRT_files/figure-html/unnamed-chunk-9-1.png" width="576"></p>
</div>
<div class="section level4">
<h4 id="posteriori-distribution">Posteriori distribution<a class="anchor" aria-label="anchor" href="#posteriori-distribution"></a>
</h4>
<p>To better appreciate the range of the underlying depressive
symptomatology, the empirical posterior distribution can be computed</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>beta <span class="ot">&lt;-</span> modIRT<span class="sc">$</span>best</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">72</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">length</span>(t)),<span class="fu">ns</span>(t,<span class="at">knots=</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">15</span>),<span class="at">Boundary.knots =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">60</span>)))</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>chol <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">ncol=</span><span class="dv">4</span>,<span class="at">nrow=</span><span class="dv">4</span>)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>chol[<span class="fu">upper.tri</span>(chol, <span class="at">diag =</span> T)] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,beta[<span class="dv">7</span><span class="sc">:</span><span class="dv">15</span>])</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>Lambda0 <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="dv">10000</span>,<span class="at">mean =</span> Z<span class="sc">%*%</span><span class="fu">c</span>(<span class="dv">0</span>,beta[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]),Z<span class="sc">%*%</span><span class="fu">t</span>(chol)<span class="sc">%*%</span>chol<span class="sc">%*%</span><span class="fu">t</span>(Z))</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>Lambda1 <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="dv">10000</span>,<span class="at">mean =</span> Z<span class="sc">%*%</span>beta[<span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>],Z<span class="sc">%*%</span><span class="fu">t</span>(chol)<span class="sc">%*%</span>chol<span class="sc">%*%</span><span class="fu">t</span>(Z))</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>Lambda <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Lambda =</span> <span class="fu">as.vector</span>(<span class="fu">rbind</span>(Lambda0,Lambda1)))</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>phist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Lambda,<span class="fu">aes</span>(<span class="at">x=</span>Lambda))<span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">"grey"</span>, <span class="at">fill=</span><span class="st">"grey"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"underlying depressive symptomatology"</span>) <span class="sc">+</span><span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">7</span>,<span class="dv">7</span>)</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>phist</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>Warning<span class="sc">:</span>  [<span class="dv">1</span>m [<span class="dv">22</span>mRemoved <span class="dv">31365</span> rows containing non<span class="sc">-</span>finite values</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>(<span class="st">`</span><span class="at">stat_density()</span><span class="st">`</span>).</span></code></pre></div>
<p><img src="latent_process_model_with_multlcmm_IRT_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
<p>The 95% range of the underlying distribution is approximately:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">Lambda</span><span class="op">$</span><span class="va">Lambda</span>,p<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>,<span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      2.5%     97.5% </span></span>
<span><span class="co">#&gt; -5.436176  5.526873</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="location-and-discrimination-of-the-items-with-se-by-delta-method">Location and discrimination of the items (with SE by
Delta-Method)<a class="anchor" aria-label="anchor" href="#location-and-discrimination-of-the-items-with-se-by-delta-method"></a>
</h3>
<p>The location and discrimination parameters are transformations of the
estimated parameters. They are retrieved with the following code:</p>
<ul>
<li>isolate the corresponding parameters within the vector of estimated
parameters (and the corresponding variance covariance matrix)</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Parameters</span></span>
<span><span class="va">nlevel</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">nitems</span> <span class="op">&lt;-</span> <span class="fl">7</span></span>
<span><span class="va">levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">nlevel</span>,<span class="va">nitems</span><span class="op">)</span></span>
<span><span class="va">npm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">modIRT</span><span class="op">$</span><span class="va">best</span><span class="op">)</span></span>
<span><span class="va">seuils</span> <span class="op">&lt;-</span> <span class="va">modIRT</span><span class="op">$</span><span class="va">best</span><span class="op">[</span><span class="op">(</span><span class="va">npm</span><span class="op">-</span><span class="op">(</span><span class="va">nlevel</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">nitems</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">npm</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">err</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">modIRT</span><span class="op">$</span><span class="va">best</span><span class="op">[</span><span class="op">(</span><span class="va">npm</span><span class="op">-</span><span class="op">(</span><span class="va">nlevel</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">nitems</span><span class="op">)</span><span class="op">-</span><span class="op">(</span><span class="va">nitems</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">npm</span><span class="op">-</span><span class="op">(</span><span class="va">nlevel</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">nitems</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">seuils</span></span>
<span><span class="co">#&gt;     Thresh1     Thresh2     Thresh3     Thresh1     Thresh2     Thresh3 </span></span>
<span><span class="co">#&gt; -0.53482702  1.13007471  0.89283211 -0.22854149  1.01804259  1.04826421 </span></span>
<span><span class="co">#&gt;     Thresh1     Thresh2     Thresh3     Thresh1     Thresh2     Thresh3 </span></span>
<span><span class="co">#&gt; -0.37847963  1.35626552  1.32584882 -1.37992176  1.34363560  1.10210680 </span></span>
<span><span class="co">#&gt;     Thresh1     Thresh2     Thresh3     Thresh1     Thresh2     Thresh3 </span></span>
<span><span class="co">#&gt; -0.01232312  1.00871824  1.10947092 -0.19444285  0.99923061  1.02758213 </span></span>
<span><span class="co">#&gt;     Thresh1     Thresh2     Thresh3 </span></span>
<span><span class="co">#&gt;  0.92539951  1.49075284  0.87088592</span></span>
<span><span class="va">err</span></span>
<span><span class="co">#&gt; std.err 1 std.err 2 std.err 3 std.err 4 std.err 5 std.err 6 std.err 7 </span></span>
<span><span class="co">#&gt; 0.7915877 0.6407606 1.0374977 1.0083297 1.0615722 0.6853637 1.6301109</span></span>
<span><span class="co"># Variance</span></span>
<span><span class="va">Vseuils</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/VarCov.html">VarCov</a></span><span class="op">(</span><span class="va">modIRT</span><span class="op">)</span><span class="op">[</span><span class="op">(</span><span class="va">npm</span><span class="op">-</span><span class="op">(</span><span class="va">nlevel</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">nitems</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">npm</span><span class="op">)</span>,<span class="op">(</span><span class="va">npm</span><span class="op">-</span><span class="op">(</span><span class="va">nlevel</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">nitems</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">npm</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">Verr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/VarCov.html">VarCov</a></span><span class="op">(</span><span class="va">modIRT</span><span class="op">)</span><span class="op">[</span><span class="op">(</span><span class="va">npm</span><span class="op">-</span><span class="op">(</span><span class="va">nlevel</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">nitems</span><span class="op">)</span><span class="op">-</span><span class="op">(</span><span class="va">nitems</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">npm</span><span class="op">-</span><span class="op">(</span><span class="va">nlevel</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">nitems</span><span class="op">)</span><span class="op">)</span>,<span class="op">(</span><span class="va">npm</span><span class="op">-</span><span class="op">(</span><span class="va">nlevel</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">nitems</span><span class="op">)</span><span class="op">-</span><span class="op">(</span><span class="va">nitems</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">npm</span><span class="op">-</span><span class="op">(</span><span class="va">nlevel</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">nitems</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<ul>
<li>retransform these parameters to obtain the locations and the
discrimination of each item with corresponding standard deviation
(computed via Delta-method)</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generic function</span></span>
<span><span class="va">location</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">min</span>,<span class="va">max</span>,<span class="va">param</span>,<span class="va">Vparam</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">loc</span> <span class="op">&lt;-</span> <span class="va">param</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">Vparam</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">param2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">param</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">param2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="va">max</span><span class="op">-</span><span class="va">min</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">l</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">max</span><span class="op">-</span><span class="va">min</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">param2</span><span class="op">[</span><span class="va">l</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="va">param</span><span class="op">[</span><span class="va">l</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span></span>
<span>      <span class="va">loc</span><span class="op">[</span><span class="va">l</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">loc</span><span class="op">[</span><span class="va">l</span><span class="op">]</span> <span class="op">+</span> <span class="va">param</span><span class="op">[</span><span class="fl">1</span><span class="op">+</span><span class="va">l</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span></span>
<span>      <span class="va">se</span><span class="op">[</span><span class="va">l</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">param2</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">Vparam</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">param2</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">loc</span>,<span class="va">se</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># application</span></span>
<span><span class="va">ItemLoc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nitems</span>,<span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/defunct.html" class="external-link">location</a></span><span class="op">(</span>min<span class="op">=</span><span class="fl">0</span>,max<span class="op">=</span><span class="va">nlevel</span><span class="op">-</span><span class="fl">1</span>,param<span class="op">=</span><span class="va">seuils</span><span class="op">[</span><span class="op">(</span><span class="op">(</span><span class="va">nlevel</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="op">(</span><span class="va">nlevel</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">k</span><span class="op">)</span><span class="op">]</span>,Vparam<span class="op">=</span><span class="va">Vseuils</span><span class="op">[</span><span class="op">(</span><span class="op">(</span><span class="va">nlevel</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="op">(</span><span class="va">nlevel</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">k</span><span class="op">)</span>,<span class="op">(</span><span class="op">(</span><span class="va">nlevel</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="op">(</span><span class="va">nlevel</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">k</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">ItemLoc</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Item"</span>,<span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nitems</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">ItemLoc</span> <span class="op">&lt;-</span> <span class="va">ItemLoc</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">3</span>,<span class="fl">6</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ItemLoc</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Threshold"</span>,<span class="st">"SE"</span><span class="op">)</span>,<span class="va">nlevel</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">discrimination</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">err</span><span class="op">)</span></span>
<span><span class="va">sediscr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">err</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">Verr</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">err</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The 3 thresholds and discrimination estimates of each item are:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">ItemLoc</span>,<span class="va">discrimination</span>,Se<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">sediscr</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;           Threshold        SE Threshold        SE Threshold        SE</span></span>
<span><span class="co">#&gt; Item 2  -0.53482702 0.1186315 0.7422418 0.1288603  1.539391 0.1787193</span></span>
<span><span class="co">#&gt; Item 4  -0.22854149 0.1099764 0.8078692 0.1294450  1.906727 0.2056184</span></span>
<span><span class="co">#&gt; Item 6  -0.37847963 0.1177005 1.4609765 0.1831477  3.218852 0.3678817</span></span>
<span><span class="co">#&gt; Item 8  -1.37992176 0.1659480 0.4254349 0.1201425  1.640074 0.1930347</span></span>
<span><span class="co">#&gt; Item 10 -0.01232312 0.1104402 1.0051894 0.1503464  2.236115 0.2509225</span></span>
<span><span class="co">#&gt; Item 12 -0.19444285 0.1101780 0.8040190 0.1314460  1.859944 0.2049276</span></span>
<span><span class="co">#&gt; Item 14  0.92539951 0.1704771 3.1477435 0.4110930  3.906186 0.5132664</span></span>
<span><span class="co">#&gt;         discrimination         Se</span></span>
<span><span class="co">#&gt; Item 2       1.2632839 0.12076274</span></span>
<span><span class="co">#&gt; Item 4       1.5606453 0.15190436</span></span>
<span><span class="co">#&gt; Item 6       0.9638575 0.09865421</span></span>
<span><span class="co">#&gt; Item 8       0.9917392 0.09708010</span></span>
<span><span class="co">#&gt; Item 10      0.9419990 0.09708166</span></span>
<span><span class="co">#&gt; Item 12      1.4590793 0.14172215</span></span>
<span><span class="co">#&gt; Item 14      0.6134552 0.07734546</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="item-category-probability-curve">item category probability curve<a class="anchor" aria-label="anchor" href="#item-category-probability-curve"></a>
</h3>
<p>The curve of each item category probability according to the
underlying level of depressive symptomatology can be obtain usinf the
ItemInfo function.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## computations</span></span>
<span><span class="va">info_modIRT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ItemInfo.html">ItemInfo</a></span><span class="op">(</span><span class="va">modIRT</span>, lprocess<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>,<span class="fl">6</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">meaning</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Enjoy"</span>,<span class="st">"Laugh"</span>,<span class="st">"Cheerful"</span> ,<span class="st">"Slow"</span> ,<span class="st">"Appearance"</span> ,<span class="st">"Looking Forward"</span> ,<span class="st">"Leisure"</span><span class="op">)</span></span>
<span><span class="va">items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"hads"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">14</span>,<span class="fl">2</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## automatic graph</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0.5</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="op">{</span>     </span>
<span> <span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">info_modIRT</span>, which<span class="op">=</span><span class="st">"LevelProb"</span>, outcome<span class="op">=</span><span class="va">items</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>,</span>
<span>      main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Item"</span>,<span class="fl">2</span><span class="op">*</span><span class="va">k</span>,<span class="st">"-"</span>,<span class="va">meaning</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fl">2</span>, legend<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="fl">0</span>,axes<span class="op">=</span><span class="cn">FALSE</span>, xlab<span class="op">=</span><span class="st">""</span>, ylab<span class="op">=</span><span class="st">""</span>, col<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"center"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Level"</span>,<span class="fl">0</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, col<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, lwd<span class="op">=</span><span class="fl">2</span>, box.lty<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_process_model_with_multlcmm_IRT_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="do">## graph with ggplot</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>){</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>ICC  <span class="ot">&lt;-</span> info_modIRT<span class="sc">$</span>LevelInfo[<span class="fu">which</span>(info_modIRT<span class="sc">$</span>LevelInfo[,<span class="dv">1</span>]<span class="sc">==</span>items[k]),]</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>p[[k]] <span class="ot">&lt;-</span> (<span class="fu">ggplot</span>(ICC)</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>      <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Lprocess, <span class="at">y =</span> Prob, <span class="at">group =</span> Level,<span class="at">color=</span>Level), <span class="at">show.legend =</span> F,<span class="at">alpha =</span> <span class="dv">1</span>,<span class="at">size=</span><span class="fl">1.2</span>)</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>      <span class="co"># + stat_smooth(aes(x = time, y = hads_scorea), method = "loess", size = 0.75)</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>      <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>      <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="fu">paste</span>(<span class="st">"Item"</span>,<span class="dv">2</span><span class="sc">*</span>k,<span class="st">"-"</span>,meaning[k]))</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>      <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"construct"</span>)</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>      <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>      <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Probability of item level"</span>))</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>}</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>Warning<span class="sc">:</span>  [<span class="dv">1</span>m [<span class="dv">22</span>mUsing <span class="st">`</span><span class="at">size</span><span class="st">`</span> aesthetic <span class="cf">for</span> lines was deprecated <span class="cf">in</span> ggplot2 <span class="dv">3</span>.<span class="dv">4</span>.<span class="fl">0.</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a> [<span class="dv">36</span>mℹ [<span class="dv">39</span>m Please use <span class="st">`</span><span class="at">linewidth</span><span class="st">`</span> instead.</span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a> [<span class="dv">90</span>mThis warning is displayed once every <span class="dv">8</span> hours. [<span class="dv">39</span>m</span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a> [<span class="dv">90</span>mCall <span class="st">`</span><span class="at">lifecycle::last_lifecycle_warnings()</span><span class="st">`</span> to see where this warning was [<span class="dv">39</span>m</span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a> [<span class="dv">90</span>mgenerated. [<span class="dv">39</span>m</span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a>p[[<span class="dv">8</span>]] <span class="ot">&lt;-</span> (<span class="fu">ggplot</span>(ICC)</span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a>      <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Lprocess, <span class="at">y =</span> Prob, <span class="at">group =</span> Level,<span class="at">color=</span>Level),<span class="at">alpha =</span> <span class="dv">1</span>,<span class="at">size=</span><span class="fl">1.2</span>)</span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a>      <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a>)</span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a>legend <span class="ot">&lt;-</span> <span class="fu">get_legend</span>(p[[<span class="dv">8</span>]])</span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="fu">grid.arrange</span>(p[[<span class="dv">1</span>]],p[[<span class="dv">2</span>]],p[[<span class="dv">3</span>]],p[[<span class="dv">4</span>]],p[[<span class="dv">5</span>]],p[[<span class="dv">6</span>]],p[[<span class="dv">7</span>]],<span class="fu">as_ggplot</span>(legend),<span class="at">ncol=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="latent_process_model_with_multlcmm_IRT_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="item-characteristic-curves">Item characteristic curves<a class="anchor" aria-label="anchor" href="#item-characteristic-curves"></a>
</h3>
<p>The following code computes the expectation of each item according to
the underlying level of depressive symptomatology. This is achieved with
predictYcond function with two plot possibilities: direct plot function
or ggplot</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">expe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictYcond.html">predictYcond</a></span><span class="op">(</span><span class="va">modIRT</span>,lprocess <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>,<span class="fl">6</span>,by<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># via the internal plot function </span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">expe</span>, xlab<span class="op">=</span><span class="st">"underlying depressive symptomatology"</span>, main<span class="op">=</span><span class="st">"Item Expectation Curves"</span>,</span>
<span>     legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Item"</span>,<span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nitems</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_process_model_with_multlcmm_IRT_files/figure-html/unnamed-chunk-17-1.png" width="672"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># via ggplot</span></span>
<span><span class="va">j</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">expe</span><span class="op">$</span><span class="va">pred</span><span class="op">$</span><span class="va">Yname</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">expe</span><span class="op">$</span><span class="va">pred</span><span class="op">$</span><span class="va">item</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>,<span class="va">j</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">4</span>,<span class="va">j</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">6</span>,<span class="va">j</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">8</span>,<span class="va">j</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>,<span class="va">j</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">12</span>,<span class="va">j</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">14</span>,<span class="va">j</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">expe</span><span class="op">$</span><span class="va">pred</span><span class="op">)</span></span>
<span>      <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Lprocess</span>, y <span class="op">=</span> <span class="va">Ypred</span>, group<span class="op">=</span><span class="va">item</span>,color<span class="op">=</span><span class="va">item</span><span class="op">)</span>,alpha <span class="op">=</span> <span class="fl">1</span>,size<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span></span>
<span>      <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span>      <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"underlying depressive symptomatology"</span><span class="op">)</span></span>
<span>      <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">3</span><span class="op">)</span></span>
<span>      <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Item Expectation"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="latent_process_model_with_multlcmm_IRT_files/figure-html/unnamed-chunk-18-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="item-information-function">Item Information Function<a class="anchor" aria-label="anchor" href="#item-information-function"></a>
</h3>
<p>The level of information brought by each item category (information
share) and brought in total by each item is also computed by the
ItemInfo function. The curves can be again plotted directly with options
which=“LevelInfo” and which=“ItemInfo” respectively.</p>
<div class="section level4">
<h4 id="by-category">by Category<a class="anchor" aria-label="anchor" href="#by-category"></a>
</h4>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0.5</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="op">{</span>     </span>
<span> <span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">info_modIRT</span>, which<span class="op">=</span><span class="st">"LevelInfo"</span>, outcome<span class="op">=</span><span class="va">items</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>,</span>
<span> main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Item"</span>,<span class="fl">2</span><span class="op">*</span><span class="va">k</span>,<span class="st">"-"</span>,<span class="va">meaning</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fl">2</span>, legend<span class="op">=</span><span class="cn">NULL</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1.3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="fl">0</span>,axes<span class="op">=</span><span class="cn">FALSE</span>, xlab<span class="op">=</span><span class="st">""</span>, ylab<span class="op">=</span><span class="st">""</span>, col<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"center"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Level"</span>,<span class="fl">0</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, col<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, lwd<span class="op">=</span><span class="fl">2</span>, box.lty<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_process_model_with_multlcmm_IRT_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="by-item">by Item<a class="anchor" aria-label="anchor" href="#by-item"></a>
</h4>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">info_modIRT</span>, which<span class="op">=</span><span class="st">"ItemInfo"</span>, lwd<span class="op">=</span><span class="fl">2</span>, legend.loc<span class="op">=</span><span class="st">"topleft"</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_process_model_with_multlcmm_IRT_files/figure-html/unnamed-chunk-20-1.png" width="576"></p>
</div>
</div>
<div class="section level3">
<h3 id="predicted-item-trajectory-according-to-time">Predicted item trajectory according to time<a class="anchor" aria-label="anchor" href="#predicted-item-trajectory-according-to-time"></a>
</h3>
<p>Item predicted trajectories according to a specific profile of
covariates can be computed using predictY function:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">datnew</span><span class="op">)</span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">grp</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ns0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">modIRT</span>,var.time <span class="op">=</span> <span class="st">"time"</span>,newdata<span class="op">=</span><span class="va">datnew</span>,methInteg <span class="op">=</span> <span class="fl">1</span>,nsim<span class="op">=</span><span class="fl">2000</span>,draws<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">grp</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">ns1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">modIRT</span>,var.time <span class="op">=</span> <span class="st">"time"</span>,newdata<span class="op">=</span><span class="va">datnew</span>,methInteg <span class="op">=</span> <span class="fl">1</span>,nsim<span class="op">=</span><span class="fl">2000</span>,draws<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0.5</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">{</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">ns0</span>,outcome <span class="op">=</span> <span class="va">k</span>,shades <span class="op">=</span> <span class="cn">T</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">3</span><span class="op">)</span>,bty<span class="op">=</span><span class="st">"l"</span>,legend<span class="op">=</span><span class="cn">NULL</span>,main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Item"</span>,<span class="fl">2</span><span class="op">*</span><span class="va">k</span>,<span class="st">"-"</span>,<span class="va">meaning</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">)</span>,ylab<span class="op">=</span><span class="st">"Item level"</span>,xlab<span class="op">=</span><span class="st">"months on the waiting list"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">ns1</span>,outcome<span class="op">=</span><span class="va">k</span>,shades<span class="op">=</span><span class="cn">T</span>,add<span class="op">=</span><span class="cn">T</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="latent_process_model_with_multlcmm_IRT_files/figure-html/unnamed-chunk-22-1.png" width="576"></p>
</div>
</div>
<div class="section level2">
<h2 id="assessment-of-dif-and-rs">Assessment of DIF and RS<a class="anchor" aria-label="anchor" href="#assessment-of-dif-and-rs"></a>
</h2>
<div class="section level3">
<h3 id="estimation-of-the-irt-model-with-a-dif-on-group">Estimation of the IRT model with a DIF on group<a class="anchor" aria-label="anchor" href="#estimation-of-the-irt-model-with-a-dif-on-group"></a>
</h3>
<p>DIF is programmed using contrasts (item-specific departure around the
mean effect on the underlying latent process)</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># initialization of the parameter vector for faster convergence</span></span>
<span><span class="va">npm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">modIRT</span><span class="op">$</span><span class="va">best</span><span class="op">)</span></span>
<span><span class="va">Binit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">modIRT</span><span class="op">$</span><span class="va">best</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="op">(</span><span class="va">nitems</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,<span class="va">modIRT</span><span class="op">$</span><span class="va">best</span><span class="op">[</span><span class="op">(</span><span class="va">npm</span><span class="op">-</span><span class="va">nlevel</span><span class="op">*</span><span class="va">nitems</span><span class="op">-</span><span class="fl">9</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">npm</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># estimation</span></span>
<span><span class="va">modIRT_DIFg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multlcmm.html">multlcmm</a></span><span class="op">(</span><span class="va">hads_2</span> <span class="op">+</span> <span class="va">hads_4</span> <span class="op">+</span><span class="va">hads_6</span> <span class="op">+</span> <span class="va">hads_8</span> <span class="op">+</span><span class="va">hads_10</span><span class="op">+</span><span class="va">hads_12</span> <span class="op">+</span> <span class="va">hads_14</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">time</span>,knots<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">15</span><span class="op">)</span>,Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">60</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">grp</span><span class="op">)</span> <span class="op">+</span><span class="fu">contrast</span><span class="op">(</span><span class="va">grp</span><span class="op">)</span>,random<span class="op">=</span><span class="op">~</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">time</span>,knots<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">15</span><span class="op">)</span>,Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">60</span><span class="op">)</span><span class="op">)</span>,data<span class="op">=</span><span class="va">simdataHADS</span>,subject<span class="op">=</span><span class="st">"ID"</span>,link<span class="op">=</span><span class="st">"thresholds"</span>,methInteg<span class="op">=</span><span class="st">"QMC"</span>,nMC<span class="op">=</span><span class="fl">1000</span>,B<span class="op">=</span><span class="va">Binit</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sumDIF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">modIRT_DIFg</span><span class="op">)</span></span>
<span><span class="co">#&gt; General latent class mixed model </span></span>
<span><span class="co">#&gt;      fitted by maximum likelihood method </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; multlcmm(fixed = hads_2 + hads_4 + hads_6 + hads_8 + hads_10 + </span></span>
<span><span class="co">#&gt;     hads_12 + hads_14 ~ ns(time, knots = c(7, 15), Boundary.knots = c(0, </span></span>
<span><span class="co">#&gt;     60)) * (grp) + contrast(grp), random = ~1 + ns(time, knots = c(7, </span></span>
<span><span class="co">#&gt;     15), Boundary.knots = c(0, 60)), subject = "ID", link = "thresholds", </span></span>
<span><span class="co">#&gt;     data = simdataHADS, methInteg = "QMC", nMC = 1000)</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Statistical Model: </span></span>
<span><span class="co">#&gt;      Dataset: simdataHADS </span></span>
<span><span class="co">#&gt;      Number of subjects: 561 </span></span>
<span><span class="co">#&gt;      Number of observations: 7980 </span></span>
<span><span class="co">#&gt;      Number of latent classes: 1 </span></span>
<span><span class="co">#&gt;      Number of parameters: 50  </span></span>
<span><span class="co">#&gt;      Link functions: Thresholds for hads_2 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_4 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_6 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_8 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_10 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_12 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_14 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Iteration process: </span></span>
<span><span class="co">#&gt;      Convergence criteria satisfied </span></span>
<span><span class="co">#&gt;      Number of iterations:  13 </span></span>
<span><span class="co">#&gt;      Convergence criteria: parameters= 1.3e-07 </span></span>
<span><span class="co">#&gt;                          : likelihood= 5.3e-06 </span></span>
<span><span class="co">#&gt;                          : second derivatives= 9e-07 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Goodness-of-fit statistics: </span></span>
<span><span class="co">#&gt;      maximum log-likelihood: -7214.28  </span></span>
<span><span class="co">#&gt;      AIC: 14528.56  </span></span>
<span><span class="co">#&gt;      BIC: 14745.05  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Maximum Likelihood Estimates: </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Fixed effects in the longitudinal model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                  coef      Se   Wald p-value</span></span>
<span><span class="co">#&gt; intercept (not estimated)     0.00000                       </span></span>
<span><span class="co">#&gt; ns(...)1                     -0.12748 0.14988 -0.851 0.39501</span></span>
<span><span class="co">#&gt; ns(...)2                      0.21532 0.28874  0.746 0.45583</span></span>
<span><span class="co">#&gt; ns(...)3                      0.53107 0.18189  2.920 0.00350</span></span>
<span><span class="co">#&gt; grp                          -0.53889 0.16731 -3.221 0.00128</span></span>
<span><span class="co">#&gt; ns(...)1:grp                  0.21171 0.20603  1.028 0.30413</span></span>
<span><span class="co">#&gt; ns(...)2:grp                  0.46671 0.34710  1.345 0.17875</span></span>
<span><span class="co">#&gt; ns(...)3:grp                 -0.00820 0.21014 -0.039 0.96885</span></span>
<span><span class="co">#&gt; Contrasts on grp (p=0.29283)                                </span></span>
<span><span class="co">#&gt; hads_2                       -0.02642 0.05645 -0.468 0.63972</span></span>
<span><span class="co">#&gt; hads_4                       -0.02348 0.05147 -0.456 0.64819</span></span>
<span><span class="co">#&gt; hads_6                       -0.00915 0.07182 -0.127 0.89860</span></span>
<span><span class="co">#&gt; hads_8                        0.03429 0.06495  0.528 0.59756</span></span>
<span><span class="co">#&gt; hads_10                      -0.09224 0.07381 -1.250 0.21142</span></span>
<span><span class="co">#&gt; hads_12                      -0.10713 0.05455 -1.964 0.04954</span></span>
<span><span class="co">#&gt; hads_14**                     0.22413 0.11256  1.991 0.04646</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variance-covariance matrix of the random-effects:</span></span>
<span><span class="co">#&gt; (the variance of the first random effect is not estimated)</span></span>
<span><span class="co">#&gt;           intercept ns(...)1 ns(...)2 ns(...)3</span></span>
<span><span class="co">#&gt; intercept   1.00000                           </span></span>
<span><span class="co">#&gt; ns(...)1   -0.46196  0.85115                  </span></span>
<span><span class="co">#&gt; ns(...)2   -1.14653  1.13101  2.67135         </span></span>
<span><span class="co">#&gt; ns(...)3   -0.27252  0.59376  0.66774  0.46547</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                            hads_2   hads_4   hads_6   hads_8  hads_10  hads_12</span></span>
<span><span class="co">#&gt; Residual standard error:  0.79214  0.63961  1.03469  0.99749  1.07431  0.69536</span></span>
<span><span class="co">#&gt;                           hads_14</span></span>
<span><span class="co">#&gt; Residual standard error:  1.55512</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameters of the link functions:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                     coef      Se   Wald p-value</span></span>
<span><span class="co">#&gt; hads_2-Thresh1  -0.53412 0.14549 -3.671 0.00024</span></span>
<span><span class="co">#&gt; hads_2-Thresh2   1.13040 0.05280 21.408 0.00000</span></span>
<span><span class="co">#&gt; hads_2-Thresh3   0.89312 0.04989 17.903 0.00000</span></span>
<span><span class="co">#&gt; hads_4-Thresh1  -0.22590 0.13702 -1.649 0.09922</span></span>
<span><span class="co">#&gt; hads_4-Thresh2   1.01769 0.04765 21.358 0.00000</span></span>
<span><span class="co">#&gt; hads_4-Thresh3   1.04790 0.05780 18.129 0.00000</span></span>
<span><span class="co">#&gt; hads_6-Thresh1  -0.36726 0.14755 -2.489 0.01281</span></span>
<span><span class="co">#&gt; hads_6-Thresh2   1.35459 0.06746 20.079 0.00000</span></span>
<span><span class="co">#&gt; hads_6-Thresh3   1.32477 0.09338 14.187 0.00000</span></span>
<span><span class="co">#&gt; hads_8-Thresh1  -1.33351 0.18354 -7.265 0.00000</span></span>
<span><span class="co">#&gt; hads_8-Thresh2   1.33761 0.06297 21.242 0.00000</span></span>
<span><span class="co">#&gt; hads_8-Thresh3   1.09643 0.05722 19.161 0.00000</span></span>
<span><span class="co">#&gt; hads_10-Thresh1 -0.04701 0.14524 -0.324 0.74620</span></span>
<span><span class="co">#&gt; hads_10-Thresh2  1.01460 0.05447 18.627 0.00000</span></span>
<span><span class="co">#&gt; hads_10-Thresh3  1.11577 0.06559 17.011 0.00000</span></span>
<span><span class="co">#&gt; hads_12-Thresh1 -0.24013 0.13820 -1.738 0.08228</span></span>
<span><span class="co">#&gt; hads_12-Thresh2  1.00629 0.04810 20.923 0.00000</span></span>
<span><span class="co">#&gt; hads_12-Thresh3  1.03509 0.05774 17.928 0.00000</span></span>
<span><span class="co">#&gt; hads_14-Thresh1  1.02240 0.19798  5.164 0.00000</span></span>
<span><span class="co">#&gt; hads_14-Thresh2  1.46048 0.09380 15.570 0.00000</span></span>
<span><span class="co">#&gt; hads_14-Thresh3  0.85264 0.09818  8.685 0.00000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  ** coefficient not estimated but obtained from the others as minus the sum of them </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="va">sumDIF</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="co">#&gt;    intercept (not estimated)                     ns(...)1 </span></span>
<span><span class="co">#&gt;                           NA                      0.14988 </span></span>
<span><span class="co">#&gt;                     ns(...)2                     ns(...)3 </span></span>
<span><span class="co">#&gt;                      0.28874                      0.18189 </span></span>
<span><span class="co">#&gt;                          grp                 ns(...)1:grp </span></span>
<span><span class="co">#&gt;                      0.16731                      0.20603 </span></span>
<span><span class="co">#&gt;                 ns(...)2:grp                 ns(...)3:grp </span></span>
<span><span class="co">#&gt;                      0.34710                      0.21014 </span></span>
<span><span class="co">#&gt; Contrasts on grp (p=0.29283)                       hads_2 </span></span>
<span><span class="co">#&gt;                           NA                      0.05645 </span></span>
<span><span class="co">#&gt;                       hads_4                       hads_6 </span></span>
<span><span class="co">#&gt;                      0.05147                      0.07182 </span></span>
<span><span class="co">#&gt;                       hads_8                      hads_10 </span></span>
<span><span class="co">#&gt;                      0.06495                      0.07381 </span></span>
<span><span class="co">#&gt;                      hads_12                    hads_14** </span></span>
<span><span class="co">#&gt;                      0.05455                      0.11256</span></span></code></pre></div>
<p>To be done again …. L’item 2 est le seul item qui semble être
différent entre les groupes (p=0.0071) avec un niveau plus faible chez
les preemptive par rapport aux autres items. Au global, la différence de
groupe entre les 7 items ne semble pas significative (p=0.2665 au global
(Chi2 à 6 degrés de liberté)).</p>
<p>Global test for contrasts</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/WaldMult.html">WaldMult</a></span><span class="op">(</span><span class="va">modIRT_DIFg</span>,pos<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span><span class="op">:</span><span class="fl">13</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                                                                 Wald Test</span></span>
<span><span class="co">#&gt; contrast11 = contrast12 = contrast13 = contrast14 = contrast15 = contrast16 = 0   7.31339</span></span>
<span><span class="co">#&gt;                                                                                 p_value</span></span>
<span><span class="co">#&gt; contrast11 = contrast12 = contrast13 = contrast14 = contrast15 = contrast16 = 0 0.29283</span></span></code></pre></div>
<p>95% confidence interval of the difference between groups for item
2:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">modIRT_DIFg</span><span class="op">)</span><span class="op">[</span><span class="fl">10</span>,<span class="op">]</span></span>
<span><span class="co">#&gt; General latent class mixed model </span></span>
<span><span class="co">#&gt;      fitted by maximum likelihood method </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; multlcmm(fixed = hads_2 + hads_4 + hads_6 + hads_8 + hads_10 + </span></span>
<span><span class="co">#&gt;     hads_12 + hads_14 ~ ns(time, knots = c(7, 15), Boundary.knots = c(0, </span></span>
<span><span class="co">#&gt;     60)) * (grp) + contrast(grp), random = ~1 + ns(time, knots = c(7, </span></span>
<span><span class="co">#&gt;     15), Boundary.knots = c(0, 60)), subject = "ID", link = "thresholds", </span></span>
<span><span class="co">#&gt;     data = simdataHADS, methInteg = "QMC", nMC = 1000)</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Statistical Model: </span></span>
<span><span class="co">#&gt;      Dataset: simdataHADS </span></span>
<span><span class="co">#&gt;      Number of subjects: 561 </span></span>
<span><span class="co">#&gt;      Number of observations: 7980 </span></span>
<span><span class="co">#&gt;      Number of latent classes: 1 </span></span>
<span><span class="co">#&gt;      Number of parameters: 50  </span></span>
<span><span class="co">#&gt;      Link functions: Thresholds for hads_2 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_4 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_6 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_8 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_10 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_12 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_14 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Iteration process: </span></span>
<span><span class="co">#&gt;      Convergence criteria satisfied </span></span>
<span><span class="co">#&gt;      Number of iterations:  13 </span></span>
<span><span class="co">#&gt;      Convergence criteria: parameters= 1.3e-07 </span></span>
<span><span class="co">#&gt;                          : likelihood= 5.3e-06 </span></span>
<span><span class="co">#&gt;                          : second derivatives= 9e-07 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Goodness-of-fit statistics: </span></span>
<span><span class="co">#&gt;      maximum log-likelihood: -7214.28  </span></span>
<span><span class="co">#&gt;      AIC: 14528.56  </span></span>
<span><span class="co">#&gt;      BIC: 14745.05  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Maximum Likelihood Estimates: </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Fixed effects in the longitudinal model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                  coef      Se   Wald p-value</span></span>
<span><span class="co">#&gt; intercept (not estimated)     0.00000                       </span></span>
<span><span class="co">#&gt; ns(...)1                     -0.12748 0.14988 -0.851 0.39501</span></span>
<span><span class="co">#&gt; ns(...)2                      0.21532 0.28874  0.746 0.45583</span></span>
<span><span class="co">#&gt; ns(...)3                      0.53107 0.18189  2.920 0.00350</span></span>
<span><span class="co">#&gt; grp                          -0.53889 0.16731 -3.221 0.00128</span></span>
<span><span class="co">#&gt; ns(...)1:grp                  0.21171 0.20603  1.028 0.30413</span></span>
<span><span class="co">#&gt; ns(...)2:grp                  0.46671 0.34710  1.345 0.17875</span></span>
<span><span class="co">#&gt; ns(...)3:grp                 -0.00820 0.21014 -0.039 0.96885</span></span>
<span><span class="co">#&gt; Contrasts on grp (p=0.29283)                                </span></span>
<span><span class="co">#&gt; hads_2                       -0.02642 0.05645 -0.468 0.63972</span></span>
<span><span class="co">#&gt; hads_4                       -0.02348 0.05147 -0.456 0.64819</span></span>
<span><span class="co">#&gt; hads_6                       -0.00915 0.07182 -0.127 0.89860</span></span>
<span><span class="co">#&gt; hads_8                        0.03429 0.06495  0.528 0.59756</span></span>
<span><span class="co">#&gt; hads_10                      -0.09224 0.07381 -1.250 0.21142</span></span>
<span><span class="co">#&gt; hads_12                      -0.10713 0.05455 -1.964 0.04954</span></span>
<span><span class="co">#&gt; hads_14**                     0.22413 0.11256  1.991 0.04646</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variance-covariance matrix of the random-effects:</span></span>
<span><span class="co">#&gt; (the variance of the first random effect is not estimated)</span></span>
<span><span class="co">#&gt;           intercept ns(...)1 ns(...)2 ns(...)3</span></span>
<span><span class="co">#&gt; intercept   1.00000                           </span></span>
<span><span class="co">#&gt; ns(...)1   -0.46196  0.85115                  </span></span>
<span><span class="co">#&gt; ns(...)2   -1.14653  1.13101  2.67135         </span></span>
<span><span class="co">#&gt; ns(...)3   -0.27252  0.59376  0.66774  0.46547</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                            hads_2   hads_4   hads_6   hads_8  hads_10  hads_12</span></span>
<span><span class="co">#&gt; Residual standard error:  0.79214  0.63961  1.03469  0.99749  1.07431  0.69536</span></span>
<span><span class="co">#&gt;                           hads_14</span></span>
<span><span class="co">#&gt; Residual standard error:  1.55512</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameters of the link functions:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                     coef      Se   Wald p-value</span></span>
<span><span class="co">#&gt; hads_2-Thresh1  -0.53412 0.14549 -3.671 0.00024</span></span>
<span><span class="co">#&gt; hads_2-Thresh2   1.13040 0.05280 21.408 0.00000</span></span>
<span><span class="co">#&gt; hads_2-Thresh3   0.89312 0.04989 17.903 0.00000</span></span>
<span><span class="co">#&gt; hads_4-Thresh1  -0.22590 0.13702 -1.649 0.09922</span></span>
<span><span class="co">#&gt; hads_4-Thresh2   1.01769 0.04765 21.358 0.00000</span></span>
<span><span class="co">#&gt; hads_4-Thresh3   1.04790 0.05780 18.129 0.00000</span></span>
<span><span class="co">#&gt; hads_6-Thresh1  -0.36726 0.14755 -2.489 0.01281</span></span>
<span><span class="co">#&gt; hads_6-Thresh2   1.35459 0.06746 20.079 0.00000</span></span>
<span><span class="co">#&gt; hads_6-Thresh3   1.32477 0.09338 14.187 0.00000</span></span>
<span><span class="co">#&gt; hads_8-Thresh1  -1.33351 0.18354 -7.265 0.00000</span></span>
<span><span class="co">#&gt; hads_8-Thresh2   1.33761 0.06297 21.242 0.00000</span></span>
<span><span class="co">#&gt; hads_8-Thresh3   1.09643 0.05722 19.161 0.00000</span></span>
<span><span class="co">#&gt; hads_10-Thresh1 -0.04701 0.14524 -0.324 0.74620</span></span>
<span><span class="co">#&gt; hads_10-Thresh2  1.01460 0.05447 18.627 0.00000</span></span>
<span><span class="co">#&gt; hads_10-Thresh3  1.11577 0.06559 17.011 0.00000</span></span>
<span><span class="co">#&gt; hads_12-Thresh1 -0.24013 0.13820 -1.738 0.08228</span></span>
<span><span class="co">#&gt; hads_12-Thresh2  1.00629 0.04810 20.923 0.00000</span></span>
<span><span class="co">#&gt; hads_12-Thresh3  1.03509 0.05774 17.928 0.00000</span></span>
<span><span class="co">#&gt; hads_14-Thresh1  1.02240 0.19798  5.164 0.00000</span></span>
<span><span class="co">#&gt; hads_14-Thresh2  1.46048 0.09380 15.570 0.00000</span></span>
<span><span class="co">#&gt; hads_14-Thresh3  0.85264 0.09818  8.685 0.00000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  ** coefficient not estimated but obtained from the others as minus the sum of them </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sum</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">sum</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">*</span><span class="va">sum</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">sum</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">*</span><span class="va">sum</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;        coef        coef        coef </span></span>
<span><span class="co">#&gt; -0.02642000 -0.13705997  0.08421997</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="c--estimation-of-the-irt-model-with-a-response-shift-over-time">C. Estimation of the IRT model with a Response Shift over time<a class="anchor" aria-label="anchor" href="#c--estimation-of-the-irt-model-with-a-response-shift-over-time"></a>
</h3>
<p>Response Shift is modelled by adding contrasts on the functions of
time</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># initialization of the parameter vector for faster convergence</span></span>
<span><span class="va">npm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">modIRT</span><span class="op">$</span><span class="va">best</span><span class="op">)</span></span>
<span><span class="va">Binit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">modIRT</span><span class="op">$</span><span class="va">best</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">3</span><span class="op">*</span><span class="op">(</span><span class="va">nitems</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,<span class="va">modIRT</span><span class="op">$</span><span class="va">best</span><span class="op">[</span><span class="op">(</span><span class="va">npm</span><span class="op">-</span><span class="va">nlevel</span><span class="op">*</span><span class="va">nitems</span><span class="op">-</span><span class="fl">9</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">npm</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># estimation</span></span>
<span><span class="va">modIRT_DIFt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multlcmm.html">multlcmm</a></span><span class="op">(</span><span class="va">hads_2</span> <span class="op">+</span> <span class="va">hads_4</span> <span class="op">+</span><span class="va">hads_6</span> <span class="op">+</span> <span class="va">hads_8</span> <span class="op">+</span><span class="va">hads_10</span><span class="op">+</span><span class="va">hads_12</span> <span class="op">+</span> <span class="va">hads_14</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">time</span>,knots<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">15</span><span class="op">)</span>,Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">60</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">grp</span><span class="op">)</span> <span class="op">+</span> <span class="fu">contrast</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">time</span>,knots<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">15</span><span class="op">)</span>,Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">60</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,random<span class="op">=</span><span class="op">~</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">time</span>,knots<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">15</span><span class="op">)</span>,Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">60</span><span class="op">)</span><span class="op">)</span>,data<span class="op">=</span><span class="va">simdataHADS</span>,subject<span class="op">=</span><span class="st">"ID"</span>,link<span class="op">=</span><span class="st">"thresholds"</span>,methInteg<span class="op">=</span><span class="st">"QMC"</span>,nMC<span class="op">=</span><span class="fl">1000</span>,B<span class="op">=</span><span class="va">Binit</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">modIRT_DIFt</span><span class="op">)</span></span>
<span><span class="co">#&gt; General latent class mixed model </span></span>
<span><span class="co">#&gt;      fitted by maximum likelihood method </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; multlcmm(fixed = hads_2 + hads_4 + hads_6 + hads_8 + hads_10 + </span></span>
<span><span class="co">#&gt;     hads_12 + hads_14 ~ ns(time, knots = c(7, 15), Boundary.knots = c(0, </span></span>
<span><span class="co">#&gt;     60)) * (grp) + contrast(ns(time, knots = c(7, 15), Boundary.knots = c(0, </span></span>
<span><span class="co">#&gt;     60))), random = ~1 + ns(time, knots = c(7, 15), Boundary.knots = c(0, </span></span>
<span><span class="co">#&gt;     60)), subject = "ID", link = "thresholds", data = simdataHADS, </span></span>
<span><span class="co">#&gt;     methInteg = "QMC", nMC = 1000)</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Statistical Model: </span></span>
<span><span class="co">#&gt;      Dataset: simdataHADS </span></span>
<span><span class="co">#&gt;      Number of subjects: 561 </span></span>
<span><span class="co">#&gt;      Number of observations: 7980 </span></span>
<span><span class="co">#&gt;      Number of latent classes: 1 </span></span>
<span><span class="co">#&gt;      Number of parameters: 62  </span></span>
<span><span class="co">#&gt;      Link functions: Thresholds for hads_2 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_4 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_6 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_8 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_10 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_12 </span></span>
<span><span class="co">#&gt;                      Thresholds for hads_14 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Iteration process: </span></span>
<span><span class="co">#&gt;      Convergence criteria satisfied </span></span>
<span><span class="co">#&gt;      Number of iterations:  25 </span></span>
<span><span class="co">#&gt;      Convergence criteria: parameters= 7.7e-07 </span></span>
<span><span class="co">#&gt;                          : likelihood= 2e-05 </span></span>
<span><span class="co">#&gt;                          : second derivatives= 1.5e-06 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Goodness-of-fit statistics: </span></span>
<span><span class="co">#&gt;      maximum log-likelihood: -7205.82  </span></span>
<span><span class="co">#&gt;      AIC: 14535.65  </span></span>
<span><span class="co">#&gt;      BIC: 14804.09  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Maximum Likelihood Estimates: </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Fixed effects in the longitudinal model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                       coef      Se   Wald p-value</span></span>
<span><span class="co">#&gt; intercept (not estimated)          0.00000                       </span></span>
<span><span class="co">#&gt; ns(...)1                          -0.15118 0.14527 -1.041 0.29799</span></span>
<span><span class="co">#&gt; ns(...)2                           0.24201 0.22065  1.097 0.27273</span></span>
<span><span class="co">#&gt; ns(...)3                           0.51599 0.14376  3.589 0.00033</span></span>
<span><span class="co">#&gt; grp                               -0.56666 0.14421 -3.929 0.00009</span></span>
<span><span class="co">#&gt; ns(...)1:grp                       0.20990 0.19824  1.059 0.28967</span></span>
<span><span class="co">#&gt; ns(...)2:grp                       0.46825 0.26337  1.778 0.07541</span></span>
<span><span class="co">#&gt; ns(...)3:grp                      -0.00269 0.10362 -0.026 0.97926</span></span>
<span><span class="co">#&gt; Contrasts on ns(...)1 (p=0.19144)                                </span></span>
<span><span class="co">#&gt; hads_2                             0.08808 0.12351  0.713 0.47575</span></span>
<span><span class="co">#&gt; hads_4                             0.11588 0.11125  1.042 0.29762</span></span>
<span><span class="co">#&gt; hads_6                            -0.44923 0.16043 -2.800 0.00511</span></span>
<span><span class="co">#&gt; hads_8                             0.07870 0.14551  0.541 0.58861</span></span>
<span><span class="co">#&gt; hads_10                            0.02251 0.15339  0.147 0.88334</span></span>
<span><span class="co">#&gt; hads_12                            0.07310 0.11507  0.635 0.52527</span></span>
<span><span class="co">#&gt; hads_14**                          0.07096 0.25197  0.282 0.77823</span></span>
<span><span class="co">#&gt; Contrasts on ns(...)2 (p=0.15757)                                </span></span>
<span><span class="co">#&gt; hads_2                             0.05069 0.20882  0.243 0.80818</span></span>
<span><span class="co">#&gt; hads_4                             0.31902 0.19262  1.656 0.09768</span></span>
<span><span class="co">#&gt; hads_6                            -0.12456 0.24725 -0.504 0.61442</span></span>
<span><span class="co">#&gt; hads_8                            -0.15758 0.23823 -0.661 0.50831</span></span>
<span><span class="co">#&gt; hads_10                           -0.50100 0.26666 -1.879 0.06027</span></span>
<span><span class="co">#&gt; hads_12                           -0.22571 0.19444 -1.161 0.24572</span></span>
<span><span class="co">#&gt; hads_14**                          0.63914 0.44963  1.421 0.15517</span></span>
<span><span class="co">#&gt; Contrasts on ns(...)3 (p=0.12167)                                </span></span>
<span><span class="co">#&gt; hads_2                             0.09775 0.14180  0.689 0.49061</span></span>
<span><span class="co">#&gt; hads_4                             0.26875 0.12584  2.136 0.03270</span></span>
<span><span class="co">#&gt; hads_6                             0.07197 0.15943  0.451 0.65169</span></span>
<span><span class="co">#&gt; hads_8                            -0.10742 0.16213 -0.663 0.50761</span></span>
<span><span class="co">#&gt; hads_10                           -0.22367 0.17189 -1.301 0.19317</span></span>
<span><span class="co">#&gt; hads_12                           -0.21525 0.12666 -1.699 0.08924</span></span>
<span><span class="co">#&gt; hads_14**                          0.10787 0.27732  0.389 0.69729</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variance-covariance matrix of the random-effects:</span></span>
<span><span class="co">#&gt; (the variance of the first random effect is not estimated)</span></span>
<span><span class="co">#&gt;           intercept ns(...)1 ns(...)2 ns(...)3</span></span>
<span><span class="co">#&gt; intercept   1.00000                           </span></span>
<span><span class="co">#&gt; ns(...)1   -0.46502  0.83427                  </span></span>
<span><span class="co">#&gt; ns(...)2   -1.15064  1.12124  2.65929         </span></span>
<span><span class="co">#&gt; ns(...)3   -0.26882  0.58400  0.66300  0.45942</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                            hads_2   hads_4   hads_6   hads_8  hads_10  hads_12</span></span>
<span><span class="co">#&gt; Residual standard error:  0.79106  0.64238  1.02392  0.99607  1.04240  0.66925</span></span>
<span><span class="co">#&gt;                           hads_14</span></span>
<span><span class="co">#&gt; Residual standard error:  1.61569</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameters of the link functions:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                     coef      Se   Wald p-value</span></span>
<span><span class="co">#&gt; hads_2-Thresh1  -0.51076 0.14481 -3.527 0.00042</span></span>
<span><span class="co">#&gt; hads_2-Thresh2   1.12935 0.05266 21.444 0.00000</span></span>
<span><span class="co">#&gt; hads_2-Thresh3   0.89240 0.04978 17.929 0.00000</span></span>
<span><span class="co">#&gt; hads_4-Thresh1  -0.10615 0.12077 -0.879 0.37947</span></span>
<span><span class="co">#&gt; hads_4-Thresh2   1.02070 0.04795 21.287 0.00000</span></span>
<span><span class="co">#&gt; hads_4-Thresh3   1.05232 0.05838 18.025 0.00000</span></span>
<span><span class="co">#&gt; hads_6-Thresh1  -0.44550 0.16207 -2.749 0.00598</span></span>
<span><span class="co">#&gt; hads_6-Thresh2   1.35186 0.06684 20.226 0.00000</span></span>
<span><span class="co">#&gt; hads_6-Thresh3   1.32294 0.09294 14.235 0.00000</span></span>
<span><span class="co">#&gt; hads_8-Thresh1  -1.40668 0.19676 -7.149 0.00000</span></span>
<span><span class="co">#&gt; hads_8-Thresh2   1.33585 0.06286 21.250 0.00000</span></span>
<span><span class="co">#&gt; hads_8-Thresh3   1.09600 0.05707 19.206 0.00000</span></span>
<span><span class="co">#&gt; hads_10-Thresh1 -0.20171 0.16312 -1.237 0.21625</span></span>
<span><span class="co">#&gt; hads_10-Thresh2  1.00090 0.05294 18.907 0.00000</span></span>
<span><span class="co">#&gt; hads_10-Thresh3  1.10217 0.06395 17.235 0.00000</span></span>
<span><span class="co">#&gt; hads_12-Thresh1 -0.24862 0.13162 -1.889 0.05891</span></span>
<span><span class="co">#&gt; hads_12-Thresh2  0.98979 0.04693 21.093 0.00000</span></span>
<span><span class="co">#&gt; hads_12-Thresh3  1.01983 0.05642 18.077 0.00000</span></span>
<span><span class="co">#&gt; hads_14-Thresh1  1.22178 0.29419  4.153 0.00003</span></span>
<span><span class="co">#&gt; hads_14-Thresh2  1.48491 0.09737 15.251 0.00000</span></span>
<span><span class="co">#&gt; hads_14-Thresh3  0.86615 0.10043  8.624 0.00000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  ** coefficient not estimated but obtained from the others as minus the sum of them </span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
<p>There does not seem to be any difference in item trajectories over
time (see global p-values for each function of time in the summary). We
can seek whether there are some difference item by item using Wald Test.
This can be done with the WaldMult function of lcmm except for the last
item since this parameter is a combination of the others. Next code
details how to obtain this item-specific test of invariance over
time.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Pvalue for the last contrast</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">modIRT_DIFt</span><span class="op">)</span></span>
<span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">modIRT_DIFt</span><span class="op">)</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">49</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span><span class="op">+</span><span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">49</span><span class="op">-</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span><span class="op">+</span><span class="fl">12</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">49</span><span class="op">-</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">A</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">b</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">A</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">v</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">A</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">b</span></span>
<span><span class="va">DIF14</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">pchisq</a></span><span class="op">(</span><span class="va">w</span>, df<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">)</span> <span class="co"># p=0.3722833</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## pvalues for all the items including the last one</span></span>
<span><span class="va">DIF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">14</span>,by<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,<span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="../reference/WaldMult.html">WaldMult</a></span><span class="op">(</span><span class="va">modIRT_DIFt</span>,pos<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span><span class="op">+</span><span class="va">k</span>,<span class="op">(</span><span class="fl">7</span><span class="op">+</span><span class="fl">6</span><span class="op">+</span><span class="va">k</span><span class="op">)</span>,<span class="op">(</span><span class="fl">7</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="fl">6</span><span class="op">+</span><span class="va">k</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">}</span><span class="op">)</span>,<span class="va">DIF14</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">DIF</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"item"</span>,<span class="st">"pvalue"</span><span class="op">)</span></span>
<span><span class="va">DIF</span>   </span>
<span><span class="co">#&gt;      item    pvalue</span></span>
<span><span class="co">#&gt; [1,]    2 0.7075200</span></span>
<span><span class="co">#&gt; [2,]    4 0.0830700</span></span>
<span><span class="co">#&gt; [3,]    6 0.0451500</span></span>
<span><span class="co">#&gt; [4,]    8 0.8516600</span></span>
<span><span class="co">#&gt; [5,]   10 0.3021600</span></span>
<span><span class="co">#&gt; [6,]   12 0.3751000</span></span>
<span><span class="co">#&gt; [7,]   14 0.5168641</span></span></code></pre></div>
<p>Interpretation.</p>
<div class="section level4">
<h4 id="prediction-in-the-item-scale-to-compare-the-model-with-rs-and-without-rs">Prediction in the item scale to compare the model with RS and
without RS<a class="anchor" aria-label="anchor" href="#prediction-in-the-item-scale-to-compare-the-model-with-rs-and-without-rs"></a>
</h4>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">datnew</span><span class="op">)</span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">grp</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ns0DIFt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">modIRT_DIFt</span>,var.time <span class="op">=</span> <span class="st">"time"</span>,newdata<span class="op">=</span><span class="va">datnew</span>,methInteg <span class="op">=</span> <span class="fl">1</span>,nsim<span class="op">=</span><span class="fl">2000</span>,draws<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">grp</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">ns1DIFt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">modIRT_DIFt</span>,var.time <span class="op">=</span> <span class="st">"time"</span>,newdata<span class="op">=</span><span class="va">datnew</span>,methInteg <span class="op">=</span> <span class="fl">1</span>,nsim<span class="op">=</span><span class="fl">2000</span>,draws<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0.5</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">{</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">ns0</span>,outcome <span class="op">=</span> <span class="va">k</span>,shades <span class="op">=</span> <span class="cn">T</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">3</span><span class="op">)</span>,bty<span class="op">=</span><span class="st">"l"</span>,legend<span class="op">=</span><span class="cn">NULL</span>,main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Item"</span>,<span class="fl">2</span><span class="op">*</span><span class="va">k</span>,<span class="st">"-"</span>,<span class="va">meaning</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">)</span>,ylab<span class="op">=</span><span class="st">"Item level"</span>,xlab<span class="op">=</span><span class="st">"months on the waiting list"</span>,color<span class="op">=</span><span class="fl">1</span>,lwd<span class="op">=</span><span class="fl">2</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">ns0DIFt</span>,outcome<span class="op">=</span><span class="va">k</span>,shades<span class="op">=</span><span class="cn">T</span>,lty<span class="op">=</span><span class="fl">2</span>,add<span class="op">=</span><span class="cn">T</span>,col<span class="op">=</span><span class="fl">1</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">ns1</span>,outcome<span class="op">=</span><span class="va">k</span>,shades<span class="op">=</span><span class="cn">T</span>,add<span class="op">=</span><span class="cn">T</span>,col<span class="op">=</span><span class="fl">4</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">ns1DIFt</span>,outcome<span class="op">=</span><span class="va">k</span>,shades<span class="op">=</span><span class="cn">T</span>,add<span class="op">=</span><span class="cn">T</span>,col<span class="op">=</span><span class="fl">4</span>,lty<span class="op">=</span><span class="fl">2</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"top"</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"(RS overall test: p = "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">DIF</span><span class="op">[</span><span class="va">k</span>,<span class="fl">2</span><span class="op">]</span>,digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,<span class="st">")"</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>,bty<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="fl">0</span>,xaxt<span class="op">=</span><span class="st">'n'</span>,yaxt<span class="op">=</span><span class="st">'n'</span>,bty<span class="op">=</span><span class="st">'n'</span>,pch<span class="op">=</span><span class="st">''</span>,ylab<span class="op">=</span><span class="st">''</span>,xlab<span class="op">=</span><span class="st">''</span>, main <span class="op">=</span><span class="st">''</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"top"</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dialysed"</span>,<span class="st">"pre-emptive"</span><span class="op">)</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">2</span>,bty<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"bottom"</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"without RS"</span>,<span class="st">"with RS"</span><span class="op">)</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gray"</span>,<span class="st">"gray"</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">2</span>,bty<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_process_model_with_multlcmm_IRT_files/figure-html/unnamed-chunk-32-1.png" width="576"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cecile Proust-Lima, Viviane Philipps.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
