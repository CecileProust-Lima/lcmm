<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="lcmm">
<title>Accounting for latent class assignment uncertainty in subsequent analyses • lcmm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Accounting for latent class assignment uncertainty in subsequent analyses">
<meta property="og:description" content="lcmm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">lcmm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/lcmm.html">GET STARTED</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">VIGNETTES</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/latent_class_model_with_hlme.html">How to estimate a latent class mixed model using hlme function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_lcmm.html">How to estimate a latent process mixed model using lcmm function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm.html">How to estimate a latent process mixed model for multivariate markers using multlcmm function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm_IRT.html">Continuous-time longitudinal IRT model</a>
    <a class="dropdown-item" href="../articles/joint_latent_class_model_with_Jointlcmm.html">How to estimate a joint latent class mixed model using Jointlcmm function</a>
    <a class="dropdown-item" href="../articles/multivariate_latent_class_model_with_mpjlcmm.html">How to estimate a multivariate latent class mixed model using mpjlcmm function</a>
    <a class="dropdown-item" href="../articles/secondary_model_with_externVar.html">Accounting for latent class assignment uncertainty in subsequent analyses</a>
    <a class="dropdown-item" href="../articles/pre_normalizing.html">Pre-normalizing a dependent variable using lcmm</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/usual_problems.html">FAQ</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">REFERENCE</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">CHANGELOG</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/CecileProust-Lima/lcmm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">

<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Accounting for latent class assignment uncertainty in subsequent analyses</h1>
                        <h4 data-toc-skip class="author">Cecile Proust-Lima, Maris Dussartre, Viviane Philipps</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CecileProust-Lima/lcmm/blob/HEAD/../vignettes/secondary_model_with_externVar.Rmd" class="external-link"><code>../vignettes/secondary_model_with_externVar.Rmd</code></a></small>
      <div class="d-none name"><code>secondary_model_with_externVar.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p align="justify">
This vignette addresses the case where the latent class structure stemmed from a latent class model estimated with lcmm, hlme, multlcmm, Jointlcmm or mpjlcmm is to be used in secondary regressions. Please refer to vignettes <a href="latent_class_model_with_hlme.html">hlme</a>, <a href="joint_latent_class_model_with_Jointlcmm.html">Jointlcmm</a>, <a href="multivariate_latent_class_model_with_mpjlcmm.html">mpjlcmm</a> for description of latent class model estimation.
</p>
<p align="justify">
In the following, we call the “primary model” the latent class model from which the latent class structure is built, “external” variables, the variables not used in the primary model, and “secondary model” the subsequent regression model that:
</p>
<ul>
<li><p>explains the latent class structure using external predictors, in a multinomial logistic regression;</p></li>
<li><p>explains external outcomes using the latent class structure as one of the predictors. Regression currently handled in the package are: linear regression, all the mixed-effect regressions of the package, and survival proportional hazard model.</p></li>
</ul>
<p align="justify">
The statistical issue with the secondary use of latent class structures is that the latent class structure is latent, and that the posterior classification obtained from an estimated latent class model is an estimation with error. In addition to the statistical fluctuations to account for in the variance, the misclassification may also bias naive use of the posterior classification (Bakk &amp; Kuha 2021). To account for the inherent misclassification (or error of classification) in a latent class model, different techniques exist (see Bakk &amp; Kuha (2021) for a review).
</p>
</div>
<div class="section level2">
<h2 id="secondary-modeling-approaches-that-account-for-misclassification">Secondary modeling approaches that account for misclassification<a class="anchor" aria-label="anchor" href="#secondary-modeling-approaches-that-account-for-misclassification"></a>
</h2>
<p align="justify">
In the lcmm package, we implemented in the function externVar two methods for estimating secondary models while accounting for the error of classification: a conditional regression on the truth, called “conditional” (Vermunt et al. 2010, Bakk et al. 2013), and a two-stage estimation of the joint likelihood, called “twoStageJoint” (Xue &amp; Bandeen-Roche 2002, Bakk &amp; Kuha 2018, Proust-Lima et al. 2023). These methods have been validated in simulations (paper to come).
</p>
<div class="section level3">
<h3 id="the-conditional-regression-on-the-truth">The conditional regression on the truth<a class="anchor" aria-label="anchor" href="#the-conditional-regression-on-the-truth"></a>
</h3>
<p align="justify">
The conditional regression on the truth uses the Bayes theorem to translate the secondary regression according to the posterior classification into a secondary regression according to the true latent class structure. This is done through the introduction of the probability of the latent class structure given the assignment (call the misclassification probability) when using an external outcome and the probability of the posterior assignment given the true latent class structure when using a external predictors. This trick allows to estimate parameters that do not suffer from the misclassification anymore.
</p>
<p align="justify">
The variance of the secondary model estimates still need to account for the multiple step estimation (1. primary latent class model, 2. secondary regression) (Bakk et al., 2014). This is currently achieved by parametric bootstrap method in externVar.
</p>
</div>
<div class="section level3">
<h3 id="the-two-stage-estimation-using-the-joint-likelihood">The two-stage estimation using the joint likelihood<a class="anchor" aria-label="anchor" href="#the-two-stage-estimation-using-the-joint-likelihood"></a>
</h3>
<p align="justify">
With an external outcome, the two-stage method relies on the joint likelihood of the primary latent class model and of the secondary model. The estimates obtained from the primary model are entered in the joint likelihood as input, and the joint likelihood is maximized on the parameters of the secondary model only.
</p>
<p align="justify">
With an external predictor, the two-stage method relies on the likelihood of the primary latent class model in which the latent class probability model is taken from the secondary model. As for an external outcome, estimates obtained from the primary model are entered in the likelihood as input, except those for the class-membership. The likelihood is then maximized according to the parameters of this secondary class-membership model.
</p>
<p align="justify">
As for the conditional regression, the variance of the secondary model estimates still need to account for the multiple step estimation (1. primary latent class model, 2. secondary regression) (Bakk et al. 2018, Proust-Lima et al. 2023). This can be achieved by parametric bootstrap method or directly by computing the Hessian from the joint likelihood. Both approaches are implemented. The default method is “Hessian”.
</p>
</div>
<div class="section level3">
<h3 id="remarks-for-the-secondary-models">Remarks for the secondary models:<a class="anchor" aria-label="anchor" href="#remarks-for-the-secondary-models"></a>
</h3>
<p align="justify">
The secondary models may be estimated on the exact same population as the primary model, on a sub-population or on another independent population. However, in any case, the data used for the secondary model should contain all the variables used in the primary model in addition to those of the secondary model.
</p>
</div>
</div>
<div class="section level2">
<h2 id="example-on-paquid-dataset">Example on paquid DataSet<a class="anchor" aria-label="anchor" href="#example-on-paquid-dataset"></a>
</h2>
<div class="section level3">
<h3 id="primary-model">Primary model<a class="anchor" aria-label="anchor" href="#primary-model"></a>
</h3>
<p align="justify">
For all the methods, we first need to estimate a primary latent class model from which the latent class structure will be built. We use the same example as in the vignette: <a href="latent_class_model_with_hlme.html">“How to estimate a latent class mixed model using hlme function”</a>. This model is a latent class linear mixed model to identify distinct profiles of trajectory of normalized MMSE over age, adjusted for CEP (common effect across classes).
</p>
<div class="section level4">
<h4 id="estimation">estimation<a class="anchor" aria-label="anchor" href="#estimation"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">NormPsy</span><span class="op">)</span></span>
<span><span class="va">paquid</span><span class="op">$</span><span class="va">normMMSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/NormPsy/man/normMMSE.html" class="external-link">normMMSE</a></span><span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">MMSE</span><span class="op">)</span></span>
<span><span class="va">paquid</span><span class="op">$</span><span class="va">age65</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">age</span> <span class="op">-</span> <span class="fl">65</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span></span>
<span><span class="va">PrimModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hlme.html">hlme</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">CEP</span>,</span>
<span>                     random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                     subject <span class="op">=</span> <span class="st">'ID'</span>,</span>
<span>                     data <span class="op">=</span> <span class="va">paquid</span>,</span>
<span>                     ng <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                     mixture <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                     B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">64</span>, <span class="fl">63</span>, <span class="fl">18</span>, <span class="fl">3</span>, <span class="op">-</span><span class="fl">16</span>, <span class="op">-</span><span class="fl">4</span>, <span class="fl">14</span>, <span class="fl">221</span>, <span class="op">-</span><span class="fl">228</span>, <span class="fl">429</span>, <span class="fl">62</span>, <span class="op">-</span><span class="fl">121</span>, <span class="fl">36</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="brief-description-of-the-results">brief description of the results<a class="anchor" aria-label="anchor" href="#brief-description-of-the-results"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datnew</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">65</span>, <span class="fl">95</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">age65</span>  <span class="op">&lt;-</span> <span class="op">(</span><span class="va">datnew</span><span class="op">$</span><span class="va">age</span> <span class="op">-</span> <span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">CEP</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">PrimModel</span>, <span class="va">datnew</span>, draws<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">p</span>, shades<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deeppink"</span>, <span class="st">"deepskyblue"</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="secondary_model_with_externVar_files/figure-html/unnamed-chunk-3-1.png" width="576"></p>
<p align="justify">
The posterior classification finds a small class (12.4% of the sample) characterized by a substantial decline over age and a large class (87.6% of the sample) with a relatively stable trajectory over age. The classification is correct: mean probability of 80% and 87%, for those classified in 1 and 2, respectively.
</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/postprob.html">postprob</a></span><span class="op">(</span><span class="va">PrimModel</span><span class="op">)</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Posterior classification: </span></span>
<span><span class="co">#&gt;   class1 class2</span></span>
<span><span class="co">#&gt; N   62.0  438.0</span></span>
<span><span class="co">#&gt; %   12.4   87.6</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Posterior classification table: </span></span>
<span><span class="co">#&gt;      --&gt; mean of posterior probabilities in each class </span></span>
<span><span class="co">#&gt;         prob1  prob2</span></span>
<span><span class="co">#&gt; class1 0.8054 0.1946</span></span>
<span><span class="co">#&gt; class2 0.1270 0.8730</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Posterior probabilities above a threshold (%): </span></span>
<span><span class="co">#&gt;          class1 class2</span></span>
<span><span class="co">#&gt; prob&gt;0.7  61.29  90.18</span></span>
<span><span class="co">#&gt; prob&gt;0.8  58.06  69.18</span></span>
<span><span class="co">#&gt; prob&gt;0.9  43.55  47.95</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="secondary-model-for-longitudinal-external-outcome-ces-d">Secondary model for longitudinal external outcome: CES-D<a class="anchor" aria-label="anchor" href="#secondary-model-for-longitudinal-external-outcome-ces-d"></a>
</h3>
<p align="justify">
In this example, we want to assess the profiles of trajectory of depressive symptomatology (CES-D scale for Center for Epidemiologic Studies - Depression) in the two classes identified on MMSE.
</p>
<p align="justify">
CES-D is repeated at each occasion, we thus need a linear mixed model. The specification is the same as in all the other functions of the package. Given the strong asymmetry in the distribution of CES-D (see vignette <a href="pre_normalizing.html">Pre-normalizing a dependent variable using lcmm</a>), we use a curvilinear mixed model with a normalizing link function approximated by splines (i.e., same as lcmm function).
</p>
<p align="justify">
We specify a quadratic model and adjust for sex (male). The latent class predictor is specified through “mixture” argument.
</p>
<p>For this example, we apply the secondary model on the same sample “paquid”.</p>
<div class="section level4">
<h4 id="with-two-stage-approach">with two-stage approach<a class="anchor" aria-label="anchor" href="#with-two-stage-approach"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CESD2stage</span> <span class="op">=</span> <span class="fu"><a href="../reference/externVar.html">externVar</a></span><span class="op">(</span><span class="va">PrimModel</span>,</span>
<span>                      fixed <span class="op">=</span> <span class="va">CESD</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">male</span>,</span>
<span>                      random <span class="op">=</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                      subject <span class="op">=</span> <span class="st">"ID"</span>,</span>
<span>                      data <span class="op">=</span> <span class="va">paquid</span>,</span>
<span>                      mixture <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                      method <span class="op">=</span> <span class="st">"twoStageJoint"</span>,</span>
<span>                      link <span class="op">=</span> <span class="st">"3-quant-splines"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sum2st</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">CESD2stage</span><span class="op">)</span></span>
<span><span class="co">#&gt; Secondary linear mixed model </span></span>
<span><span class="co">#&gt;      fitted by maximum likelihood method </span></span>
<span><span class="co">#&gt;  ** Total parameter variance estimated using the Hessian of the joint likelihood ** </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; externVar(model = PrimModel, fixed = CESD ~ age65 + I(age65^2) + </span></span>
<span><span class="co">#&gt;     male, mixture = ~age65 + I(age65^2), random = ~age65 + I(age65^2), </span></span>
<span><span class="co">#&gt;     subject = "ID", link = "3-quant-splines", data = paquid, </span></span>
<span><span class="co">#&gt;     method = "twoStageJoint")</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Statistical Model: </span></span>
<span><span class="co">#&gt;      Dataset: paquid </span></span>
<span><span class="co">#&gt;      Number of subjects: 500 </span></span>
<span><span class="co">#&gt;      Number of observations: 2104 </span></span>
<span><span class="co">#&gt;      Number of observations deleted: 146 </span></span>
<span><span class="co">#&gt;      Number of latent classes: 2 </span></span>
<span><span class="co">#&gt;      Number of parameters: 17  </span></span>
<span><span class="co">#&gt;      Link function: Quadratic I-splines with nodes  </span></span>
<span><span class="co">#&gt; 0 6 52  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Iteration process: </span></span>
<span><span class="co">#&gt;      Convergence criteria satisfied </span></span>
<span><span class="co">#&gt;      Number of iterations:  25 </span></span>
<span><span class="co">#&gt;      Convergence criteria: parameters= 1.6e-07 </span></span>
<span><span class="co">#&gt;                          : likelihood= 7.3e-08 </span></span>
<span><span class="co">#&gt;                          : second derivatives= 3e-13 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Goodness-of-fit statistics: </span></span>
<span><span class="co">#&gt;      maximum log-likelihood: -6418.8  </span></span>
<span><span class="co">#&gt;      AIC: 12871.59  </span></span>
<span><span class="co">#&gt;      BIC: 12943.24  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;      Discrete posterior log-likelihood: -6320.31  </span></span>
<span><span class="co">#&gt;      Discrete AIC: 12674.61  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;      Mean discrete AIC per subject: 12.6746  </span></span>
<span><span class="co">#&gt;      Mean UACV per subject: 12.6406  </span></span>
<span><span class="co">#&gt;      Mean discrete LL per subject: -12.6406  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Maximum Likelihood Estimates: </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Fixed effects in the longitudinal model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                      coef      Se   Wald p-value</span></span>
<span><span class="co">#&gt; intercept class1 (not estimated)        0                       </span></span>
<span><span class="co">#&gt; intercept class2                  1.06287 0.63470  1.675 0.09401</span></span>
<span><span class="co">#&gt; age65 class1                      1.67967 0.80282  2.092 0.03642</span></span>
<span><span class="co">#&gt; age65 class2                     -0.15996 0.23531 -0.680 0.49663</span></span>
<span><span class="co">#&gt; I(age65^2) class1                -0.27413 0.27750 -0.988 0.32321</span></span>
<span><span class="co">#&gt; I(age65^2) class2                 0.18294 0.06943  2.635 0.00841</span></span>
<span><span class="co">#&gt; male                             -0.42171 0.11249 -3.749 0.00018</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variance-covariance matrix of the random-effects:</span></span>
<span><span class="co">#&gt;            intercept    age65 I(age65^2)</span></span>
<span><span class="co">#&gt; intercept    2.04087                    </span></span>
<span><span class="co">#&gt; age65       -0.91475  1.36808           </span></span>
<span><span class="co">#&gt; I(age65^2)   0.11088 -0.31057    0.08149</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error (not estimated) = 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameters of the link function:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                coef      Se   Wald p-value</span></span>
<span><span class="co">#&gt; I-splines1 -1.18192 0.54471 -2.170 0.03002</span></span>
<span><span class="co">#&gt; I-splines2  1.30506 0.02327 56.084 0.00000</span></span>
<span><span class="co">#&gt; I-splines3  1.77459 0.04239 41.859 0.00000</span></span>
<span><span class="co">#&gt; I-splines4  0.94043 0.17185  5.472 0.00000</span></span>
<span><span class="co">#&gt; I-splines5  1.43204 0.16928  8.460 0.00000</span></span></code></pre></div>
<p align="justify">
The secondary model summary is very similar to any other summary of lcmm package. It includes information on the estimation procedure, and the estimates obtained. By default, the variance of the parameters are estimated by the Hessian.
</p>
<p align="justify">
Main usual postfit functions of the package apply to externVar. For instance, the mean predicted trajectories can be computed and plotted:
</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">65</span>, <span class="fl">95</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">data_pred</span><span class="op">$</span><span class="va">age65</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">data_pred</span><span class="op">$</span><span class="va">age</span> <span class="op">-</span> <span class="fl">65</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span></span>
<span><span class="va">data_pred</span><span class="op">$</span><span class="va">male</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">predIC0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">CESD2stage</span>, <span class="va">data_pred</span>, var.time <span class="op">=</span> <span class="st">"age"</span>, draws<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">data_pred</span><span class="op">$</span><span class="va">male</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">predIC1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">CESD2stage</span>, <span class="va">data_pred</span>, var.time <span class="op">=</span> <span class="st">"age"</span>, draws<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">predIC0</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deeppink"</span>, <span class="st">"deepskyblue"</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span>, ylab<span class="op">=</span><span class="st">"CESD"</span>, main<span class="op">=</span><span class="st">"Predicted trajectories for CESD"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span><span class="op">)</span>, shades<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">predIC1</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deeppink"</span>,<span class="st">"deepskyblue"</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">2</span>, ylab<span class="op">=</span><span class="st">"CESD"</span>, main<span class="op">=</span><span class="st">"Predicted trajectories for CESD"</span>, legend<span class="op">=</span><span class="cn">NULL</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">25</span><span class="op">)</span>, shades<span class="op">=</span><span class="cn">TRUE</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="secondary_model_with_externVar_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
<p align="justify">
In the large class 2, the CESD remains relatively constant then increases slowly after 80 years old while in small class 1, CESD is lower at 65 years old but increases constantly over the age span.
</p>
<p>CESD model fit can be evaluated the same way as any model in lcmm package:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">CESD2stage</span>, cex.main<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="secondary_model_with_externVar_files/figure-html/unnamed-chunk-9-1.png" width="768"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">CESD2stage</span>, which<span class="op">=</span><span class="st">"fit"</span>, var.time<span class="op">=</span><span class="st">"age"</span>, marg<span class="op">=</span><span class="cn">FALSE</span>, shades <span class="op">=</span> <span class="cn">TRUE</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deeppink"</span>, <span class="st">"deepskyblue"</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="secondary_model_with_externVar_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
<p>These graphs suggest a good fit to the data.</p>
</div>
<div class="section level4">
<h4 id="with-conditional-regression">with conditional regression<a class="anchor" aria-label="anchor" href="#with-conditional-regression"></a>
</h4>
<p align="justify">
This procedure is much longer as based on parametric bootstrap for the variance estimation. The default number of replicates is 200.
</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CESDCond</span> <span class="op">=</span> <span class="fu"><a href="../reference/externVar.html">externVar</a></span><span class="op">(</span><span class="va">PrimModel</span>,</span>
<span>                      fixed <span class="op">=</span> <span class="va">CESD</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">male</span>,</span>
<span>                      random <span class="op">=</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                      subject <span class="op">=</span> <span class="st">"ID"</span>,</span>
<span>                      data <span class="op">=</span> <span class="va">paquid</span>,</span>
<span>                      mixture <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                      method <span class="op">=</span> <span class="st">"conditional"</span>,</span>
<span>                      link <span class="op">=</span> <span class="st">"3-quant-splines"</span><span class="op">)</span></span></code></pre></div>
<p align="justify">
To limit the computation time, starting values close to the optimum can be rapidly obtained by estimating the model with the uncorrected variance varest=“none”, and then use these estimates as initial values when running the parametric bootstrap:
</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CESDCondNone</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/externVar.html">externVar</a></span><span class="op">(</span><span class="va">PrimModel</span>,</span>
<span>                      fixed <span class="op">=</span> <span class="va">CESD</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">male</span>,</span>
<span>                      random <span class="op">=</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                      subject <span class="op">=</span> <span class="st">"ID"</span>,</span>
<span>                      data <span class="op">=</span> <span class="va">paquid</span>,</span>
<span>                      mixture <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                      method <span class="op">=</span> <span class="st">"conditional"</span>,</span>
<span>                      link <span class="op">=</span> <span class="st">"3-quant-splines"</span>,</span>
<span>                      varest<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span>
<span><span class="va">CESDCondPBoot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/externVar.html">externVar</a></span><span class="op">(</span><span class="va">PrimModel</span>,</span>
<span>                      fixed <span class="op">=</span> <span class="va">CESD</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">male</span>,</span>
<span>                      random <span class="op">=</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                      subject <span class="op">=</span> <span class="st">"ID"</span>,</span>
<span>                      data <span class="op">=</span> <span class="va">paquid</span>,</span>
<span>                      mixture <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                      method <span class="op">=</span> <span class="st">"conditional"</span>,</span>
<span>                      link <span class="op">=</span> <span class="st">"3-quant-splines"</span>,</span>
<span>                      B<span class="op">=</span><span class="va">CESDCondNone</span><span class="op">$</span><span class="va">best</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">CESDCond</span><span class="op">)</span></span>
<span><span class="co">#&gt; Secondary linear mixed model </span></span>
<span><span class="co">#&gt;      fitted by maximum likelihood method </span></span>
<span><span class="co">#&gt;  ** Total parameter variance estimated using parametric bootstrap ** </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; externVar(model = PrimModel, fixed = CESD ~ age65 + I(age65^2) + </span></span>
<span><span class="co">#&gt;     male, mixture = ~age65 + I(age65^2), random = ~age65 + I(age65^2), </span></span>
<span><span class="co">#&gt;     subject = "ID", link = "3-quant-splines", data = paquid, </span></span>
<span><span class="co">#&gt;     method = "conditional")</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Statistical Model: </span></span>
<span><span class="co">#&gt;      Dataset: paquid </span></span>
<span><span class="co">#&gt;      Number of subjects: 500 </span></span>
<span><span class="co">#&gt;      Number of observations: 2104 </span></span>
<span><span class="co">#&gt;      Number of observations deleted: 146 </span></span>
<span><span class="co">#&gt;      Number of latent classes: 2 </span></span>
<span><span class="co">#&gt;      Number of parameters: 17  </span></span>
<span><span class="co">#&gt;      Link function: Quadratic I-splines with nodes  </span></span>
<span><span class="co">#&gt; 0 6 52  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Iteration process: </span></span>
<span><span class="co">#&gt;      Convergence criteria satisfied </span></span>
<span><span class="co">#&gt;      Proportion of convergence on bootstrap iterations (%)= 99.5 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Goodness-of-fit statistics: </span></span>
<span><span class="co">#&gt;      maximum log-likelihood: -6419.02  </span></span>
<span><span class="co">#&gt;      AIC: 12862.54  </span></span>
<span><span class="co">#&gt;      BIC: 12934.18  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;      Discrete posterior log-likelihood: -6315.97  </span></span>
<span><span class="co">#&gt;      Discrete AIC: 12665.94  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;      Mean discrete AIC per subject: 12.6659  </span></span>
<span><span class="co">#&gt;      Mean UACV per subject: 12.6686  </span></span>
<span><span class="co">#&gt;      Mean discrete LL per subject: -12.6319  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Maximum Likelihood Estimates: </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Fixed effects in the longitudinal model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                      coef      Se   Wald p-value</span></span>
<span><span class="co">#&gt; intercept class1 (not estimated)        0                       </span></span>
<span><span class="co">#&gt; intercept class2                  0.78323 0.73518  1.065 0.28672</span></span>
<span><span class="co">#&gt; age65 class1                      1.15513 0.99941  1.156 0.24776</span></span>
<span><span class="co">#&gt; age65 class2                     -0.02754 0.29245 -0.094 0.92497</span></span>
<span><span class="co">#&gt; I(age65^2) class1                -0.09971 0.35363 -0.282 0.77797</span></span>
<span><span class="co">#&gt; I(age65^2) class2                 0.13347 0.09503  1.404 0.16018</span></span>
<span><span class="co">#&gt; male                             -0.42379 0.11375 -3.726 0.00019</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variance-covariance matrix of the random-effects:</span></span>
<span><span class="co">#&gt;            intercept    age65 I(age65^2)</span></span>
<span><span class="co">#&gt; intercept    1.64210                    </span></span>
<span><span class="co">#&gt; age65       -0.83078  1.39116           </span></span>
<span><span class="co">#&gt; I(age65^2)   0.12253 -0.33125    0.08384</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error (not estimated) = 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameters of the link function:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                coef      Se   Wald p-value</span></span>
<span><span class="co">#&gt; I-splines1 -1.40773 0.61731 -2.280 0.02258</span></span>
<span><span class="co">#&gt; I-splines2  1.30413 0.02327 56.042 0.00000</span></span>
<span><span class="co">#&gt; I-splines3  1.77263 0.04253 41.678 0.00000</span></span>
<span><span class="co">#&gt; I-splines4  0.94140 0.17275  5.450 0.00000</span></span>
<span><span class="co">#&gt; I-splines5  1.44412 0.16933  8.528 0.00000</span></span></code></pre></div>
<p align="justify">
The two methods (two-stage -plain, conditional -dashed) provide very close predicted trajectories of CESD
</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_pred</span><span class="op">$</span><span class="va">male</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">predIC0Cond</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">CESDCond</span>, <span class="va">data_pred</span>, var.time <span class="op">=</span> <span class="st">"age"</span>, draws<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">data_pred</span><span class="op">$</span><span class="va">male</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">predIC1Cond</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">CESDCond</span>, <span class="va">data_pred</span>, var.time <span class="op">=</span> <span class="st">"age"</span>, draws<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">predIC0</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deeppink"</span>, <span class="st">"deepskyblue"</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span>, ylab<span class="op">=</span><span class="st">"CESD"</span>, main<span class="op">=</span><span class="st">"Predicted CESD in men"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span><span class="op">)</span>, shades<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">predIC0Cond</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"orchid3"</span>, <span class="st">"skyblue3"</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">2</span>, ylab<span class="op">=</span><span class="st">"CESD"</span>, main<span class="op">=</span><span class="st">""</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span><span class="op">)</span>, shades<span class="op">=</span><span class="cn">TRUE</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">predIC1</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deeppink"</span>, <span class="st">"deepskyblue"</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span>, ylab<span class="op">=</span><span class="st">"CESD"</span>, main<span class="op">=</span><span class="st">"Predicted CESD in women"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span><span class="op">)</span>, shades<span class="op">=</span><span class="cn">TRUE</span>, legend<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">predIC1Cond</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"orchid3"</span>, <span class="st">"skyblue3"</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">2</span>, ylab<span class="op">=</span><span class="st">"CESD"</span>, main<span class="op">=</span><span class="st">""</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span><span class="op">)</span>, shades<span class="op">=</span><span class="cn">TRUE</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="secondary_model_with_externVar_files/figure-html/unnamed-chunk-15-1.png" width="768"></p>
</div>
</div>
<div class="section level3">
<h3 id="secondary-model-for-time-to-event-outcome">Secondary model for time-to-event outcome<a class="anchor" aria-label="anchor" href="#secondary-model-for-time-to-event-outcome"></a>
</h3>
<p align="justify">
Time-to-event external outcomes with one or multiple competing causes are handled in externVar under parametric proportional hazard models. The specification is very similar to the one of Jointlcmm and mpjlcmm. Notably the procedure handles left truncated data. The baseline risk is either Weibull or approximated by splines. Here, we use a model with class-specific Weibull hazards for the time to dementia.
</p>
<div class="section level4">
<h4 id="with-two-stage-approach-1">with two-stage approach<a class="anchor" aria-label="anchor" href="#with-two-stage-approach-1"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Dem2stage</span> <span class="op">=</span> <span class="fu"><a href="../reference/externVar.html">externVar</a></span><span class="op">(</span><span class="va">PrimModel</span>,</span>
<span>                     survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>, <span class="va">agedem</span>, <span class="va">dem</span><span class="op">)</span> <span class="op">~</span> <span class="va">CEP</span> <span class="op">+</span> <span class="va">male</span>,</span>
<span>                     hazard <span class="op">=</span> <span class="st">"Weibull"</span>,</span>
<span>                     subject <span class="op">=</span> <span class="st">"ID"</span>,</span>
<span>                     data <span class="op">=</span> <span class="va">paquid</span>,</span>
<span>                     method <span class="op">=</span> <span class="st">"twoStageJoint"</span>,</span>
<span>                     B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p align="justify">
With hazardtype argument, we can also assume a proportional hazard across classes with either a Weibull baseline risk function or a splines baseline risk function.
</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Dem2stageWPH</span> <span class="op">=</span> <span class="fu"><a href="../reference/externVar.html">externVar</a></span><span class="op">(</span><span class="va">PrimModel</span>,</span>
<span>                      survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>, <span class="va">agedem</span>, <span class="va">dem</span><span class="op">)</span> <span class="op">~</span> <span class="va">CEP</span> <span class="op">+</span> <span class="va">male</span>,</span>
<span>                      hazard <span class="op">=</span> <span class="st">"Weibull"</span>,</span>
<span>                      hazardtype <span class="op">=</span> <span class="st">"PH"</span>,</span>
<span>                      subject <span class="op">=</span> <span class="st">"ID"</span>,</span>
<span>                      data <span class="op">=</span> <span class="va">paquid</span>,</span>
<span>                      method <span class="op">=</span> <span class="st">"twoStageJoint"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Dem2stageSPH</span> <span class="op">=</span> <span class="fu"><a href="../reference/externVar.html">externVar</a></span><span class="op">(</span><span class="va">PrimModel</span>,</span>
<span>                      survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>, <span class="va">agedem</span>, <span class="va">dem</span><span class="op">)</span> <span class="op">~</span> <span class="va">CEP</span> <span class="op">+</span> <span class="va">male</span>,</span>
<span>                      hazard <span class="op">=</span> <span class="st">"splines"</span>,</span>
<span>                      hazardtype <span class="op">=</span> <span class="st">"PH"</span>,</span>
<span>                      subject <span class="op">=</span> <span class="st">"ID"</span>,</span>
<span>                      data <span class="op">=</span> <span class="va">paquid</span>,</span>
<span>                      method <span class="op">=</span> <span class="st">"twoStageJoint"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/summarytable.html">summarytable</a></span><span class="op">(</span><span class="va">Dem2stage</span>, <span class="va">Dem2stageWPH</span>, <span class="va">Dem2stageSPH</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"npm"</span>,<span class="st">"loglik"</span>,<span class="st">"BIC"</span>,<span class="st">"AIC"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;              npm    loglik      BIC      AIC</span></span>
<span><span class="co">#&gt; Dem2stage      6 -9359.942 18757.17 18731.88</span></span>
<span><span class="co">#&gt; Dem2stageWPH   5 -9359.972 18751.02 18729.94</span></span>
<span><span class="co">#&gt; Dem2stageSPH  10 -9359.473 18781.09 18738.95</span></span></code></pre></div>
<p align="justify">
The three models give the same likelihood so the parcimonious model (Weibull proportional hazard) is selected according to AIC. The predicted survival for the reference category (male=0, CEP=0) are:
</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">Dem2stageWPH</span>, which<span class="op">=</span><span class="st">"survival"</span>, var.time<span class="op">=</span><span class="st">"age"</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deeppink"</span>, <span class="st">"deepskyblue"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="secondary_model_with_externVar_files/figure-html/unnamed-chunk-18-1.png" width="576"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Dem2stageWPH</span><span class="op">)</span></span>
<span><span class="co">#&gt; Secondary survival model </span></span>
<span><span class="co">#&gt;      fitted by maximum likelihood method </span></span>
<span><span class="co">#&gt;  ** Total parameter variance estimated using the Hessian of the joint likelihood ** </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; externVar(model = PrimModel, subject = "ID", survival = Surv(age_init, </span></span>
<span><span class="co">#&gt;     agedem, dem) ~ CEP + male, hazard = "Weibull", hazardtype = "PH", </span></span>
<span><span class="co">#&gt;     data = paquid, method = "twoStageJoint")</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Statistical Model: </span></span>
<span><span class="co">#&gt;      Dataset: paquid </span></span>
<span><span class="co">#&gt;      Number of subjects: 500 </span></span>
<span><span class="co">#&gt;      Number of latent classes: 2 </span></span>
<span><span class="co">#&gt;      Number of parameters: 5  </span></span>
<span><span class="co">#&gt;      Event 1 : </span></span>
<span><span class="co">#&gt;         Number of events: 128</span></span>
<span><span class="co">#&gt;         Proportional hazards over latent classes and </span></span>
<span><span class="co">#&gt;         Weibull baseline risk function </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Iteration process: </span></span>
<span><span class="co">#&gt;      Convergence criteria satisfied </span></span>
<span><span class="co">#&gt;      Number of iterations:  50 </span></span>
<span><span class="co">#&gt;      Convergence criteria: parameters= 1.5e-08 </span></span>
<span><span class="co">#&gt;                          : likelihood= 8.5e-08 </span></span>
<span><span class="co">#&gt;                          : second derivatives= 2.3e-13 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Goodness-of-fit statistics: </span></span>
<span><span class="co">#&gt;      maximum log-likelihood: -9359.97  </span></span>
<span><span class="co">#&gt;      AIC: 18729.94  </span></span>
<span><span class="co">#&gt;      BIC: 18751.02  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Maximum Likelihood Estimates: </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameters in the proportional hazard model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                              coef    Se      Wald p-value</span></span>
<span><span class="co">#&gt; event1 +/-sqrt(Weibull1)  0.10250 0.00055 185.554 0.00000</span></span>
<span><span class="co">#&gt; event1 +/-sqrt(Weibull2)  4.70210 0.22965  20.475 0.00000</span></span>
<span><span class="co">#&gt; event1 SurvPH class1      2.99426 0.34644   8.643 0.00000</span></span>
<span><span class="co">#&gt; CEP                      -0.73975 0.24783  -2.985 0.00284</span></span>
<span><span class="co">#&gt; male                      0.14360 0.24559   0.585 0.55874</span></span></code></pre></div>
<p align="justify">
The risk of dementia is much larger in latent class 1 compared to latent class 2 with a log hazard ratio of 2.99425 (se=0.34645). For instance, at 80 years old, the dementia-free probability remains almost at 1 in latent 2 while it is around 60% in latent class 1. At 90 years old, it is 0 for latent class 1 while it is around 70% in latent class 2.
</p>
</div>
<div class="section level4">
<h4 id="with-conditional-regression-1">with conditional regression<a class="anchor" aria-label="anchor" href="#with-conditional-regression-1"></a>
</h4>
<p>This is not yet operational</p>
</div>
</div>
<div class="section level3">
<h3 id="secondary-model-for-predictors-of-latent-class-membership">Secondary model for predictors of latent class membership<a class="anchor" aria-label="anchor" href="#secondary-model-for-predictors-of-latent-class-membership"></a>
</h3>
<p align="justify">
It is frequent to try to characterize the latent classes according to covariates of interest. This corresponds to model in a secondary model the latent class membership according to covariates. For instance, with this example, we may want to assess whether male and CEP are associated with latent class structure.
</p>
<p>This is implemented in externVar by specifying the classmb model:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">maleCEPmodel</span> <span class="op">=</span> <span class="fu"><a href="../reference/externVar.html">externVar</a></span><span class="op">(</span><span class="va">PrimModel</span>,</span>
<span>                    classmb <span class="op">=</span> <span class="op">~</span> <span class="va">male</span> <span class="op">+</span> <span class="va">CEP</span>,</span>
<span>                    subject <span class="op">=</span> <span class="st">"ID"</span>,</span>
<span>                    data <span class="op">=</span> <span class="va">paquid</span>,</span>
<span>                    method <span class="op">=</span> <span class="st">"twoStageJoint"</span><span class="op">)</span></span>
<span><span class="va">Class2stage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">maleCEPmodel</span><span class="op">)</span></span>
<span><span class="co">#&gt; Secondary multinomial model for external class predictor </span></span>
<span><span class="co">#&gt;      fitted by maximum likelihood method </span></span>
<span><span class="co">#&gt;  ** Total parameter variance estimated using the Hessian of the joint likelihood ** </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; externVar(model = PrimModel, subject = "ID", classmb = ~male + </span></span>
<span><span class="co">#&gt;     CEP, data = paquid, method = "twoStageJoint")</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Statistical Model: </span></span>
<span><span class="co">#&gt;      Dataset: paquid </span></span>
<span><span class="co">#&gt;      Number of subjects: 500 </span></span>
<span><span class="co">#&gt;      Number of latent classes: 2 </span></span>
<span><span class="co">#&gt;      Number of parameters: 3  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Iteration process: </span></span>
<span><span class="co">#&gt;      Convergence criteria satisfied </span></span>
<span><span class="co">#&gt;      Number of iterations:  5 </span></span>
<span><span class="co">#&gt;      Convergence criteria: parameters= 3.1e-06 </span></span>
<span><span class="co">#&gt;                          : likelihood= 4.2e-06 </span></span>
<span><span class="co">#&gt;                          : second derivatives= 1.1e-11 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Goodness-of-fit statistics: </span></span>
<span><span class="co">#&gt;      maximum log-likelihood: -8894.28  </span></span>
<span><span class="co">#&gt;      AIC: 17794.56  </span></span>
<span><span class="co">#&gt;      BIC: 17807.2  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Maximum Likelihood Estimates: </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Fixed effects in the class-membership model:</span></span>
<span><span class="co">#&gt; (the class of reference is the last class) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                      coef    Se     Wald p-value</span></span>
<span><span class="co">#&gt; intercept class1 -1.68614 0.50262 -3.355 0.00079</span></span>
<span><span class="co">#&gt; male class1      -1.09687 0.44277 -2.477 0.01324</span></span>
<span><span class="co">#&gt; CEP class1        0.90387 0.50666  1.784 0.07443</span></span></code></pre></div>
<p align="justify">
In latent class membership models, the reference class is always the last one. Here, using the two-stage approach, both male and CEP are significantly associated with the class membership, males being less likely in latent class 1 than in latent class 2 (log odds-ratio = -1.09687 se=0.44277), and participants with CEP=1 more likely in latent class 1 than in latent class 2 (log odds-ratio = 0.904 se=0.507).
</p>
<p align="justify">
With the conditional regression, the estimated parameters are slightly different although the two methods have been shown to provide unbiased estimates.
</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">maleCEPmodelCond</span> <span class="op">=</span> <span class="fu"><a href="../reference/externVar.html">externVar</a></span><span class="op">(</span><span class="va">PrimModel</span>,</span>
<span>                    classmb <span class="op">=</span> <span class="op">~</span> <span class="va">male</span> <span class="op">+</span> <span class="va">CEP</span>,</span>
<span>                    subject <span class="op">=</span> <span class="st">"ID"</span>,</span>
<span>                    data <span class="op">=</span> <span class="va">paquid</span>,</span>
<span>                    method <span class="op">=</span> <span class="st">"conditional"</span><span class="op">)</span></span>
<span><span class="va">ClassCond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">maleCEPmodelCond</span><span class="op">)</span></span>
<span><span class="co">#&gt; Secondary multinomial model for external class predictor </span></span>
<span><span class="co">#&gt;      fitted by maximum likelihood method </span></span>
<span><span class="co">#&gt;  ** Total parameter variance estimated using parametric bootstrap ** </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; externVar(model = PrimModel, subject = "ID", classmb = ~male + </span></span>
<span><span class="co">#&gt;     CEP, data = paquid, method = "conditional")</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Statistical Model: </span></span>
<span><span class="co">#&gt;      Dataset: paquid </span></span>
<span><span class="co">#&gt;      Number of subjects: 500 </span></span>
<span><span class="co">#&gt;      Number of latent classes: 2 </span></span>
<span><span class="co">#&gt;      Number of parameters: 3  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Iteration process: </span></span>
<span><span class="co">#&gt;      Convergence criteria satisfied </span></span>
<span><span class="co">#&gt;      Proportion of convergence on bootstrap iterations (%)= 100 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Goodness-of-fit statistics: </span></span>
<span><span class="co">#&gt;      maximum log-likelihood: -180.44  </span></span>
<span><span class="co">#&gt;      AIC: 366.88  </span></span>
<span><span class="co">#&gt;      BIC: 379.53  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Maximum Likelihood Estimates: </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Fixed effects in the class-membership model:</span></span>
<span><span class="co">#&gt; (the class of reference is the last class) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                      coef    Se     Wald p-value</span></span>
<span><span class="co">#&gt; intercept class1 -1.57512 0.57809 -2.725 0.00644</span></span>
<span><span class="co">#&gt; male class1      -1.43894 0.57802 -2.489 0.01279</span></span>
<span><span class="co">#&gt; CEP class1        0.87433 0.61569  1.420 0.15558</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Class2stage</span>,<span class="va">ClassCond</span><span class="op">)</span></span>
<span><span class="co">#&gt;                      coef      Se   Wald p-value     coef      Se   Wald</span></span>
<span><span class="co">#&gt; intercept class1 -1.68614 0.50262 -3.355 0.00079 -1.57512 0.57809 -2.725</span></span>
<span><span class="co">#&gt; male class1      -1.09687 0.44277 -2.477 0.01324 -1.43894 0.57802 -2.489</span></span>
<span><span class="co">#&gt; CEP class1        0.90387 0.50666  1.784 0.07443  0.87433 0.61569  1.420</span></span>
<span><span class="co">#&gt;                  p-value</span></span>
<span><span class="co">#&gt; intercept class1 0.00644</span></span>
<span><span class="co">#&gt; male class1      0.01279</span></span>
<span><span class="co">#&gt; CEP class1       0.15558</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="references">References:<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Bakk, Z. &amp; Kuha, J. Relating latent class membership to external variables: An overview. Br J Math Stat Psychol 74, 340–362 (2021).</p>
<p>Bakk, Z., Oberski, D. L. &amp; Vermunt, J. K. Relating Latent Class Assignments to External Variables: Standard Errors for Correct Inference. Political Analysis 22, 520–540 (2014).</p>
<p>Bakk, Z., Tekle, F. B. &amp; Vermunt, J. K. Estimating the Association between Latent Class Membership and External Variables Using Bias-adjusted Three-step Approaches. Sociological Methodology 43, 272–311 (2013).</p>
<p>Bakk, Z. &amp; Kuha, J. Two-Step Estimation of Models Between Latent Classes and External Variables. Psychometrika 83, 871–892 (2018).</p>
<p>Proust-Lima, C. et al. Describing complex disease progression using joint latent class models for multivariate longitudinal markers and clinical endpoints. Stat Med 42, 3996–4014 (2023).</p>
<p>Vermunt, J. K. Latent Class Modeling with Covariates: Two Improved Three-Step Approaches. Political Analysis 18, 450–469 (2010).</p>
<p>Xue, Q. L. &amp; Bandeen-Roche, K. Combining complete multivariate outcomes with incomplete covariate information: A latent class approach. Biometrics. 58, 110–120 (2002).</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Cecile Proust-Lima, Viviane Philipps.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
