<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>How to estimate a joint latent class mixed model using Jointlcmm function • lcmm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to estimate a joint latent class mixed model using Jointlcmm function">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lcmm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/lcmm.html">GET STARTED</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">VIGNETTES</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/latent_class_model_with_hlme.html">How to estimate a latent class mixed model using hlme function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_lcmm.html">How to estimate a latent process mixed model using lcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm.html">How to estimate a latent process mixed model for multivariate markers using multlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm_IRT.html">Continuous-time longitudinal IRT model</a></li>
    <li><a class="dropdown-item" href="../articles/joint_latent_class_model_with_Jointlcmm.html">How to estimate a joint latent class mixed model using Jointlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/multivariate_latent_class_model_with_mpjlcmm.html">How to estimate a multivariate latent class mixed model using mpjlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/secondary_model_with_externVar.html">Accounting for latent class assignment uncertainty in subsequent analyses</a></li>
    <li><a class="dropdown-item" href="../articles/pre_normalizing.html">Pre-normalizing a dependent variable using lcmm</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/usual_problems.html">FAQ</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">REFERENCE</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">CHANGELOG</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CecileProust-Lima/lcmm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>How to estimate a joint latent class mixed model using Jointlcmm function</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CecileProust-Lima/lcmm/blob/HEAD/vignettes/joint_latent_class_model_with_Jointlcmm.Rmd" class="external-link"><code>vignettes/joint_latent_class_model_with_Jointlcmm.Rmd</code></a></small>
      <div class="d-none name"><code>joint_latent_class_model_with_Jointlcmm.Rmd</code></div>
    </div>

    
    
<p> </p>
<div class="section level2">
<h2 id="background-on-the-model">Background on the model<a class="anchor" aria-label="anchor" href="#background-on-the-model"></a>
</h2>
<p align="justify">
</p>
<p>Joint models are used to analyse simultaneously two related
phenomena, the evolution of a variable and the occurence of an event.
Joint latent class models (JLCM) consist of a linear mixed model and a
proportional hazard model linked by the latent classes. The population
is split in several groups, the latent classes, and each class is
caracterized by a specific evolution of the dependent variable and an
associated risk of event.</p>
<p> </p>
<p align="justify">
</p>
<p>Latent class membership is defined by a discrete random variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>i</mi></msub><annotation encoding="application/x-tex">c_{i}</annotation></semantics></math>
that equals
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
if subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
belongs to latent class
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
= 1,
…,<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>).
The variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>i</mi></msub><annotation encoding="application/x-tex">c_{i}</annotation></semantics></math>
is latent; its probability is described using a multinomial logistic
model according to covariates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>c</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">X_{ci}</annotation></semantics></math>:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mrow><mi>i</mi><mi>g</mi></mrow></msub><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><mi>g</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mrow><mi>c</mi><mi>i</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ξ</mi><mrow><mn>0</mn><mi>g</mi></mrow></msub><mo>+</mo><msub><mi>X</mi><mrow><mi>c</mi><mi>i</mi></mrow></msub><msub><mi>ξ</mi><mrow><mn>1</mn><mi>g</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msubsup><mo>∑</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></msubsup><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ξ</mi><mrow><mn>0</mn><mi>l</mi></mrow></msub><mo>+</mo><msub><mi>X</mi><mrow><mi>c</mi><mi>i</mi></mrow></msub><msub><mi>ξ</mi><mrow><mn>1</mn><mi>l</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">\pi_{ig}= P(c_{i} = g|X_{ci}) = \frac{\exp(\xi_{0g}+X_{ci}\xi_{1g})}{ \sum_{l=1}^{G}\exp(\xi_{0l}+X_{ci}\xi_{1l})}</annotation></semantics></math></p>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ξ</mi><mrow><mn>0</mn><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">\xi_{0g}</annotation></semantics></math>
is the intercept for class
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ξ</mi><mrow><mn>1</mn><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">\xi_{1g}</annotation></semantics></math>
is the q1-vector of class-specific parameters associated with the
q1-vector of time-independent covariates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>c</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">X_{ci}</annotation></semantics></math>.
For identifiability,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ξ</mi><mrow><mn>0</mn><mi>G</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\xi_{0G} = 0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ξ</mi><mrow><mn>1</mn><mi>G</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\xi_{1G} = 0</annotation></semantics></math>.
When no covariate predicts the latent class membership, this model
reduces to a class-specific probability.

<p align="justify">
For a continuous and Gaussian variable, the trajectories of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
are defined conditionally to the latent class by a linear mixed model.
So, conditional on class
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>,
the model is defined for subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
at occasion
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>:
</p>
<p> </p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mo stretchy="false" form="prefix">|</mo><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><mi>g</mi></mrow></msub><mo>=</mo><msub><mi>X</mi><mrow><mn>2</mn><mi>i</mi><mi>j</mi></mrow></msub><mi>β</mi><mo>+</mo><msub><mi>X</mi><mrow><mn>3</mn><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>γ</mi><mi>g</mi></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>b</mi><mi>i</mi></msub><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Y_{ij}|_{c_{i}=g} = X_{2ij}\beta+X_{3ij}\gamma_{g}+Z_{ij}b_{i}+\epsilon_{ij}</annotation></semantics></math></p>
<p> </p>
<p align="justify">
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mn>2</mn><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">X_{2ij}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mn>3</mn><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">X_{3ij}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">Z_{ij}</annotation></semantics></math>
are vectors of covariates respectively associated with common fixed
effects over classes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>,
class-specific fixed effects
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mi>g</mi></msub><annotation encoding="application/x-tex">\gamma_{g}</annotation></semantics></math>
and with individual random effects
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub><msub><mo stretchy="false" form="prefix">|</mo><mrow><mi>c</mi><mi>i</mi><mo>=</mo><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">b_{i}|_{ci=g}</annotation></semantics></math>
called
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>b</mi><mrow><mi>i</mi><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">b_{ig}</annotation></semantics></math>
whose distributions are now class-specific.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_{2}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>3</mn></msub><annotation encoding="application/x-tex">X_{3}</annotation></semantics></math>
can’t have common variables.
</p>
<p align="justify">
The proporional hazard model is defined conditionaly on the same class
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
as :
</p>
<p> </p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mo stretchy="false" form="prefix">|</mo><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><mi>g</mi></mrow></msub><mo>=</mo><msub><mi>λ</mi><mrow><mn>0</mn><mi>g</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mrow><mn>4</mn><mi>i</mi></mrow></msub><mi>ψ</mi><mo>+</mo><msub><mi>X</mi><mrow><mn>5</mn><mi>i</mi></mrow></msub><msub><mi>η</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\lambda(t)|_{c_{i}=g} = \lambda_{0g}(t)\exp(X_{4i}\psi+X_{5i}\eta_g)</annotation></semantics></math></p>
<p> </p>
<p align="justify">
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mn>4</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">X_{4i}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mn>5</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">X_{5i}</annotation></semantics></math>
are vectors of covariates respectively associated with common effects
aver classes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
and class-specific effects
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>η</mi><mi>g</mi></msub><annotation encoding="application/x-tex">\eta_g</annotation></semantics></math>.
</p>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>We use the paquid sample included in the package. Please refer to the
introduction vignette for more details about these data. We consider
here only the subjects at risk of dementia at the begining of the study
:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paquidS</span> <span class="op">&lt;-</span> <span class="va">paquid</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">agedem</span> <span class="op">&gt;</span> <span class="va">paquid</span><span class="op">$</span><span class="va">age_init</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>We also create some variables that will be used in the example :</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">NormPsy</span><span class="op">)</span></span>
<span><span class="va">paquidS</span><span class="op">$</span><span class="va">normMMSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/NormPsy/man/normMMSE.html" class="external-link">normMMSE</a></span><span class="op">(</span><span class="va">paquidS</span><span class="op">$</span><span class="va">MMSE</span><span class="op">)</span></span>
<span><span class="va">paquidS</span><span class="op">$</span><span class="va">age65</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">paquidS</span><span class="op">$</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="first-use-of-jointlcmm-function">First use of Jointlcmm function<a class="anchor" aria-label="anchor" href="#first-use-of-jointlcmm-function"></a>
</h2>
<p>We model jointly the trajectory of normMMSE and time to dementia. As
a JLCM is estimated for a fixed number of latent classes, we begin by
specifying the model with 1 latent class.</p>
<div class="section level3">
<h3 id="linear-mixed-model-for-normmmse-trajectory">1. Linear mixed model for normMMSE trajectory<a class="anchor" aria-label="anchor" href="#linear-mixed-model-for-normmmse-trajectory"></a>
</h3>
<p>We begin by specifying the linear mixed model for normMMSE. We will
consider the same specification as in the hlme vignette, that is a
quadratic trajectory with age adjusted for CEP.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lmm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hlme.html">hlme</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">CEP</span> , random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, </span>
<span>             subject <span class="op">=</span> <span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquidS</span>,verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lmm</span><span class="op">)</span></span>
<span><span class="co">#&gt; Heterogenous linear mixed model </span></span>
<span><span class="co">#&gt;      fitted by maximum likelihood method </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; hlme(fixed = normMMSE ~ age65 + I(age65^2) + CEP, random = ~age65 + </span></span>
<span><span class="co">#&gt;     I(age65^2), subject = "ID", data = paquidS, verbose = FALSE)</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Statistical Model: </span></span>
<span><span class="co">#&gt;      Dataset: paquidS </span></span>
<span><span class="co">#&gt;      Number of subjects: 499 </span></span>
<span><span class="co">#&gt;      Number of observations: 2213 </span></span>
<span><span class="co">#&gt;      Number of observations deleted: 36 </span></span>
<span><span class="co">#&gt;      Number of latent classes: 1 </span></span>
<span><span class="co">#&gt;      Number of parameters: 11  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Iteration process: </span></span>
<span><span class="co">#&gt;      Convergence criteria satisfied </span></span>
<span><span class="co">#&gt;      Number of iterations:  25 </span></span>
<span><span class="co">#&gt;      Convergence criteria: parameters= 2.1e-07 </span></span>
<span><span class="co">#&gt;                          : likelihood= 6.6e-09 </span></span>
<span><span class="co">#&gt;                          : second derivatives= 5.8e-16 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Goodness-of-fit statistics: </span></span>
<span><span class="co">#&gt;      maximum log-likelihood: -8916.59  </span></span>
<span><span class="co">#&gt;      AIC: 17855.18  </span></span>
<span><span class="co">#&gt;      BIC: 17901.52  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Maximum Likelihood Estimates: </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Fixed effects in the longitudinal model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                  coef      Se     Wald p-value</span></span>
<span><span class="co">#&gt; intercept    64.64416 1.95702   33.032 0.00000</span></span>
<span><span class="co">#&gt; age65         5.59810 2.30157    2.432 0.01500</span></span>
<span><span class="co">#&gt; I(age65^2)   -6.09658 0.79065   -7.711 0.00000</span></span>
<span><span class="co">#&gt; CEP          13.65079 1.35072   10.106 0.00000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variance-covariance matrix of the random-effects:</span></span>
<span><span class="co">#&gt;             intercept     age65 I(age65^2)</span></span>
<span><span class="co">#&gt; intercept   212.80180                     </span></span>
<span><span class="co">#&gt; age65      -216.41731  456.5118           </span></span>
<span><span class="co">#&gt; I(age65^2)   55.71579 -145.7874   59.36679</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                coef      Se</span></span>
<span><span class="co">#&gt; Residual standard error:   10.07244 0.20277</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="survival-model-for-dementia-diagnosis">2. Survival model for dementia diagnosis<a class="anchor" aria-label="anchor" href="#survival-model-for-dementia-diagnosis"></a>
</h3>
<p>Joinlcmm assumes a parametric baseline risk function. We thus need to
determine the family of baseline risks. To do so, we will use the
jointlcmm function in which the longitudinal part will be the same as in
hlme.</p>
<p>In the application, the risk of dementia is described according to
age so we have a problem of delayed entry. The program handles it by
specifying age_init in the Surv object.</p>
<p>We try different families of baseline risks (Weibull, Splines,
piecewise constant) and we systematically adjust on CEP and male.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Weibull distribution</span></span>
<span><span class="va">mj1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Jointlcmm.html">Jointlcmm</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">CEP</span>, random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, </span>
<span>                 survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>, <span class="va">agedem</span>, <span class="va">dem</span><span class="op">)</span> <span class="op">~</span> <span class="va">CEP</span> <span class="op">+</span> <span class="va">male</span>, hazard <span class="op">=</span> <span class="st">"Weibull"</span>,</span>
<span>                 subject <span class="op">=</span> <span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquidS</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">mj1</span><span class="op">$</span><span class="va">best</span></span>
<span><span class="co">#&gt; event1 +/-sqrt(Weibull1) event1 +/-sqrt(Weibull2)                      CEP </span></span>
<span><span class="co">#&gt;                0.1038941                3.6270872               -0.2484354 </span></span>
<span><span class="co">#&gt;                     male                intercept                    age65 </span></span>
<span><span class="co">#&gt;               -0.2007211               64.6441641                5.5980977 </span></span>
<span><span class="co">#&gt;               I(age65^2)                      CEP                 varcov 1 </span></span>
<span><span class="co">#&gt;               -6.0965763               13.6507881              212.8020164 </span></span>
<span><span class="co">#&gt;                 varcov 2                 varcov 3                 varcov 4 </span></span>
<span><span class="co">#&gt;             -216.4176788              456.5123512               55.7159127 </span></span>
<span><span class="co">#&gt;                 varcov 5                 varcov 6                   stderr </span></span>
<span><span class="co">#&gt;             -145.7875460               59.3668519               10.0724388</span></span>
<span><span class="co"># Note that to reduce computation time, we could fix the parameters of the longitudinal </span></span>
<span><span class="co">#part to those of the linear mixed model </span></span>
<span><span class="va">binit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="va">lmm</span><span class="op">$</span><span class="va">best</span><span class="op">)</span></span>
<span><span class="va">mj1bis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Jointlcmm.html">Jointlcmm</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">CEP</span>, random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                    survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>, <span class="va">agedem</span>, <span class="va">dem</span><span class="op">)</span> <span class="op">~</span> <span class="va">CEP</span> <span class="op">+</span> <span class="va">male</span>, hazard <span class="op">=</span> <span class="st">"Weibull"</span>,</span>
<span>                    subject <span class="op">=</span> <span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquidS</span>,B<span class="op">=</span><span class="va">binit</span>, posfix<span class="op">=</span><span class="fl">5</span><span class="op">:</span><span class="fl">15</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># Piecewise constant hazard</span></span>
<span><span class="va">mjP1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Jointlcmm.html">Jointlcmm</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">CEP</span>, random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                  survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>, <span class="va">agedem</span>, <span class="va">dem</span><span class="op">)</span> <span class="op">~</span> <span class="va">CEP</span> <span class="op">+</span> <span class="va">male</span>, hazard <span class="op">=</span> <span class="st">"piecewise"</span>,</span>
<span>                  subject <span class="op">=</span> <span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquidS</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># Hazard approximated by cubic splines (3 intern knots located at the quantiles by default</span></span>
<span><span class="va">mjS1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Jointlcmm.html">Jointlcmm</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">CEP</span>, random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                  survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>, <span class="va">agedem</span>, <span class="va">dem</span><span class="op">)</span> <span class="op">~</span> <span class="va">CEP</span> <span class="op">+</span> <span class="va">male</span>, hazard <span class="op">=</span> <span class="st">"splines"</span>,</span>
<span>                  subject <span class="op">=</span> <span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquidS</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>The Weibull model gives the best fit.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># From the summary table, we prefer the Weibull model</span></span>
<span><span class="fu"><a href="../reference/summarytable.html">summarytable</a></span><span class="op">(</span><span class="va">mj1</span>,<span class="va">mjP1</span>,<span class="va">mjS1</span><span class="op">)</span></span>
<span><span class="co">#&gt;      G    loglik npm      BIC %class1</span></span>
<span><span class="co">#&gt; mj1  1 -9449.079  15 18991.35     100</span></span>
<span><span class="co">#&gt; mjP1 1 -9452.777  17 19011.17     100</span></span>
<span><span class="co">#&gt; mjS1 1 -9447.434  20 19019.12     100</span></span>
<span><span class="fu"><a href="../reference/summarytable.html">summarytable</a></span><span class="op">(</span><span class="va">mj1</span>,<span class="va">mjP1</span>,<span class="va">mjS1</span>,which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"npm"</span>,<span class="st">"loglik"</span>,<span class="st">"AIC"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      npm    loglik      AIC</span></span>
<span><span class="co">#&gt; mj1   15 -9449.079 18928.16</span></span>
<span><span class="co">#&gt; mjP1  17 -9452.777 18939.55</span></span>
<span><span class="co">#&gt; mjS1  20 -9447.434 18934.87</span></span>
<span><span class="co"># Summary of the model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mj1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joint latent class model for quantitative outcome and competing risks </span></span>
<span><span class="co">#&gt;      fitted by maximum likelihood method </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Jointlcmm(fixed = normMMSE ~ age65 + I(age65^2) + CEP, random = ~age65 + </span></span>
<span><span class="co">#&gt;     I(age65^2), subject = "ID", survival = Surv(age_init, agedem, </span></span>
<span><span class="co">#&gt;     dem) ~ CEP + male, hazard = "Weibull", data = paquidS, verbose = FALSE)</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Statistical Model: </span></span>
<span><span class="co">#&gt;      Dataset: paquidS </span></span>
<span><span class="co">#&gt;      Number of subjects: 499 </span></span>
<span><span class="co">#&gt;      Number of observations: 2213 </span></span>
<span><span class="co">#&gt;      Number of latent classes: 1 </span></span>
<span><span class="co">#&gt;      Number of parameters: 15  </span></span>
<span><span class="co">#&gt;      Event 1: </span></span>
<span><span class="co">#&gt;         Number of events: 128</span></span>
<span><span class="co">#&gt;         Weibull baseline risk function </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Iteration process: </span></span>
<span><span class="co">#&gt;      Convergence criteria satisfied </span></span>
<span><span class="co">#&gt;      Number of iterations:  37 </span></span>
<span><span class="co">#&gt;      Convergence criteria: parameters= 2.6e-06 </span></span>
<span><span class="co">#&gt;                          : likelihood= 2.3e-07 </span></span>
<span><span class="co">#&gt;                          : second derivatives= 1.2e-12 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Goodness-of-fit statistics: </span></span>
<span><span class="co">#&gt;      maximum log-likelihood: -9449.08  </span></span>
<span><span class="co">#&gt;      AIC: 18928.16  </span></span>
<span><span class="co">#&gt;      BIC: 18991.35  </span></span>
<span><span class="co">#&gt;      Score test statistic for CI assumption: 168.544 (p-value=0) </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Maximum Likelihood Estimates: </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Parameters in the proportional hazard model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                coef      Se     Wald p-value</span></span>
<span><span class="co">#&gt; event1 +/-sqrt(Weibull1)    0.10389 0.00060  174.217 0.00000</span></span>
<span><span class="co">#&gt; event1 +/-sqrt(Weibull2)    3.62709 0.17427   20.812 0.00000</span></span>
<span><span class="co">#&gt; CEP                        -0.24844 0.18806   -1.321 0.18650</span></span>
<span><span class="co">#&gt; male                       -0.20072 0.20399   -0.984 0.32513</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects in the longitudinal model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                  coef      Se     Wald p-value</span></span>
<span><span class="co">#&gt; intercept    64.64416 1.95705   33.031 0.00000</span></span>
<span><span class="co">#&gt; age65         5.59810 2.30170    2.432 0.01501</span></span>
<span><span class="co">#&gt; I(age65^2)   -6.09658 0.79069   -7.710 0.00000</span></span>
<span><span class="co">#&gt; CEP          13.65079 1.35071   10.106 0.00000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variance-covariance matrix of the random-effects:</span></span>
<span><span class="co">#&gt;             intercept     age65 I(age65^2)</span></span>
<span><span class="co">#&gt; intercept   212.80202                     </span></span>
<span><span class="co">#&gt; age65      -216.41768  456.5124           </span></span>
<span><span class="co">#&gt; I(age65^2)   55.71591 -145.7876   59.36685</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                               coef      Se</span></span>
<span><span class="co">#&gt; Residual standard error   10.07244 0.20278</span></span></code></pre></div>
<p>It is possible to change the parameterization of the survival model
(with log instead of +/-sqrt)</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">binit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="va">lmm</span><span class="op">$</span><span class="va">best</span><span class="op">)</span></span>
<span><span class="va">mj1ter</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Jointlcmm.html">Jointlcmm</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">CEP</span>, random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                    survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>, <span class="va">agedem</span>, <span class="va">dem</span><span class="op">)</span> <span class="op">~</span> <span class="va">CEP</span> <span class="op">+</span> <span class="va">male</span>, hazard <span class="op">=</span> <span class="st">"Weibull"</span>,</span>
<span>                    subject <span class="op">=</span> <span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquidS</span>,B<span class="op">=</span><span class="va">binit</span>, posfix<span class="op">=</span><span class="fl">5</span><span class="op">:</span><span class="fl">15</span>,logscale <span class="op">=</span> <span class="cn">TRUE</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; event1 log(Weibull1) event1 log(Weibull2)                  CEP </span></span>
<span><span class="co">#&gt;                    1                    1                    1 </span></span>
<span><span class="co">#&gt;                 male </span></span>
<span><span class="co">#&gt;                    1 </span></span>
<span><span class="co">#&gt; event1 log(Weibull1) event1 log(Weibull2)                  CEP </span></span>
<span><span class="co">#&gt;            0.2372000            0.9902321            0.9056381 </span></span>
<span><span class="co">#&gt;                 male </span></span>
<span><span class="co">#&gt;            0.9770275 </span></span>
<span><span class="co">#&gt; event1 log(Weibull1) event1 log(Weibull2)                  CEP </span></span>
<span><span class="co">#&gt;           -0.7251690            0.9888428            0.8884781 </span></span>
<span><span class="co">#&gt;                 male </span></span>
<span><span class="co">#&gt;            0.9730797 </span></span>
<span><span class="co">#&gt; event1 log(Weibull1) event1 log(Weibull2)                  CEP </span></span>
<span><span class="co">#&gt;           -1.7269514            0.9892144            0.8859636 </span></span>
<span><span class="co">#&gt;                 male </span></span>
<span><span class="co">#&gt;            0.9725280 </span></span>
<span><span class="co">#&gt; event1 log(Weibull1) event1 log(Weibull2)                  CEP </span></span>
<span><span class="co">#&gt;           -2.7335154            0.9898055            0.8852146 </span></span>
<span><span class="co">#&gt;                 male </span></span>
<span><span class="co">#&gt;            0.9723791 </span></span>
<span><span class="co">#&gt; event1 log(Weibull1) event1 log(Weibull2)                  CEP </span></span>
<span><span class="co">#&gt;           -3.7396381            0.9903824            0.8842992 </span></span>
<span><span class="co">#&gt;                 male </span></span>
<span><span class="co">#&gt;            0.9721774</span></span>
<span><span class="co"># Same loglikelihood, HR, only the parameters of the baseline risk function change.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mj1ter</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joint latent class model for quantitative outcome and competing risks </span></span>
<span><span class="co">#&gt;      fitted by maximum likelihood method </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Jointlcmm(fixed = normMMSE ~ age65 + I(age65^2) + CEP, random = ~age65 + </span></span>
<span><span class="co">#&gt;     I(age65^2), subject = "ID", survival = Surv(age_init, agedem, </span></span>
<span><span class="co">#&gt;     dem) ~ CEP + male, hazard = "Weibull", data = paquidS, logscale = TRUE, </span></span>
<span><span class="co">#&gt;     posfix = 5:15, verbose = FALSE)</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Statistical Model: </span></span>
<span><span class="co">#&gt;      Dataset: paquidS </span></span>
<span><span class="co">#&gt;      Number of subjects: 499 </span></span>
<span><span class="co">#&gt;      Number of observations: 2213 </span></span>
<span><span class="co">#&gt;      Number of latent classes: 1 </span></span>
<span><span class="co">#&gt;      Number of parameters: 15  </span></span>
<span><span class="co">#&gt;      Number of estimated parameters: 4  </span></span>
<span><span class="co">#&gt;      Event 1: </span></span>
<span><span class="co">#&gt;         Number of events: 128</span></span>
<span><span class="co">#&gt;         Weibull baseline risk function </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Iteration process: </span></span>
<span><span class="co">#&gt;      Convergence criteria satisfied </span></span>
<span><span class="co">#&gt;      Number of iterations:  90 </span></span>
<span><span class="co">#&gt;      Convergence criteria: parameters= 6.4e-05 </span></span>
<span><span class="co">#&gt;                          : likelihood= 4.1e-05 </span></span>
<span><span class="co">#&gt;                          : second derivatives= 8e-07 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Goodness-of-fit statistics: </span></span>
<span><span class="co">#&gt;      maximum log-likelihood: -9449.08  </span></span>
<span><span class="co">#&gt;      AIC: 18906.16  </span></span>
<span><span class="co">#&gt;      BIC: 18923.01  </span></span>
<span><span class="co">#&gt;      Score test statistic for CI assumption: 168.584 (p-value=0) </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Maximum Likelihood Estimates: </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Parameters in the proportional hazard model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                            coef      Se    Wald p-value</span></span>
<span><span class="co">#&gt; event1 log(Weibull1)  -59.41437 3.23418 -18.371 0.00000</span></span>
<span><span class="co">#&gt; event1 log(Weibull2)    2.57409 0.05404  47.632 0.00000</span></span>
<span><span class="co">#&gt; CEP                    -0.24874 0.18769  -1.325 0.18508</span></span>
<span><span class="co">#&gt; male                   -0.20153 0.20258  -0.995 0.31982</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects in the longitudinal model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                  coef  Se Wald p-value</span></span>
<span><span class="co">#&gt; intercept    64.64416*                </span></span>
<span><span class="co">#&gt; age65         5.59810*                </span></span>
<span><span class="co">#&gt; I(age65^2)   -6.09658*                </span></span>
<span><span class="co">#&gt; CEP          13.65079*                </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variance-covariance matrix of the random-effects:</span></span>
<span><span class="co">#&gt;            intercept   age65       I(age65^2)</span></span>
<span><span class="co">#&gt; intercept   212.80180*                       </span></span>
<span><span class="co">#&gt; age65      -216.41731*  456.51177*           </span></span>
<span><span class="co">#&gt; I(age65^2)   55.71579* -145.78736* 59.36679* </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                               coef  Se</span></span>
<span><span class="co">#&gt; Residual standard error   10.07244*   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  * coefficient fixed by the user </span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="estimation-with-different-numbers-of-latent-classes">3. Estimation with different numbers of latent classes<a class="anchor" aria-label="anchor" href="#estimation-with-different-numbers-of-latent-classes"></a>
</h3>
<p>Once the specification of the model under G=1 is done (one class
means independent models), we can estimate the model with more than one
class.</p>
<p>This is a cumbersome step in the analysis since the estimation has to
be replicated for different numbers of latent classes AND various
initial values to avoid the convergence toward a local maximum.</p>
<div class="section level4">
<h4 id="model-with-two-latent-classes">3.1 Model with two latent classes<a class="anchor" aria-label="anchor" href="#model-with-two-latent-classes"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Model with 2 latent classes and class-specific baseline risks</span></span>
<span><span class="co"># The starting values are determined by the model under G=1</span></span>
<span><span class="co"># CAUTION: Try to specify argument B=. Otherwise, the program internally estimated a </span></span>
<span><span class="co"># first model with G=1 which artificially makes the program longer. </span></span>
<span><span class="va">mj2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Jointlcmm.html">Jointlcmm</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">CEP</span>, mixture <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, </span>
<span>                 random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>, <span class="va">agedem</span>, <span class="va">dem</span><span class="op">)</span> </span>
<span>                 <span class="op">~</span> <span class="va">CEP</span></span>
<span>                 <span class="op">+</span> <span class="va">male</span>, hazard <span class="op">=</span> <span class="st">"Weibull"</span>, subject <span class="op">=</span> <span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquidS</span>, ng<span class="op">=</span><span class="fl">2</span>,B<span class="op">=</span><span class="va">mj1</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># model with 2 latent classes and proportional hazards in each class</span></span>
<span><span class="va">mj2_prop</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Jointlcmm.html">Jointlcmm</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">CEP</span>, mixture <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                      random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>, <span class="va">agedem</span>, <span class="va">dem</span><span class="op">)</span></span>
<span>                      <span class="op">~</span> <span class="va">CEP</span> <span class="op">+</span> <span class="va">male</span>, hazard <span class="op">=</span> <span class="st">"Weibull"</span>, subject <span class="op">=</span> <span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquidS</span>,</span>
<span>                      ng<span class="op">=</span><span class="fl">2</span>,B<span class="op">=</span><span class="va">mj1</span>, hazardtype<span class="op">=</span><span class="st">'PH'</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># comparison</span></span>
<span><span class="fu"><a href="../reference/summarytable.html">summarytable</a></span><span class="op">(</span><span class="va">mj2</span>,<span class="va">mj2_prop</span>,which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"npm"</span>,<span class="st">"loglik"</span>,<span class="st">"AIC"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;          npm    loglik      AIC</span></span>
<span><span class="co">#&gt; mj2       21 -9337.187 18716.37</span></span>
<span><span class="co">#&gt; mj2_prop  20 -9338.147 18716.29</span></span></code></pre></div>
<p>We could choose to consider proportional hazards given the fit
obtained but we continue with class-specific baseline risk functions to
allow for more flexibility. Note that the results in terms of
classification seem to be very close.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Classification given in</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mj2</span><span class="op">$</span><span class="va">pprob</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ID class    probYT1    probYT2</span></span>
<span><span class="co">#&gt; 1  1     2 0.38861735 0.61138265</span></span>
<span><span class="co">#&gt; 2  2     1 0.94870154 0.05129846</span></span>
<span><span class="co">#&gt; 3  3     2 0.44381993 0.55618007</span></span>
<span><span class="co">#&gt; 4  4     2 0.32373146 0.67626854</span></span>
<span><span class="co">#&gt; 5  5     2 0.02164884 0.97835116</span></span>
<span><span class="co">#&gt; 6  6     1 0.73146956 0.26853044</span></span>
<span><span class="co"># comparison of classifications</span></span>
<span><span class="fu"><a href="../reference/xclass.html">xclass</a></span><span class="op">(</span><span class="va">mj2</span>,<span class="va">mj2_prop</span><span class="op">)</span></span>
<span><span class="co">#&gt;    </span></span>
<span><span class="co">#&gt;       1   2</span></span>
<span><span class="co">#&gt;   1 100   5</span></span>
<span><span class="co">#&gt;   2   0 394</span></span></code></pre></div>
<p>The estimates of the model are in the summary.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># summary of the model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mj2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joint latent class model for quantitative outcome and competing risks </span></span>
<span><span class="co">#&gt;      fitted by maximum likelihood method </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Jointlcmm(fixed = normMMSE ~ age65 + I(age65^2) + CEP, mixture = ~age65 + </span></span>
<span><span class="co">#&gt;     I(age65^2), random = ~age65 + I(age65^2), subject = "ID", </span></span>
<span><span class="co">#&gt;     ng = 2, survival = Surv(age_init, agedem, dem) ~ CEP + male, </span></span>
<span><span class="co">#&gt;     hazard = "Weibull", data = paquidS, verbose = FALSE)</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Statistical Model: </span></span>
<span><span class="co">#&gt;      Dataset: paquidS </span></span>
<span><span class="co">#&gt;      Number of subjects: 499 </span></span>
<span><span class="co">#&gt;      Number of observations: 2213 </span></span>
<span><span class="co">#&gt;      Number of latent classes: 2 </span></span>
<span><span class="co">#&gt;      Number of parameters: 21  </span></span>
<span><span class="co">#&gt;      Event 1: </span></span>
<span><span class="co">#&gt;         Number of events: 128</span></span>
<span><span class="co">#&gt;         Class-specific hazards and </span></span>
<span><span class="co">#&gt;         Weibull baseline risk function </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Iteration process: </span></span>
<span><span class="co">#&gt;      Convergence criteria satisfied </span></span>
<span><span class="co">#&gt;      Number of iterations:  26 </span></span>
<span><span class="co">#&gt;      Convergence criteria: parameters= 2.2e-07 </span></span>
<span><span class="co">#&gt;                          : likelihood= 2.7e-09 </span></span>
<span><span class="co">#&gt;                          : second derivatives= 5.1e-13 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Goodness-of-fit statistics: </span></span>
<span><span class="co">#&gt;      maximum log-likelihood: -9337.19  </span></span>
<span><span class="co">#&gt;      AIC: 18716.37  </span></span>
<span><span class="co">#&gt;      BIC: 18804.84  </span></span>
<span><span class="co">#&gt;      Score test statistic for CI assumption: 66.059 (p-value=0) </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Maximum Likelihood Estimates: </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Fixed effects in the class-membership model:</span></span>
<span><span class="co">#&gt; (the class of reference is the last class) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                        coef      Se     Wald p-value</span></span>
<span><span class="co">#&gt; intercept class1   -0.61509 0.16464   -3.736 0.00019</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameters in the proportional hazard model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                        coef      Se     Wald p-value</span></span>
<span><span class="co">#&gt; event1 +/-sqrt(Weibull1) class 1    0.10969 0.00061  180.580 0.00000</span></span>
<span><span class="co">#&gt; event1 +/-sqrt(Weibull2) class 1    4.69547 0.24017   19.550 0.00000</span></span>
<span><span class="co">#&gt; event1 +/-sqrt(Weibull1) class 2    0.10232 0.00041  251.266 0.00000</span></span>
<span><span class="co">#&gt; event1 +/-sqrt(Weibull2) class 2    5.32355 0.39054   13.631 0.00000</span></span>
<span><span class="co">#&gt; CEP                                -0.80979 0.24500   -3.305 0.00095</span></span>
<span><span class="co">#&gt; male                                0.17328 0.25829    0.671 0.50230</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects in the longitudinal model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                         coef      Se     Wald p-value</span></span>
<span><span class="co">#&gt; intercept class1    59.64993 3.73794   15.958 0.00000</span></span>
<span><span class="co">#&gt; intercept class2    63.87580 2.48880   25.665 0.00000</span></span>
<span><span class="co">#&gt; age65 class1        14.76204 5.31366    2.778 0.00547</span></span>
<span><span class="co">#&gt; age65 class2         5.53815 2.91838    1.898 0.05774</span></span>
<span><span class="co">#&gt; I(age65^2) class1  -14.00994 1.82782   -7.665 0.00000</span></span>
<span><span class="co">#&gt; I(age65^2) class2   -4.23437 0.89428   -4.735 0.00000</span></span>
<span><span class="co">#&gt; CEP                 14.37978 1.29026   11.145 0.00000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variance-covariance matrix of the random-effects:</span></span>
<span><span class="co">#&gt;             intercept     age65 I(age65^2)</span></span>
<span><span class="co">#&gt; intercept   227.63114                     </span></span>
<span><span class="co">#&gt; age65      -228.34057  435.7444           </span></span>
<span><span class="co">#&gt; I(age65^2)   58.48699 -129.3542   41.96664</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                               coef      Se</span></span>
<span><span class="co">#&gt; Residual standard error   10.01950 0.19840</span></span></code></pre></div>
<p>From this first model, we can look at different output functions
available in the package to evaluate the quality of fit of the
model.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># quality of the classification</span></span>
<span><span class="fu"><a href="../reference/postprob.html">postprob</a></span><span class="op">(</span><span class="va">mj2</span><span class="op">)</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Posterior classification based on longitudinal and time-to-event data: </span></span>
<span><span class="co">#&gt;   class1 class2</span></span>
<span><span class="co">#&gt; N 105.00 394.00</span></span>
<span><span class="co">#&gt; %  21.04  78.96</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Posterior classification table: </span></span>
<span><span class="co">#&gt;      --&gt; mean of posterior probabilities in each class </span></span>
<span><span class="co">#&gt;         prob1  prob2</span></span>
<span><span class="co">#&gt; class1 0.9006 0.0994</span></span>
<span><span class="co">#&gt; class2 0.1507 0.8493</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Posterior probabilities above a threshold (%): </span></span>
<span><span class="co">#&gt;          class1 class2</span></span>
<span><span class="co">#&gt; prob&gt;0.7  84.76  71.07</span></span>
<span><span class="co">#&gt; prob&gt;0.8  80.95  63.20</span></span>
<span><span class="co">#&gt; prob&gt;0.9  71.43  53.81</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Posterior classification based only on longitudinal data: </span></span>
<span><span class="co">#&gt;   class1 class2</span></span>
<span><span class="co">#&gt; N 109.00 390.00</span></span>
<span><span class="co">#&gt; %  21.84  78.16</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># residuals</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mj2</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fit of the longitudinal model: marginal predictions</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mj2</span>,which<span class="op">=</span><span class="st">"fit"</span>,var.time<span class="op">=</span><span class="st">"age"</span><span class="op">)</span></span></code></pre></div>
<p><img src="joint_latent_class_model_with_Jointlcmm_files/figure-html/unnamed-chunk-12-1.png" width="480" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fit of the longitudinal model: subject-specific predictions</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mj2</span>,which<span class="op">=</span><span class="st">"fit"</span>,var.time<span class="op">=</span><span class="st">"age"</span>,marg<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="joint_latent_class_model_with_Jointlcmm_files/figure-html/unnamed-chunk-12-2.png" width="480" style="display: block; margin: auto;"></p>
<p>And the predictions of the model:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot of the baseline risk functions and survival functions</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mj2</span>,which<span class="op">=</span><span class="st">"baselinerisk"</span>,var.time<span class="op">=</span><span class="st">"age"</span><span class="op">)</span></span></code></pre></div>
<p><img src="joint_latent_class_model_with_Jointlcmm_files/figure-html/unnamed-chunk-13-1.png" width="480" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mj2</span>,which<span class="op">=</span><span class="st">"survival"</span>,var.time<span class="op">=</span><span class="st">"age"</span><span class="op">)</span></span></code></pre></div>
<p><img src="joint_latent_class_model_with_Jointlcmm_files/figure-html/unnamed-chunk-13-2.png" width="480" style="display: block; margin: auto;"></p>
<p>The model obtained with the first call of jointlcmm is not
necessarily the maximum likelihood estimator for 2 classes. The model
must be refitted with other initial values. There are different
possibilities in the package:</p>
<ul>
<li><p>random departure from the asymptotic distribution of the
estimates under G=1</p></li>
<li><p>initial values chosen by the user</p></li>
<li><p>a grid search with replicates R times the random departures with
a maximu of M iterations of the algorithm each time. The program
finishes the estimation with the departure which gave the best log
likelihood after the M iterations. This is what is recommended with
latent class models to ensure the convergence toward the global
maximum.</p></li>
</ul>
<p>The grid search can take a lot of time as replicating R model
estimation. I recommend to use 100 random departures and if possible
between 30-50 iterations. Here, we will illustrate the procedure with
less replicates and iterations to reduce the processing time.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># model with 2 latent classes and class-specific risk functions.</span></span>
<span><span class="co"># multiple departures using a grid search </span></span>
<span><span class="co"># (here, only a small gridsearch with 15 replicates and 10 iterations </span></span>
<span><span class="co"># we recommend more replicated -50 to 100- and 30 iterations) </span></span>
<span><span class="co"># Be careful, this might take a lot of time !!</span></span>
<span><span class="va">mj2b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gridsearch.html">gridsearch</a></span><span class="op">(</span>rep <span class="op">=</span> <span class="fl">15</span>, maxiter <span class="op">=</span> <span class="fl">10</span>, minit <span class="op">=</span> <span class="va">mj1</span>, <span class="fu"><a href="../reference/Jointlcmm.html">Jointlcmm</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">CEP</span>, mixture <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>        survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>, <span class="va">agedem</span>, <span class="va">dem</span><span class="op">)</span> <span class="op">~</span> <span class="va">CEP</span> <span class="op">+</span> <span class="va">male</span>, hazard <span class="op">=</span> <span class="st">"Weibull"</span>, </span>
<span>        subject <span class="op">=</span> <span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquidS</span>, ng<span class="op">=</span><span class="fl">2</span>,verbose<span class="op">=</span><span class="cn">F</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># An alternative is to directly choose the initial values and explore different </span></span>
<span><span class="co"># plausible departures. </span></span>
<span><span class="co"># The order of the B vector is the same as in the summary.</span></span>
<span><span class="co"># Below, I keep the variance covariance parameters as in G=1. The other parameters are </span></span>
<span><span class="co"># chosen according to values obtained above. </span></span>
<span><span class="va">binit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.10</span>,<span class="fl">5</span>,<span class="fl">0.11</span>,<span class="fl">5.1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">70</span>,<span class="fl">60</span>,<span class="fl">3</span>,<span class="fl">8</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">5</span>,<span class="fl">13</span>,<span class="va">mj1</span><span class="op">$</span><span class="va">best</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">mj2c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Jointlcmm.html">Jointlcmm</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">CEP</span>, mixture <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, </span>
<span>                  random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>, <span class="va">agedem</span>, <span class="va">dem</span><span class="op">)</span></span>
<span>                  <span class="op">~</span> <span class="va">CEP</span> <span class="op">+</span> <span class="va">male</span>, hazard <span class="op">=</span> <span class="st">"Weibull"</span>, subject <span class="op">=</span> <span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquidS</span>,</span>
<span>                  ng<span class="op">=</span><span class="fl">2</span>,B<span class="op">=</span><span class="va">binit</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># We can also start with a random departure:</span></span>
<span><span class="va">mj2d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Jointlcmm.html">Jointlcmm</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">CEP</span>, mixture <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, </span>
<span>                  random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>, <span class="va">agedem</span>, <span class="va">dem</span><span class="op">)</span></span>
<span>                  <span class="op">~</span> <span class="va">CEP</span> <span class="op">+</span> <span class="va">male</span>, hazard <span class="op">=</span> <span class="st">"Weibull"</span>, subject <span class="op">=</span> <span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquidS</span>,</span>
<span>                  ng<span class="op">=</span><span class="fl">2</span>,B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">mj1</span><span class="op">)</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>In this example, we always converge to the same maximum whatever the
departure but the latent classes might be exchanged.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Comparison of the model estimations</span></span>
<span><span class="fu"><a href="../reference/summarytable.html">summarytable</a></span><span class="op">(</span><span class="va">mj2</span>,<span class="va">mj2b</span>,<span class="va">mj2c</span>,<span class="va">mj2d</span><span class="op">)</span></span>
<span><span class="co">#&gt;      G    loglik npm      BIC  %class1  %class2</span></span>
<span><span class="co">#&gt; mj2  2 -9337.187  21 18804.84 21.04208 78.95792</span></span>
<span><span class="co">#&gt; mj2b 2 -9337.187  21 18804.84 78.95792 21.04208</span></span>
<span><span class="co">#&gt; mj2c 2 -9337.187  21 18804.84 78.95792 21.04208</span></span>
<span><span class="co">#&gt; mj2d 2 -9337.187  21 18804.84 78.95792 21.04208</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="model-with-more-than-2-latent-classes">3.2 Model with more than 2 latent classes<a class="anchor" aria-label="anchor" href="#model-with-more-than-2-latent-classes"></a>
</h4>
<p>Estimation of the models with 3 and 4 classes from default values
(based on G=1 model estimates).</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mj3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Jointlcmm.html">Jointlcmm</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">CEP</span>, mixture <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                 random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>, <span class="va">agedem</span>, <span class="va">dem</span><span class="op">)</span> </span>
<span>                 <span class="op">~</span> <span class="va">CEP</span> <span class="op">+</span> <span class="va">male</span>, hazard <span class="op">=</span> <span class="st">"Weibull"</span>, subject <span class="op">=</span> <span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquidS</span>, </span>
<span>                 ng <span class="op">=</span> <span class="fl">3</span>, B <span class="op">=</span> <span class="va">mj1</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Infinite parameters...</span></span>
<span><span class="co">#&gt; Last step values :</span></span>
<span><span class="co">#&gt;       b : -0.02264855 0.05241709 0.1468811 3.443894 0.1038941 3.627087 0.140392 3.791267 -0.2484353 -0.2007211 0.00358595 64.64416 129.2885 3.296868 5.5981 7.900332 -6.886679 -6.096577 -5.304574 13.65079 14.58773 -14.83557 15.37587 3.81936 -5.796415 3.343778 10.07244 </span></span>
<span><span class="co">#&gt;       objective function : -9449.079 </span></span>
<span><span class="co">#&gt;       Convergence criteria: parameters stability= 0 </span></span>
<span><span class="co">#&gt;                           : function stability= 0 </span></span>
<span><span class="co">#&gt;                           : best relative distance to maximum obtained (RDM)= 1</span></span>
<span></span>
<span><span class="va">mj4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Jointlcmm.html">Jointlcmm</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">CEP</span>, mixture <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                 random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>, <span class="va">agedem</span>, <span class="va">dem</span><span class="op">)</span> </span>
<span>                 <span class="op">~</span> <span class="va">CEP</span> <span class="op">+</span> <span class="va">male</span>, hazard <span class="op">=</span> <span class="st">"Weibull"</span>, subject <span class="op">=</span> <span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquidS</span>, </span>
<span>                 ng <span class="op">=</span> <span class="fl">4</span>, B <span class="op">=</span> <span class="va">mj1</span>,verbose<span class="op">=</span><span class="cn">F</span><span class="op">)</span> </span></code></pre></div>
<p>The program did not converge properly after 100 iterations (the
maximum number of iterations specified by default). This is explained by
the fact that the program converged to an non optimal point (local
maximum). Indeed, when looking at the results (loglikelihood and
estimates), the model mj3 converged toward the 1 class model and the
model mj4 converged toward the 2 class model.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summarytable.html">summarytable</a></span><span class="op">(</span><span class="va">mj1</span>,<span class="va">mj2</span>,<span class="va">mj3</span>,<span class="va">mj4</span><span class="op">)</span></span>
<span><span class="co">#&gt;     G        loglik npm          BIC   %class1  %class2  %class3 %class4</span></span>
<span><span class="co">#&gt; mj1 1 -9.449079e+03  15 1.899135e+04 100.00000                          </span></span>
<span><span class="co">#&gt; mj2 2 -9.337187e+03  21 1.880484e+04  21.04208 78.95792                 </span></span>
<span><span class="co">#&gt; mj3 3 -1.000000e+09  27 2.000000e+09   0.00000  0.00000  0.00000        </span></span>
<span><span class="co">#&gt; mj4 4 -9.337187e+03  33 1.887939e+04   0.00000 78.95792 21.04208       0</span></span></code></pre></div>
<p>Such a problem may happen and the user should be careful with this
issue. We can use other initial values to search for the global maximum
in another part of the parameter space:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For 3 classes, we need 6 additional parameters compared to the 2 class model: </span></span>
<span><span class="co"># 1 proba + 2 Weibull + 3 polynomial parameters. </span></span>
<span></span>
<span><span class="va">Binit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mj2</span><span class="op">$</span><span class="va">best</span><span class="op">)</span> <span class="op">+</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">Binit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">18</span>, <span class="fl">19</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Binit</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">mj2</span><span class="op">$</span><span class="va">best</span></span>
<span><span class="va">Binit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">11</span>, <span class="fl">14</span>, <span class="fl">17</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.11</span>, <span class="fl">4</span>, <span class="fl">70</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">mj3b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Jointlcmm.html">Jointlcmm</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">CEP</span>, mixture <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, </span>
<span>                  random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>, <span class="va">agedem</span>, <span class="va">dem</span><span class="op">)</span></span>
<span>                  <span class="op">~</span> <span class="va">CEP</span> <span class="op">+</span> <span class="va">male</span>, hazard <span class="op">=</span> <span class="st">"Weibull"</span>, subject <span class="op">=</span> <span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquidS</span>, </span>
<span>                  ng <span class="op">=</span> <span class="fl">3</span>, B <span class="op">=</span> <span class="va">Binit</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># For the 4 class model, we can start from the three class model:</span></span>
<span><span class="va">Binit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mj3b</span><span class="op">$</span><span class="va">best</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Binit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">7</span>, <span class="fl">10</span><span class="op">:</span><span class="fl">15</span>, <span class="fl">17</span><span class="op">:</span><span class="fl">19</span>, <span class="fl">21</span><span class="op">:</span><span class="fl">23</span>, <span class="fl">25</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Binit</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">mj3b</span><span class="op">$</span><span class="va">best</span></span>
<span><span class="va">Binit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">16</span>, <span class="fl">20</span>, <span class="fl">24</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">10</span>, <span class="fl">60</span>, <span class="fl">5</span>, <span class="op">-</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">mj4b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Jointlcmm.html">Jointlcmm</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">CEP</span>, mixture <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                  random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>, <span class="va">agedem</span>, <span class="va">dem</span><span class="op">)</span> </span>
<span>                  <span class="op">~</span> <span class="va">CEP</span> <span class="op">+</span> <span class="va">male</span>, hazard <span class="op">=</span> <span class="st">"Weibull"</span>, subject <span class="op">=</span> <span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquidS</span>, </span>
<span>                  ng <span class="op">=</span> <span class="fl">4</span>, B <span class="op">=</span> <span class="va">Binit</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># The best way is to use the grid search (although for the class, we consider only </span></span>
<span><span class="co"># 10 replicates and 15 iterations at max so that it is not too long)</span></span>
<span><span class="co"># But it is always better to try more random departures and iterations. </span></span>
<span><span class="co"># 3 class model with gridsearch</span></span>
<span><span class="va">mj3c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gridsearch.html">gridsearch</a></span><span class="op">(</span>rep <span class="op">=</span> <span class="fl">10</span>, maxiter <span class="op">=</span> <span class="fl">15</span>, minit <span class="op">=</span> <span class="va">mj1</span>, <span class="fu"><a href="../reference/Jointlcmm.html">Jointlcmm</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span></span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">CEP</span>, mixture <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span></span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>, <span class="va">agedem</span>, <span class="va">dem</span><span class="op">)</span> <span class="op">~</span> <span class="va">CEP</span> <span class="op">+</span> <span class="va">male</span>,</span>
<span>                   hazard <span class="op">=</span> <span class="st">"Weibull"</span>, subject <span class="op">=</span> <span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquidS</span>, ng <span class="op">=</span><span class="fl">3</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> </span>
<span> </span>
<span><span class="co"># 4 class model with gridsearch</span></span>
<span><span class="va">mj4c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gridsearch.html">gridsearch</a></span><span class="op">(</span>rep <span class="op">=</span> <span class="fl">10</span>, maxiter <span class="op">=</span> <span class="fl">15</span>, minit <span class="op">=</span> <span class="va">mj1</span>, <span class="fu"><a href="../reference/Jointlcmm.html">Jointlcmm</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span></span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">CEP</span>, mixture <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span> <span class="op">+</span></span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>, <span class="va">agedem</span>, <span class="va">dem</span><span class="op">)</span> <span class="op">~</span> <span class="va">CEP</span> <span class="op">+</span> <span class="va">male</span>,</span>
<span>                  hazard <span class="op">=</span> <span class="st">"Weibull"</span>, subject <span class="op">=</span> <span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquidS</span>, ng <span class="op">=</span> <span class="fl">4</span>,verbose<span class="op">=</span><span class="cn">F</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>From the summary, we choose the 4 class model.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># summarytable by default</span></span>
<span><span class="fu"><a href="../reference/summarytable.html">summarytable</a></span><span class="op">(</span><span class="va">mj1</span>,<span class="va">mj2</span>,<span class="va">mj3</span>,<span class="va">mj3b</span>,<span class="va">mj3c</span>,<span class="va">mj4</span>,<span class="va">mj4b</span>,<span class="va">mj4c</span><span class="op">)</span></span>
<span><span class="co">#&gt;      G        loglik npm          BIC   %class1   %class2  %class3  %class4</span></span>
<span><span class="co">#&gt; mj1  1 -9.449079e+03  15 1.899135e+04 100.00000                            </span></span>
<span><span class="co">#&gt; mj2  2 -9.337187e+03  21 1.880484e+04  21.04208 78.957916                  </span></span>
<span><span class="co">#&gt; mj3  3 -1.000000e+09  27 2.000000e+09   0.00000  0.000000  0.00000         </span></span>
<span><span class="co">#&gt; mj3b 3 -9.294952e+03  27 1.875764e+04  68.33667 13.026052 18.63727         </span></span>
<span><span class="co">#&gt; mj3c 3 -9.294952e+03  27 1.875764e+04  18.63727 68.336673 13.02605         </span></span>
<span><span class="co">#&gt; mj4  4 -9.337187e+03  33 1.887939e+04   0.00000 78.957916 21.04208  0.00000</span></span>
<span><span class="co">#&gt; mj4b 4 -9.267481e+03  33 1.873998e+04  69.13828  3.006012 14.02806 13.82766</span></span>
<span><span class="co">#&gt; mj4c 4 -9.279455e+03  33 1.876393e+04  14.22846  9.819639 48.89780 27.05411</span></span>
<span><span class="co"># summary table with other measures for those who converged: </span></span>
<span><span class="fu"><a href="../reference/summarytable.html">summarytable</a></span><span class="op">(</span><span class="va">mj1</span>,<span class="va">mj2</span>,<span class="va">mj3c</span>,<span class="va">mj4b</span>,which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"npm"</span>,<span class="st">"conv"</span>,<span class="st">"loglik"</span>,<span class="st">"BIC"</span>,<span class="st">"SABIC"</span>,<span class="st">"entropy"</span>,<span class="st">"scoretest"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      npm conv    loglik      BIC    SABIC   entropy scoretest</span></span>
<span><span class="co">#&gt; mj1   15    1 -9449.079 18991.35 18943.74 1.0000000         0</span></span>
<span><span class="co">#&gt; mj2   21    1 -9337.187 18804.84 18738.18 0.5905253         0</span></span>
<span><span class="co">#&gt; mj3c  27    1 -9294.952 18757.64 18671.94 0.5419923         0</span></span>
<span><span class="co">#&gt; mj4b  33    1 -9267.481 18739.98 18635.24 0.6052817         0</span></span>
<span><span class="co"># plots</span></span>
<span><span class="fu"><a href="../reference/summaryplot.html">summaryplot</a></span><span class="op">(</span><span class="va">mj1</span>,<span class="va">mj2</span>,<span class="va">mj3c</span>,<span class="va">mj4b</span>,which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BIC"</span>,<span class="st">"entropy"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="joint_latent_class_model_with_Jointlcmm_files/figure-html/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># score test statistics for the independence assumption</span></span>
<span><span class="va">ST</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mj1</span><span class="op">$</span><span class="va">scoretest</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">mj2</span><span class="op">$</span><span class="va">scoretest</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">mj3c</span><span class="op">$</span><span class="va">scoretest</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">mj4b</span><span class="op">$</span><span class="va">scoretest</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> </span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">ST</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"l"</span>,bty<span class="op">=</span><span class="st">'n'</span>,main<span class="op">=</span><span class="st">"Score test"</span>, xlab<span class="op">=</span><span class="st">"number of classes"</span>, ylab<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="joint_latent_class_model_with_Jointlcmm_files/figure-html/unnamed-chunk-20-2.png" width="672" style="display: block; margin: auto;"></p>
<p>The score test statistics rejects the conditional independence at the
5% level but the shape of the curve of ST according to the number of
class (with the asymptot) tells us that we will probably never reach the
significance level.</p>
</div>
</div>
<div class="section level3">
<h3 id="analysis-of-the-results-with-the-4-class-model">4. Analysis of the results with the 4 class model<a class="anchor" aria-label="anchor" href="#analysis-of-the-results-with-the-4-class-model"></a>
</h3>
</div>
<div class="section level3">
<h3 id="summary-of-the-estimation">4.1. Summary of the estimation<a class="anchor" aria-label="anchor" href="#summary-of-the-estimation"></a>
</h3>
<p>The summary gives all the important information</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mj4b</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joint latent class model for quantitative outcome and competing risks </span></span>
<span><span class="co">#&gt;      fitted by maximum likelihood method </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Jointlcmm(fixed = normMMSE ~ age65 + I(age65^2) + CEP, mixture = ~age65 + </span></span>
<span><span class="co">#&gt;     I(age65^2), random = ~age65 + I(age65^2), subject = "ID", </span></span>
<span><span class="co">#&gt;     ng = 4, survival = Surv(age_init, agedem, dem) ~ CEP + male, </span></span>
<span><span class="co">#&gt;     hazard = "Weibull", data = paquidS)</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Statistical Model: </span></span>
<span><span class="co">#&gt;      Dataset: paquidS </span></span>
<span><span class="co">#&gt;      Number of subjects: 499 </span></span>
<span><span class="co">#&gt;      Number of observations: 2213 </span></span>
<span><span class="co">#&gt;      Number of latent classes: 4 </span></span>
<span><span class="co">#&gt;      Number of parameters: 33  </span></span>
<span><span class="co">#&gt;      Event 1: </span></span>
<span><span class="co">#&gt;         Number of events: 128</span></span>
<span><span class="co">#&gt;         Class-specific hazards and </span></span>
<span><span class="co">#&gt;         Weibull baseline risk function </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Iteration process: </span></span>
<span><span class="co">#&gt;      Convergence criteria satisfied </span></span>
<span><span class="co">#&gt;      Number of iterations:  37 </span></span>
<span><span class="co">#&gt;      Convergence criteria: parameters= 5.1e-07 </span></span>
<span><span class="co">#&gt;                          : likelihood= 1.9e-09 </span></span>
<span><span class="co">#&gt;                          : second derivatives= 2e-11 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Goodness-of-fit statistics: </span></span>
<span><span class="co">#&gt;      maximum log-likelihood: -9267.48  </span></span>
<span><span class="co">#&gt;      AIC: 18600.96  </span></span>
<span><span class="co">#&gt;      BIC: 18739.98  </span></span>
<span><span class="co">#&gt;      Score test statistic for CI assumption: 30.667 (p-value=0) </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Maximum Likelihood Estimates: </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Fixed effects in the class-membership model:</span></span>
<span><span class="co">#&gt; (the class of reference is the last class) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                        coef       Se     Wald p-value</span></span>
<span><span class="co">#&gt; intercept class1    0.65212  0.23030    2.832 0.00463</span></span>
<span><span class="co">#&gt; intercept class2   -1.43834  0.35000   -4.110 0.00004</span></span>
<span><span class="co">#&gt; intercept class3   -0.24518  0.24883   -0.985 0.32447</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameters in the proportional hazard model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                        coef       Se     Wald p-value</span></span>
<span><span class="co">#&gt; event1 +/-sqrt(Weibull1) class 1    0.10121  0.00039  259.468 0.00000</span></span>
<span><span class="co">#&gt; event1 +/-sqrt(Weibull2) class 1    7.04817  0.82048    8.590 0.00000</span></span>
<span><span class="co">#&gt; event1 +/-sqrt(Weibull1) class 2    0.11421  0.00080  142.611 0.00000</span></span>
<span><span class="co">#&gt; event1 +/-sqrt(Weibull2) class 2    5.57068  0.73739    7.555 0.00000</span></span>
<span><span class="co">#&gt; event1 +/-sqrt(Weibull1) class 3    0.10955  0.00039  278.060 0.00000</span></span>
<span><span class="co">#&gt; event1 +/-sqrt(Weibull2) class 3    6.39438  0.42368   15.093 0.00000</span></span>
<span><span class="co">#&gt; event1 +/-sqrt(Weibull1) class 4    0.10567  0.00037  284.419 0.00000</span></span>
<span><span class="co">#&gt; event1 +/-sqrt(Weibull2) class 4    6.91442  0.50272   13.754 0.00000</span></span>
<span><span class="co">#&gt; CEP                                -0.66581  0.26347   -2.527 0.01150</span></span>
<span><span class="co">#&gt; male                                0.43642  0.29474    1.481 0.13869</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects in the longitudinal model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                         coef       Se     Wald p-value</span></span>
<span><span class="co">#&gt; intercept class1    65.30224  3.38070   19.316 0.00000</span></span>
<span><span class="co">#&gt; intercept class2    83.22520  9.26192    8.986 0.00000</span></span>
<span><span class="co">#&gt; intercept class3    65.50576  4.93596   13.271 0.00000</span></span>
<span><span class="co">#&gt; intercept class4    57.39464  5.26996   10.891 0.00000</span></span>
<span><span class="co">#&gt; age65 class1         4.62182  3.73925    1.236 0.21645</span></span>
<span><span class="co">#&gt; age65 class2       -64.10601 16.27520   -3.939 0.00008</span></span>
<span><span class="co">#&gt; age65 class3        15.15503  6.72450    2.254 0.02421</span></span>
<span><span class="co">#&gt; age65 class4        19.31410  6.06023    3.187 0.00144</span></span>
<span><span class="co">#&gt; I(age65^2) class1   -3.25830  1.08339   -3.008 0.00263</span></span>
<span><span class="co">#&gt; I(age65^2) class2   16.81961  6.30158    2.669 0.00761</span></span>
<span><span class="co">#&gt; I(age65^2) class3  -16.26249  2.15040   -7.563 0.00000</span></span>
<span><span class="co">#&gt; I(age65^2) class4  -11.44706  1.80170   -6.353 0.00000</span></span>
<span><span class="co">#&gt; CEP                 12.80547  1.20940   10.588 0.00000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variance-covariance matrix of the random-effects:</span></span>
<span><span class="co">#&gt;             intercept     age65 I(age65^2)</span></span>
<span><span class="co">#&gt; intercept   235.93031                     </span></span>
<span><span class="co">#&gt; age65      -251.67607  439.6307           </span></span>
<span><span class="co">#&gt; I(age65^2)   74.24157 -139.0736   45.49113</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                               coef       Se</span></span>
<span><span class="co">#&gt; Residual standard error    9.94241  0.19331</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="evaluation-of-the-classification">4.2. Evaluation of the classification<a class="anchor" aria-label="anchor" href="#evaluation-of-the-classification"></a>
</h3>
<p>A major element of joint latent class models is the posterior
classification, and the discriminatory power of this classification.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># table with the posterior classification</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mj4b</span><span class="op">$</span><span class="va">pprob</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ID class     probYT1      probYT2      probYT3   probYT4</span></span>
<span><span class="co">#&gt; 1  1     1 0.458599701 7.289192e-02 1.526894e-01 0.3158190</span></span>
<span><span class="co">#&gt; 2  2     4 0.002627611 1.713013e-06 4.695802e-01 0.5277904</span></span>
<span><span class="co">#&gt; 3  3     1 0.432859275 7.912249e-02 2.306033e-01 0.2574149</span></span>
<span><span class="co">#&gt; 4  4     4 0.260838221 2.008358e-15 9.800983e-03 0.7293608</span></span>
<span><span class="co">#&gt; 5  5     1 0.608782214 4.225492e-21 2.848206e-05 0.3911893</span></span>
<span><span class="co">#&gt; 6  6     4 0.009333558 2.860090e-14 1.728421e-02 0.9733822</span></span>
<span><span class="co"># output for classification evaluation</span></span>
<span><span class="fu"><a href="../reference/postprob.html">postprob</a></span><span class="op">(</span><span class="va">mj4b</span><span class="op">)</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Posterior classification based on longitudinal and time-to-event data: </span></span>
<span><span class="co">#&gt;   class1 class2 class3 class4</span></span>
<span><span class="co">#&gt; N 345.00  15.00  70.00  69.00</span></span>
<span><span class="co">#&gt; %  69.14   3.01  14.03  13.83</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Posterior classification table: </span></span>
<span><span class="co">#&gt;      --&gt; mean of posterior probabilities in each class </span></span>
<span><span class="co">#&gt;         prob1  prob2  prob3  prob4</span></span>
<span><span class="co">#&gt; class1 0.7188 0.0093 0.0817 0.1902</span></span>
<span><span class="co">#&gt; class2 0.0355 0.8873 0.0518 0.0254</span></span>
<span><span class="co">#&gt; class3 0.0565 0.0319 0.7978 0.1137</span></span>
<span><span class="co">#&gt; class4 0.1155 0.0000 0.0621 0.8224</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Posterior probabilities above a threshold (%): </span></span>
<span><span class="co">#&gt;          class1 class2 class3 class4</span></span>
<span><span class="co">#&gt; prob&gt;0.7  49.28  86.67  67.14  71.01</span></span>
<span><span class="co">#&gt; prob&gt;0.8  40.87  86.67  54.29  65.22</span></span>
<span><span class="co">#&gt; prob&gt;0.9  31.30  73.33  52.86  59.42</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Posterior classification based only on longitudinal data: </span></span>
<span><span class="co">#&gt;   class1 class2 class3 class4</span></span>
<span><span class="co">#&gt; N 344.00  16.00  68.00  71.00</span></span>
<span><span class="co">#&gt; %  68.94   3.21  13.63  14.23</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="graphs-for-the-fit">4.3 Graphs for the fit<a class="anchor" aria-label="anchor" href="#graphs-for-the-fit"></a>
</h3>
<p>We can assess the fit of the model by comparing the predictions to
the observations by time intervals.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># overall</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mj4b</span>, which <span class="op">=</span> <span class="st">"fit"</span>, var.time <span class="op">=</span> <span class="st">"age65"</span>, marg <span class="op">=</span> <span class="cn">F</span>, break.times <span class="op">=</span> <span class="fl">10</span>, bty <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"normMMSE"</span>, xlab <span class="op">=</span> <span class="st">"Age in decades from 65 years"</span>,shades<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="joint_latent_class_model_with_Jointlcmm_files/figure-html/unnamed-chunk-23-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># by covariate profile</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mj4b</span>, which <span class="op">=</span> <span class="st">"fit"</span>, var.time <span class="op">=</span> <span class="st">"age65"</span>, marg <span class="op">=</span> <span class="cn">F</span>, break.times <span class="op">=</span> <span class="fl">10</span>, bty <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"normMMSE"</span>, xlab <span class="op">=</span> <span class="st">"Age in decades from 65 years"</span>,subset <span class="op">=</span> <span class="va">dem</span> <span class="op">==</span> <span class="fl">1</span>,</span>
<span>     main<span class="op">=</span><span class="st">"diagnosed as demented"</span>,shades<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mj4b</span>, which <span class="op">=</span> <span class="st">"fit"</span>, var.time <span class="op">=</span> <span class="st">"age65"</span>, marg <span class="op">=</span> <span class="cn">F</span>, break.times <span class="op">=</span> <span class="fl">10</span>, bty <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"normMMSE"</span>, xlab <span class="op">=</span> <span class="st">"Age in decades from 65 years"</span>,subset <span class="op">=</span> <span class="va">dem</span> <span class="op">==</span> <span class="fl">0</span>,</span>
<span>     main<span class="op">=</span><span class="st">"non diagnosed as demented"</span>,shades<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="joint_latent_class_model_with_Jointlcmm_files/figure-html/unnamed-chunk-24-1.png" width="864" style="display: block; margin: auto;"></p>
<p>The residuals of the longitudinal part:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mj4b</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="graph-of-predicted-trajectories-according-to-a-profile-of-covariates">4.4. Graph of predicted trajectories according to a profile of
covariates<a class="anchor" aria-label="anchor" href="#graph-of-predicted-trajectories-according-to-a-profile-of-covariates"></a>
</h3>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datnew</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age65 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span>, length<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">male</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">CEP</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="co"># computation of the predictions</span></span>
<span><span class="va">mj4b.pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">mj4b</span>, newdata <span class="op">=</span> <span class="va">datnew</span>, var.time <span class="op">=</span> <span class="st">"age65"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mj4b.pred</span>, bty <span class="op">=</span> <span class="st">"l"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">80</span><span class="op">)</span>, legend.loc <span class="op">=</span> <span class="st">"bottomleft"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"normMMSE"</span>, xlab <span class="op">=</span> <span class="st">"age in decades from 65 years"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="joint_latent_class_model_with_Jointlcmm_files/figure-html/unnamed-chunk-26-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="graph-of-predicted-cumulative-incidence-according-to-a-profile-of-covariates">4.5. Graph of predicted cumulative incidence according to a profile
of covariates<a class="anchor" aria-label="anchor" href="#graph-of-predicted-cumulative-incidence-according-to-a-profile-of-covariates"></a>
</h3>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># graph of predicted survival trajectory for the reference group</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mj4b</span>, which <span class="op">=</span> <span class="st">"survival"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, legend.loc <span class="op">=</span> <span class="cn">F</span>, bty <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"age in years"</span>, ylab <span class="op">=</span> <span class="st">"dementia-free probability"</span><span class="op">)</span></span></code></pre></div>
<p><img src="joint_latent_class_model_with_Jointlcmm_files/figure-html/unnamed-chunk-27-1.png" width="480" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># computation of the cumulative incidence for a specific profile of covariates</span></span>
<span><span class="va">cuminc0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cuminc.html">cuminc</a></span><span class="op">(</span><span class="va">mj4b</span>,time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">65</span>,<span class="fl">95</span>,by<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cuminc1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cuminc.html">cuminc</a></span><span class="op">(</span><span class="va">mj4b</span>,time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">65</span>,<span class="fl">95</span>,by<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,CEP<span class="op">=</span><span class="fl">1</span>,male<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># plot of cumulative incidences</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">cuminc0</span>,title<span class="op">=</span><span class="st">"CEP=0 and male=0"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">cuminc1</span>,lty<span class="op">=</span><span class="fl">2</span>,title<span class="op">=</span><span class="st">"CEP=1 and male=1"</span><span class="op">)</span></span></code></pre></div>
<p><img src="joint_latent_class_model_with_Jointlcmm_files/figure-html/unnamed-chunk-28-1.png" width="864" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="c--to-go-further">C. To go further …<a class="anchor" aria-label="anchor" href="#c--to-go-further"></a>
</h2>
<div class="section level3">
<h3 id="individual-dynamic-prediction">1. Individual dynamic prediction<a class="anchor" aria-label="anchor" href="#individual-dynamic-prediction"></a>
</h3>
<p>The joint latent class model can be used to provide individual
dynamic prediction of the event from the observed repeated measures of
the marker. This is usually done for a “new” subject (not in the
estimation data) but for the class, we focus on subject 72:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paq72</span> <span class="op">&lt;-</span> <span class="va">paquidS</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">paquidS</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="fl">72</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="co"># prediction computation</span></span>
<span><span class="va">dynp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dynpred.html">dynpred</a></span><span class="op">(</span><span class="va">mj4b</span>, <span class="va">paq72</span>, landmark <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">90</span><span class="op">)</span>, var.time <span class="op">=</span> <span class="st">"age65"</span>, </span>
<span>                horizon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">9</span><span class="op">)</span>, fun.time <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span> <span class="fl">10</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">65</span> <span class="op">}</span>, </span>
<span>                draws <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;       ID landmark horizon    pred_50   pred_2.5  pred_97.5</span></span>
<span><span class="co">#&gt;  [1,] 72       80       1 0.01792567 0.01025557 0.02845754</span></span>
<span><span class="co">#&gt;  [2,] 72       80       3 0.07781886 0.04932919 0.11742875</span></span>
<span><span class="co">#&gt;  [3,] 72       80       5 0.17582383 0.12074292 0.24851275</span></span>
<span><span class="co">#&gt;  [4,] 72       80       8 0.30572794 0.22399247 0.40675696</span></span>
<span><span class="co">#&gt;  [5,] 72       80       9 0.34106835 0.25532066 0.43885727</span></span>
<span><span class="co">#&gt;  [6,] 72       90       1 0.08007715 0.03678548 0.15947501</span></span>
<span><span class="co">#&gt;  [7,] 72       90       3 0.22151193 0.10915870 0.42406186</span></span>
<span><span class="co">#&gt;  [8,] 72       90       5 0.31316574 0.18850276 0.53375716</span></span>
<span><span class="co">#&gt;  [9,] 72       90       8 0.58655983 0.39958818 0.81559952</span></span>
<span><span class="co">#&gt; [10,] 72       90       9 0.72133824 0.50421389 0.94933195</span></span>
<span><span class="co"># graph of predictions</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">dynp</span>, landmark <span class="op">=</span> <span class="fl">80</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">55</span>, <span class="fl">85</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">20</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"normMMSE"</span>, main <span class="op">=</span> <span class="st">"At landmark age 80"</span>, xlab <span class="op">=</span> <span class="st">"age in years"</span><span class="op">)</span></span></code></pre></div>
<p><img src="joint_latent_class_model_with_Jointlcmm_files/figure-html/unnamed-chunk-29-1.png" width="480" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">dynp</span>, landmark <span class="op">=</span> <span class="fl">90</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">55</span>, <span class="fl">85</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">20</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"normMMSE"</span>, main <span class="op">=</span> <span class="st">"At landmark age 90"</span>, xlab <span class="op">=</span> <span class="st">"age in years"</span><span class="op">)</span></span></code></pre></div>
<p><img src="joint_latent_class_model_with_Jointlcmm_files/figure-html/unnamed-chunk-29-2.png" width="480" style="display: block; margin: auto;"></p>
<p>When the objective is to provide dynamic predictions, the predictive
power of the model should be specifically checked using appropriate
techniques. The package has an internal measure, the EPOCE which
quantifies the pronostic information. For measures such as the AUC or
Brier Score, other packages can be used from the dynamic predictions
obtained with Jointlcmm, for instance timeROC (Blanche et al.,
Biometrics 2015).</p>
<p>Here is an example of the use of EPOCE:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># definition of the prediction times</span></span>
<span><span class="va">landmark</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">70</span>, <span class="fl">72</span>, <span class="fl">75</span>, <span class="fl">77</span>, <span class="fl">80</span>, <span class="fl">82</span>, <span class="fl">85</span>, <span class="fl">87</span>, <span class="fl">90</span><span class="op">)</span></span>
<span><span class="co"># calculation of the measure for each model. Be careful with the function which links </span></span>
<span><span class="co"># the time in the longitudinal model and the time in the survival model (fun.time)</span></span>
<span><span class="va">epoce1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epoce.html">epoce</a></span><span class="op">(</span><span class="va">mj1</span>, pred.times <span class="op">=</span> <span class="va">landmark</span>, var.time <span class="op">=</span> <span class="st">"age65"</span>,fun.time <span class="op">=</span> </span>
<span>                  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span> <span class="fl">10</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">65</span> <span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; Be patient, epoce function is running ... </span></span>
<span><span class="co">#&gt; The program took 0.32 seconds</span></span>
<span><span class="va">epoce2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epoce.html">epoce</a></span><span class="op">(</span><span class="va">mj2</span>, pred.times <span class="op">=</span> <span class="va">landmark</span>, var.time <span class="op">=</span> <span class="st">"age65"</span>,fun.time <span class="op">=</span> </span>
<span>                  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span> <span class="fl">10</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">65</span> <span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; Be patient, epoce function is running ... </span></span>
<span><span class="co">#&gt; The program took 0.58 seconds</span></span>
<span><span class="va">epoce3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epoce.html">epoce</a></span><span class="op">(</span><span class="va">mj3b</span>, pred.times <span class="op">=</span> <span class="va">landmark</span>, var.time <span class="op">=</span> <span class="st">"age65"</span>,fun.time <span class="op">=</span> </span>
<span>                  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span> <span class="fl">10</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">65</span> <span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; Be patient, epoce function is running ... </span></span>
<span><span class="co">#&gt; The program took 0.84 seconds</span></span>
<span><span class="va">epoce4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epoce.html">epoce</a></span><span class="op">(</span><span class="va">mj4b</span>, pred.times <span class="op">=</span> <span class="va">landmark</span>, var.time <span class="op">=</span> <span class="st">"age65"</span>,fun.time <span class="op">=</span> </span>
<span>                  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span> <span class="fl">10</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">65</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; Be patient, epoce function is running ... </span></span>
<span><span class="co">#&gt; The program took 1.12 seconds</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># computation of the differences in EPOCE</span></span>
<span><span class="va">diff23</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Diffepoce.html">Diffepoce</a></span><span class="op">(</span><span class="va">epoce2</span>, <span class="va">epoce3</span><span class="op">)</span></span>
<span><span class="va">diff34</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Diffepoce.html">Diffepoce</a></span><span class="op">(</span><span class="va">epoce3</span>, <span class="va">epoce4</span><span class="op">)</span></span>
<span><span class="co"># and the graphs for the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">epoce1</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.5</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"cross-validated EPOCE estimates"</span>,bty <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">epoce2</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">epoce3</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="fl">3</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">epoce4</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="fl">4</span>, lty <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G=1"</span>, <span class="st">"G=2"</span>, <span class="st">"G=3"</span>, <span class="st">"G=4"</span><span class="op">)</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,lty <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, </span>
<span>       bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">diff23</span>, main <span class="op">=</span> <span class="st">"Difference in EPOCE estimates"</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,pch <span class="op">=</span> <span class="fl">20</span>, </span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.05</span>, <span class="fl">0.30</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">diff34</span>, add <span class="op">=</span> <span class="cn">T</span>, main <span class="op">=</span> <span class="st">"Difference in EPOCE estimates"</span>, col <span class="op">=</span> <span class="fl">4</span>,</span>
<span>     lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">18</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G=2/G=3"</span>, <span class="st">"G=3/G=4"</span>, <span class="st">"95%TI"</span>, <span class="st">"95%TI"</span><span class="op">)</span>,</span>
<span>       ncol <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">18</span>, <span class="fl">20</span>, <span class="fl">18</span><span class="op">)</span>, </span>
<span>       bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<p><img src="joint_latent_class_model_with_Jointlcmm_files/figure-html/unnamed-chunk-31-1.png" width="768" style="display: block; margin: auto;"></p>
<p>Here the model with 3 latent classes seems to have a better
predictive power than the 4 class model.</p>
</div>
<div class="section level3">
<h3 id="competing-risks">2. Competing risks<a class="anchor" aria-label="anchor" href="#competing-risks"></a>
</h3>
<p>Jointlcmm function can account for competing risks with the same
structure of call. The only difference is in the definition of the time
to event which is the minimum time between all the causes of event and
the censoring. The indicator of event also indicates 0 for censoring or
k for cause k. Suppose we have further information in the paquidS
sample, namely a variable Age_CR that includes the first event between
dementia and death, and Indic_CR that indicates the cause of event,
dementia or death before dementia. In the following we give some
examples of joint latent class models with competing risks.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># model with G=1 with Weibull for both events</span></span>
<span><span class="va">mj1_CR</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Jointlcmm.html">Jointlcmm</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">CEP</span>, random <span class="op">=</span><span class="op">~</span>  <span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, </span>
<span>                         survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>, <span class="va">Age_CR</span>, <span class="va">Indic_CR</span><span class="op">)</span> <span class="op">~</span> <span class="va">CEP</span> <span class="op">+</span> <span class="va">male</span>, </span>
<span>                         hazard <span class="op">=</span> <span class="st">"Weibull"</span>, subject <span class="op">=</span> <span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquidS_CR</span>, ng <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>In the regression, we can consider specific effects with cause()
:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># model with G=1 and cause-specific effects of CEP and male</span></span>
<span><span class="va">mj1_CR_CS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Jointlcmm.html">Jointlcmm</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">CEP</span>, random <span class="op">=</span><span class="op">~</span> <span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, </span>
<span>                 survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>, <span class="va">Age_CR</span>, <span class="va">Indic_CR</span><span class="op">)</span>  <span class="op">~</span> <span class="fu">cause</span><span class="op">(</span><span class="va">CEP</span><span class="op">)</span> </span>
<span>                <span class="op">+</span> <span class="fu">cause</span><span class="op">(</span><span class="va">male</span><span class="op">)</span>, hazard <span class="op">=</span> <span class="st">"Weibull"</span>, subject <span class="op">=</span> <span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquidS_CR</span>, </span>
<span>                ng <span class="op">=</span> <span class="fl">1</span>,verbose<span class="op">=</span><span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p>Note that different baseline risk functions can be considered for the
two events:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mj1_CR_WS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Jointlcmm.html">Jointlcmm</a></span><span class="op">(</span><span class="va">normMMSE</span> <span class="op">~</span> <span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">CEP</span>, random <span class="op">=</span><span class="op">~</span>  <span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, </span>
<span>                         survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>, <span class="va">Age_CR</span>, <span class="va">Indic_CR</span><span class="op">)</span> <span class="op">~</span> <span class="va">CEP</span> <span class="op">+</span> <span class="va">male</span>, </span>
<span>                         hazard <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Weibull"</span>,<span class="st">"splines"</span><span class="op">)</span>, subject <span class="op">=</span> <span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquidS_CR</span>, ng <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mj1_CR_WS</span><span class="op">)</span></span></code></pre></div>
<p>We can now use the same technique of estimation with G&gt;1 for this
model with competing risks …</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cecile Proust-Lima, Viviane Philipps.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
