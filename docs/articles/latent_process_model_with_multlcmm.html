<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="lcmm">
<title>How to estimate a latent process mixed model for multivariate markers using multlcmm function • lcmm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to estimate a latent process mixed model for multivariate markers using multlcmm function">
<meta property="og:description" content="lcmm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">lcmm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/lcmm.html">GET STARTED</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">VIGNETTES</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/latent_class_model_with_hlme.html">How to estimate a latent class mixed model using hlme function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_lcmm.html">How to estimate a latent process mixed model using lcmm function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm.html">How to estimate a latent process mixed model for multivariate markers using multlcmm function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm_IRT.html">Continuous-time longitudinal IRT model</a>
    <a class="dropdown-item" href="../articles/joint_latent_class_model_with_Jointlcmm.html">How to estimate a joint latent class mixed model using Jointlcmm function</a>
    <a class="dropdown-item" href="../articles/multivariate_latent_class_model_with_mpjlcmm.html">How to estimate a multivariate latent class mixed model using mpjlcmm function</a>
    <a class="dropdown-item" href="../articles/pre_normalizing.html">Pre-normalizing a dependent variable using lcmm</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/usual_problems.html">FAQ</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">REFERENCE</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">CHANGELOG</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/CecileProust-Lima/lcmm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">

<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>How to estimate a latent process mixed model for multivariate markers using multlcmm function</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CecileProust-Lima/lcmm/blob/HEAD/vignettes/latent_process_model_with_multlcmm.Rmd" class="external-link"><code>vignettes/latent_process_model_with_multlcmm.Rmd</code></a></small>
      <div class="d-none name"><code>latent_process_model_with_multlcmm.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background-and-definitions">Background and definitions<a class="anchor" aria-label="anchor" href="#background-and-definitions"></a>
</h2>
<p align="justify">
</p>
<p>Each dynamic phenomenon can be characterized by a latent process <span class="math inline">\((\Lambda(t))\)</span> which evolves in continuous time <span class="math inline">\(t\)</span>. Sometimes, this latent process is measured through several markers so that the latent process is their common factor.</p>
<p>Function multlcmm treats this idea and extend the linear mixed model theory to several markers measuring the same underlying quantity, these markers not being necessarily Gaussian.</p>
<div class="section level3">
<h3 id="the-latent-process-mixed-model-for-multivariate-markers">The latent process mixed model for multivariate markers<a class="anchor" aria-label="anchor" href="#the-latent-process-mixed-model-for-multivariate-markers"></a>
</h3>
<p align="justify">
</p>
<p>The latent process mixed model is introduced in Proust-Lima et al. (2006 - <a href="https://doi.org/10.1111/j.1541-0420.2006.00573.x" class="external-link uri">https://doi.org/10.1111/j.1541-0420.2006.00573.x</a>, 2013 - <a href="https://doi.org/10.1111/bmsp.12000" class="external-link uri">https://doi.org/10.1111/bmsp.12000</a> and 2022 - <a href="https://doi.org/10.1016/j.ymeth.2022.01.005" class="external-link uri">https://doi.org/10.1016/j.ymeth.2022.01.005</a> ).</p>
<p>The quantity of interest defined as a latent process is modeled according to time using a linear mixed model:</p>
<p><span class="math display">\[\Lambda(t) = X(t) \beta + Z(t)u_i +w_i(t)\]</span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(X(t)\)</span> and <span class="math inline">\(Z(t)\)</span> are vectors of covariates (<span class="math inline">\(Z(t)\)</span> is included in <span class="math inline">\(X(t)\)</span>);</li>
<li>
<span class="math inline">\(\beta\)</span> are the fixed effects (i.e., population mean effects);</li>
<li>
<span class="math inline">\(u_i\)</span> are the random effects (i.e., individual effects); they are distributed according to a zero-mean multivariate normal distribution with covariance matrix <span class="math inline">\(B\)</span>;</li>
<li>
<span class="math inline">\((w_i(t))\)</span> is a Gaussian process that might be added in the model to relax the intra-subject correlation structure.</li>
</ul>
<p>This structural model for <span class="math inline">\(\Lambda(t)\)</span> according to time and covariates is exactly the same as in the <a href="latent_process_model_with_lcmm.html">univariate case</a>.</p>
Now, instead of defining one equation of observation, we define K equations of observation for the K different markers with <span class="math inline">\(Y_{ijk}\)</span> the observation for subject <span class="math inline">\(i\)</span>, marker <span class="math inline">\(k\)</span> and occasion <span class="math inline">\(j\)</span>. As in the univariate case, several types of markers can be handled by defining a marker-specific link function <span class="math inline">\(H_{k}\)</span>. The marker-specific equation of observation also includes potentially some contrasts <span class="math inline">\(\gamma_k\)</span> on covariates and a marker and subject specific random intercept so that:

<p><span class="math display">\[Y_{ijk} = H_{k}(~  \Lambda(t_{ijk})+ X_{cijk}\gamma_{k} + \alpha_{ik} + \epsilon_{ijk} ~ ; \eta_{k}) \]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\alpha_{ik} \tilde{} N(0,\sigma_k^2)\)</span></li>
<li>
<span class="math inline">\(X_{cijk}\)</span> vector of covariates</li>
<li>
<span class="math inline">\(\gamma_k\)</span> are contrasts (with the sum over <span class="math inline">\(k\)</span> equal to 0)</li>
<li>
<span class="math inline">\(t_{ijk}\)</span> the time of measurement for subject <span class="math inline">\(i\)</span>, marker <span class="math inline">\(k\)</span> and occasion <span class="math inline">\(j\)</span>;</li>
<li>
<span class="math inline">\(\epsilon_{ijk}\)</span> an independent Gaussian error with mean zero and variance <span class="math inline">\(\sigma_{\epsilon_k}^2\)</span>;</li>
<li>
<span class="math inline">\(H_k\)</span> the link function (parameterized by <span class="math inline">\(\eta_k\)</span>) that transforms the latent process into the scale and metric of marker <span class="math inline">\(k\)</span>.</li>
</ul>
<p>The link functions are the same as in the univariate case (in lcmm). For continuous outcomes, <span class="math inline">\(H^{-1}\)</span> is a parametric family of increasing monotonic functions among:</p>
<ul>
<li>the linear transformation: this reduces to the linear mixed model (2 parameters)</li>
<li>the Beta cumulative distribution family rescaled (4 parameters)</li>
<li>the basis of quadratic I-splines with m knots (m+2 parameters)</li>
</ul>
<p>For binary and ordinal outcomes, <span class="math inline">\(H_k\)</span> links each level of the variable with an interval of values for the latent process plus measurement errors. This corresponds to the (cumulative) probit model.</p>
<p>We describe below a case with continuous link functions. For ordinal markers, see <a href="latent_process_model_with_multlcmm_IRT.html">vignette</a>.</p>
</div>
<div class="section level3">
<h3 id="identifiability">Identifiability<a class="anchor" aria-label="anchor" href="#identifiability"></a>
</h3>
<p>As in any latent variable model, the metric of the latent variable has to be defined. In contrast with lcmm function, here the variance of the first random effect <span class="math inline">\(u_i\)</span> is set to 1 and the mean intercept (in <span class="math inline">\(\beta\)</span>) is set to 0.</p>
<p> </p>
</div>
</div>
<div class="section level2">
<h2 id="example-with-cognitive-process">Example with cognitive process<a class="anchor" aria-label="anchor" href="#example-with-cognitive-process"></a>
</h2>
<p align="justify">
In this example, we study cognitive trajectory over time when cognition is defined as the common factor underlying three psychometric tests: <strong>MMSE</strong>, <strong>BVRT</strong> and <strong>IST</strong>. Here the timescale is years since entry into the cohort, the trajectory is assumed quadratic in time (both at individual and population level) and the model is adjusted for <span class="math inline">\(age\)</span> at entry. To further investigate the effect of gender, both mean effects on the common factor and differential effects (contrasts) on each marker are included (not in interaction with time in this example).
</p>
<div class="section level3">
<h3 id="model-considered">Model considered :<a class="anchor" aria-label="anchor" href="#model-considered"></a>
</h3>
<p align="justify">
</p>
<p> </p>
<p><span class="math display">\[Y_{ijk} = H_k(~ \beta_{1}t_{ij} + \beta_{2}t_{ij}^2 +\beta_{3}age75_{i} + \beta_{4}male_{i} +\gamma_{k}male_{i} \\ +u_{0i}+u_{1i}t_{ij}+u_{2i}t_{ij}^2+ \alpha_{ik} + \omega_i(t_{ijk}) +\epsilon_{ijk} ~~, \eta_k)\]</span></p>
<p> </p>
<p><em>Where : </em></p>
<p><span class="math inline">\(u_{i}\tilde{}N(0,B)\)</span> and V(<span class="math inline">\(u_{0i}\)</span>)=1, <span class="math inline">\(\omega_i(t)\)</span> is a Brownian process, <span class="math inline">\(\alpha_{ik}\tilde{}N(0,\sigma_k^2)\)</span> and for k = 1,2,3: <span class="math inline">\(Y_{ij1}= MMSE_{ij}\)</span> , <span class="math inline">\(Y_{ij2}= IST_{ij}\)</span> and <span class="math inline">\(Y_{ij3}= BVRT_{ij})\)</span></p>
<p> </p>
</div>
<div class="section level3">
<h3 id="estimation-with-different-link-functions">Estimation with different link functions<a class="anchor" aria-label="anchor" href="#estimation-with-different-link-functions"></a>
</h3>
<p>We first create the variable time and recenter and scale age to avoid numerical problems</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paquid</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">age</span> <span class="op">-</span> <span class="va">paquid</span><span class="op">$</span><span class="va">age_init</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span></span>
<span><span class="va">paquid</span><span class="op">$</span><span class="va">age75</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">age_init</span> <span class="op">-</span> <span class="fl">75</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span></span></code></pre></div>
<div class="section level4">
<h4 id="linear-link-functions">linear link functions<a class="anchor" aria-label="anchor" href="#linear-link-functions"></a>
</h4>
<p>By default, all the link functions are set to linear:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mult_lin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multlcmm.html">multlcmm</a></span><span class="op">(</span><span class="va">MMSE</span> <span class="op">+</span> <span class="va">IST</span> <span class="op">+</span> <span class="va">BVRT</span> <span class="op">~</span> <span class="va">age75</span> <span class="op">+</span> <span class="va">male</span> <span class="op">+</span> <span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span> <span class="fu">contrast</span><span class="op">(</span><span class="va">male</span><span class="op">)</span>, random <span class="op">=</span><span class="op">~</span> <span class="va">time</span> <span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="fl">10</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquid</span>, randomY <span class="op">=</span> <span class="cn">TRUE</span>, cor <span class="op">=</span> <span class="fu">BM</span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p> </p>
</div>
<div class="section level4">
<h4 id="nonlinear-link-functions">nonlinear link functions<a class="anchor" aria-label="anchor" href="#nonlinear-link-functions"></a>
</h4>
<p>Depending on the nature of the data, some nonlinear link functions may be necessary. Here for instance, the MMSE is highly skewed:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">MMSE</span>, breaks<span class="op">=</span><span class="fl">31</span>,main<span class="op">=</span><span class="st">"MMSE distribution"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">IST</span>, breaks<span class="op">=</span><span class="fl">41</span>,main<span class="op">=</span><span class="st">"IST distribution"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">BVRT</span>, breaks<span class="op">=</span><span class="fl">16</span>, main<span class="op">=</span><span class="st">"BVRT distribution"</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_process_model_with_multlcmm_files/figure-html/hist-1.png" width="768" style="display: block; margin: auto;"></p>
<p>As in the univariate case, Beta CDF or splines can be considered. The link function family can either be the same for all the markers (even if the parameters will be different):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example with Beta</span></span>
<span><span class="va">mult_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multlcmm.html">multlcmm</a></span><span class="op">(</span><span class="va">MMSE</span> <span class="op">+</span> <span class="va">IST</span> <span class="op">+</span> <span class="va">BVRT</span> <span class="op">~</span> <span class="va">age75</span> <span class="op">+</span> <span class="va">male</span> <span class="op">+</span> <span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span> <span class="fu">contrast</span><span class="op">(</span><span class="va">male</span><span class="op">)</span>, random <span class="op">=</span><span class="op">~</span> <span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquid</span>, randomY <span class="op">=</span> <span class="cn">TRUE</span>, cor <span class="op">=</span> <span class="fu">BM</span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, link <span class="op">=</span> <span class="st">'beta'</span><span class="op">)</span></span></code></pre></div>
<p>Or the link functions can be chosen differently. For instance,</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># different number of knots in splines</span></span>
<span><span class="va">mult_betaspl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multlcmm.html">multlcmm</a></span><span class="op">(</span><span class="va">MMSE</span> <span class="op">+</span> <span class="va">IST</span> <span class="op">+</span> <span class="va">BVRT</span> <span class="op">~</span> <span class="va">age75</span> <span class="op">+</span> <span class="va">male</span> <span class="op">+</span> <span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span> <span class="fu">contrast</span><span class="op">(</span><span class="va">male</span><span class="op">)</span>, random <span class="op">=</span><span class="op">~</span><span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquid</span>, randomY <span class="op">=</span> <span class="cn">TRUE</span>, cor <span class="op">=</span> <span class="fu">BM</span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'beta'</span>,<span class="st">'3-quant-splines'</span>,<span class="st">'3-quant-splines'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="fixing-some-transformation-parameters">Fixing some transformation parameters<a class="anchor" aria-label="anchor" href="#fixing-some-transformation-parameters"></a>
</h4>
<p>Note that the splines transformation may sometimes involve parameters so close to 0 that it entails a lack of convergence (since the parameter is at the boundary of the parameter space). This often happens with MMSE. For instance, in the example below, convergence cannot be reached easily because the third parameter of MMSE transformation is lower than <span class="math inline">\(10^{-4}\)</span>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># with splines</span></span>
<span><span class="va">mult_splines</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multlcmm.html">multlcmm</a></span><span class="op">(</span><span class="va">MMSE</span> <span class="op">+</span> <span class="va">IST</span> <span class="op">+</span> <span class="va">BVRT</span> <span class="op">~</span> <span class="va">age75</span> <span class="op">+</span> <span class="va">male</span> <span class="op">+</span> <span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span> <span class="fu">contrast</span><span class="op">(</span><span class="va">male</span><span class="op">)</span>, random <span class="op">=</span><span class="op">~</span><span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquid</span>, randomY <span class="op">=</span> <span class="cn">TRUE</span>, cor <span class="op">=</span> <span class="fu">BM</span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, maxiter<span class="op">=</span><span class="fl">50</span>, link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'3-quant-splines'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This problem can be easily dealt with by fixing this parameter with posfix option. To do so, the position of the parameter can be identified from the vector of estimates (21st parameter here):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mult_splines</span><span class="op">$</span><span class="va">best</span></span>
<span><span class="co">#&gt;         age75          male          time  I(time^2/10)    contrast11 </span></span>
<span><span class="co">#&gt; -1.010112e+00  1.517389e-01 -1.118084e+00 -2.478814e+00 -5.978284e-02 </span></span>
<span><span class="co">#&gt;    contrast12      varcov 1      varcov 2      varcov 3      varcov 4 </span></span>
<span><span class="co">#&gt; -2.512760e-01 -1.106827e-01  1.646540e+00  3.635506e-02 -5.852103e+00 </span></span>
<span><span class="co">#&gt;      varcov 5          cor1     std.err 1     std.err 2     std.err 3 </span></span>
<span><span class="co">#&gt;  3.512056e+01  9.040474e-01  9.131173e-01  8.691138e-01  1.312155e+00 </span></span>
<span><span class="co">#&gt;  std.randomY1  std.randomY2  std.randomY3    I-splines1    I-splines2 </span></span>
<span><span class="co">#&gt;  5.219795e-01  8.013844e-01  8.154404e-01 -6.345444e+00  9.980752e-01 </span></span>
<span><span class="co">#&gt;    I-splines3    I-splines4    I-splines5    I-splines1    I-splines2 </span></span>
<span><span class="co">#&gt; -3.231409e-05  2.443017e+00  1.370905e+00 -6.074106e+00  1.070865e+00 </span></span>
<span><span class="co">#&gt;    I-splines3    I-splines4    I-splines5    I-splines1    I-splines2 </span></span>
<span><span class="co">#&gt; -2.083883e+00  1.500616e+00 -1.398814e+00 -6.608395e+00  9.986261e-01 </span></span>
<span><span class="co">#&gt;    I-splines3    I-splines4    I-splines5 </span></span>
<span><span class="co">#&gt;  1.923664e+00  1.991036e+00  1.529003e+00</span></span></code></pre></div>
<p>And the model can be refitted from these estimates and the newly fixed parameter:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># with splines</span></span>
<span><span class="va">mult_splines2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multlcmm.html">multlcmm</a></span><span class="op">(</span><span class="va">MMSE</span> <span class="op">+</span> <span class="va">IST</span> <span class="op">+</span> <span class="va">BVRT</span> <span class="op">~</span> <span class="va">age75</span> <span class="op">+</span> <span class="va">male</span> <span class="op">+</span> <span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span> <span class="fu">contrast</span><span class="op">(</span><span class="va">male</span><span class="op">)</span>, random <span class="op">=</span><span class="op">~</span><span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquid</span>, randomY <span class="op">=</span> <span class="cn">TRUE</span>, cor <span class="op">=</span> <span class="fu">BM</span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, maxiter<span class="op">=</span><span class="fl">50</span>, link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'3-quant-splines'</span><span class="op">)</span>, posfix<span class="op">=</span><span class="fl">21</span>, B<span class="op">=</span><span class="va">mult_splines</span><span class="op">$</span><span class="va">best</span><span class="op">)</span></span></code></pre></div>
<p>With this constraint, the model converges correctly.</p>
<p> </p>
</div>
</div>
<div class="section level3">
<h3 id="comparison-of-the-models">Comparison of the models<a class="anchor" aria-label="anchor" href="#comparison-of-the-models"></a>
</h3>
<p align="justify">
</p>
<p>Objects <code>mult_lin</code>, <code>mult_beta</code>, <code>mult_betaspl</code>, ‘mult_splines2’ are multivariate latent process mixed models that assume the exact same trajectory for the underlying latent process but different link functions. As in the univariate case, the models can be compared using information criteria. The <code>summarytable</code> give us such information.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">summarytable</span>(mult_lin,mult_beta,mult_betaspl,mult_splines2, <span class="dt">which =</span><span class="kw">c</span>(<span class="st">"loglik"</span>, <span class="st">"conv"</span>, <span class="st">"npm"</span>, <span class="st">"AIC"</span>))</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">                 loglik conv npm      AIC</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">mult_lin      <span class="fl">-15379.35</span>    <span class="dv">1</span>  <span class="dv">24</span> <span class="fl">30806.70</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">mult_beta     <span class="fl">-14374.60</span>    <span class="dv">1</span>  <span class="dv">30</span> <span class="fl">28809.21</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5">mult_betaspl  <span class="fl">-14373.66</span>    <span class="dv">1</span>  <span class="dv">32</span> <span class="fl">28811.33</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6">mult_splines2 <span class="fl">-14408.50</span>    <span class="dv">1</span>  <span class="dv">32</span> <span class="fl">28881.00</span></a></code></pre></div>
<p> </p>
<p>Models involving Beta transformations and splines transformations seem to fit a lot better in terms of AIC than the linear transformations showing the departure from normality.</p>
<p> </p>
<p>The transformations can be plotted and compared between models:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mult_splines2</span>, which <span class="op">=</span> <span class="st">"linkfunction"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, lwd <span class="op">=</span><span class="fl">1</span>,lty<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mult_lin</span>,which<span class="op">=</span><span class="st">"linkfunction"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">1</span>,lty<span class="op">=</span><span class="fl">2</span>,add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mult_beta</span>,which<span class="op">=</span><span class="st">"linkfunction"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>,lty<span class="op">=</span><span class="fl">3</span>,add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mult_betaspl</span>,which<span class="op">=</span><span class="st">"linkfunction"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">1</span>,lty<span class="op">=</span><span class="fl">1</span>,add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"bottomright"</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linear"</span>,<span class="st">"beta"</span>,<span class="st">"splines"</span>,<span class="st">"beta/splines"</span><span class="op">)</span>,bty<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_process_model_with_multlcmm_files/figure-html/testprint2-1.png" width="672" style="display: block; margin: auto;">  </p>
<p>Except from the linear transformations, all the estimation transformations are really close.</p>
<p> </p>
</div>
<div class="section level3">
<h3 id="postfit-outputs">Postfit outputs<a class="anchor" aria-label="anchor" href="#postfit-outputs"></a>
</h3>
<div class="section level4">
<h4 id="estimated-link-functions">Estimated link functions:<a class="anchor" aria-label="anchor" href="#estimated-link-functions"></a>
</h4>
<p> </p>
<p>Confidence intervals of the link functions can be obtained by the Monte Carlo method:</p>
<p> </p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">CIlink</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictlink.html">predictlink</a></span><span class="op">(</span><span class="va">mult_betaspl</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">CIlink</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>, shades <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_process_model_with_multlcmm_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></p>
<p> </p>
</div>
<div class="section level4">
<h4 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h4>
<p>The summary of the model includes convergence, goodness of fit criteria and estimated parameters.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">summary</span>(mult_betaspl) </a>
<a class="sourceLine" id="cb12-2" data-line-number="2">General latent class mixed model </a>
<a class="sourceLine" id="cb12-3" data-line-number="3">     fitted by maximum likelihood method </a>
<a class="sourceLine" id="cb12-4" data-line-number="4"> </a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="kw">multlcmm</span>(<span class="dt">fixed =</span> MMSE <span class="op">+</span><span class="st"> </span>IST <span class="op">+</span><span class="st"> </span>BVRT <span class="op">~</span><span class="st"> </span>age75 <span class="op">+</span><span class="st"> </span>male <span class="op">+</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(time<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">10</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="st">    </span><span class="kw">contrast</span>(male), <span class="dt">random =</span> <span class="op">~</span>time <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(time<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">10</span>), <span class="dt">subject =</span> <span class="st">"ID"</span>, </a>
<a class="sourceLine" id="cb12-7" data-line-number="7">    <span class="dt">randomY =</span> <span class="ot">TRUE</span>, <span class="dt">link =</span> <span class="kw">c</span>(<span class="st">"beta"</span>, <span class="st">"3-quant-splines"</span>, <span class="st">"3-quant-splines"</span>), </a>
<a class="sourceLine" id="cb12-8" data-line-number="8">    <span class="dt">cor =</span> <span class="kw">BM</span>(time), <span class="dt">data =</span> paquid, <span class="dt">nproc =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb12-9" data-line-number="9"> </a>
<a class="sourceLine" id="cb12-10" data-line-number="10">Statistical Model<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="st">     </span>Dataset<span class="op">:</span><span class="st"> </span>paquid </a>
<a class="sourceLine" id="cb12-12" data-line-number="12">     Number of subjects<span class="op">:</span><span class="st"> </span><span class="dv">500</span> </a>
<a class="sourceLine" id="cb12-13" data-line-number="13">     Number of observations<span class="op">:</span><span class="st"> </span><span class="dv">6216</span> </a>
<a class="sourceLine" id="cb12-14" data-line-number="14">     Number of latent classes<span class="op">:</span><span class="st"> </span><span class="dv">1</span> </a>
<a class="sourceLine" id="cb12-15" data-line-number="15">     Number of parameters<span class="op">:</span><span class="st"> </span><span class="dv">32</span>  </a>
<a class="sourceLine" id="cb12-16" data-line-number="16">     Link functions<span class="op">:</span><span class="st"> </span>Standardised Beta CdF <span class="cf">for</span> MMSE  </a>
<a class="sourceLine" id="cb12-17" data-line-number="17">                     Quadratic I<span class="op">-</span>splines with nodes <span class="dv">5</span> <span class="dv">27</span> <span class="dv">40</span> <span class="cf">for</span> IST </a>
<a class="sourceLine" id="cb12-18" data-line-number="18">                     Quadratic I<span class="op">-</span>splines with nodes <span class="dv">0</span> <span class="dv">11</span> <span class="dv">15</span> <span class="cf">for</span> BVRT </a>
<a class="sourceLine" id="cb12-19" data-line-number="19"> </a>
<a class="sourceLine" id="cb12-20" data-line-number="20">Iteration process<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-21" data-line-number="21"><span class="st">     </span>Convergence criteria satisfied </a>
<a class="sourceLine" id="cb12-22" data-line-number="22">     Number of iterations<span class="op">:</span><span class="st">  </span><span class="dv">31</span> </a>
<a class="sourceLine" id="cb12-23" data-line-number="23">     Convergence criteria<span class="op">:</span><span class="st"> </span>parameters=<span class="st"> </span><span class="fl">1e-07</span> </a>
<a class="sourceLine" id="cb12-24" data-line-number="24">                         <span class="op">:</span><span class="st"> </span>likelihood=<span class="st"> </span><span class="fl">1.5e-07</span> </a>
<a class="sourceLine" id="cb12-25" data-line-number="25">                         <span class="op">:</span><span class="st"> </span>second derivatives=<span class="st"> </span><span class="fl">5.1e-12</span> </a>
<a class="sourceLine" id="cb12-26" data-line-number="26"> </a>
<a class="sourceLine" id="cb12-27" data-line-number="27">Goodness<span class="op">-</span>of<span class="op">-</span>fit statistics<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-28" data-line-number="28"><span class="st">     </span>maximum log<span class="op">-</span>likelihood<span class="op">:</span><span class="st"> </span><span class="fl">-14373.66</span>  </a>
<a class="sourceLine" id="cb12-29" data-line-number="29">     AIC<span class="op">:</span><span class="st"> </span><span class="fl">28811.33</span>  </a>
<a class="sourceLine" id="cb12-30" data-line-number="30">     BIC<span class="op">:</span><span class="st"> </span><span class="fl">28946.2</span>  </a>
<a class="sourceLine" id="cb12-31" data-line-number="31"> </a>
<a class="sourceLine" id="cb12-32" data-line-number="32">Maximum Likelihood Estimates<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-33" data-line-number="33"><span class="st"> </span></a>
<a class="sourceLine" id="cb12-34" data-line-number="34">Fixed effects <span class="cf">in</span> the longitudinal model<span class="op">:</span></a>
<a class="sourceLine" id="cb12-35" data-line-number="35"></a>
<a class="sourceLine" id="cb12-36" data-line-number="36"><span class="st">                                </span>coef      Se   Wald p<span class="op">-</span>value</a>
<a class="sourceLine" id="cb12-37" data-line-number="37"><span class="kw">intercept</span> (not estimated)    <span class="fl">0.00000</span>                       </a>
<a class="sourceLine" id="cb12-38" data-line-number="38">age75                       <span class="fl">-1.09189</span> <span class="fl">0.11368</span> <span class="fl">-9.605</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb12-39" data-line-number="39">male                         <span class="fl">0.14430</span> <span class="fl">0.11934</span>  <span class="fl">1.209</span> <span class="fl">0.22659</span></a>
<a class="sourceLine" id="cb12-40" data-line-number="40">time                        <span class="fl">-1.24025</span> <span class="fl">0.19076</span> <span class="fl">-6.502</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb12-41" data-line-number="41"><span class="kw">I</span>(time<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">10</span>)                <span class="fl">-2.39711</span> <span class="fl">0.98528</span> <span class="fl">-2.433</span> <span class="fl">0.01498</span></a>
<a class="sourceLine" id="cb12-42" data-line-number="42">Contrasts on <span class="kw">male</span> (<span class="dt">p=</span><span class="fl">3e-04</span>)                                </a>
<a class="sourceLine" id="cb12-43" data-line-number="43">MMSE                        <span class="fl">-0.07360</span> <span class="fl">0.06931</span> <span class="fl">-1.062</span> <span class="fl">0.28829</span></a>
<a class="sourceLine" id="cb12-44" data-line-number="44">IST                         <span class="fl">-0.26698</span> <span class="fl">0.07854</span> <span class="fl">-3.399</span> <span class="fl">0.00068</span></a>
<a class="sourceLine" id="cb12-45" data-line-number="45">BVRT<span class="op">**</span><span class="st">                       </span><span class="fl">0.34058</span> <span class="fl">0.08810</span>  <span class="fl">3.866</span> <span class="fl">0.00011</span></a>
<a class="sourceLine" id="cb12-46" data-line-number="46"></a>
<a class="sourceLine" id="cb12-47" data-line-number="47"></a>
<a class="sourceLine" id="cb12-48" data-line-number="48">Variance<span class="op">-</span>covariance matrix of the random<span class="op">-</span>effects<span class="op">:</span></a>
<a class="sourceLine" id="cb12-49" data-line-number="49">(the variance of the first random effect is not estimated)</a>
<a class="sourceLine" id="cb12-50" data-line-number="50">             intercept     time <span class="kw">I</span>(time<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb12-51" data-line-number="51">intercept      <span class="fl">1.00000</span>                      </a>
<a class="sourceLine" id="cb12-52" data-line-number="52">time           <span class="fl">0.05618</span>  <span class="fl">1.53473</span>             </a>
<a class="sourceLine" id="cb12-53" data-line-number="53"><span class="kw">I</span>(time<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">10</span>)  <span class="fl">-0.77856</span> <span class="fl">-5.22729</span>     <span class="fl">32.31854</span></a>
<a class="sourceLine" id="cb12-54" data-line-number="54"></a>
<a class="sourceLine" id="cb12-55" data-line-number="55">                       coef      Se</a>
<a class="sourceLine" id="cb12-56" data-line-number="56">BM standard error<span class="op">:</span><span class="st">  </span><span class="fl">0.98003</span> <span class="fl">0.13326</span></a>
<a class="sourceLine" id="cb12-57" data-line-number="57"></a>
<a class="sourceLine" id="cb12-58" data-line-number="58">                                         MMSE      IST     BVRT</a>
<a class="sourceLine" id="cb12-59" data-line-number="59">Residual standard error<span class="op">:</span><span class="st">              </span><span class="fl">1.01982</span>  <span class="fl">0.93048</span>  <span class="fl">1.42284</span></a>
<a class="sourceLine" id="cb12-60" data-line-number="60">Standard error of the random effect<span class="op">:</span><span class="st">  </span><span class="fl">0.57605</span>  <span class="fl">0.85186</span>  <span class="fl">0.89027</span></a>
<a class="sourceLine" id="cb12-61" data-line-number="61"></a>
<a class="sourceLine" id="cb12-62" data-line-number="62">Parameters of the link functions<span class="op">:</span></a>
<a class="sourceLine" id="cb12-63" data-line-number="63"></a>
<a class="sourceLine" id="cb12-64" data-line-number="64"><span class="st">                    </span>coef      Se    Wald p<span class="op">-</span>value</a>
<a class="sourceLine" id="cb12-65" data-line-number="65">MMSE<span class="op">-</span>Beta1       <span class="fl">1.41416</span> <span class="fl">0.07051</span>  <span class="fl">20.056</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb12-66" data-line-number="66">MMSE<span class="op">-</span>Beta2      <span class="fl">-0.25052</span> <span class="fl">0.08346</span>  <span class="fl">-3.002</span> <span class="fl">0.00269</span></a>
<a class="sourceLine" id="cb12-67" data-line-number="67">MMSE<span class="op">-</span>Beta3       <span class="fl">0.45879</span> <span class="fl">0.02586</span>  <span class="fl">17.741</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb12-68" data-line-number="68">MMSE<span class="op">-</span>Beta4       <span class="fl">0.06439</span> <span class="fl">0.00580</span>  <span class="fl">11.095</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb12-69" data-line-number="69">IST<span class="op">-</span>I<span class="op">-</span>splines1  <span class="fl">-6.51526</span> <span class="fl">0.52193</span> <span class="fl">-12.483</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb12-70" data-line-number="70">IST<span class="op">-</span>I<span class="op">-</span>splines2   <span class="fl">1.10955</span> <span class="fl">0.15664</span>   <span class="fl">7.083</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb12-71" data-line-number="71">IST<span class="op">-</span>I<span class="op">-</span>splines3   <span class="fl">2.14896</span> <span class="fl">0.09800</span>  <span class="fl">21.928</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb12-72" data-line-number="72">IST<span class="op">-</span>I<span class="op">-</span>splines4   <span class="fl">1.56009</span> <span class="fl">0.08373</span>  <span class="fl">18.633</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb12-73" data-line-number="73">IST<span class="op">-</span>I<span class="op">-</span>splines5   <span class="fl">1.44628</span> <span class="fl">0.07305</span>  <span class="fl">19.799</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb12-74" data-line-number="74">BVRT<span class="op">-</span>I<span class="op">-</span>splines1 <span class="fl">-7.31210</span> <span class="fl">0.68892</span> <span class="fl">-10.614</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb12-75" data-line-number="75">BVRT<span class="op">-</span>I<span class="op">-</span>splines2  <span class="fl">1.13661</span> <span class="fl">0.26027</span>   <span class="fl">4.367</span> <span class="fl">0.00001</span></a>
<a class="sourceLine" id="cb12-76" data-line-number="76">BVRT<span class="op">-</span>I<span class="op">-</span>splines3  <span class="fl">1.97351</span> <span class="fl">0.12641</span>  <span class="fl">15.611</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb12-77" data-line-number="77">BVRT<span class="op">-</span>I<span class="op">-</span>splines4  <span class="fl">2.08216</span> <span class="fl">0.09703</span>  <span class="fl">21.459</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb12-78" data-line-number="78">BVRT<span class="op">-</span>I<span class="op">-</span>splines5  <span class="fl">1.58945</span> <span class="fl">0.07545</span>  <span class="fl">21.065</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb12-79" data-line-number="79"></a>
<a class="sourceLine" id="cb12-80" data-line-number="80"> <span class="op">**</span><span class="st"> </span>coefficient not estimated but obtained from the others as minus the sum of them </a>
<a class="sourceLine" id="cb12-81" data-line-number="81"> </a></code></pre></div>
<p>From the estimates, the underlying cognition has a quadratic trajectory over time, older subjects at baseline have systematically lower cognitive level. There is no difference according to gender. However, there are significantly differential effects of gender on psychometric tests (p=0.0003) with a systematically higher BVRT for men and higher IST levels for women.</p>
</div>
<div class="section level4">
<h4 id="variance-explained">Variance explained<a class="anchor" aria-label="anchor" href="#variance-explained"></a>
</h4>
<p>For multivariate data, the latent process is the common underlying factor of the different markers. Thus, we can compute the residual variance of each marker explained the latent process. This variance explained is conditional on the covariates and computed for a specific time.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">VarExpl</span>(mult_betaspl, <span class="kw">data.frame</span>(<span class="dt">time=</span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">            class1</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">%Var<span class="op">-</span>MMSE <span class="fl">42.16100</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4">%Var<span class="op">-</span>IST  <span class="fl">38.58841</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5">%Var<span class="op">-</span>BVRT <span class="fl">26.19821</span></a></code></pre></div>
<p>For example, the common factor explained 42% of MMSE residual variation while it explained 26% of the BVRT residual variation at time 0.</p>
</div>
<div class="section level4">
<h4 id="graph-of-predicted-trajectories-for-the-markers">Graph of predicted trajectories for the markers<a class="anchor" aria-label="anchor" href="#graph-of-predicted-trajectories-for-the-markers"></a>
</h4>
<p>As with lcmm function, predicted trajectories of the markers can be computed according to a covariate profile and then plotted.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datnew</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.08</span>,<span class="fl">2.2</span>,length<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">age_init</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">65</span>,<span class="fl">95</span>, length<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">age75</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">datnew</span><span class="op">$</span><span class="va">age_init</span> <span class="op">-</span> <span class="fl">75</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">male</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">predict_women</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">mult_betaspl</span>,newdata<span class="op">=</span><span class="va">datnew</span>,var.time<span class="op">=</span><span class="st">'time'</span>,draws<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">male</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">predict_men</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">mult_betaspl</span>,newdata<span class="op">=</span><span class="va">datnew</span>,var.time<span class="op">=</span><span class="st">'time'</span>,draws<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">predict_women</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, type<span class="op">=</span><span class="st">'l'</span>, col<span class="op">=</span><span class="fl">6</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">'time since entry (in decades)'</span>, ylab<span class="op">=</span><span class="st">'Marker'</span>, bty<span class="op">=</span><span class="st">'l'</span>, legend<span class="op">=</span><span class="cn">NULL</span>, shades<span class="op">=</span><span class="cn">TRUE</span>, outcome <span class="op">=</span> <span class="fl">1</span>, main<span class="op">=</span><span class="st">'Mean predicted trajectory for MMSE'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">predict_men</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, type<span class="op">=</span><span class="st">'l'</span>, col<span class="op">=</span><span class="fl">3</span>, shades<span class="op">=</span><span class="cn">TRUE</span>, outcome <span class="op">=</span> <span class="fl">1</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">30</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Women"</span>, <span class="st">"Men"</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">3</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, cex<span class="op">=</span><span class="fl">0.8</span>,bty<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">predict_women</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, type<span class="op">=</span><span class="st">'l'</span>, col<span class="op">=</span><span class="fl">6</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">40</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">'time since entry (in decades)'</span>, ylab<span class="op">=</span><span class="st">'Marker'</span>, bty<span class="op">=</span><span class="st">'l'</span>, legend<span class="op">=</span><span class="cn">NULL</span>, shades<span class="op">=</span><span class="cn">TRUE</span>, outcome <span class="op">=</span> <span class="fl">2</span>, main<span class="op">=</span><span class="st">'Mean predicted trajectory for IST'</span><span class="op">)</span> </span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">predict_men</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, type<span class="op">=</span><span class="st">'l'</span>, col<span class="op">=</span><span class="fl">3</span>, shades<span class="op">=</span><span class="cn">TRUE</span>, outcome <span class="op">=</span> <span class="fl">2</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">predict_women</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, type<span class="op">=</span><span class="st">'l'</span>, col<span class="op">=</span><span class="fl">6</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">15</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">'time since entry (in decades)'</span>, ylab<span class="op">=</span><span class="st">'Marker'</span>, bty<span class="op">=</span><span class="st">'l'</span>, legend<span class="op">=</span><span class="cn">NULL</span>, shades<span class="op">=</span><span class="cn">TRUE</span>, outcome <span class="op">=</span> <span class="fl">3</span>, main<span class="op">=</span><span class="st">'Mean predicted trajectory for BVRT'</span><span class="op">)</span> </span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">predict_men</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, type<span class="op">=</span><span class="st">'l'</span>, col<span class="op">=</span><span class="fl">3</span>, shades<span class="op">=</span><span class="cn">TRUE</span>, outcome <span class="op">=</span> <span class="fl">3</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_process_model_with_multlcmm_files/figure-html/unnamed-chunk-8-1.png" width="768" style="display: block; margin: auto;"></p>
<p> </p>
</div>
<div class="section level4">
<h4 id="goodness-of-fit-graph-of-the-residuals">Goodness of fit: graph of the residuals<a class="anchor" aria-label="anchor" href="#goodness-of-fit-graph-of-the-residuals"></a>
</h4>
<p>As in any mixed model, we expect the subject-specicif residuals (bottom right panel) to be Gaussian.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mult_betaspl</span>, cex.main<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="goodness-of-fit-graph-of-the-predictions-versus-observations">Goodness of fit: graph of the predictions versus observations<a class="anchor" aria-label="anchor" href="#goodness-of-fit-graph-of-the-predictions-versus-observations"></a>
</h4>
<p>The mean predictions and observations can be plotted according to time. Note that the predictions and observations are in the scale of the latent process (observations are transformed with the estimated link functions):</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mult_betaspl</span>, which<span class="op">=</span><span class="st">"fit"</span>, var.time<span class="op">=</span><span class="st">"time"</span>, bty<span class="op">=</span><span class="st">"l"</span>, xlab<span class="op">=</span><span class="st">"time since entry (in decades)"</span>, cex.lab<span class="op">=</span><span class="fl">1.1</span>, break.times<span class="op">=</span><span class="fl">8</span>, ylab<span class="op">=</span><span class="st">"latent process"</span>, lwd<span class="op">=</span><span class="fl">2</span>, marg<span class="op">=</span><span class="cn">FALSE</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">0.0</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">2</span><span class="op">)</span>, shades <span class="op">=</span> <span class="cn">TRUE</span>, outcome <span class="op">=</span> <span class="fl">1</span>, col<span class="op">=</span><span class="fl">2</span>, main<span class="op">=</span><span class="st">"MMSE predictions vs observations"</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mult_betaspl</span>, which<span class="op">=</span><span class="st">"fit"</span>, var.time<span class="op">=</span><span class="st">"time"</span>, bty<span class="op">=</span><span class="st">"l"</span>, xlab<span class="op">=</span><span class="st">"time since entry (in decades)"</span>, cex.lab<span class="op">=</span><span class="fl">1.1</span>, break.times<span class="op">=</span><span class="fl">8</span>, ylab<span class="op">=</span><span class="st">"latent process"</span>, lwd<span class="op">=</span><span class="fl">2</span>, marg<span class="op">=</span><span class="cn">FALSE</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">0.3</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">2</span><span class="op">)</span>, shades <span class="op">=</span> <span class="cn">TRUE</span>, outcome <span class="op">=</span> <span class="fl">2</span>, col<span class="op">=</span><span class="fl">3</span>, main<span class="op">=</span><span class="st">"IST predictions vs observations"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mult_betaspl</span>, which<span class="op">=</span><span class="st">"fit"</span>, var.time<span class="op">=</span><span class="st">"time"</span>, bty<span class="op">=</span><span class="st">"l"</span>, xlab<span class="op">=</span><span class="st">"time since entry (in decades)"</span>, cex.lab<span class="op">=</span><span class="fl">1.1</span>, break.times<span class="op">=</span><span class="fl">8</span>, ylab<span class="op">=</span><span class="st">"latent process"</span>, lwd<span class="op">=</span><span class="fl">2</span>, marg<span class="op">=</span><span class="cn">FALSE</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>,<span class="fl">0.5</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">2</span><span class="op">)</span>, shades <span class="op">=</span> <span class="cn">TRUE</span>, outcome <span class="op">=</span> <span class="fl">3</span>, col<span class="op">=</span><span class="fl">4</span>, main<span class="op">=</span><span class="st">"BVRT predictions vs observations"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="latent_process_model_with_multlcmm_files/figure-html/unnamed-chunk-10-1.png" width="768" style="display: block; margin: auto;"></p>
<p> </p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="to-go-further">To go further …<a class="anchor" aria-label="anchor" href="#to-go-further"></a>
</h2>
<div class="section level3">
<h3 id="heterogeneous-profiles-of-trajectories">heterogeneous profiles of trajectories<a class="anchor" aria-label="anchor" href="#heterogeneous-profiles-of-trajectories"></a>
</h3>
<p>The latent process mixed model for multivariate markers extends to the heterogeneous case with latent classes. The same strategy as explained with <a href="latent_class_model_with_hlme.html">hlme</a> can be used.</p>
</div>
<div class="section level3">
<h3 id="joint-analysis-of-a-time-to-event">joint analysis of a time to event<a class="anchor" aria-label="anchor" href="#joint-analysis-of-a-time-to-event"></a>
</h3>
<p>The latent process mixed model for multivariate markers extends to the case of a joint model. This is done in <a href="joint_latent_class_model_with_Jointlcmm.html">Jointlcmm when one latent process is involved</a> or mpjlcmm when <a href="multivariate_latent_class_model_with_mpjlcmm.html">multivariate latent processes are considered</a>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Cecile Proust-Lima, Viviane Philipps.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
