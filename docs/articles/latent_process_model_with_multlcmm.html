<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>How to estimate a latent process mixed model for multivariate markers using multlcmm function • lcmm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to estimate a latent process mixed model for multivariate markers using multlcmm function">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lcmm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/lcmm.html">GET STARTED</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">VIGNETTES</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/latent_class_model_with_hlme.html">How to estimate a latent class mixed model using hlme function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_lcmm.html">How to estimate a latent process mixed model using lcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm.html">How to estimate a latent process mixed model for multivariate markers using multlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm_IRT.html">Continuous-time longitudinal IRT model</a></li>
    <li><a class="dropdown-item" href="../articles/joint_latent_class_model_with_Jointlcmm.html">How to estimate a joint latent class mixed model using Jointlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/multivariate_latent_class_model_with_mpjlcmm.html">How to estimate a multivariate latent class mixed model using mpjlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/secondary_model_with_externVar.html">Accounting for latent class assignment uncertainty in subsequent analyses</a></li>
    <li><a class="dropdown-item" href="../articles/pre_normalizing.html">Pre-normalizing a dependent variable using lcmm</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/usual_problems.html">FAQ</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">REFERENCE</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">CHANGELOG</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CecileProust-Lima/lcmm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>How to estimate a latent process mixed model for multivariate markers using multlcmm function</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CecileProust-Lima/lcmm/blob/HEAD/vignettes/latent_process_model_with_multlcmm.Rmd" class="external-link"><code>vignettes/latent_process_model_with_multlcmm.Rmd</code></a></small>
      <div class="d-none name"><code>latent_process_model_with_multlcmm.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background-and-definitions">Background and definitions<a class="anchor" aria-label="anchor" href="#background-and-definitions"></a>
</h2>
<p align="justify">
</p>
<p>Each dynamic phenomenon can be characterized by a latent process
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>Λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\Lambda(t))</annotation></semantics></math>
which evolves in continuous time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.
Sometimes, this latent process is measured through several markers so
that the latent process is their common factor.</p>
<p>Function multlcmm treats this idea and extend the linear mixed model
theory to several markers measuring the same underlying quantity, these
markers not being necessarily Gaussian.</p>
<div class="section level3">
<h3 id="the-latent-process-mixed-model-for-multivariate-markers">The latent process mixed model for multivariate markers<a class="anchor" aria-label="anchor" href="#the-latent-process-mixed-model-for-multivariate-markers"></a>
</h3>
<p align="justify">
</p>
<p>The latent process mixed model is introduced in Proust-Lima et
al. (2006 - <a href="https://doi.org/10.1111/j.1541-0420.2006.00573.x" class="external-link uri">https://doi.org/10.1111/j.1541-0420.2006.00573.x</a>, 2013 -
<a href="https://doi.org/10.1111/bmsp.12000" class="external-link uri">https://doi.org/10.1111/bmsp.12000</a> and 2022 - <a href="https://doi.org/10.1016/j.ymeth.2022.01.005" class="external-link uri">https://doi.org/10.1016/j.ymeth.2022.01.005</a> ).</p>
<p>The quantity of interest defined as a latent process is modeled
according to time using a linear mixed model:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>X</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>β</mi><mo>+</mo><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>u</mi><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Lambda(t) = X(t) \beta + Z(t)u_i +w_i(t)</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X(t)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Z(t)</annotation></semantics></math>
are vectors of covariates
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Z(t)</annotation></semantics></math>
is included in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X(t)</annotation></semantics></math>);</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
are the fixed effects (i.e., population mean effects);</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>u</mi><mi>i</mi></msub><annotation encoding="application/x-tex">u_i</annotation></semantics></math>
are the random effects (i.e., individual effects); they are distributed
according to a zero-mean multivariate normal distribution with
covariance matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>;</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(w_i(t))</annotation></semantics></math>
is a Gaussian process that might be added in the model to relax the
intra-subject correlation structure.</li>
</ul>
<p>This structural model for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Lambda(t)</annotation></semantics></math>
according to time and covariates is exactly the same as in the <a href="latent_process_model_with_lcmm.html">univariate case</a>.</p>
Now, instead of defining one equation of observation, we define K
equations of observation for the K different markers with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">Y_{ijk}</annotation></semantics></math>
the observation for subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
marker
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
and occasion
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>.
As in the univariate case, several types of markers can be handled by
defining a marker-specific link function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mi>k</mi></msub><annotation encoding="application/x-tex">H_{k}</annotation></semantics></math>.
The marker-specific equation of observation also includes potentially
some contrasts
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\gamma_k</annotation></semantics></math>
on covariates and a marker and subject specific random intercept so
that:

<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo>=</mo><msub><mi>H</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mspace width="0.222em"></mspace><mi>Λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>X</mi><mrow><mi>c</mi><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><msub><mi>γ</mi><mi>k</mi></msub><mo>+</mo><msub><mi>α</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mspace width="0.222em"></mspace><mo>;</mo><msub><mi>η</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y_{ijk} = H_{k}(~  \Lambda(t_{ijk})+ X_{cijk}\gamma_{k} + \alpha_{ik} + \epsilon_{ijk} ~ ; \eta_{k}) </annotation></semantics></math></p>
<p>where:</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mover><mrow></mrow><mo accent="true">̃</mo></mover><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>σ</mi><mi>k</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha_{ik} \tilde{} N(0,\sigma_k^2)</annotation></semantics></math></li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>c</mi><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">X_{cijk}</annotation></semantics></math>
vector of covariates</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\gamma_k</annotation></semantics></math>
are contrasts (with the sum over
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
equal to 0)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">t_{ijk}</annotation></semantics></math>
the time of measurement for subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
marker
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
and occasion
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>;</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">\epsilon_{ijk}</annotation></semantics></math>
an independent Gaussian error with mean zero and variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>σ</mi><msub><mi>ϵ</mi><mi>k</mi></msub><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_{\epsilon_k}^2</annotation></semantics></math>;</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mi>k</mi></msub><annotation encoding="application/x-tex">H_k</annotation></semantics></math>
the link function (parameterized by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>η</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\eta_k</annotation></semantics></math>)
that transforms the latent process into the scale and metric of marker
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.</li>
</ul>
<p>The link functions are the same as in the univariate case (in lcmm).
For continuous outcomes,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>H</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><annotation encoding="application/x-tex">H^{-1}</annotation></semantics></math>
is a parametric family of increasing monotonic functions among:</p>
<ul>
<li>the linear transformation: this reduces to the linear mixed model (2
parameters)</li>
<li>the Beta cumulative distribution family rescaled (4 parameters)</li>
<li>the basis of quadratic I-splines with m knots (m+2 parameters)</li>
</ul>
<p>For binary and ordinal outcomes,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mi>k</mi></msub><annotation encoding="application/x-tex">H_k</annotation></semantics></math>
links each level of the variable with an interval of values for the
latent process plus measurement errors. This corresponds to the
(cumulative) probit model.</p>
<p>We describe below a case with continuous link functions. For ordinal
markers, see <a href="latent_process_model_with_multlcmm_IRT.html">vignette</a>.</p>
</div>
<div class="section level3">
<h3 id="identifiability">Identifiability<a class="anchor" aria-label="anchor" href="#identifiability"></a>
</h3>
<p>As in any latent variable model, the metric of the latent variable
has to be defined. In contrast with lcmm function, here the variance of
the first random effect
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>u</mi><mi>i</mi></msub><annotation encoding="application/x-tex">u_i</annotation></semantics></math>
is set to 1 and the mean intercept (in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>)
is set to 0.</p>
<p> </p>
</div>
</div>
<div class="section level2">
<h2 id="example-with-cognitive-process">Example with cognitive process<a class="anchor" aria-label="anchor" href="#example-with-cognitive-process"></a>
</h2>
<p align="justify">
In this example, we study cognitive trajectory over time when cognition
is defined as the common factor underlying three psychometric tests:
<strong>MMSE</strong>, <strong>BVRT</strong> and <strong>IST</strong>.
Here the timescale is years since entry into the cohort, the trajectory
is assumed quadratic in time (both at individual and population level)
and the model is adjusted for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>g</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">age</annotation></semantics></math>
at entry. To further investigate the effect of gender, both mean effects
on the common factor and differential effects (contrasts) on each marker
are included (not in interaction with time in this example).
</p>
<div class="section level3">
<h3 id="model-considered">Model considered :<a class="anchor" aria-label="anchor" href="#model-considered"></a>
</h3>
<p align="justify">
</p>
<p> </p>
<p><span class="math display">$$Y_{ijk} = H_k(~ \beta_{1}t_{ij} +
\beta_{2}t_{ij}^2 +\beta_{3}age75_{i} + \beta_{4}male_{i}
+\gamma_{k}male_{i} \\ +u_{0i}+u_{1i}t_{ij}+u_{2i}t_{ij}^2+ \alpha_{ik}
+ \omega_i(t_{ijk}) +\epsilon_{ijk} ~~, \eta_k)$$</span></p>
<p> </p>
<p><em>Where : </em></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>i</mi></msub><mover><mrow></mrow><mo accent="true">̃</mo></mover><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">u_{i}\tilde{}N(0,B)</annotation></semantics></math>
and
V(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>u</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">u_{0i}</annotation></semantics></math>)=1,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ω</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\omega_i(t)</annotation></semantics></math>
is a Brownian process,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mover><mrow></mrow><mo accent="true">̃</mo></mover><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>σ</mi><mi>k</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha_{ik}\tilde{}N(0,\sigma_k^2)</annotation></semantics></math>
and for k = 1,2,3:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi><mn>1</mn></mrow></msub><mo>=</mo><mi>M</mi><mi>M</mi><mi>S</mi><msub><mi>E</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Y_{ij1}= MMSE_{ij}</annotation></semantics></math>
,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi><mn>2</mn></mrow></msub><mo>=</mo><mi>I</mi><mi>S</mi><msub><mi>T</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Y_{ij2}= IST_{ij}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi><mn>3</mn></mrow></msub><mo>=</mo><mi>B</mi><mi>V</mi><mi>R</mi><msub><mi>T</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">Y_{ij3}= BVRT_{ij})</annotation></semantics></math></p>
<p> </p>
</div>
<div class="section level3">
<h3 id="estimation-with-different-link-functions">Estimation with different link functions<a class="anchor" aria-label="anchor" href="#estimation-with-different-link-functions"></a>
</h3>
<p>We first create the variable time and recenter and scale age to avoid
numerical problems</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paquid</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">age</span> <span class="op">-</span> <span class="va">paquid</span><span class="op">$</span><span class="va">age_init</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span></span>
<span><span class="va">paquid</span><span class="op">$</span><span class="va">age75</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">age_init</span> <span class="op">-</span> <span class="fl">75</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span></span></code></pre></div>
<div class="section level4">
<h4 id="linear-link-functions">linear link functions<a class="anchor" aria-label="anchor" href="#linear-link-functions"></a>
</h4>
<p>By default, all the link functions are set to linear:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mult_lin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multlcmm.html">multlcmm</a></span><span class="op">(</span><span class="va">MMSE</span> <span class="op">+</span> <span class="va">IST</span> <span class="op">+</span> <span class="va">BVRT</span> <span class="op">~</span> <span class="va">age75</span> <span class="op">+</span> <span class="va">male</span> <span class="op">+</span> <span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span> <span class="fu">contrast</span><span class="op">(</span><span class="va">male</span><span class="op">)</span>, random <span class="op">=</span><span class="op">~</span> <span class="va">time</span> <span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="fl">10</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquid</span>, randomY <span class="op">=</span> <span class="cn">TRUE</span>, cor <span class="op">=</span> <span class="fu">BM</span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p> </p>
</div>
<div class="section level4">
<h4 id="nonlinear-link-functions">nonlinear link functions<a class="anchor" aria-label="anchor" href="#nonlinear-link-functions"></a>
</h4>
<p>Depending on the nature of the data, some nonlinear link functions
may be necessary. Here for instance, the MMSE is highly skewed:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">MMSE</span>, breaks<span class="op">=</span><span class="fl">31</span>,main<span class="op">=</span><span class="st">"MMSE distribution"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">IST</span>, breaks<span class="op">=</span><span class="fl">41</span>,main<span class="op">=</span><span class="st">"IST distribution"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">BVRT</span>, breaks<span class="op">=</span><span class="fl">16</span>, main<span class="op">=</span><span class="st">"BVRT distribution"</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_process_model_with_multlcmm_files/figure-html/hist-1.png" width="768" style="display: block; margin: auto;"></p>
<p>As in the univariate case, Beta CDF or splines can be considered. The
link function family can either be the same for all the markers (even if
the parameters will be different):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example with Beta</span></span>
<span><span class="va">mult_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multlcmm.html">multlcmm</a></span><span class="op">(</span><span class="va">MMSE</span> <span class="op">+</span> <span class="va">IST</span> <span class="op">+</span> <span class="va">BVRT</span> <span class="op">~</span> <span class="va">age75</span> <span class="op">+</span> <span class="va">male</span> <span class="op">+</span> <span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span> <span class="fu">contrast</span><span class="op">(</span><span class="va">male</span><span class="op">)</span>, random <span class="op">=</span><span class="op">~</span> <span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquid</span>, randomY <span class="op">=</span> <span class="cn">TRUE</span>, cor <span class="op">=</span> <span class="fu">BM</span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, link <span class="op">=</span> <span class="st">'beta'</span><span class="op">)</span></span></code></pre></div>
<p>Or the link functions can be chosen differently. For instance,</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># different number of knots in splines</span></span>
<span><span class="va">mult_betaspl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multlcmm.html">multlcmm</a></span><span class="op">(</span><span class="va">MMSE</span> <span class="op">+</span> <span class="va">IST</span> <span class="op">+</span> <span class="va">BVRT</span> <span class="op">~</span> <span class="va">age75</span> <span class="op">+</span> <span class="va">male</span> <span class="op">+</span> <span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span> <span class="fu">contrast</span><span class="op">(</span><span class="va">male</span><span class="op">)</span>, random <span class="op">=</span><span class="op">~</span><span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquid</span>, randomY <span class="op">=</span> <span class="cn">TRUE</span>, cor <span class="op">=</span> <span class="fu">BM</span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'beta'</span>,<span class="st">'3-quant-splines'</span>,<span class="st">'3-quant-splines'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="fixing-some-transformation-parameters">Fixing some transformation parameters<a class="anchor" aria-label="anchor" href="#fixing-some-transformation-parameters"></a>
</h4>
<p>Note that the splines transformation may sometimes involve parameters
so close to 0 that it entails a lack of convergence (since the parameter
is at the boundary of the parameter space). This often happens with
MMSE. For instance, in the example below, convergence cannot be reached
easily because the third parameter of MMSE transformation is lower than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>10</mn><mrow><mo>−</mo><mn>4</mn></mrow></msup><annotation encoding="application/x-tex">10^{-4}</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># with splines</span></span>
<span><span class="va">mult_splines</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multlcmm.html">multlcmm</a></span><span class="op">(</span><span class="va">MMSE</span> <span class="op">+</span> <span class="va">IST</span> <span class="op">+</span> <span class="va">BVRT</span> <span class="op">~</span> <span class="va">age75</span> <span class="op">+</span> <span class="va">male</span> <span class="op">+</span> <span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span> <span class="fu">contrast</span><span class="op">(</span><span class="va">male</span><span class="op">)</span>, random <span class="op">=</span><span class="op">~</span><span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquid</span>, randomY <span class="op">=</span> <span class="cn">TRUE</span>, cor <span class="op">=</span> <span class="fu">BM</span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, maxiter<span class="op">=</span><span class="fl">50</span>, link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'3-quant-splines'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This problem can be easily dealt with by fixing this parameter with
posfix option. To do so, the position of the parameter can be identified
from the vector of estimates (21st parameter here):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mult_splines</span><span class="op">$</span><span class="va">best</span></span>
<span><span class="co">#&gt;        age75         male         time I(time^2/10)   contrast11   contrast12 </span></span>
<span><span class="co">#&gt; -0.912118930  0.164705475 -0.955078743 -2.296125675 -0.052690937 -0.220337184 </span></span>
<span><span class="co">#&gt;     varcov 1     varcov 2     varcov 3     varcov 4     varcov 5         cor1 </span></span>
<span><span class="co">#&gt; -0.332258581  1.540065925  1.019664345 -5.546558036 31.247410582  0.774705941 </span></span>
<span><span class="co">#&gt;    std.err 1    std.err 2    std.err 3 std.randomY1 std.randomY2 std.randomY3 </span></span>
<span><span class="co">#&gt;  0.807451187  0.769052360  1.150155867  0.454810816  0.710396463  0.705932382 </span></span>
<span><span class="co">#&gt;   I-splines1   I-splines2   I-splines3   I-splines4   I-splines5   I-splines1 </span></span>
<span><span class="co">#&gt; -5.524719359  0.916356313  0.000290703  2.293739286  1.291376405 -5.265491398 </span></span>
<span><span class="co">#&gt;   I-splines2   I-splines3   I-splines4   I-splines5   I-splines1   I-splines2 </span></span>
<span><span class="co">#&gt;  0.970909306 -1.956899644  1.416412002 -1.317262925 -5.675350250  0.880373218 </span></span>
<span><span class="co">#&gt;   I-splines3   I-splines4   I-splines5 </span></span>
<span><span class="co">#&gt;  1.802212853  1.867532747  1.432048460</span></span></code></pre></div>
<p>And the model can be refitted from these estimates and the newly
fixed parameter:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># with splines</span></span>
<span><span class="va">mult_splines2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multlcmm.html">multlcmm</a></span><span class="op">(</span><span class="va">MMSE</span> <span class="op">+</span> <span class="va">IST</span> <span class="op">+</span> <span class="va">BVRT</span> <span class="op">~</span> <span class="va">age75</span> <span class="op">+</span> <span class="va">male</span> <span class="op">+</span> <span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span> <span class="fu">contrast</span><span class="op">(</span><span class="va">male</span><span class="op">)</span>, random <span class="op">=</span><span class="op">~</span><span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">'ID'</span>, data <span class="op">=</span> <span class="va">paquid</span>, randomY <span class="op">=</span> <span class="cn">TRUE</span>, cor <span class="op">=</span> <span class="fu">BM</span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, maxiter<span class="op">=</span><span class="fl">50</span>, link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'3-quant-splines'</span><span class="op">)</span>, posfix<span class="op">=</span><span class="fl">21</span>, B<span class="op">=</span><span class="va">mult_splines</span><span class="op">$</span><span class="va">best</span><span class="op">)</span></span></code></pre></div>
<p>With this constraint, the model converges correctly.</p>
<p> </p>
</div>
</div>
<div class="section level3">
<h3 id="comparison-of-the-models">Comparison of the models<a class="anchor" aria-label="anchor" href="#comparison-of-the-models"></a>
</h3>
<p align="justify">
</p>
<p>Objects <code>mult_lin</code>, <code>mult_beta</code>,
<code>mult_betaspl</code>, ‘mult_splines2’ are multivariate latent
process mixed models that assume the exact same trajectory for the
underlying latent process but different link functions. As in the
univariate case, the models can be compared using information criteria.
The <code>summarytable</code> give us such information.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">summarytable</span>(mult_lin,mult_beta,mult_betaspl,mult_splines2, <span class="at">which =</span><span class="fu">c</span>(<span class="st">"loglik"</span>, <span class="st">"conv"</span>, <span class="st">"npm"</span>, <span class="st">"AIC"</span>))</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>                 loglik conv npm      AIC</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>mult_lin      <span class="sc">-</span><span class="fl">15379.35</span>    <span class="dv">1</span>  <span class="dv">24</span> <span class="fl">30806.70</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>mult_beta     <span class="sc">-</span><span class="fl">14374.60</span>    <span class="dv">1</span>  <span class="dv">30</span> <span class="fl">28809.21</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>mult_betaspl  <span class="sc">-</span><span class="fl">14373.66</span>    <span class="dv">1</span>  <span class="dv">32</span> <span class="fl">28811.33</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>mult_splines2 <span class="sc">-</span><span class="fl">14408.50</span>    <span class="dv">1</span>  <span class="dv">32</span> <span class="fl">28881.00</span></span></code></pre></div>
<p> </p>
<p>Models involving Beta transformations and splines transformations
seem to fit a lot better in terms of AIC than the linear transformations
showing the departure from normality.</p>
<p> </p>
<p>The transformations can be plotted and compared between models:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mult_splines2</span>, which <span class="op">=</span> <span class="st">"linkfunction"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, lwd <span class="op">=</span><span class="fl">1</span>,lty<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mult_lin</span>,which<span class="op">=</span><span class="st">"linkfunction"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">1</span>,lty<span class="op">=</span><span class="fl">2</span>,add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mult_beta</span>,which<span class="op">=</span><span class="st">"linkfunction"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>,lty<span class="op">=</span><span class="fl">3</span>,add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mult_betaspl</span>,which<span class="op">=</span><span class="st">"linkfunction"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">1</span>,lty<span class="op">=</span><span class="fl">1</span>,add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"bottomright"</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linear"</span>,<span class="st">"beta"</span>,<span class="st">"splines"</span>,<span class="st">"beta/splines"</span><span class="op">)</span>,bty<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_process_model_with_multlcmm_files/figure-html/testprint2-1.png" width="672" style="display: block; margin: auto;">
 </p>
<p>Except from the linear transformations, all the estimation
transformations are really close.</p>
<p> </p>
</div>
<div class="section level3">
<h3 id="postfit-outputs">Postfit outputs<a class="anchor" aria-label="anchor" href="#postfit-outputs"></a>
</h3>
<div class="section level4">
<h4 id="estimated-link-functions">Estimated link functions:<a class="anchor" aria-label="anchor" href="#estimated-link-functions"></a>
</h4>
<p> </p>
<p>Confidence intervals of the link functions can be obtained by the
Monte Carlo method:</p>
<p> </p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">CIlink</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictlink.html">predictlink</a></span><span class="op">(</span><span class="va">mult_betaspl</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">CIlink</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>, shades <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_process_model_with_multlcmm_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></p>
<p> </p>
</div>
<div class="section level4">
<h4 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h4>
<p>The summary of the model includes convergence, goodness of fit
criteria and estimated parameters.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">summary</span>(mult_betaspl) </span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>General latent class mixed model </span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>     fitted by maximum likelihood method </span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a> </span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="fu">multlcmm</span>(<span class="at">fixed =</span> MMSE <span class="sc">+</span> IST <span class="sc">+</span> BVRT <span class="sc">~</span> age75 <span class="sc">+</span> male <span class="sc">+</span> time <span class="sc">+</span> <span class="fu">I</span>(time<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>    <span class="fu">contrast</span>(male), <span class="at">random =</span> <span class="sc">~</span>time <span class="sc">+</span> <span class="fu">I</span>(time<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">10</span>), <span class="at">subject =</span> <span class="st">"ID"</span>, </span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>    <span class="at">randomY =</span> <span class="cn">TRUE</span>, <span class="at">link =</span> <span class="fu">c</span>(<span class="st">"beta"</span>, <span class="st">"3-quant-splines"</span>, <span class="st">"3-quant-splines"</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>    ), <span class="at">cor =</span> <span class="fu">BM</span>(time), <span class="at">data =</span> paquid)</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a> </span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>Statistical Model<span class="sc">:</span> </span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>     Dataset<span class="sc">:</span> paquid </span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>     Number of subjects<span class="sc">:</span> <span class="dv">500</span> </span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>     Number of observations<span class="sc">:</span> <span class="dv">6216</span> </span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>     Number of latent classes<span class="sc">:</span> <span class="dv">1</span> </span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>     Number of parameters<span class="sc">:</span> <span class="dv">32</span>  </span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>     Link functions<span class="sc">:</span> Standardised Beta CdF <span class="cf">for</span> MMSE  </span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>                     Quadratic I<span class="sc">-</span>splines with nodes <span class="dv">5</span> <span class="dv">27</span> <span class="dv">40</span> <span class="cf">for</span> IST </span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>                     Quadratic I<span class="sc">-</span>splines with nodes <span class="dv">0</span> <span class="dv">11</span> <span class="dv">15</span> <span class="cf">for</span> BVRT </span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a> </span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>Iteration process<span class="sc">:</span> </span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>     Convergence criteria satisfied </span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>     Number of iterations<span class="sc">:</span>  <span class="dv">31</span> </span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>     Convergence criteria<span class="sc">:</span> parameters<span class="ot">=</span> <span class="fl">1e-07</span> </span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>                         <span class="sc">:</span> likelihood<span class="ot">=</span> <span class="fl">1.5e-07</span> </span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a>                         <span class="sc">:</span> second derivatives<span class="ot">=</span> <span class="fl">5.1e-12</span> </span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a> </span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a>Goodness<span class="sc">-</span>of<span class="sc">-</span>fit statistics<span class="sc">:</span> </span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a>     maximum log<span class="sc">-</span>likelihood<span class="sc">:</span> <span class="sc">-</span><span class="fl">14373.66</span>  </span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a>     AIC<span class="sc">:</span> <span class="fl">28811.33</span>  </span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a>     BIC<span class="sc">:</span> <span class="fl">28946.2</span>  </span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a> </span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a>Maximum Likelihood Estimates<span class="sc">:</span> </span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a> </span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a>Fixed effects <span class="cf">in</span> the longitudinal model<span class="sc">:</span></span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a></span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a>                                coef      Se   Wald p<span class="sc">-</span>value</span>
<span id="cb12-37"><a href="#cb12-37" tabindex="-1"></a><span class="fu">intercept</span> (not estimated)    <span class="fl">0.00000</span>                       </span>
<span id="cb12-38"><a href="#cb12-38" tabindex="-1"></a>age75                       <span class="sc">-</span><span class="fl">1.09189</span> <span class="fl">0.11368</span> <span class="sc">-</span><span class="fl">9.605</span> <span class="fl">0.00000</span></span>
<span id="cb12-39"><a href="#cb12-39" tabindex="-1"></a>male                         <span class="fl">0.14430</span> <span class="fl">0.11934</span>  <span class="fl">1.209</span> <span class="fl">0.22659</span></span>
<span id="cb12-40"><a href="#cb12-40" tabindex="-1"></a>time                        <span class="sc">-</span><span class="fl">1.24025</span> <span class="fl">0.19076</span> <span class="sc">-</span><span class="fl">6.502</span> <span class="fl">0.00000</span></span>
<span id="cb12-41"><a href="#cb12-41" tabindex="-1"></a><span class="fu">I</span>(time<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">10</span>)                <span class="sc">-</span><span class="fl">2.39711</span> <span class="fl">0.98528</span> <span class="sc">-</span><span class="fl">2.433</span> <span class="fl">0.01498</span></span>
<span id="cb12-42"><a href="#cb12-42" tabindex="-1"></a>Contrasts on <span class="fu">male</span> (<span class="at">p=</span><span class="fl">3e-04</span>)                                </span>
<span id="cb12-43"><a href="#cb12-43" tabindex="-1"></a>MMSE                        <span class="sc">-</span><span class="fl">0.07360</span> <span class="fl">0.06931</span> <span class="sc">-</span><span class="fl">1.062</span> <span class="fl">0.28829</span></span>
<span id="cb12-44"><a href="#cb12-44" tabindex="-1"></a>IST                         <span class="sc">-</span><span class="fl">0.26698</span> <span class="fl">0.07854</span> <span class="sc">-</span><span class="fl">3.399</span> <span class="fl">0.00068</span></span>
<span id="cb12-45"><a href="#cb12-45" tabindex="-1"></a>BVRT<span class="sc">**</span>                       <span class="fl">0.34058</span> <span class="fl">0.08810</span>  <span class="fl">3.866</span> <span class="fl">0.00011</span></span>
<span id="cb12-46"><a href="#cb12-46" tabindex="-1"></a></span>
<span id="cb12-47"><a href="#cb12-47" tabindex="-1"></a></span>
<span id="cb12-48"><a href="#cb12-48" tabindex="-1"></a>Variance<span class="sc">-</span>covariance matrix of the random<span class="sc">-</span>effects<span class="sc">:</span></span>
<span id="cb12-49"><a href="#cb12-49" tabindex="-1"></a>(the variance of the first random effect is not estimated)</span>
<span id="cb12-50"><a href="#cb12-50" tabindex="-1"></a>             intercept     time <span class="fu">I</span>(time<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb12-51"><a href="#cb12-51" tabindex="-1"></a>intercept      <span class="fl">1.00000</span>                      </span>
<span id="cb12-52"><a href="#cb12-52" tabindex="-1"></a>time           <span class="fl">0.05618</span>  <span class="fl">1.53473</span>             </span>
<span id="cb12-53"><a href="#cb12-53" tabindex="-1"></a><span class="fu">I</span>(time<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">10</span>)  <span class="sc">-</span><span class="fl">0.77856</span> <span class="sc">-</span><span class="fl">5.22729</span>     <span class="fl">32.31854</span></span>
<span id="cb12-54"><a href="#cb12-54" tabindex="-1"></a></span>
<span id="cb12-55"><a href="#cb12-55" tabindex="-1"></a>                       coef      Se</span>
<span id="cb12-56"><a href="#cb12-56" tabindex="-1"></a>BM standard error<span class="sc">:</span>  <span class="fl">0.98003</span> <span class="fl">0.13326</span></span>
<span id="cb12-57"><a href="#cb12-57" tabindex="-1"></a></span>
<span id="cb12-58"><a href="#cb12-58" tabindex="-1"></a>                                         MMSE      IST     BVRT</span>
<span id="cb12-59"><a href="#cb12-59" tabindex="-1"></a>Residual standard error<span class="sc">:</span>              <span class="fl">1.01982</span>  <span class="fl">0.93048</span>  <span class="fl">1.42284</span></span>
<span id="cb12-60"><a href="#cb12-60" tabindex="-1"></a>Standard error of the random effect<span class="sc">:</span>  <span class="fl">0.57605</span>  <span class="fl">0.85186</span>  <span class="fl">0.89027</span></span>
<span id="cb12-61"><a href="#cb12-61" tabindex="-1"></a></span>
<span id="cb12-62"><a href="#cb12-62" tabindex="-1"></a>Parameters of the link functions<span class="sc">:</span></span>
<span id="cb12-63"><a href="#cb12-63" tabindex="-1"></a></span>
<span id="cb12-64"><a href="#cb12-64" tabindex="-1"></a>                    coef      Se    Wald p<span class="sc">-</span>value</span>
<span id="cb12-65"><a href="#cb12-65" tabindex="-1"></a>MMSE<span class="sc">-</span>Beta1       <span class="fl">1.41416</span> <span class="fl">0.07051</span>  <span class="fl">20.056</span> <span class="fl">0.00000</span></span>
<span id="cb12-66"><a href="#cb12-66" tabindex="-1"></a>MMSE<span class="sc">-</span>Beta2      <span class="sc">-</span><span class="fl">0.25052</span> <span class="fl">0.08346</span>  <span class="sc">-</span><span class="fl">3.002</span> <span class="fl">0.00269</span></span>
<span id="cb12-67"><a href="#cb12-67" tabindex="-1"></a>MMSE<span class="sc">-</span>Beta3       <span class="fl">0.45879</span> <span class="fl">0.02586</span>  <span class="fl">17.741</span> <span class="fl">0.00000</span></span>
<span id="cb12-68"><a href="#cb12-68" tabindex="-1"></a>MMSE<span class="sc">-</span>Beta4       <span class="fl">0.06439</span> <span class="fl">0.00580</span>  <span class="fl">11.095</span> <span class="fl">0.00000</span></span>
<span id="cb12-69"><a href="#cb12-69" tabindex="-1"></a>IST<span class="sc">-</span>I<span class="sc">-</span>splines1  <span class="sc">-</span><span class="fl">6.51526</span> <span class="fl">0.52193</span> <span class="sc">-</span><span class="fl">12.483</span> <span class="fl">0.00000</span></span>
<span id="cb12-70"><a href="#cb12-70" tabindex="-1"></a>IST<span class="sc">-</span>I<span class="sc">-</span>splines2   <span class="fl">1.10955</span> <span class="fl">0.15664</span>   <span class="fl">7.083</span> <span class="fl">0.00000</span></span>
<span id="cb12-71"><a href="#cb12-71" tabindex="-1"></a>IST<span class="sc">-</span>I<span class="sc">-</span>splines3   <span class="fl">2.14896</span> <span class="fl">0.09800</span>  <span class="fl">21.928</span> <span class="fl">0.00000</span></span>
<span id="cb12-72"><a href="#cb12-72" tabindex="-1"></a>IST<span class="sc">-</span>I<span class="sc">-</span>splines4   <span class="fl">1.56009</span> <span class="fl">0.08373</span>  <span class="fl">18.633</span> <span class="fl">0.00000</span></span>
<span id="cb12-73"><a href="#cb12-73" tabindex="-1"></a>IST<span class="sc">-</span>I<span class="sc">-</span>splines5   <span class="fl">1.44628</span> <span class="fl">0.07305</span>  <span class="fl">19.799</span> <span class="fl">0.00000</span></span>
<span id="cb12-74"><a href="#cb12-74" tabindex="-1"></a>BVRT<span class="sc">-</span>I<span class="sc">-</span>splines1 <span class="sc">-</span><span class="fl">7.31210</span> <span class="fl">0.68892</span> <span class="sc">-</span><span class="fl">10.614</span> <span class="fl">0.00000</span></span>
<span id="cb12-75"><a href="#cb12-75" tabindex="-1"></a>BVRT<span class="sc">-</span>I<span class="sc">-</span>splines2  <span class="fl">1.13661</span> <span class="fl">0.26027</span>   <span class="fl">4.367</span> <span class="fl">0.00001</span></span>
<span id="cb12-76"><a href="#cb12-76" tabindex="-1"></a>BVRT<span class="sc">-</span>I<span class="sc">-</span>splines3  <span class="fl">1.97351</span> <span class="fl">0.12641</span>  <span class="fl">15.611</span> <span class="fl">0.00000</span></span>
<span id="cb12-77"><a href="#cb12-77" tabindex="-1"></a>BVRT<span class="sc">-</span>I<span class="sc">-</span>splines4  <span class="fl">2.08216</span> <span class="fl">0.09703</span>  <span class="fl">21.459</span> <span class="fl">0.00000</span></span>
<span id="cb12-78"><a href="#cb12-78" tabindex="-1"></a>BVRT<span class="sc">-</span>I<span class="sc">-</span>splines5  <span class="fl">1.58945</span> <span class="fl">0.07545</span>  <span class="fl">21.065</span> <span class="fl">0.00000</span></span>
<span id="cb12-79"><a href="#cb12-79" tabindex="-1"></a></span>
<span id="cb12-80"><a href="#cb12-80" tabindex="-1"></a> <span class="sc">**</span> coefficient not estimated but obtained from the others as minus the sum of them </span>
<span id="cb12-81"><a href="#cb12-81" tabindex="-1"></a> </span></code></pre></div>
<p>From the estimates, the underlying cognition has a quadratic
trajectory over time, older subjects at baseline have systematically
lower cognitive level. There is no difference according to gender.
However, there are significantly differential effects of gender on
psychometric tests (p=0.0003) with a systematically higher BVRT for men
and higher IST levels for women.</p>
</div>
<div class="section level4">
<h4 id="variance-explained">Variance explained<a class="anchor" aria-label="anchor" href="#variance-explained"></a>
</h4>
<p>For multivariate data, the latent process is the common underlying
factor of the different markers. Thus, we can compute the residual
variance of each marker explained the latent process. This variance
explained is conditional on the covariates and computed for a specific
time.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">VarExpl</span>(mult_betaspl, <span class="fu">data.frame</span>(<span class="at">time=</span><span class="dv">0</span>))</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>            class1</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>%Var<span class="sc">-</span>MMSE <span class="fl">42.16100</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>%Var<span class="sc">-</span>IST  <span class="fl">38.58841</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>%Var<span class="sc">-</span>BVRT <span class="fl">26.19821</span></span></code></pre></div>
<p>For example, the common factor explained 42% of MMSE residual
variation while it explained 26% of the BVRT residual variation at time
0.</p>
</div>
<div class="section level4">
<h4 id="graph-of-predicted-trajectories-for-the-markers">Graph of predicted trajectories for the markers<a class="anchor" aria-label="anchor" href="#graph-of-predicted-trajectories-for-the-markers"></a>
</h4>
<p>As with lcmm function, predicted trajectories of the markers can be
computed according to a covariate profile and then plotted.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datnew</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.08</span>,<span class="fl">2.2</span>,length<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">age_init</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">65</span>,<span class="fl">95</span>, length<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">age75</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">datnew</span><span class="op">$</span><span class="va">age_init</span> <span class="op">-</span> <span class="fl">75</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">male</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">predict_women</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">mult_betaspl</span>,newdata<span class="op">=</span><span class="va">datnew</span>,var.time<span class="op">=</span><span class="st">'time'</span>,draws<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">male</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">predict_men</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">mult_betaspl</span>,newdata<span class="op">=</span><span class="va">datnew</span>,var.time<span class="op">=</span><span class="st">'time'</span>,draws<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">predict_women</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, type<span class="op">=</span><span class="st">'l'</span>, col<span class="op">=</span><span class="fl">6</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">'time since entry (in decades)'</span>, ylab<span class="op">=</span><span class="st">'Marker'</span>, bty<span class="op">=</span><span class="st">'l'</span>, legend<span class="op">=</span><span class="cn">NULL</span>, shades<span class="op">=</span><span class="cn">TRUE</span>, outcome <span class="op">=</span> <span class="fl">1</span>, main<span class="op">=</span><span class="st">'Mean predicted trajectory for MMSE'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">predict_men</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, type<span class="op">=</span><span class="st">'l'</span>, col<span class="op">=</span><span class="fl">3</span>, shades<span class="op">=</span><span class="cn">TRUE</span>, outcome <span class="op">=</span> <span class="fl">1</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">30</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Women"</span>, <span class="st">"Men"</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">3</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, cex<span class="op">=</span><span class="fl">0.8</span>,bty<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">predict_women</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, type<span class="op">=</span><span class="st">'l'</span>, col<span class="op">=</span><span class="fl">6</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">40</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">'time since entry (in decades)'</span>, ylab<span class="op">=</span><span class="st">'Marker'</span>, bty<span class="op">=</span><span class="st">'l'</span>, legend<span class="op">=</span><span class="cn">NULL</span>, shades<span class="op">=</span><span class="cn">TRUE</span>, outcome <span class="op">=</span> <span class="fl">2</span>, main<span class="op">=</span><span class="st">'Mean predicted trajectory for IST'</span><span class="op">)</span> </span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">predict_men</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, type<span class="op">=</span><span class="st">'l'</span>, col<span class="op">=</span><span class="fl">3</span>, shades<span class="op">=</span><span class="cn">TRUE</span>, outcome <span class="op">=</span> <span class="fl">2</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">predict_women</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, type<span class="op">=</span><span class="st">'l'</span>, col<span class="op">=</span><span class="fl">6</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">15</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">'time since entry (in decades)'</span>, ylab<span class="op">=</span><span class="st">'Marker'</span>, bty<span class="op">=</span><span class="st">'l'</span>, legend<span class="op">=</span><span class="cn">NULL</span>, shades<span class="op">=</span><span class="cn">TRUE</span>, outcome <span class="op">=</span> <span class="fl">3</span>, main<span class="op">=</span><span class="st">'Mean predicted trajectory for BVRT'</span><span class="op">)</span> </span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">predict_men</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, type<span class="op">=</span><span class="st">'l'</span>, col<span class="op">=</span><span class="fl">3</span>, shades<span class="op">=</span><span class="cn">TRUE</span>, outcome <span class="op">=</span> <span class="fl">3</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_process_model_with_multlcmm_files/figure-html/unnamed-chunk-8-1.png" width="768" style="display: block; margin: auto;"></p>
<p> </p>
</div>
<div class="section level4">
<h4 id="goodness-of-fit-graph-of-the-residuals">Goodness of fit: graph of the residuals<a class="anchor" aria-label="anchor" href="#goodness-of-fit-graph-of-the-residuals"></a>
</h4>
<p>As in any mixed model, we expect the subject-specicif residuals
(bottom right panel) to be Gaussian.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mult_betaspl</span>, cex.main<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="goodness-of-fit-graph-of-the-predictions-versus-observations">Goodness of fit: graph of the predictions versus observations<a class="anchor" aria-label="anchor" href="#goodness-of-fit-graph-of-the-predictions-versus-observations"></a>
</h4>
<p>The mean predictions and observations can be plotted according to
time. Note that the predictions and observations are in the scale of the
latent process (observations are transformed with the estimated link
functions):</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mult_betaspl</span>, which<span class="op">=</span><span class="st">"fit"</span>, var.time<span class="op">=</span><span class="st">"time"</span>, bty<span class="op">=</span><span class="st">"l"</span>, xlab<span class="op">=</span><span class="st">"time since entry (in decades)"</span>, cex.lab<span class="op">=</span><span class="fl">1.1</span>, break.times<span class="op">=</span><span class="fl">8</span>, ylab<span class="op">=</span><span class="st">"latent process"</span>, lwd<span class="op">=</span><span class="fl">2</span>, marg<span class="op">=</span><span class="cn">FALSE</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">0.0</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">2</span><span class="op">)</span>, shades <span class="op">=</span> <span class="cn">TRUE</span>, outcome <span class="op">=</span> <span class="fl">1</span>, col<span class="op">=</span><span class="fl">2</span>, main<span class="op">=</span><span class="st">"MMSE predictions vs observations"</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mult_betaspl</span>, which<span class="op">=</span><span class="st">"fit"</span>, var.time<span class="op">=</span><span class="st">"time"</span>, bty<span class="op">=</span><span class="st">"l"</span>, xlab<span class="op">=</span><span class="st">"time since entry (in decades)"</span>, cex.lab<span class="op">=</span><span class="fl">1.1</span>, break.times<span class="op">=</span><span class="fl">8</span>, ylab<span class="op">=</span><span class="st">"latent process"</span>, lwd<span class="op">=</span><span class="fl">2</span>, marg<span class="op">=</span><span class="cn">FALSE</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">0.3</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">2</span><span class="op">)</span>, shades <span class="op">=</span> <span class="cn">TRUE</span>, outcome <span class="op">=</span> <span class="fl">2</span>, col<span class="op">=</span><span class="fl">3</span>, main<span class="op">=</span><span class="st">"IST predictions vs observations"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mult_betaspl</span>, which<span class="op">=</span><span class="st">"fit"</span>, var.time<span class="op">=</span><span class="st">"time"</span>, bty<span class="op">=</span><span class="st">"l"</span>, xlab<span class="op">=</span><span class="st">"time since entry (in decades)"</span>, cex.lab<span class="op">=</span><span class="fl">1.1</span>, break.times<span class="op">=</span><span class="fl">8</span>, ylab<span class="op">=</span><span class="st">"latent process"</span>, lwd<span class="op">=</span><span class="fl">2</span>, marg<span class="op">=</span><span class="cn">FALSE</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>,<span class="fl">0.5</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">2</span><span class="op">)</span>, shades <span class="op">=</span> <span class="cn">TRUE</span>, outcome <span class="op">=</span> <span class="fl">3</span>, col<span class="op">=</span><span class="fl">4</span>, main<span class="op">=</span><span class="st">"BVRT predictions vs observations"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="latent_process_model_with_multlcmm_files/figure-html/unnamed-chunk-10-1.png" width="768" style="display: block; margin: auto;"></p>
<p> </p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="to-go-further">To go further …<a class="anchor" aria-label="anchor" href="#to-go-further"></a>
</h2>
<div class="section level3">
<h3 id="heterogeneous-profiles-of-trajectories">heterogeneous profiles of trajectories<a class="anchor" aria-label="anchor" href="#heterogeneous-profiles-of-trajectories"></a>
</h3>
<p>The latent process mixed model for multivariate markers extends to
the heterogeneous case with latent classes. The same strategy as
explained with <a href="latent_class_model_with_hlme.html">hlme</a> can
be used.</p>
</div>
<div class="section level3">
<h3 id="joint-analysis-of-a-time-to-event">joint analysis of a time to event<a class="anchor" aria-label="anchor" href="#joint-analysis-of-a-time-to-event"></a>
</h3>
<p>The latent process mixed model for multivariate markers extends to
the case of a joint model. This is done in <a href="joint_latent_class_model_with_Jointlcmm.html">Jointlcmm when one
latent process is involved</a> or mpjlcmm when <a href="multivariate_latent_class_model_with_mpjlcmm.html">multivariate
latent processes are considered</a>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cecile Proust-Lima, Viviane Philipps.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
