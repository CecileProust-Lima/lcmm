<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="lcmm">
<title>How to estimate a multivariate latent class mixed model using mpjlcmm function • lcmm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to estimate a multivariate latent class mixed model using mpjlcmm function">
<meta property="og:description" content="lcmm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">lcmm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/lcmm.html">GET STARTED</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">VIGNETTES</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/latent_class_model_with_hlme.html">How to estimate a latent class mixed model using hlme function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_lcmm.html">How to estimate a latent process mixed model using lcmm function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm.html">How to estimate a latent process mixed model for multivariate markers using multlcmm function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm_IRT.html">Continuous-time longitudinal IRT model</a>
    <a class="dropdown-item" href="../articles/joint_latent_class_model_with_Jointlcmm.html">How to estimate a joint latent class mixed model using Jointlcmm function</a>
    <a class="dropdown-item" href="../articles/multivariate_latent_class_model_with_mpjlcmm.html">How to estimate a multivariate latent class mixed model using mpjlcmm function</a>
    <a class="dropdown-item" href="../articles/pre_normalizing.html">Pre-normalizing a dependent variable using lcmm</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/usual_problems.html">FAQ</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">REFERENCE</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">CHANGELOG</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/CecileProust-Lima/lcmm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">

<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>How to estimate a multivariate latent class mixed model using mpjlcmm function</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CecileProust-Lima/lcmm/blob/HEAD/vignettes/multivariate_latent_class_model_with_mpjlcmm.Rmd" class="external-link"><code>vignettes/multivariate_latent_class_model_with_mpjlcmm.Rmd</code></a></small>
      <div class="d-none name"><code>multivariate_latent_class_model_with_mpjlcmm.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background-and-definitions">Background and definitions<a class="anchor" aria-label="anchor" href="#background-and-definitions"></a>
</h2>
<p align="justify">
The latent class mixed model consists in assuming that the population is heterogeneous and composed of <span class="math inline">\(G\)</span> latent classes. In the multivariate case, the latent classes are defined according to <span class="math inline">\(K\)</span> longitudinal outcomes, resulting in <span class="math inline">\(G\)</span> groups characterized by <span class="math inline">\(G\)</span> sets of <span class="math inline">\(K\)</span> mean profiles of trajectories.
</p>
<div class="section level3">
<h3 id="the-multivariate-latent-class-mixed-model">The multivariate latent class mixed model<a class="anchor" aria-label="anchor" href="#the-multivariate-latent-class-mixed-model"></a>
</h3>
<p align="justify">
</p>
<p>Latent class membership is defined by a discrete random variable <span class="math inline">\(c_{i}\)</span> that equals <span class="math inline">\(g\)</span> if subject <span class="math inline">\(i\)</span> belongs to latent class <span class="math inline">\(g\)</span> (<span class="math inline">\(g\)</span> = 1, …,<span class="math inline">\(G\)</span>). The variable <span class="math inline">\(c_{i}\)</span> is latent; its probability is described using a multinomial logistic model according to covariates <span class="math inline">\(X_{ci}\)</span>:</p>
<p><span class="math inline">\(\pi_{ig}= P(c_{i} = g|X_{ci}) = \frac{\exp(\xi_{0g}+X_{ci}\xi_{1g})}{ \sum_{l=1}^{G}\exp(\xi_{0l}+X_{ci}\xi_{1l})}\)</span></p>
where <span class="math inline">\(\xi_{0g}\)</span> is the intercept for class <span class="math inline">\(g\)</span> and <span class="math inline">\(\xi_{1g}\)</span> is the q1-vector of class-specific parameters associated with the q1-vector of time-independent covariates <span class="math inline">\(X_{ci}\)</span>. For identifiability, <span class="math inline">\(\xi_{0G} = 0\)</span> and <span class="math inline">\(\xi_{1G} = 0\)</span>. When no covariate predicts the latent class membership, this model reduces to a class-specific probability.

<p align="justify">
The trajectories of each <span class="math inline">\(Y_k\)</span> for <span class="math inline">\(k=1,..,K\)</span> are defined conditionally to the latent class. For Gaussian outcomes, conditional on class <span class="math inline">\(g\)</span>, the model is a linear mixed model defined for subject <span class="math inline">\(i\)</span> at occasion <span class="math inline">\(j\)</span> by:
</p>
<p><span class="math display">\[Y_{kij}|_{c_{i}=g} = X_{2kij}\beta_k+X_{3kij}\gamma_{kg}+Z_{kij}b_{ki}+\epsilon_{kij}\]</span></p>
<p align="justify">
where <span class="math inline">\(X_{2kij}\)</span>, <span class="math inline">\(X_{3kij}\)</span> and <span class="math inline">\(Z_{kij}\)</span> are vectors of covariates respectively associated with common fixed effects over classes <span class="math inline">\(\beta_k\)</span>, class-specific fixed effects <span class="math inline">\(\gamma_{kg}\)</span> and with individual random effects <span class="math inline">\(b_{ki}|_{ci=g}\)</span> called <span class="math inline">\(b_{kig}\)</span> whose distributions are now class-specific. <span class="math inline">\(X_{2k}\)</span> and <span class="math inline">\(X_{3k}\)</span> can’t have common variables.
</p>
<p align="justify">
Neither the random effects nor the error measurements are correlated between outcomes. So conditionally to the latent classes the <span class="math inline">\(K\)</span> outcomes are independent.
</p>
<p> </p>
For curvilinear outcomes, we use a latent process model defined by:

<p> </p>
<p><span class="math display">\[Y_{ijk}|_{c_{i}=g} = H_k(~ X_{2ijk}\beta_k+X_{3ijk}\gamma_{gk}+Z_{ijk}b_{ik}+\epsilon_{ijk} ~; \eta_k)\]</span></p>
<p> </p>
<p>where <span class="math inline">\(H_k\)</span> is a link function parameterized by <span class="math inline">\(\eta_k\)</span>. <span class="math inline">\(H^{-1}\)</span> can belong to the family of linear functions, rescaled Beta cumulative distribution function, or quadractic I-splines functions. Note however that the mpjlcmm function only supports continuous outcomes, so the IRT models are not available for the moment.</p>
<p> </p>
</div>
<div class="section level3">
<h3 id="posterior-classification">Posterior classification<a class="anchor" aria-label="anchor" href="#posterior-classification"></a>
</h3>
<p align="justify">
In models involving latent classes, a posterior classification of the subjects in each latent class can be made. It is based on the posterior calculation of the class-membership probabilities and is used to characterize the classification of the subjects as well as to evaluate the goodness-of-fit of the model.
</p>
<p align="justify">
Posterior class-membership probabilities are computed using the Bayes theorem as the probability of belonging to a latent class given the whole information collected. In a longitudinal model, they are defined for subject <span class="math inline">\(i\)</span> and latent class <span class="math inline">\(g\)</span> as:
</p>
<p> </p>
<p><span class="math display">\[\hat{\pi}_{ig}^Y=P(c_{i}=g|X_{i},Y_{i},\hat{\theta}_{G})\]</span></p>
<p><em>where :</em> <span class="math inline">\(\hat{\theta}_{G}\)</span> is the vector of parameters estimated in the <span class="math inline">\(G\)</span> latent class model.</p>
<p> </p>
<p> </p>
</div>
</div>
<div class="section level2">
<h2 id="a-bivariate-example">A bivariate example<a class="anchor" aria-label="anchor" href="#a-bivariate-example"></a>
</h2>
<p align="justify">
In this example we study simultaneously the trajectories of a cognitive marker (<strong>MMSE</strong>) and a depression scale (<strong>CESD</strong>) in a sample of old people (aged 65 years old and over at inclusion) followed for up to 15 years. The two outcomes have a skewed distribution, so we will use latent process models with I-splines link functions.
</p>
<div class="section level3">
<h3 id="model-considered">Model considered<a class="anchor" aria-label="anchor" href="#model-considered"></a>
</h3>
<p align="justify">
We consider class specific linear trajectories with age without further ajustement. For class <span class="math inline">\(g\)</span>, subejct <span class="math inline">\(i\)</span> and repeated measurement <span class="math inline">\(j\)</span>, the model is:
</p>
<p> </p>
<p><span class="math display">\[MMSE_{ij}|_{c_{i}=g}=\beta_{10g}+\beta_{11g}age_{ij}+u_{10ig}+u_{11ig}age_{ij}+\epsilon_{1ij}\]</span></p>
<p><span class="math display">\[CESD_{ij}|_{c_{i}=g}=\beta_{20g}+\beta_{21g}age_{ij}+u_{20ig}+u_{21ig}age_{ij}+\epsilon_{2ij}\]</span></p>
<p> </p>
<p><em>Where :</em> <span class="math inline">\(u_{kig} \sim \mathcal{N}(0,B_{kg})\)</span> and <span class="math inline">\(\epsilon_{ij} \sim \mathcal{N}(0,\sigma^2)\)</span>.</p>
<p> </p>
</div>
<div class="section level3">
<h3 id="estimate-the-model-with-only-one-class-g1">Estimate the model with only one class (G=1)<a class="anchor" aria-label="anchor" href="#estimate-the-model-with-only-one-class-g1"></a>
</h3>
<p>To estimate a multivariate model, we define first each univariate submodel with the appropriate function. As we use here latent process models, we use the lcmm function.</p>
<p> </p>
<p>We begin with the MMSE :</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">mMMSE &lt;-<span class="st"> </span><span class="kw">lcmm</span>(MMSE <span class="op">~</span><span class="st"> </span><span class="kw">I</span>((age<span class="dv">-65</span>)<span class="op">/</span><span class="dv">10</span>), <span class="dt">random =</span><span class="op">~</span><span class="kw">I</span>((age<span class="dv">-65</span>)<span class="op">/</span><span class="dv">10</span>), <span class="dt">subject=</span><span class="st">'ID'</span>, <span class="dt">data =</span> paquid,</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">              <span class="dt">link =</span><span class="st">"5-quant-splines"</span>, <span class="dt">verbose=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">summary</span>(mMMSE)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">General latent class mixed model </a>
<a class="sourceLine" id="cb1-5" data-line-number="5">     fitted by maximum likelihood method </a>
<a class="sourceLine" id="cb1-6" data-line-number="6"> </a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw">lcmm</span>(<span class="dt">fixed =</span> MMSE <span class="op">~</span><span class="st"> </span><span class="kw">I</span>((age <span class="op">-</span><span class="st"> </span><span class="dv">65</span>)<span class="op">/</span><span class="dv">10</span>), <span class="dt">random =</span> <span class="op">~</span><span class="kw">I</span>((age <span class="op">-</span><span class="st"> </span><span class="dv">65</span>)<span class="op">/</span><span class="dv">10</span>), </a>
<a class="sourceLine" id="cb1-8" data-line-number="8">    <span class="dt">subject =</span> <span class="st">"ID"</span>, <span class="dt">link =</span> <span class="st">"5-quant-splines"</span>, <span class="dt">data =</span> paquid, </a>
<a class="sourceLine" id="cb1-9" data-line-number="9">    <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"> </a>
<a class="sourceLine" id="cb1-11" data-line-number="11">Statistical Model<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="st">     </span>Dataset<span class="op">:</span><span class="st"> </span>paquid </a>
<a class="sourceLine" id="cb1-13" data-line-number="13">     Number of subjects<span class="op">:</span><span class="st"> </span><span class="dv">500</span> </a>
<a class="sourceLine" id="cb1-14" data-line-number="14">     Number of observations<span class="op">:</span><span class="st"> </span><span class="dv">2214</span> </a>
<a class="sourceLine" id="cb1-15" data-line-number="15">     Number of observations deleted<span class="op">:</span><span class="st"> </span><span class="dv">36</span> </a>
<a class="sourceLine" id="cb1-16" data-line-number="16">     Number of latent classes<span class="op">:</span><span class="st"> </span><span class="dv">1</span> </a>
<a class="sourceLine" id="cb1-17" data-line-number="17">     Number of parameters<span class="op">:</span><span class="st"> </span><span class="dv">11</span>  </a>
<a class="sourceLine" id="cb1-18" data-line-number="18">     Link <span class="cf">function</span><span class="op">:</span><span class="st"> </span>Quadratic I<span class="op">-</span>splines with nodes  </a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="dv">0</span> <span class="dv">25</span> <span class="dv">27</span> <span class="dv">29</span> <span class="dv">30</span>  </a>
<a class="sourceLine" id="cb1-20" data-line-number="20"> </a>
<a class="sourceLine" id="cb1-21" data-line-number="21">Iteration process<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="st">     </span>Convergence criteria satisfied </a>
<a class="sourceLine" id="cb1-23" data-line-number="23">     Number of iterations<span class="op">:</span><span class="st">  </span><span class="dv">32</span> </a>
<a class="sourceLine" id="cb1-24" data-line-number="24">     Convergence criteria<span class="op">:</span><span class="st"> </span>parameters=<span class="st"> </span><span class="fl">1.5e-08</span> </a>
<a class="sourceLine" id="cb1-25" data-line-number="25">                         <span class="op">:</span><span class="st"> </span>likelihood=<span class="st"> </span><span class="fl">1.4e-06</span> </a>
<a class="sourceLine" id="cb1-26" data-line-number="26">                         <span class="op">:</span><span class="st"> </span>second derivatives=<span class="st"> </span><span class="fl">1.2e-07</span> </a>
<a class="sourceLine" id="cb1-27" data-line-number="27"> </a>
<a class="sourceLine" id="cb1-28" data-line-number="28">Goodness<span class="op">-</span>of<span class="op">-</span>fit statistics<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="st">     </span>maximum log<span class="op">-</span>likelihood<span class="op">:</span><span class="st"> </span><span class="fl">-4687.54</span>  </a>
<a class="sourceLine" id="cb1-30" data-line-number="30">     AIC<span class="op">:</span><span class="st"> </span><span class="fl">9397.08</span>  </a>
<a class="sourceLine" id="cb1-31" data-line-number="31">     BIC<span class="op">:</span><span class="st"> </span><span class="fl">9443.45</span>  </a>
<a class="sourceLine" id="cb1-32" data-line-number="32"> </a>
<a class="sourceLine" id="cb1-33" data-line-number="33">     Discrete posterior log<span class="op">-</span>likelihood<span class="op">:</span><span class="st"> </span><span class="fl">-4677.75</span>  </a>
<a class="sourceLine" id="cb1-34" data-line-number="34">     Discrete AIC<span class="op">:</span><span class="st"> </span><span class="fl">9377.5</span>  </a>
<a class="sourceLine" id="cb1-35" data-line-number="35"> </a>
<a class="sourceLine" id="cb1-36" data-line-number="36">     Mean discrete AIC per subject<span class="op">:</span><span class="st"> </span><span class="fl">9.3775</span>  </a>
<a class="sourceLine" id="cb1-37" data-line-number="37">     Mean UACV per subject<span class="op">:</span><span class="st"> </span><span class="fl">9.3762</span>  </a>
<a class="sourceLine" id="cb1-38" data-line-number="38">     Mean discrete LL per subject<span class="op">:</span><span class="st"> </span><span class="fl">-9.3555</span>  </a>
<a class="sourceLine" id="cb1-39" data-line-number="39"> </a>
<a class="sourceLine" id="cb1-40" data-line-number="40">Maximum Likelihood Estimates<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-41" data-line-number="41"><span class="st"> </span></a>
<a class="sourceLine" id="cb1-42" data-line-number="42">Fixed effects <span class="cf">in</span> the longitudinal model<span class="op">:</span></a>
<a class="sourceLine" id="cb1-43" data-line-number="43"></a>
<a class="sourceLine" id="cb1-44" data-line-number="44"><span class="st">                              </span>coef      Se    Wald p<span class="op">-</span>value</a>
<a class="sourceLine" id="cb1-45" data-line-number="45"><span class="kw">intercept</span> (not estimated)        <span class="dv">0</span>                        </a>
<a class="sourceLine" id="cb1-46" data-line-number="46"><span class="kw">I</span>((age <span class="op">-</span><span class="st"> </span><span class="dv">65</span>)<span class="op">/</span><span class="dv">10</span>)          <span class="fl">-1.19894</span> <span class="fl">0.07188</span> <span class="fl">-16.681</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb1-47" data-line-number="47"></a>
<a class="sourceLine" id="cb1-48" data-line-number="48"></a>
<a class="sourceLine" id="cb1-49" data-line-number="49">Variance<span class="op">-</span>covariance matrix of the random<span class="op">-</span>effects<span class="op">:</span></a>
<a class="sourceLine" id="cb1-50" data-line-number="50"><span class="st">                 </span>intercept <span class="kw">I</span>((age <span class="op">-</span><span class="st"> </span><span class="dv">65</span>)<span class="op">/</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb1-51" data-line-number="51">intercept          <span class="fl">2.23236</span>                 </a>
<a class="sourceLine" id="cb1-52" data-line-number="52"><span class="kw">I</span>((age <span class="op">-</span><span class="st"> </span><span class="dv">65</span>)<span class="op">/</span><span class="dv">10</span>)  <span class="fl">-0.90184</span>          <span class="fl">0.86839</span></a>
<a class="sourceLine" id="cb1-53" data-line-number="53"></a>
<a class="sourceLine" id="cb1-54" data-line-number="54">Residual standard <span class="kw">error</span> (not estimated) =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1-55" data-line-number="55"></a>
<a class="sourceLine" id="cb1-56" data-line-number="56">Parameters of the link <span class="cf">function</span><span class="op">:</span></a>
<a class="sourceLine" id="cb1-57" data-line-number="57"></a>
<a class="sourceLine" id="cb1-58" data-line-number="58"><span class="st">               </span>coef      Se    Wald p<span class="op">-</span>value</a>
<a class="sourceLine" id="cb1-59" data-line-number="59">I<span class="op">-</span>splines1 <span class="fl">-7.12837</span> <span class="fl">0.24342</span> <span class="fl">-29.284</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb1-60" data-line-number="60">I<span class="op">-</span>splines2  <span class="fl">1.04836</span> <span class="fl">0.08124</span>  <span class="fl">12.905</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb1-61" data-line-number="61">I<span class="op">-</span>splines3 <span class="fl">-0.00109</span> <span class="fl">0.03823</span>  <span class="fl">-0.029</span> <span class="fl">0.97718</span></a>
<a class="sourceLine" id="cb1-62" data-line-number="62">I<span class="op">-</span>splines4  <span class="fl">1.98400</span> <span class="fl">0.03385</span>  <span class="fl">58.609</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb1-63" data-line-number="63">I<span class="op">-</span>splines5  <span class="fl">1.25589</span> <span class="fl">0.03022</span>  <span class="fl">41.554</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb1-64" data-line-number="64">I<span class="op">-</span>splines6  <span class="fl">1.00133</span> <span class="fl">0.03617</span>  <span class="fl">27.681</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb1-65" data-line-number="65">I<span class="op">-</span>splines7  <span class="fl">0.91387</span> <span class="fl">0.02684</span>  <span class="fl">34.055</span> <span class="fl">0.00000</span></a></code></pre></div>
<p> </p>
<p>We see in the summary that one of the I-splines parameters is very small. To avoid numerical issues in more complex models, we fix this parameter to zero :</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">binit &lt;-<span class="st"> </span>mMMSE<span class="op">$</span>best</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">binit[<span class="dv">7</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">mMMSE1 &lt;-<span class="st"> </span><span class="kw">lcmm</span>(MMSE <span class="op">~</span><span class="st"> </span><span class="kw">I</span>((age<span class="dv">-65</span>)<span class="op">/</span><span class="dv">10</span>), <span class="dt">random =</span><span class="op">~</span><span class="kw">I</span>((age<span class="dv">-65</span>)<span class="op">/</span><span class="dv">10</span>), <span class="dt">subject=</span><span class="st">'ID'</span>, <span class="dt">data =</span> paquid,</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">               <span class="dt">link =</span><span class="st">"5-quant-splines"</span>, <span class="dt">verbose=</span><span class="ot">FALSE</span>, <span class="dt">B=</span>binit, <span class="dt">posfix=</span><span class="dv">7</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="kw">summary</span>(mMMSE1)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">General latent class mixed model </a>
<a class="sourceLine" id="cb2-7" data-line-number="7">     fitted by maximum likelihood method </a>
<a class="sourceLine" id="cb2-8" data-line-number="8"> </a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="kw">lcmm</span>(<span class="dt">fixed =</span> MMSE <span class="op">~</span><span class="st"> </span><span class="kw">I</span>((age <span class="op">-</span><span class="st"> </span><span class="dv">65</span>)<span class="op">/</span><span class="dv">10</span>), <span class="dt">random =</span> <span class="op">~</span><span class="kw">I</span>((age <span class="op">-</span><span class="st"> </span><span class="dv">65</span>)<span class="op">/</span><span class="dv">10</span>), </a>
<a class="sourceLine" id="cb2-10" data-line-number="10">    <span class="dt">subject =</span> <span class="st">"ID"</span>, <span class="dt">link =</span> <span class="st">"5-quant-splines"</span>, <span class="dt">data =</span> paquid, </a>
<a class="sourceLine" id="cb2-11" data-line-number="11">    <span class="dt">posfix =</span> <span class="dv">7</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb2-12" data-line-number="12"> </a>
<a class="sourceLine" id="cb2-13" data-line-number="13">Statistical Model<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="st">     </span>Dataset<span class="op">:</span><span class="st"> </span>paquid </a>
<a class="sourceLine" id="cb2-15" data-line-number="15">     Number of subjects<span class="op">:</span><span class="st"> </span><span class="dv">500</span> </a>
<a class="sourceLine" id="cb2-16" data-line-number="16">     Number of observations<span class="op">:</span><span class="st"> </span><span class="dv">2214</span> </a>
<a class="sourceLine" id="cb2-17" data-line-number="17">     Number of observations deleted<span class="op">:</span><span class="st"> </span><span class="dv">36</span> </a>
<a class="sourceLine" id="cb2-18" data-line-number="18">     Number of latent classes<span class="op">:</span><span class="st"> </span><span class="dv">1</span> </a>
<a class="sourceLine" id="cb2-19" data-line-number="19">     Number of parameters<span class="op">:</span><span class="st"> </span><span class="dv">11</span>  </a>
<a class="sourceLine" id="cb2-20" data-line-number="20">     Number of estimated parameters<span class="op">:</span><span class="st"> </span><span class="dv">10</span>  </a>
<a class="sourceLine" id="cb2-21" data-line-number="21">     Link <span class="cf">function</span><span class="op">:</span><span class="st"> </span>Quadratic I<span class="op">-</span>splines with nodes  </a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="dv">0</span> <span class="dv">25</span> <span class="dv">27</span> <span class="dv">29</span> <span class="dv">30</span>  </a>
<a class="sourceLine" id="cb2-23" data-line-number="23"> </a>
<a class="sourceLine" id="cb2-24" data-line-number="24">Iteration process<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="st">     </span>Convergence criteria satisfied </a>
<a class="sourceLine" id="cb2-26" data-line-number="26">     Number of iterations<span class="op">:</span><span class="st">  </span><span class="dv">1</span> </a>
<a class="sourceLine" id="cb2-27" data-line-number="27">     Convergence criteria<span class="op">:</span><span class="st"> </span>parameters=<span class="st"> </span><span class="fl">1.1e-13</span> </a>
<a class="sourceLine" id="cb2-28" data-line-number="28">                         <span class="op">:</span><span class="st"> </span>likelihood=<span class="st"> </span><span class="fl">2.3e-10</span> </a>
<a class="sourceLine" id="cb2-29" data-line-number="29">                         <span class="op">:</span><span class="st"> </span>second derivatives=<span class="st"> </span><span class="fl">1.7e-14</span> </a>
<a class="sourceLine" id="cb2-30" data-line-number="30"> </a>
<a class="sourceLine" id="cb2-31" data-line-number="31">Goodness<span class="op">-</span>of<span class="op">-</span>fit statistics<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-32" data-line-number="32"><span class="st">     </span>maximum log<span class="op">-</span>likelihood<span class="op">:</span><span class="st"> </span><span class="fl">-4687.54</span>  </a>
<a class="sourceLine" id="cb2-33" data-line-number="33">     AIC<span class="op">:</span><span class="st"> </span><span class="fl">9395.08</span>  </a>
<a class="sourceLine" id="cb2-34" data-line-number="34">     BIC<span class="op">:</span><span class="st"> </span><span class="fl">9437.23</span>  </a>
<a class="sourceLine" id="cb2-35" data-line-number="35"> </a>
<a class="sourceLine" id="cb2-36" data-line-number="36">     Discrete posterior log<span class="op">-</span>likelihood<span class="op">:</span><span class="st"> </span><span class="fl">-4677.75</span>  </a>
<a class="sourceLine" id="cb2-37" data-line-number="37">     Discrete AIC<span class="op">:</span><span class="st"> </span><span class="fl">9375.5</span>  </a>
<a class="sourceLine" id="cb2-38" data-line-number="38"> </a>
<a class="sourceLine" id="cb2-39" data-line-number="39">     Mean discrete AIC per subject<span class="op">:</span><span class="st"> </span><span class="fl">9.3755</span>  </a>
<a class="sourceLine" id="cb2-40" data-line-number="40">     Mean UACV per subject<span class="op">:</span><span class="st"> </span><span class="fl">9.3762</span>  </a>
<a class="sourceLine" id="cb2-41" data-line-number="41">     Mean discrete LL per subject<span class="op">:</span><span class="st"> </span><span class="fl">-9.3555</span>  </a>
<a class="sourceLine" id="cb2-42" data-line-number="42"> </a>
<a class="sourceLine" id="cb2-43" data-line-number="43">Maximum Likelihood Estimates<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-44" data-line-number="44"><span class="st"> </span></a>
<a class="sourceLine" id="cb2-45" data-line-number="45">Fixed effects <span class="cf">in</span> the longitudinal model<span class="op">:</span></a>
<a class="sourceLine" id="cb2-46" data-line-number="46"></a>
<a class="sourceLine" id="cb2-47" data-line-number="47"><span class="st">                              </span>coef      Se    Wald p<span class="op">-</span>value</a>
<a class="sourceLine" id="cb2-48" data-line-number="48"><span class="kw">intercept</span> (not estimated)        <span class="dv">0</span>                        </a>
<a class="sourceLine" id="cb2-49" data-line-number="49"><span class="kw">I</span>((age <span class="op">-</span><span class="st"> </span><span class="dv">65</span>)<span class="op">/</span><span class="dv">10</span>)          <span class="fl">-1.19894</span> <span class="fl">0.07188</span> <span class="fl">-16.681</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb2-50" data-line-number="50"></a>
<a class="sourceLine" id="cb2-51" data-line-number="51"></a>
<a class="sourceLine" id="cb2-52" data-line-number="52">Variance<span class="op">-</span>covariance matrix of the random<span class="op">-</span>effects<span class="op">:</span></a>
<a class="sourceLine" id="cb2-53" data-line-number="53"><span class="st">                 </span>intercept <span class="kw">I</span>((age <span class="op">-</span><span class="st"> </span><span class="dv">65</span>)<span class="op">/</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb2-54" data-line-number="54">intercept          <span class="fl">2.23236</span>                 </a>
<a class="sourceLine" id="cb2-55" data-line-number="55"><span class="kw">I</span>((age <span class="op">-</span><span class="st"> </span><span class="dv">65</span>)<span class="op">/</span><span class="dv">10</span>)  <span class="fl">-0.90184</span>          <span class="fl">0.86839</span></a>
<a class="sourceLine" id="cb2-56" data-line-number="56"></a>
<a class="sourceLine" id="cb2-57" data-line-number="57">Residual standard <span class="kw">error</span> (not estimated) =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-58" data-line-number="58"></a>
<a class="sourceLine" id="cb2-59" data-line-number="59">Parameters of the link <span class="cf">function</span><span class="op">:</span></a>
<a class="sourceLine" id="cb2-60" data-line-number="60"></a>
<a class="sourceLine" id="cb2-61" data-line-number="61"><span class="st">               </span>coef       Se    Wald p<span class="op">-</span>value</a>
<a class="sourceLine" id="cb2-62" data-line-number="62">I<span class="op">-</span>splines1 <span class="fl">-7.12837</span>  <span class="fl">0.24343</span> <span class="fl">-29.283</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb2-63" data-line-number="63">I<span class="op">-</span>splines2  <span class="fl">1.04836</span>  <span class="fl">0.08124</span>  <span class="fl">12.905</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb2-64" data-line-number="64">I<span class="op">-</span>splines3  <span class="fl">0.00000</span><span class="op">*</span><span class="st">                        </span></a>
<a class="sourceLine" id="cb2-65" data-line-number="65">I<span class="op">-</span>splines4  <span class="fl">1.98400</span>  <span class="fl">0.03385</span>  <span class="fl">58.607</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb2-66" data-line-number="66">I<span class="op">-</span>splines5  <span class="fl">1.25589</span>  <span class="fl">0.03022</span>  <span class="fl">41.554</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb2-67" data-line-number="67">I<span class="op">-</span>splines6  <span class="fl">1.00133</span>  <span class="fl">0.03617</span>  <span class="fl">27.681</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb2-68" data-line-number="68">I<span class="op">-</span>splines7  <span class="fl">0.91387</span>  <span class="fl">0.02684</span>  <span class="fl">34.055</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb2-69" data-line-number="69"></a>
<a class="sourceLine" id="cb2-70" data-line-number="70"> <span class="op">*</span><span class="st"> </span>coefficient fixed by the user </a>
<a class="sourceLine" id="cb2-71" data-line-number="71"> </a></code></pre></div>
<p> </p>
<p>We use the same specification for CESD. Note however that the specification can differ between the outcomes.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">mCESD1 &lt;-<span class="st"> </span><span class="kw">lcmm</span>(CESD <span class="op">~</span><span class="st"> </span><span class="kw">I</span>((age<span class="dv">-65</span>)<span class="op">/</span><span class="dv">10</span>), <span class="dt">random =</span><span class="op">~</span><span class="kw">I</span>((age<span class="dv">-65</span>)<span class="op">/</span><span class="dv">10</span>), <span class="dt">subject=</span><span class="st">'ID'</span>, <span class="dt">data =</span> paquid,</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">               <span class="dt">link =</span><span class="st">"5-quant-splines"</span>, <span class="dt">verbose=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw">summary</span>(mCESD1)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">General latent class mixed model </a>
<a class="sourceLine" id="cb3-5" data-line-number="5">     fitted by maximum likelihood method </a>
<a class="sourceLine" id="cb3-6" data-line-number="6"> </a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="kw">lcmm</span>(<span class="dt">fixed =</span> CESD <span class="op">~</span><span class="st"> </span><span class="kw">I</span>((age <span class="op">-</span><span class="st"> </span><span class="dv">65</span>)<span class="op">/</span><span class="dv">10</span>), <span class="dt">random =</span> <span class="op">~</span><span class="kw">I</span>((age <span class="op">-</span><span class="st"> </span><span class="dv">65</span>)<span class="op">/</span><span class="dv">10</span>), </a>
<a class="sourceLine" id="cb3-8" data-line-number="8">    <span class="dt">subject =</span> <span class="st">"ID"</span>, <span class="dt">link =</span> <span class="st">"5-quant-splines"</span>, <span class="dt">data =</span> paquid, </a>
<a class="sourceLine" id="cb3-9" data-line-number="9">    <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb3-10" data-line-number="10"> </a>
<a class="sourceLine" id="cb3-11" data-line-number="11">Statistical Model<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="st">     </span>Dataset<span class="op">:</span><span class="st"> </span>paquid </a>
<a class="sourceLine" id="cb3-13" data-line-number="13">     Number of subjects<span class="op">:</span><span class="st"> </span><span class="dv">500</span> </a>
<a class="sourceLine" id="cb3-14" data-line-number="14">     Number of observations<span class="op">:</span><span class="st"> </span><span class="dv">2104</span> </a>
<a class="sourceLine" id="cb3-15" data-line-number="15">     Number of observations deleted<span class="op">:</span><span class="st"> </span><span class="dv">146</span> </a>
<a class="sourceLine" id="cb3-16" data-line-number="16">     Number of latent classes<span class="op">:</span><span class="st"> </span><span class="dv">1</span> </a>
<a class="sourceLine" id="cb3-17" data-line-number="17">     Number of parameters<span class="op">:</span><span class="st"> </span><span class="dv">11</span>  </a>
<a class="sourceLine" id="cb3-18" data-line-number="18">     Link <span class="cf">function</span><span class="op">:</span><span class="st"> </span>Quadratic I<span class="op">-</span>splines with nodes  </a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="dv">0</span> <span class="dv">2</span> <span class="dv">6</span> <span class="dv">12</span> <span class="dv">52</span>  </a>
<a class="sourceLine" id="cb3-20" data-line-number="20"> </a>
<a class="sourceLine" id="cb3-21" data-line-number="21">Iteration process<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="st">     </span>Convergence criteria satisfied </a>
<a class="sourceLine" id="cb3-23" data-line-number="23">     Number of iterations<span class="op">:</span><span class="st">  </span><span class="dv">21</span> </a>
<a class="sourceLine" id="cb3-24" data-line-number="24">     Convergence criteria<span class="op">:</span><span class="st"> </span>parameters=<span class="st"> </span><span class="fl">1.9e-10</span> </a>
<a class="sourceLine" id="cb3-25" data-line-number="25">                         <span class="op">:</span><span class="st"> </span>likelihood=<span class="st"> </span><span class="fl">8.1e-09</span> </a>
<a class="sourceLine" id="cb3-26" data-line-number="26">                         <span class="op">:</span><span class="st"> </span>second derivatives=<span class="st"> </span><span class="fl">3.9e-16</span> </a>
<a class="sourceLine" id="cb3-27" data-line-number="27"> </a>
<a class="sourceLine" id="cb3-28" data-line-number="28">Goodness<span class="op">-</span>of<span class="op">-</span>fit statistics<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-29" data-line-number="29"><span class="st">     </span>maximum log<span class="op">-</span>likelihood<span class="op">:</span><span class="st"> </span><span class="fl">-6331.04</span>  </a>
<a class="sourceLine" id="cb3-30" data-line-number="30">     AIC<span class="op">:</span><span class="st"> </span><span class="fl">12684.07</span>  </a>
<a class="sourceLine" id="cb3-31" data-line-number="31">     BIC<span class="op">:</span><span class="st"> </span><span class="fl">12730.43</span>  </a>
<a class="sourceLine" id="cb3-32" data-line-number="32"> </a>
<a class="sourceLine" id="cb3-33" data-line-number="33">     Discrete posterior log<span class="op">-</span>likelihood<span class="op">:</span><span class="st"> </span><span class="fl">-6320.34</span>  </a>
<a class="sourceLine" id="cb3-34" data-line-number="34">     Discrete AIC<span class="op">:</span><span class="st"> </span><span class="fl">12662.67</span>  </a>
<a class="sourceLine" id="cb3-35" data-line-number="35"> </a>
<a class="sourceLine" id="cb3-36" data-line-number="36">     Mean discrete AIC per subject<span class="op">:</span><span class="st"> </span><span class="fl">12.6627</span>  </a>
<a class="sourceLine" id="cb3-37" data-line-number="37">     Mean UACV per subject<span class="op">:</span><span class="st"> </span><span class="fl">12.6623</span>  </a>
<a class="sourceLine" id="cb3-38" data-line-number="38">     Mean discrete LL per subject<span class="op">:</span><span class="st"> </span><span class="fl">-12.6407</span>  </a>
<a class="sourceLine" id="cb3-39" data-line-number="39"> </a>
<a class="sourceLine" id="cb3-40" data-line-number="40">Maximum Likelihood Estimates<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-41" data-line-number="41"><span class="st"> </span></a>
<a class="sourceLine" id="cb3-42" data-line-number="42">Fixed effects <span class="cf">in</span> the longitudinal model<span class="op">:</span></a>
<a class="sourceLine" id="cb3-43" data-line-number="43"></a>
<a class="sourceLine" id="cb3-44" data-line-number="44"><span class="st">                              </span>coef      Se    Wald p<span class="op">-</span>value</a>
<a class="sourceLine" id="cb3-45" data-line-number="45"><span class="kw">intercept</span> (not estimated)        <span class="dv">0</span>                        </a>
<a class="sourceLine" id="cb3-46" data-line-number="46"><span class="kw">I</span>((age <span class="op">-</span><span class="st"> </span><span class="dv">65</span>)<span class="op">/</span><span class="dv">10</span>)           <span class="fl">0.53187</span> <span class="fl">0.05164</span>  <span class="fl">10.299</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb3-47" data-line-number="47"></a>
<a class="sourceLine" id="cb3-48" data-line-number="48"></a>
<a class="sourceLine" id="cb3-49" data-line-number="49">Variance<span class="op">-</span>covariance matrix of the random<span class="op">-</span>effects<span class="op">:</span></a>
<a class="sourceLine" id="cb3-50" data-line-number="50"><span class="st">                 </span>intercept <span class="kw">I</span>((age <span class="op">-</span><span class="st"> </span><span class="dv">65</span>)<span class="op">/</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb3-51" data-line-number="51">intercept          <span class="fl">2.08271</span>                 </a>
<a class="sourceLine" id="cb3-52" data-line-number="52"><span class="kw">I</span>((age <span class="op">-</span><span class="st"> </span><span class="dv">65</span>)<span class="op">/</span><span class="dv">10</span>)  <span class="fl">-0.43992</span>          <span class="fl">0.18055</span></a>
<a class="sourceLine" id="cb3-53" data-line-number="53"></a>
<a class="sourceLine" id="cb3-54" data-line-number="54">Residual standard <span class="kw">error</span> (not estimated) =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb3-55" data-line-number="55"></a>
<a class="sourceLine" id="cb3-56" data-line-number="56">Parameters of the link <span class="cf">function</span><span class="op">:</span></a>
<a class="sourceLine" id="cb3-57" data-line-number="57"></a>
<a class="sourceLine" id="cb3-58" data-line-number="58"><span class="st">               </span>coef      Se    Wald p<span class="op">-</span>value</a>
<a class="sourceLine" id="cb3-59" data-line-number="59">I<span class="op">-</span>splines1 <span class="fl">-1.66789</span> <span class="fl">0.10563</span> <span class="fl">-15.790</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb3-60" data-line-number="60">I<span class="op">-</span>splines2  <span class="fl">1.04688</span> <span class="fl">0.02463</span>  <span class="fl">42.503</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb3-61" data-line-number="61">I<span class="op">-</span>splines3  <span class="fl">0.74268</span> <span class="fl">0.03772</span>  <span class="fl">19.688</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb3-62" data-line-number="62">I<span class="op">-</span>splines4  <span class="fl">0.98353</span> <span class="fl">0.03239</span>  <span class="fl">30.363</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb3-63" data-line-number="63">I<span class="op">-</span>splines5  <span class="fl">1.55698</span> <span class="fl">0.04484</span>  <span class="fl">34.726</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb3-64" data-line-number="64">I<span class="op">-</span>splines6 <span class="fl">-0.93391</span> <span class="fl">0.16623</span>  <span class="fl">-5.618</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb3-65" data-line-number="65">I<span class="op">-</span>splines7  <span class="fl">1.38694</span> <span class="fl">0.17715</span>   <span class="fl">7.829</span> <span class="fl">0.00000</span></a></code></pre></div>
<p> </p>
<p>Based on these two submodels, the multivariate model can then be estimated.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE1</span>,<span class="va">mCESD1</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, data<span class="op">=</span><span class="va">paquid</span>, ng<span class="op">=</span><span class="fl">1</span>, posfix<span class="op">=</span><span class="fl">7</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p> </p>
<p>As the two outcomes are independent conditionaly to the latent classes and that we only have one class, the multivariate model is equivalent to the two separated submodel. We can check that the estimations are the same :</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">cbind</span>(mm1<span class="op">$</span>best, <span class="kw">c</span>(mMMSE1<span class="op">$</span>best, mCESD1<span class="op">$</span>best))</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">                       [,<span class="dv">1</span>]       [,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="kw">I</span>((age <span class="op">-</span><span class="st"> </span><span class="dv">65</span>)<span class="op">/</span><span class="dv">10</span>) <span class="fl">-1.1989362</span> <span class="fl">-1.1989355</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4">varcov <span class="dv">1</span>          <span class="fl">2.2323591</span>  <span class="fl">2.2323555</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">varcov <span class="dv">2</span>         <span class="fl">-0.9018448</span> <span class="fl">-0.9018425</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6">varcov <span class="dv">3</span>          <span class="fl">0.8683880</span>  <span class="fl">0.8683859</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7">I<span class="op">-</span>splines1       <span class="fl">-7.1283743</span> <span class="fl">-7.1283683</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8">I<span class="op">-</span>splines2        <span class="fl">1.0483658</span>  <span class="fl">1.0483646</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9">I<span class="op">-</span>splines3        <span class="fl">0.0000000</span>  <span class="fl">0.0000000</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10">I<span class="op">-</span>splines4        <span class="fl">1.9839961</span>  <span class="fl">1.9839953</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11">I<span class="op">-</span>splines5        <span class="fl">1.2558910</span>  <span class="fl">1.2558911</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12">I<span class="op">-</span>splines6        <span class="fl">1.0013254</span>  <span class="fl">1.0013252</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13">I<span class="op">-</span>splines7        <span class="fl">0.9138711</span>  <span class="fl">0.9138711</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="kw">I</span>((age <span class="op">-</span><span class="st"> </span><span class="dv">65</span>)<span class="op">/</span><span class="dv">10</span>)  <span class="fl">0.5318709</span>  <span class="fl">0.5318708</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15">varcov <span class="dv">1</span>          <span class="fl">2.0827139</span>  <span class="fl">2.0827132</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16">varcov <span class="dv">2</span>         <span class="fl">-0.4399163</span> <span class="fl">-0.4399158</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17">varcov <span class="dv">3</span>          <span class="fl">0.1805552</span>  <span class="fl">0.1805550</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18">I<span class="op">-</span>splines1       <span class="fl">-1.6678879</span> <span class="fl">-1.6678880</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19">I<span class="op">-</span>splines2        <span class="fl">1.0468796</span>  <span class="fl">1.0468796</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20">I<span class="op">-</span>splines3        <span class="fl">0.7426802</span>  <span class="fl">0.7426802</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21">I<span class="op">-</span>splines4        <span class="fl">0.9835325</span>  <span class="fl">0.9835324</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22">I<span class="op">-</span>splines5        <span class="fl">1.5569752</span>  <span class="fl">1.5569752</span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23">I<span class="op">-</span>splines6       <span class="fl">-0.9339131</span> <span class="fl">-0.9339132</span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24">I<span class="op">-</span>splines7        <span class="fl">1.3869353</span>  <span class="fl">1.3869353</span></a></code></pre></div>
<p> </p>
</div>
<div class="section level3">
<h3 id="estimate-the-model-with-more-than-one-class-g-1">Estimate the model with more than one class (G &gt; 1)<a class="anchor" aria-label="anchor" href="#estimate-the-model-with-more-than-one-class-g-1"></a>
</h3>
<p> </p>
<p align="justify">
With more than one class, we begin also with univariate models and then we estimate the multivariate model. The univariate models do not need to be optimized here. We therefore use the option maxiter=0. We also fix one I-spline parameter to zero as before.
</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mMMSE2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">MMSE</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,random<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,subject<span class="op">=</span><span class="st">"ID"</span>,</span>
<span> link<span class="op">=</span><span class="st">"5-quant-splines"</span>,data<span class="op">=</span><span class="va">paquid</span>,ng<span class="op">=</span><span class="fl">2</span>,mixture<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,</span>
<span> B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">mMMSE1</span><span class="op">)</span>,maxiter<span class="op">=</span><span class="fl">0</span>, posfix<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mCESD2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">CESD</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,random<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,subject<span class="op">=</span><span class="st">"ID"</span>,</span>
<span> link<span class="op">=</span><span class="st">"5-quant-splines"</span>,data<span class="op">=</span><span class="va">paquid</span>,ng<span class="op">=</span><span class="fl">2</span>,mixture<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,</span>
<span> B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">mCESD1</span><span class="op">)</span>,maxiter<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mm2_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE2</span>,<span class="va">mCESD2</span><span class="op">)</span>,subject<span class="op">=</span><span class="st">"ID"</span>,ng<span class="op">=</span><span class="fl">2</span>,data<span class="op">=</span><span class="va">paquid</span>,posfix<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p> </p>
<p>The later model does not specify initial values. They are then extracted from the univariate models. Alternatively, we can use the one class model as starting point, or use a grid search.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mm2_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE2</span>,<span class="va">mCESD2</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">2</span>, data<span class="op">=</span><span class="va">paquid</span>,</span>
<span>                 B<span class="op">=</span><span class="va">mm1</span>, posfix<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mm2_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gridsearch.html">gridsearch</a></span><span class="op">(</span><span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE2</span>,<span class="va">mCESD2</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">2</span>,</span>
<span>                    data<span class="op">=</span><span class="va">paquid</span>, posfix<span class="op">=</span><span class="fl">10</span><span class="op">)</span>, minit<span class="op">=</span><span class="va">mm1</span>, rep<span class="op">=</span><span class="fl">50</span>, maxiter<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<p> </p>
<p align="justify">
We estimate in the following the same model with 3, 4, and 5 classes.
</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 3 classes</span></span>
<span></span>
<span><span class="va">mMMSE3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">MMSE</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, random<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>,</span>
<span> link<span class="op">=</span><span class="st">"5-quant-splines"</span>, data<span class="op">=</span><span class="va">paquid</span>, ng<span class="op">=</span><span class="fl">3</span>, mixture<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,</span>
<span> B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">mMMSE1</span><span class="op">)</span>, maxiter<span class="op">=</span><span class="fl">0</span>, posfix<span class="op">=</span><span class="fl">13</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mCESD3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">CESD</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, random<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>,</span>
<span> link<span class="op">=</span><span class="st">"5-quant-splines"</span>, data<span class="op">=</span><span class="va">paquid</span>, ng<span class="op">=</span><span class="fl">3</span>, mixture<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,</span>
<span> B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">mCESD1</span><span class="op">)</span>, maxiter<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mm3_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE3</span>,<span class="va">mCESD3</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">3</span>, data<span class="op">=</span><span class="va">paquid</span>, posfix<span class="op">=</span><span class="fl">13</span><span class="op">)</span></span>
<span><span class="va">mm3_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE3</span>,<span class="va">mCESD3</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">3</span>, data<span class="op">=</span><span class="va">paquid</span>, posfix<span class="op">=</span><span class="fl">13</span>, B<span class="op">=</span><span class="va">mm1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mm3_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gridsearch.html">gridsearch</a></span><span class="op">(</span><span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE3</span>,<span class="va">mCESD3</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">3</span>,</span>
<span> data<span class="op">=</span><span class="va">paquid</span>, posfix<span class="op">=</span><span class="fl">13</span><span class="op">)</span>, minit<span class="op">=</span><span class="va">mm1</span>, rep<span class="op">=</span><span class="fl">50</span>, maxiter<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span>                                                   </span>
<span><span class="co">## 4 classes</span></span>
<span></span>
<span><span class="va">mMMSE4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">MMSE</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, random<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>,</span>
<span> link<span class="op">=</span><span class="st">"5-quant-splines"</span>, data<span class="op">=</span><span class="va">paquid</span>, ng<span class="op">=</span><span class="fl">4</span>, mixture<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,</span>
<span> B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">mMMSE1</span><span class="op">)</span>, maxiter<span class="op">=</span><span class="fl">0</span>, posfix<span class="op">=</span><span class="fl">16</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mCESD4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">CESD</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, random<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>,</span>
<span> link<span class="op">=</span><span class="st">"5-quant-splines"</span>, data<span class="op">=</span><span class="va">paquid</span>, ng<span class="op">=</span><span class="fl">4</span>, mixture<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,</span>
<span> B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">mCESD1</span><span class="op">)</span>, maxiter<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mm4_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE4</span>,<span class="va">mCESD4</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">4</span>, data<span class="op">=</span><span class="va">paquid</span>, posfix<span class="op">=</span><span class="fl">16</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mm4_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE4</span>,<span class="va">mCESD4</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">4</span>, data<span class="op">=</span><span class="va">paquid</span>, posfix<span class="op">=</span><span class="fl">16</span>, B<span class="op">=</span><span class="va">mm1</span><span class="op">)</span></span>
<span>                                                                                       </span>
<span><span class="va">mm4_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gridsearch.html">gridsearch</a></span><span class="op">(</span><span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE4</span>,<span class="va">mCESD4</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">4</span>,</span>
<span>                    data<span class="op">=</span><span class="va">paquid</span>, posfix<span class="op">=</span><span class="fl">16</span><span class="op">)</span>, minit<span class="op">=</span><span class="va">mm1</span>, rep<span class="op">=</span><span class="fl">50</span>, maxiter<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## 5 classes</span></span>
<span></span>
<span><span class="va">mMMSE5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">MMSE</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, random<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>,</span>
<span> link<span class="op">=</span><span class="st">"5-quant-splines"</span>, data<span class="op">=</span><span class="va">paquid</span>, ng<span class="op">=</span><span class="fl">5</span>, mixture<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,</span>
<span> B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">mMMSE1</span><span class="op">)</span>, maxiter<span class="op">=</span><span class="fl">0</span> ,posfix<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mCESD5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">CESD</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, random<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>,</span>
<span> link<span class="op">=</span><span class="st">"5-quant-splines"</span>, data<span class="op">=</span><span class="va">paquid</span>, ng<span class="op">=</span><span class="fl">5</span>, mixture<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,</span>
<span> B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">mCESD1</span><span class="op">)</span>, maxiter<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mm5_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE5</span>,<span class="va">mCESD5</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">5</span>, data<span class="op">=</span><span class="va">paquid</span>, posfix<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mm5_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE5</span>,<span class="va">mCESD5</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">5</span>, data<span class="op">=</span><span class="va">paquid</span>, posfix<span class="op">=</span><span class="fl">19</span>, B<span class="op">=</span><span class="va">mm1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mm5_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gridsearch.html">gridsearch</a></span><span class="op">(</span><span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE5</span>,<span class="va">mCESD5</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">5</span>,</span>
<span>                    data<span class="op">=</span><span class="va">paquid</span>, posfix<span class="op">=</span><span class="fl">19</span><span class="op">)</span>, minit<span class="op">=</span><span class="va">mm1</span>, rep<span class="op">=</span><span class="fl">50</span>, maxiter<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<p> </p>
<p>We summarize and compare all these estimations with summarytable function :</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">summarytable</span>(mm1, mm2_a, mm2_b, mm2_c, mm3_a, mm3_b, mm3_c, mm4_a, mm4_b, mm4_c, mm5_a, mm5_b, mm5_c)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">      G    loglik npm      BIC <span class="op">%class1 %</span>class2 <span class="op">%class3 %</span>class4 %class5</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">mm1   <span class="dv">1</span> <span class="fl">-11018.58</span>  <span class="dv">21</span> <span class="fl">22167.67</span>   <span class="fl">100.0</span>                                </a>
<a class="sourceLine" id="cb10-4" data-line-number="4">mm2_a <span class="dv">2</span> <span class="fl">-11004.64</span>  <span class="dv">26</span> <span class="fl">22170.86</span>    <span class="fl">20.8</span>    <span class="fl">79.2</span>                        </a>
<a class="sourceLine" id="cb10-5" data-line-number="5">mm2_b <span class="dv">2</span> <span class="fl">-10997.88</span>  <span class="dv">26</span> <span class="fl">22157.34</span>    <span class="fl">21.4</span>    <span class="fl">78.6</span>                        </a>
<a class="sourceLine" id="cb10-6" data-line-number="6">mm2_c <span class="dv">2</span> <span class="fl">-10997.88</span>  <span class="dv">26</span> <span class="fl">22157.34</span>    <span class="fl">78.6</span>    <span class="fl">21.4</span>                        </a>
<a class="sourceLine" id="cb10-7" data-line-number="7">mm3_a <span class="dv">3</span> <span class="fl">-10983.75</span>  <span class="dv">31</span> <span class="fl">22160.14</span>     <span class="fl">8.2</span>    <span class="fl">70.8</span>    <span class="fl">21.0</span>                </a>
<a class="sourceLine" id="cb10-8" data-line-number="8">mm3_b <span class="dv">3</span> <span class="fl">-10983.75</span>  <span class="dv">31</span> <span class="fl">22160.14</span>     <span class="fl">8.2</span>    <span class="fl">70.8</span>    <span class="fl">21.0</span>                </a>
<a class="sourceLine" id="cb10-9" data-line-number="9">mm3_c <span class="dv">3</span> <span class="fl">-10983.75</span>  <span class="dv">31</span> <span class="fl">22160.14</span>     <span class="fl">8.2</span>    <span class="fl">70.8</span>    <span class="fl">21.0</span>                </a>
<a class="sourceLine" id="cb10-10" data-line-number="10">mm4_a <span class="dv">4</span> <span class="fl">-10976.16</span>  <span class="dv">36</span> <span class="fl">22176.04</span>    <span class="fl">65.0</span>    <span class="fl">19.0</span>     <span class="fl">7.8</span>     <span class="fl">8.2</span>        </a>
<a class="sourceLine" id="cb10-11" data-line-number="11">mm4_b <span class="dv">4</span> <span class="fl">-10979.04</span>  <span class="dv">36</span> <span class="fl">22181.80</span>    <span class="fl">37.6</span>    <span class="fl">13.6</span>    <span class="fl">47.8</span>     <span class="fl">1.0</span>        </a>
<a class="sourceLine" id="cb10-12" data-line-number="12">mm4_c <span class="dv">4</span> <span class="fl">-10976.16</span>  <span class="dv">36</span> <span class="fl">22176.04</span>    <span class="fl">12.6</span>    <span class="fl">26.0</span>    <span class="fl">48.6</span>    <span class="fl">12.8</span>        </a>
<a class="sourceLine" id="cb10-13" data-line-number="13">mm5_a <span class="dv">5</span> <span class="fl">-10975.59</span>  <span class="dv">41</span> <span class="fl">22205.99</span>    <span class="fl">22.0</span>    <span class="fl">29.2</span>    <span class="fl">30.0</span>    <span class="fl">10.6</span>     <span class="fl">8.2</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14">mm5_b <span class="dv">5</span> <span class="fl">-10971.30</span>  <span class="dv">41</span> <span class="fl">22197.40</span>    <span class="fl">28.8</span>    <span class="fl">11.6</span>    <span class="fl">46.2</span>     <span class="fl">1.2</span>    <span class="fl">12.2</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15">mm5_c <span class="dv">5</span> <span class="fl">-10970.69</span>  <span class="dv">41</span> <span class="fl">22196.17</span>     <span class="fl">5.2</span>    <span class="fl">14.2</span>    <span class="fl">48.6</span>     <span class="fl">9.6</span>    <span class="fl">22.4</span></a></code></pre></div>
<p> </p>
<p>We keep the best model for each number of latent classes and we plot some statistical criteria used to select the optimal number of classes :</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summaryplot.html">summaryplot</a></span><span class="op">(</span><span class="va">mm1</span>, <span class="va">mm2_b</span>, <span class="va">mm3_b</span>, <span class="va">mm4_c</span>, <span class="va">mm5_c</span><span class="op">)</span></span></code></pre></div>
<p><img src="multivariate_latent_class_model_with_mpjlcmm_files/figure-html/unnamed-chunk-12-1.png" width="768"></p>
<p>In this application, we will select the 2-class model, which presents better BIC.</p>
<p> </p>
<p>We can represent the relation the classes and the flow of the subjects with a sankey plot. This is not yet done automatically in the package.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">library</span>(ggalluvial)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">## We merge the classification of the 5 models :</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5">class12 &lt;-<span class="st"> </span><span class="kw">merge</span>(mm1<span class="op">$</span>pprob[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], mm2_b<span class="op">$</span>pprob[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">by=</span><span class="st">"ID"</span>)</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="kw">colnames</span>(class12) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"ID"</span>,<span class="st">"mm1"</span>,<span class="st">"mm2_b"</span>)</a>
<a class="sourceLine" id="cb12-7" data-line-number="7">class123 &lt;-<span class="st"> </span><span class="kw">merge</span>(class12, mm3_b<span class="op">$</span>pprob[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">by=</span><span class="st">"ID"</span>)</a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="kw">colnames</span>(class123) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"ID"</span>,<span class="st">"mm1"</span>,<span class="st">"mm2_b"</span>,<span class="st">"mm3_b"</span>)</a>
<a class="sourceLine" id="cb12-9" data-line-number="9">class1234 &lt;-<span class="st"> </span><span class="kw">merge</span>(class123, mm4_c<span class="op">$</span>pprob[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">by=</span><span class="st">"ID"</span>)</a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="kw">colnames</span>(class1234) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"ID"</span>,<span class="st">"mm1"</span>,<span class="st">"mm2_b"</span>,<span class="st">"mm3_b"</span>,<span class="st">"mm4_c"</span>)</a>
<a class="sourceLine" id="cb12-11" data-line-number="11">class &lt;-<span class="st"> </span><span class="kw">merge</span>(class1234, mm5_c<span class="op">$</span>pprob[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">by=</span><span class="st">"ID"</span>)</a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="kw">colnames</span>(class) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"ID"</span>,<span class="st">"mm1"</span>,<span class="st">"mm2_b"</span>,<span class="st">"mm3_b"</span>,<span class="st">"mm4_c"</span>,<span class="st">"mm5_c"</span>)</a>
<a class="sourceLine" id="cb12-13" data-line-number="13"></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">## We plot the flows :</span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="kw">ggplot</span>(class,</a>
<a class="sourceLine" id="cb12-16" data-line-number="16">       <span class="kw">aes</span>(<span class="dt">axis1 =</span> mm1, <span class="dt">axis2 =</span> mm2_b, <span class="dt">axis3 =</span> mm3_b, <span class="dt">axis4 =</span> mm4_c, <span class="dt">axis5 =</span> mm5_c, </a>
<a class="sourceLine" id="cb12-17" data-line-number="17">           <span class="dt">fill =</span> <span class="kw">after_stat</span>(stratum), <span class="dt">label =</span> <span class="kw">after_stat</span>(stratum))) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-18" data-line-number="18"><span class="st">    </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">"mm1"</span>,<span class="st">"mm2_b"</span>,<span class="st">"mm3_b"</span>,<span class="st">"mm4_c"</span>,<span class="st">"mm5_c"</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-19" data-line-number="19"><span class="st">  </span><span class="kw">geom_flow</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb12-20" data-line-number="20"><span class="st">  </span><span class="kw">geom_stratum</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb12-21" data-line-number="21"><span class="st">    </span><span class="kw">geom_text</span>(<span class="dt">stat =</span> <span class="st">"stratum"</span>, <span class="dt">size =</span> <span class="dv">6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-22" data-line-number="22"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"right"</span>,</a>
<a class="sourceLine" id="cb12-23" data-line-number="23">        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>),</a>
<a class="sourceLine" id="cb12-24" data-line-number="24">      <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>),</a>
<a class="sourceLine" id="cb12-25" data-line-number="25">        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>),</a>
<a class="sourceLine" id="cb12-26" data-line-number="26">        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-27" data-line-number="27"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">"Number of subjects"</span>,</a>
<a class="sourceLine" id="cb12-28" data-line-number="28">       <span class="dt">x =</span> <span class="st">"Model"</span>,</a>
<a class="sourceLine" id="cb12-29" data-line-number="29">       <span class="dt">fill =</span> <span class="st">"Class"</span>)</a>
<a class="sourceLine" id="cb12-30" data-line-number="30">Warning <span class="cf">in</span> <span class="kw">to_lodes_form</span>(<span class="dt">data =</span> data, <span class="dt">axes =</span> axis_ind, <span class="dt">discern =</span></a>
<a class="sourceLine" id="cb12-31" data-line-number="31">params<span class="op">$</span>discern)<span class="op">:</span><span class="st"> </span>Some strata appear at multiple axes.</a>
<a class="sourceLine" id="cb12-32" data-line-number="32">Warning<span class="op">:</span><span class="st"> </span> [1m [22m<span class="st">`</span><span class="dt">spread_()</span><span class="st">`</span> was deprecated <span class="cf">in</span> tidyr <span class="dv">1</span>.<span class="dv">2</span>.<span class="fl">0.</span></a>
<a class="sourceLine" id="cb12-33" data-line-number="33"> [36mℹ [39m Please use <span class="st">`</span><span class="dt">spread()</span><span class="st">`</span> instead.</a>
<a class="sourceLine" id="cb12-34" data-line-number="34"> [36mℹ [39m The deprecated feature was likely used <span class="cf">in</span> the  [34mggalluvial [39m package.</a>
<a class="sourceLine" id="cb12-35" data-line-number="35">  Please report the issue at</a>
<a class="sourceLine" id="cb12-36" data-line-number="36">   [3m [34m<span class="op">&lt;</span>https<span class="op">:</span><span class="er">//</span>github.com<span class="op">/</span>corybrunson<span class="op">/</span>ggalluvial<span class="op">/</span>issues<span class="op">&gt;</span> [39m [23m.</a>
<a class="sourceLine" id="cb12-37" data-line-number="37">Warning<span class="op">:</span><span class="st"> </span> [1m [22mThe <span class="st">`</span><span class="dt">.dots</span><span class="st">`</span> argument of <span class="st">`</span><span class="dt">group_by()</span><span class="st">`</span> is deprecated as of dplyr <span class="dv">1</span>.<span class="dv">0</span>.<span class="fl">0.</span></a>
<a class="sourceLine" id="cb12-38" data-line-number="38"> [36mℹ [39m The deprecated feature was likely used <span class="cf">in</span> the  [34mdplyr [39m package.</a>
<a class="sourceLine" id="cb12-39" data-line-number="39">  Please report the issue at  [3m [34m<span class="op">&lt;</span>https<span class="op">:</span><span class="er">//</span>github.com<span class="op">/</span>tidyverse<span class="op">/</span>dplyr<span class="op">/</span>issues<span class="op">&gt;</span> [39m [23m.</a>
<a class="sourceLine" id="cb12-40" data-line-number="40">Warning <span class="cf">in</span> <span class="kw">to_lodes_form</span>(<span class="dt">data =</span> data, <span class="dt">axes =</span> axis_ind, <span class="dt">discern =</span></a>
<a class="sourceLine" id="cb12-41" data-line-number="41">params<span class="op">$</span>discern)<span class="op">:</span><span class="st"> </span>Some strata appear at multiple axes.</a>
<a class="sourceLine" id="cb12-42" data-line-number="42"></a>
<a class="sourceLine" id="cb12-43" data-line-number="43">Warning <span class="cf">in</span> <span class="kw">to_lodes_form</span>(<span class="dt">data =</span> data, <span class="dt">axes =</span> axis_ind, <span class="dt">discern =</span></a>
<a class="sourceLine" id="cb12-44" data-line-number="44">params<span class="op">$</span>discern)<span class="op">:</span><span class="st"> </span>Some strata appear at multiple axes.</a></code></pre></div>
<p><img src="multivariate_latent_class_model_with_mpjlcmm_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<p> </p>
</div>
<div class="section level3">
<h3 id="description-of-the-2-class-model">Description of the 2-class model<a class="anchor" aria-label="anchor" href="#description-of-the-2-class-model"></a>
</h3>
<div class="section level4">
<h4 id="summary-of-the-model">Summary of the model<a class="anchor" aria-label="anchor" href="#summary-of-the-model"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">summary</span>(mm2_b)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">Multivariate joint latent class model <span class="cf">for</span> quantitative outcome and competing risks </a>
<a class="sourceLine" id="cb13-3" data-line-number="3">     fitted by maximum likelihood method </a>
<a class="sourceLine" id="cb13-4" data-line-number="4"> </a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="kw">mpjlcmm</span>(<span class="dt">longitudinal =</span> <span class="kw">list</span>(mMMSE2, mCESD2), <span class="dt">subject =</span> <span class="st">"ID"</span>, </a>
<a class="sourceLine" id="cb13-6" data-line-number="6">    <span class="dt">ng =</span> <span class="dv">2</span>, <span class="dt">data =</span> paquid, <span class="dt">posfix =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb13-7" data-line-number="7"> </a>
<a class="sourceLine" id="cb13-8" data-line-number="8">Statistical Model<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="st">     </span>Dataset<span class="op">:</span><span class="st"> </span>paquid </a>
<a class="sourceLine" id="cb13-10" data-line-number="10">     Number of subjects<span class="op">:</span><span class="st"> </span><span class="dv">500</span> </a>
<a class="sourceLine" id="cb13-11" data-line-number="11">     Number of longitudinal models<span class="op">:</span><span class="st"> </span><span class="dv">2</span> </a>
<a class="sourceLine" id="cb13-12" data-line-number="12">     Number of observations<span class="op">:</span><span class="st"> </span><span class="dv">2214</span> <span class="dv">2104</span> </a>
<a class="sourceLine" id="cb13-13" data-line-number="13">     Number of latent classes<span class="op">:</span><span class="st"> </span><span class="dv">2</span> </a>
<a class="sourceLine" id="cb13-14" data-line-number="14">     Number of parameters<span class="op">:</span><span class="st"> </span><span class="dv">27</span>  </a>
<a class="sourceLine" id="cb13-15" data-line-number="15">     Number of estimated parameters<span class="op">:</span><span class="st"> </span><span class="dv">26</span>  </a>
<a class="sourceLine" id="cb13-16" data-line-number="16">     Link functions<span class="op">:</span><span class="st"> </span>Quadratic I<span class="op">-</span>splines with nodes <span class="dv">0</span> <span class="dv">25</span> <span class="dv">27</span> <span class="dv">29</span> <span class="dv">30</span>  <span class="cf">for</span>  MMSE </a>
<a class="sourceLine" id="cb13-17" data-line-number="17">                     Quadratic I<span class="op">-</span>splines with nodes <span class="dv">0</span> <span class="dv">2</span> <span class="dv">6</span> <span class="dv">12</span> <span class="dv">52</span>  <span class="cf">for</span>  CESD </a>
<a class="sourceLine" id="cb13-18" data-line-number="18"> </a>
<a class="sourceLine" id="cb13-19" data-line-number="19">Iteration process<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-20" data-line-number="20"><span class="st">     </span>Convergence criteria satisfied </a>
<a class="sourceLine" id="cb13-21" data-line-number="21">     Number of iterations<span class="op">:</span><span class="st">  </span><span class="dv">26</span> </a>
<a class="sourceLine" id="cb13-22" data-line-number="22">     Convergence criteria<span class="op">:</span><span class="st"> </span>parameters=<span class="st"> </span><span class="fl">4.2e-06</span> </a>
<a class="sourceLine" id="cb13-23" data-line-number="23">                         <span class="op">:</span><span class="st"> </span>likelihood=<span class="st"> </span><span class="fl">8.2e-05</span> </a>
<a class="sourceLine" id="cb13-24" data-line-number="24">                         <span class="op">:</span><span class="st"> </span>second derivatives=<span class="st"> </span><span class="fl">1.1e-08</span> </a>
<a class="sourceLine" id="cb13-25" data-line-number="25"> </a>
<a class="sourceLine" id="cb13-26" data-line-number="26">Goodness<span class="op">-</span>of<span class="op">-</span>fit statistics<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-27" data-line-number="27"><span class="st">     </span>maximum log<span class="op">-</span>likelihood<span class="op">:</span><span class="st"> </span><span class="fl">-10997.88</span>  </a>
<a class="sourceLine" id="cb13-28" data-line-number="28">     AIC<span class="op">:</span><span class="st"> </span><span class="fl">22047.76</span>  </a>
<a class="sourceLine" id="cb13-29" data-line-number="29">     BIC<span class="op">:</span><span class="st"> </span><span class="fl">22157.34</span>  </a>
<a class="sourceLine" id="cb13-30" data-line-number="30"> </a>
<a class="sourceLine" id="cb13-31" data-line-number="31"> </a>
<a class="sourceLine" id="cb13-32" data-line-number="32"> </a>
<a class="sourceLine" id="cb13-33" data-line-number="33">Maximum Likelihood Estimates<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-34" data-line-number="34"><span class="st"> </span></a>
<a class="sourceLine" id="cb13-35" data-line-number="35">Fixed effects <span class="cf">in</span> the class<span class="op">-</span>membership model<span class="op">:</span></a>
<a class="sourceLine" id="cb13-36" data-line-number="36">(the class of reference is the last class) </a>
<a class="sourceLine" id="cb13-37" data-line-number="37"></a>
<a class="sourceLine" id="cb13-38" data-line-number="38">                     coef      Se    Wald p<span class="op">-</span>value</a>
<a class="sourceLine" id="cb13-39" data-line-number="39">intercept class1 <span class="fl">-1.03757</span> <span class="fl">0.19494</span>  <span class="fl">-5.322</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb13-40" data-line-number="40"></a>
<a class="sourceLine" id="cb13-41" data-line-number="41"></a>
<a class="sourceLine" id="cb13-42" data-line-number="42">Longitudinal model <span class="cf">for</span> MMSE <span class="op">:</span></a>
<a class="sourceLine" id="cb13-43" data-line-number="43"></a>
<a class="sourceLine" id="cb13-44" data-line-number="44">Fixed effects <span class="cf">in</span> the longitudinal model<span class="op">:</span></a>
<a class="sourceLine" id="cb13-45" data-line-number="45"><span class="st">                                     </span>coef      Se    Wald p<span class="op">-</span>value</a>
<a class="sourceLine" id="cb13-46" data-line-number="46">intercept <span class="kw">class1</span> (not estimated)  <span class="fl">0.00000</span>                        </a>
<a class="sourceLine" id="cb13-47" data-line-number="47">intercept class2                  <span class="fl">0.34847</span> <span class="fl">0.30384</span>   <span class="fl">1.147</span> <span class="fl">0.25143</span></a>
<a class="sourceLine" id="cb13-48" data-line-number="48"><span class="kw">I</span>(...) class1                    <span class="fl">-1.41500</span> <span class="fl">0.16752</span>  <span class="fl">-8.447</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb13-49" data-line-number="49"><span class="kw">I</span>(...) class2                    <span class="fl">-1.13436</span> <span class="fl">0.08760</span> <span class="fl">-12.949</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb13-50" data-line-number="50"></a>
<a class="sourceLine" id="cb13-51" data-line-number="51">Variance<span class="op">-</span>covariance matrix of the random<span class="op">-</span>effects<span class="op">:</span></a>
<a class="sourceLine" id="cb13-52" data-line-number="52"><span class="st">                 </span>intercept <span class="kw">I</span>((age <span class="op">-</span><span class="st"> </span><span class="dv">65</span>)<span class="op">/</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb13-53" data-line-number="53">intercept          <span class="fl">2.17911</span>                 </a>
<a class="sourceLine" id="cb13-54" data-line-number="54"><span class="kw">I</span>((age <span class="op">-</span><span class="st"> </span><span class="dv">65</span>)<span class="op">/</span><span class="dv">10</span>)  <span class="fl">-0.89871</span>          <span class="fl">0.83935</span></a>
<a class="sourceLine" id="cb13-55" data-line-number="55"></a>
<a class="sourceLine" id="cb13-56" data-line-number="56">Residual standard error<span class="op">:</span><span class="st"> </span><span class="dv">1</span> (not estimated)</a>
<a class="sourceLine" id="cb13-57" data-line-number="57"></a>
<a class="sourceLine" id="cb13-58" data-line-number="58">Parameters of the link functions<span class="op">:</span></a>
<a class="sourceLine" id="cb13-59" data-line-number="59"></a>
<a class="sourceLine" id="cb13-60" data-line-number="60"><span class="st">                    </span>coef       Se    Wald p<span class="op">-</span>value</a>
<a class="sourceLine" id="cb13-61" data-line-number="61">MMSE<span class="op">-</span>I<span class="op">-</span>splines1 <span class="fl">-6.86640</span>  <span class="fl">0.32838</span> <span class="fl">-20.910</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb13-62" data-line-number="62">MMSE<span class="op">-</span>I<span class="op">-</span>splines2  <span class="fl">1.04368</span>  <span class="fl">0.08112</span>  <span class="fl">12.865</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb13-63" data-line-number="63">MMSE<span class="op">-</span>I<span class="op">-</span>splines3  <span class="fl">0.00000</span><span class="op">*</span><span class="st">                        </span></a>
<a class="sourceLine" id="cb13-64" data-line-number="64">MMSE<span class="op">-</span>I<span class="op">-</span>splines4  <span class="fl">1.98366</span>  <span class="fl">0.03381</span>  <span class="fl">58.679</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb13-65" data-line-number="65">MMSE<span class="op">-</span>I<span class="op">-</span>splines5  <span class="fl">1.25600</span>  <span class="fl">0.03019</span>  <span class="fl">41.597</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb13-66" data-line-number="66">MMSE<span class="op">-</span>I<span class="op">-</span>splines6  <span class="fl">1.00043</span>  <span class="fl">0.03617</span>  <span class="fl">27.658</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb13-67" data-line-number="67">MMSE<span class="op">-</span>I<span class="op">-</span>splines7  <span class="fl">0.91330</span>  <span class="fl">0.02682</span>  <span class="fl">34.050</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb13-68" data-line-number="68"></a>
<a class="sourceLine" id="cb13-69" data-line-number="69"></a>
<a class="sourceLine" id="cb13-70" data-line-number="70">Longitudinal model <span class="cf">for</span> CESD <span class="op">:</span></a>
<a class="sourceLine" id="cb13-71" data-line-number="71"></a>
<a class="sourceLine" id="cb13-72" data-line-number="72">Fixed effects <span class="cf">in</span> the longitudinal model<span class="op">:</span></a>
<a class="sourceLine" id="cb13-73" data-line-number="73"><span class="st">                                     </span>coef      Se    Wald p<span class="op">-</span>value</a>
<a class="sourceLine" id="cb13-74" data-line-number="74">intercept <span class="kw">class1</span> (not estimated)  <span class="fl">0.00000</span>                        </a>
<a class="sourceLine" id="cb13-75" data-line-number="75">intercept class2                 <span class="fl">-2.84768</span> <span class="fl">0.21559</span> <span class="fl">-13.209</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb13-76" data-line-number="76"><span class="kw">I</span>(...) class1                    <span class="fl">-0.02509</span> <span class="fl">0.12124</span>  <span class="fl">-0.207</span> <span class="fl">0.83605</span></a>
<a class="sourceLine" id="cb13-77" data-line-number="77"><span class="kw">I</span>(...) class2                     <span class="fl">0.70735</span> <span class="fl">0.05778</span>  <span class="fl">12.243</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb13-78" data-line-number="78"></a>
<a class="sourceLine" id="cb13-79" data-line-number="79">Variance<span class="op">-</span>covariance matrix of the random<span class="op">-</span>effects<span class="op">:</span></a>
<a class="sourceLine" id="cb13-80" data-line-number="80"><span class="st">                 </span>intercept <span class="kw">I</span>((age <span class="op">-</span><span class="st"> </span><span class="dv">65</span>)<span class="op">/</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb13-81" data-line-number="81">intercept          <span class="fl">0.31009</span>                 </a>
<a class="sourceLine" id="cb13-82" data-line-number="82"><span class="kw">I</span>((age <span class="op">-</span><span class="st"> </span><span class="dv">65</span>)<span class="op">/</span><span class="dv">10</span>)   <span class="fl">0.04817</span>          <span class="fl">0.04441</span></a>
<a class="sourceLine" id="cb13-83" data-line-number="83"></a>
<a class="sourceLine" id="cb13-84" data-line-number="84">Residual standard error<span class="op">:</span><span class="st"> </span><span class="dv">1</span> (not estimated)</a>
<a class="sourceLine" id="cb13-85" data-line-number="85"></a>
<a class="sourceLine" id="cb13-86" data-line-number="86">Parameters of the link functions<span class="op">:</span></a>
<a class="sourceLine" id="cb13-87" data-line-number="87"></a>
<a class="sourceLine" id="cb13-88" data-line-number="88"><span class="st">                    </span>coef      Se    Wald p<span class="op">-</span>value</a>
<a class="sourceLine" id="cb13-89" data-line-number="89">CESD<span class="op">-</span>I<span class="op">-</span>splines1 <span class="fl">-3.76547</span> <span class="fl">0.22277</span> <span class="fl">-16.903</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb13-90" data-line-number="90">CESD<span class="op">-</span>I<span class="op">-</span>splines2  <span class="fl">1.02786</span> <span class="fl">0.02458</span>  <span class="fl">41.825</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb13-91" data-line-number="91">CESD<span class="op">-</span>I<span class="op">-</span>splines3  <span class="fl">0.72903</span> <span class="fl">0.03776</span>  <span class="fl">19.309</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb13-92" data-line-number="92">CESD<span class="op">-</span>I<span class="op">-</span>splines4  <span class="fl">0.98285</span> <span class="fl">0.03241</span>  <span class="fl">30.328</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb13-93" data-line-number="93">CESD<span class="op">-</span>I<span class="op">-</span>splines5  <span class="fl">1.57674</span> <span class="fl">0.04486</span>  <span class="fl">35.144</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb13-94" data-line-number="94">CESD<span class="op">-</span>I<span class="op">-</span>splines6 <span class="fl">-0.92716</span> <span class="fl">0.16796</span>  <span class="fl">-5.520</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb13-95" data-line-number="95">CESD<span class="op">-</span>I<span class="op">-</span>splines7  <span class="fl">1.36802</span> <span class="fl">0.17561</span>   <span class="fl">7.790</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb13-96" data-line-number="96"></a>
<a class="sourceLine" id="cb13-97" data-line-number="97"> <span class="op">*</span><span class="st">  </span>coefficient fixed by the user </a>
<a class="sourceLine" id="cb13-98" data-line-number="98"> </a></code></pre></div>
</div>
<div class="section level4">
<h4 id="update-the-univariate-models">Update the univariate models<a class="anchor" aria-label="anchor" href="#update-the-univariate-models"></a>
</h4>
<p>The update function returns the <span class="math inline">\(K\)</span> univariate models used to specify the mpjlcmm model, with updated outputs. The parameters and their estimated variance are replaced by the one optimized in the multivariate framework.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">upd_mm2_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">mm2_b</span><span class="op">)</span></span>
<span><span class="va">mMMSE2_biv</span> <span class="op">&lt;-</span> <span class="va">upd_mm2_b</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">mCESD2_biv</span> <span class="op">&lt;-</span> <span class="va">upd_mm2_b</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>The prediction functions are called on the mMMSE2_biv and mCESD2_biv objects.</p>
</div>
<div class="section level4">
<h4 id="predictions-of-the-trajectories">Predictions of the trajectories<a class="anchor" aria-label="anchor" href="#predictions-of-the-trajectories"></a>
</h4>
<p align="justify">
Class-specific predictions can be computed for any data contained in a dataframe as soon as all the covariates specified in the model are included in the dataframe. In the next lines, such a dataframe is created by generating a vector of <span class="math inline">\(age\)</span> values between 65 and 95. The predictions are computed with <code>predictY</code> and plotted with the associated <code>plot</code> function.
</p>
<p> </p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## predicted trajectories of the MMSE score</span></span>
<span><span class="va">pred_MMSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">mMMSE2_biv</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">65</span>,<span class="fl">95</span>,length.out<span class="op">=</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>, var.time <span class="op">=</span> <span class="st">"age"</span><span class="op">)</span></span>
<span><span class="co">## predicted trajectories of the CESD score</span></span>
<span><span class="va">pred_CESD</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">mCESD2_biv</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">65</span>,<span class="fl">95</span>,length.out<span class="op">=</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>, var.time <span class="op">=</span> <span class="st">"age"</span><span class="op">)</span></span></code></pre></div>
<p> </p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">pred_MMSE</span>, lwd<span class="op">=</span><span class="fl">3</span>, ylab<span class="op">=</span><span class="st">"MMSE"</span>, main<span class="op">=</span><span class="st">"Predicted trajectories for MMSE"</span>, legend.loc<span class="op">=</span><span class="st">"bottomleft"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">pred_CESD</span>, lwd<span class="op">=</span><span class="fl">3</span>, ylab<span class="op">=</span><span class="st">"CESD"</span>, main<span class="op">=</span><span class="st">"Predicted trajectories for CESD"</span>, legend<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p><img src="multivariate_latent_class_model_with_mpjlcmm_files/figure-html/unnamed-chunk-17-1.png" width="768"></p>
<p>To add point by point confidence bands, we use the option draws=TRUE in the predictY call.</p>
<p> </p>
</div>
</div>
<div class="section level3">
<h3 id="evaluation-of-the-model">Evaluation of the model<a class="anchor" aria-label="anchor" href="#evaluation-of-the-model"></a>
</h3>
<div class="section level4">
<h4 id="plot-of-the-residuals">Plot of the residuals<a class="anchor" aria-label="anchor" href="#plot-of-the-residuals"></a>
</h4>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mMMSE2_biv</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mCESD2_biv</span><span class="op">)</span></span></code></pre></div>
<p> </p>
</div>
<div class="section level4">
<h4 id="graph-of-the-predictions-versus-observations">Graph of the predictions versus observations<a class="anchor" aria-label="anchor" href="#graph-of-the-predictions-versus-observations"></a>
</h4>
<p> </p>
<p align="justify">
In order to evaluate the fit of the selected model, we plot simultaneously the observations and the predicted values for each latent class.
</p>
<p> </p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mMMSE2_biv</span>, which<span class="op">=</span><span class="st">"fit"</span>, var.time<span class="op">=</span><span class="st">"age"</span>, marg<span class="op">=</span><span class="cn">FALSE</span>, shades <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mCESD2_biv</span>, which<span class="op">=</span><span class="st">"fit"</span>, var.time<span class="op">=</span><span class="st">"age"</span>, marg<span class="op">=</span><span class="cn">FALSE</span>, shades <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p> </p>
</div>
<div class="section level4">
<h4 id="classification">Classification<a class="anchor" aria-label="anchor" href="#classification"></a>
</h4>
<p>The posterior classification of the model is obtained with:</p>
<p> </p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">postprob</span>(mm2_b) </a>
<a class="sourceLine" id="cb19-2" data-line-number="2"> </a>
<a class="sourceLine" id="cb19-3" data-line-number="3">Posterior classification based on longitudinal and time<span class="op">-</span>to<span class="op">-</span>event data<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="st">  </span>class1 class2</a>
<a class="sourceLine" id="cb19-5" data-line-number="5">N  <span class="fl">107.0</span>  <span class="fl">393.0</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6">%   <span class="fl">21.4</span>   <span class="fl">78.6</span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"> </a>
<a class="sourceLine" id="cb19-8" data-line-number="8">Posterior classification table<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="st">     </span><span class="op">-</span>-&gt;<span class="st"> </span>mean of posterior probabilities <span class="cf">in</span> each class </a>
<a class="sourceLine" id="cb19-10" data-line-number="10">        prob1  prob2</a>
<a class="sourceLine" id="cb19-11" data-line-number="11">class1 <span class="fl">0.8280</span> <span class="fl">0.1720</span></a>
<a class="sourceLine" id="cb19-12" data-line-number="12">class2 <span class="fl">0.1074</span> <span class="fl">0.8926</span></a>
<a class="sourceLine" id="cb19-13" data-line-number="13"> </a>
<a class="sourceLine" id="cb19-14" data-line-number="14">Posterior probabilities above a <span class="kw">threshold</span> (%)<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-15" data-line-number="15"><span class="st">         </span>class1 class2</a>
<a class="sourceLine" id="cb19-16" data-line-number="16">prob<span class="op">&gt;</span><span class="fl">0.7</span>  <span class="fl">70.09</span>  <span class="fl">87.02</span></a>
<a class="sourceLine" id="cb19-17" data-line-number="17">prob<span class="op">&gt;</span><span class="fl">0.8</span>  <span class="fl">65.42</span>  <span class="fl">78.12</span></a>
<a class="sourceLine" id="cb19-18" data-line-number="18">prob<span class="op">&gt;</span><span class="fl">0.9</span>  <span class="fl">46.73</span>  <span class="fl">64.38</span></a>
<a class="sourceLine" id="cb19-19" data-line-number="19"> </a>
<a class="sourceLine" id="cb19-20" data-line-number="20"> </a>
<a class="sourceLine" id="cb19-21" data-line-number="21">Posterior classification based only on longitudinal data<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-22" data-line-number="22"><span class="st">  </span>class1 class2</a>
<a class="sourceLine" id="cb19-23" data-line-number="23">N  <span class="fl">107.0</span>  <span class="fl">393.0</span></a>
<a class="sourceLine" id="cb19-24" data-line-number="24">%   <span class="fl">21.4</span>   <span class="fl">78.6</span></a>
<a class="sourceLine" id="cb19-25" data-line-number="25"> </a></code></pre></div>
<p> </p>
<p align="justify">
</p>
<p><code>Class 1</code> is composed of 107 subjects (21.4%), whereas 393 are in the second class.</p>
<p>We can also see a good discrimination power of the model with a mean posterior probability of 0.8280 for class 1 and 0.8926 for class 2. A satisfactory proportion of subject are also classified with a posterior probability above 0.7.</p>
<p> </p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="multivariate-joint-models">Multivariate joint models<a class="anchor" aria-label="anchor" href="#multivariate-joint-models"></a>
</h2>
<p>The mpjclmm function also allows the modelisation of a time-to-event outcome with a proportional hazard model, possibly with competing risks.</p>
<p>To add the time to dementia to the previous model, the call is :</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mmS2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE2</span>,<span class="va">mCESD2</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">2</span>, data<span class="op">=</span><span class="va">paquid</span>,</span>
<span>                survival<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">age_init</span>,<span class="va">agedem</span>,<span class="va">dem</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Cecile Proust-Lima, Viviane Philipps.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
