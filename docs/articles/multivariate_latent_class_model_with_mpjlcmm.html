<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>How to estimate a multivariate latent class mixed model using mpjlcmm function ‚Ä¢ lcmm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to estimate a multivariate latent class mixed model using mpjlcmm function">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lcmm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/lcmm.html">GET STARTED</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">VIGNETTES</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/latent_class_model_with_hlme.html">How to estimate a latent class mixed model using hlme function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_lcmm.html">How to estimate a latent process mixed model using lcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm.html">How to estimate a latent process mixed model for multivariate markers using multlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm_IRT.html">Continuous-time longitudinal IRT model</a></li>
    <li><a class="dropdown-item" href="../articles/joint_latent_class_model_with_Jointlcmm.html">How to estimate a joint latent class mixed model using Jointlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/multivariate_latent_class_model_with_mpjlcmm.html">How to estimate a multivariate latent class mixed model using mpjlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/secondary_model_with_externVar.html">Accounting for latent class assignment uncertainty in subsequent analyses</a></li>
    <li><a class="dropdown-item" href="../articles/pre_normalizing.html">Pre-normalizing a dependent variable using lcmm</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/usual_problems.html">FAQ</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">REFERENCE</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">CHANGELOG</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CecileProust-Lima/lcmm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>How to estimate a multivariate latent class mixed model using mpjlcmm function</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CecileProust-Lima/lcmm/blob/HEAD/vignettes/multivariate_latent_class_model_with_mpjlcmm.Rmd" class="external-link"><code>vignettes/multivariate_latent_class_model_with_mpjlcmm.Rmd</code></a></small>
      <div class="d-none name"><code>multivariate_latent_class_model_with_mpjlcmm.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background-and-definitions">Background and definitions<a class="anchor" aria-label="anchor" href="#background-and-definitions"></a>
</h2>
<p align="justify">
The latent class mixed model consists in assuming that the population is
heterogeneous and composed of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
latent classes. In the multivariate case, the latent classes are defined
according to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
longitudinal outcomes, resulting in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
groups characterized by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
sets of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
mean profiles of trajectories.
</p>
<div class="section level3">
<h3 id="the-multivariate-latent-class-mixed-model">The multivariate latent class mixed model<a class="anchor" aria-label="anchor" href="#the-multivariate-latent-class-mixed-model"></a>
</h3>
<p align="justify">
</p>
<p>Latent class membership is defined by a discrete random variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>i</mi></msub><annotation encoding="application/x-tex">c_{i}</annotation></semantics></math>
that equals
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
if subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
belongs to latent class
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
= 1,
‚Ä¶,<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>).
The variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>i</mi></msub><annotation encoding="application/x-tex">c_{i}</annotation></semantics></math>
is latent; its probability is described using a multinomial logistic
model according to covariates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>c</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">X_{ci}</annotation></semantics></math>:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œÄ</mi><mrow><mi>i</mi><mi>g</mi></mrow></msub><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><mi>g</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mrow><mi>c</mi><mi>i</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œæ</mi><mrow><mn>0</mn><mi>g</mi></mrow></msub><mo>+</mo><msub><mi>X</mi><mrow><mi>c</mi><mi>i</mi></mrow></msub><msub><mi>Œæ</mi><mrow><mn>1</mn><mi>g</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msubsup><mo>‚àë</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>G</mi></msubsup><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œæ</mi><mrow><mn>0</mn><mi>l</mi></mrow></msub><mo>+</mo><msub><mi>X</mi><mrow><mi>c</mi><mi>i</mi></mrow></msub><msub><mi>Œæ</mi><mrow><mn>1</mn><mi>l</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">\pi_{ig}= P(c_{i} = g|X_{ci}) = \frac{\exp(\xi_{0g}+X_{ci}\xi_{1g})}{ \sum_{l=1}^{G}\exp(\xi_{0l}+X_{ci}\xi_{1l})}</annotation></semantics></math></p>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œæ</mi><mrow><mn>0</mn><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">\xi_{0g}</annotation></semantics></math>
is the intercept for class
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œæ</mi><mrow><mn>1</mn><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">\xi_{1g}</annotation></semantics></math>
is the q1-vector of class-specific parameters associated with the
q1-vector of time-independent covariates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>c</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">X_{ci}</annotation></semantics></math>.
For identifiability,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œæ</mi><mrow><mn>0</mn><mi>G</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\xi_{0G} = 0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œæ</mi><mrow><mn>1</mn><mi>G</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\xi_{1G} = 0</annotation></semantics></math>.
When no covariate predicts the latent class membership, this model
reduces to a class-specific probability.

<p align="justify">
The trajectories of each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>k</mi></msub><annotation encoding="application/x-tex">Y_k</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mo>,</mo><mi>K</mi></mrow><annotation encoding="application/x-tex">k=1,..,K</annotation></semantics></math>
are defined conditionally to the latent class. For Gaussian outcomes,
conditional on class
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>,
the model is a linear mixed model defined for subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
at occasion
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
by:
</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>k</mi><mi>i</mi><mi>j</mi></mrow></msub><msub><mo stretchy="false" form="prefix">|</mo><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><mi>g</mi></mrow></msub><mo>=</mo><msub><mi>X</mi><mrow><mn>2</mn><mi>k</mi><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>Œ≤</mi><mi>k</mi></msub><mo>+</mo><msub><mi>X</mi><mrow><mn>3</mn><mi>k</mi><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>Œ≥</mi><mrow><mi>k</mi><mi>g</mi></mrow></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>k</mi><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>b</mi><mrow><mi>k</mi><mi>i</mi></mrow></msub><mo>+</mo><msub><mi>œµ</mi><mrow><mi>k</mi><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Y_{kij}|_{c_{i}=g} = X_{2kij}\beta_k+X_{3kij}\gamma_{kg}+Z_{kij}b_{ki}+\epsilon_{kij}</annotation></semantics></math></p>
<p align="justify">
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mn>2</mn><mi>k</mi><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">X_{2kij}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mn>3</mn><mi>k</mi><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">X_{3kij}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mrow><mi>k</mi><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">Z_{kij}</annotation></semantics></math>
are vectors of covariates respectively associated with common fixed
effects over classes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ≤</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\beta_k</annotation></semantics></math>,
class-specific fixed effects
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ≥</mi><mrow><mi>k</mi><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">\gamma_{kg}</annotation></semantics></math>
and with individual random effects
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mrow><mi>k</mi><mi>i</mi></mrow></msub><msub><mo stretchy="false" form="prefix">|</mo><mrow><mi>c</mi><mi>i</mi><mo>=</mo><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">b_{ki}|_{ci=g}</annotation></semantics></math>
called
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>b</mi><mrow><mi>k</mi><mi>i</mi><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">b_{kig}</annotation></semantics></math>
whose distributions are now class-specific.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mn>2</mn><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">X_{2k}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mn>3</mn><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">X_{3k}</annotation></semantics></math>
can‚Äôt have common variables.
</p>
<p align="justify">
Neither the random effects nor the error measurements are correlated
between outcomes. So conditionally to the latent classes the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
outcomes are independent.
</p>
<p>¬†</p>
For curvilinear outcomes, we use a latent process model defined by:

<p>¬†</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><msub><mo stretchy="false" form="prefix">|</mo><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><mi>g</mi></mrow></msub><mo>=</mo><msub><mi>H</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mspace width="0.222em"></mspace><msub><mi>X</mi><mrow><mn>2</mn><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><msub><mi>Œ≤</mi><mi>k</mi></msub><mo>+</mo><msub><mi>X</mi><mrow><mn>3</mn><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><msub><mi>Œ≥</mi><mrow><mi>g</mi><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><msub><mi>b</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>œµ</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mspace width="0.222em"></mspace><mo>;</mo><msub><mi>Œ∑</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y_{ijk}|_{c_{i}=g} = H_k(~ X_{2ijk}\beta_k+X_{3ijk}\gamma_{gk}+Z_{ijk}b_{ik}+\epsilon_{ijk} ~; \eta_k)</annotation></semantics></math></p>
<p>¬†</p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mi>k</mi></msub><annotation encoding="application/x-tex">H_k</annotation></semantics></math>
is a link function parameterized by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ∑</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\eta_k</annotation></semantics></math>.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>H</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><annotation encoding="application/x-tex">H^{-1}</annotation></semantics></math>
can belong to the family of linear functions, rescaled Beta cumulative
distribution function, or quadractic I-splines functions. Note however
that the mpjlcmm function only supports continuous outcomes, so the IRT
models are not available for the moment.</p>
<p>¬†</p>
</div>
<div class="section level3">
<h3 id="posterior-classification">Posterior classification<a class="anchor" aria-label="anchor" href="#posterior-classification"></a>
</h3>
<p align="justify">
In models involving latent classes, a posterior classification of the
subjects in each latent class can be made. It is based on the posterior
calculation of the class-membership probabilities and is used to
characterize the classification of the subjects as well as to evaluate
the goodness-of-fit of the model.
</p>
<p align="justify">
Posterior class-membership probabilities are computed using the Bayes
theorem as the probability of belonging to a latent class given the
whole information collected. In a longitudinal model, they are defined
for subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and latent class
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
as:
</p>
<p>¬†</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>œÄ</mi><mo accent="true">ÃÇ</mo></mover><mrow><mi>i</mi><mi>g</mi></mrow><mi>Y</mi></msubsup><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><mi>g</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>,</mo><msub><mover><mi>Œ∏</mi><mo accent="true">ÃÇ</mo></mover><mi>G</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\pi}_{ig}^Y=P(c_{i}=g|X_{i},Y_{i},\hat{\theta}_{G})</annotation></semantics></math></p>
<p><em>where :</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>Œ∏</mi><mo accent="true">ÃÇ</mo></mover><mi>G</mi></msub><annotation encoding="application/x-tex">\hat{\theta}_{G}</annotation></semantics></math>
is the vector of parameters estimated in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
latent class model.</p>
<p>¬†</p>
<p>¬†</p>
</div>
</div>
<div class="section level2">
<h2 id="a-bivariate-example">A bivariate example<a class="anchor" aria-label="anchor" href="#a-bivariate-example"></a>
</h2>
<p align="justify">
In this example we study simultaneously the trajectories of a cognitive
marker (<strong>MMSE</strong>) and a depression scale
(<strong>CESD</strong>) in a sample of old people (aged 65 years old and
over at inclusion) followed for up to 15 years. The two outcomes have a
skewed distribution, so we will use latent process models with I-splines
link functions.
</p>
<div class="section level3">
<h3 id="model-considered">Model considered<a class="anchor" aria-label="anchor" href="#model-considered"></a>
</h3>
<p align="justify">
We consider class specific linear trajectories with age without further
ajustement. For class
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>,
subejct
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and repeated measurement
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>,
the model is:
</p>
<p>¬†</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>M</mi><mi>S</mi><msub><mi>E</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mo stretchy="false" form="prefix">|</mo><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><mi>g</mi></mrow></msub><mo>=</mo><msub><mi>Œ≤</mi><mrow><mn>10</mn><mi>g</mi></mrow></msub><mo>+</mo><msub><mi>Œ≤</mi><mrow><mn>11</mn><mi>g</mi></mrow></msub><mi>a</mi><mi>g</mi><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>u</mi><mrow><mn>10</mn><mi>i</mi><mi>g</mi></mrow></msub><mo>+</mo><msub><mi>u</mi><mrow><mn>11</mn><mi>i</mi><mi>g</mi></mrow></msub><mi>a</mi><mi>g</mi><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>œµ</mi><mrow><mn>1</mn><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">MMSE_{ij}|_{c_{i}=g}=\beta_{10g}+\beta_{11g}age_{ij}+u_{10ig}+u_{11ig}age_{ij}+\epsilon_{1ij}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>E</mi><mi>S</mi><msub><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mo stretchy="false" form="prefix">|</mo><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><mi>g</mi></mrow></msub><mo>=</mo><msub><mi>Œ≤</mi><mrow><mn>20</mn><mi>g</mi></mrow></msub><mo>+</mo><msub><mi>Œ≤</mi><mrow><mn>21</mn><mi>g</mi></mrow></msub><mi>a</mi><mi>g</mi><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>u</mi><mrow><mn>20</mn><mi>i</mi><mi>g</mi></mrow></msub><mo>+</mo><msub><mi>u</mi><mrow><mn>21</mn><mi>i</mi><mi>g</mi></mrow></msub><mi>a</mi><mi>g</mi><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>œµ</mi><mrow><mn>2</mn><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">CESD_{ij}|_{c_{i}=g}=\beta_{20g}+\beta_{21g}age_{ij}+u_{20ig}+u_{21ig}age_{ij}+\epsilon_{2ij}</annotation></semantics></math></p>
<p>¬†</p>
<p><em>Where :</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mrow><mi>k</mi><mi>i</mi><mi>g</mi></mrow></msub><mo>‚àº</mo><mi>ùí©</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msub><mi>B</mi><mrow><mi>k</mi><mi>g</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">u_{kig} \sim \mathcal{N}(0,B_{kg})</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œµ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>‚àº</mo><mi>ùí©</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msup><mi>œÉ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\epsilon_{ij} \sim \mathcal{N}(0,\sigma^2)</annotation></semantics></math>.</p>
<p>¬†</p>
</div>
<div class="section level3">
<h3 id="estimate-the-model-with-only-one-class-g1">Estimate the model with only one class (G=1)<a class="anchor" aria-label="anchor" href="#estimate-the-model-with-only-one-class-g1"></a>
</h3>
<p>To estimate a multivariate model, we define first each univariate
submodel with the appropriate function. As we use here latent process
models, we use the lcmm function.</p>
<p>¬†</p>
<p>We begin with the MMSE :</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>mMMSE <span class="ot">&lt;-</span> <span class="fu">lcmm</span>(MMSE <span class="sc">~</span> <span class="fu">I</span>((age<span class="dv">-65</span>)<span class="sc">/</span><span class="dv">10</span>), <span class="at">random =</span><span class="sc">~</span><span class="fu">I</span>((age<span class="dv">-65</span>)<span class="sc">/</span><span class="dv">10</span>), <span class="at">subject=</span><span class="st">'ID'</span>, <span class="at">data =</span> paquid,</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>              <span class="at">link =</span><span class="st">"5-quant-splines"</span>, <span class="at">verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">summary</span>(mMMSE)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>General latent class mixed model </span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>     fitted by maximum likelihood method </span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a> </span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">lcmm</span>(<span class="at">fixed =</span> MMSE <span class="sc">~</span> <span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>)<span class="sc">/</span><span class="dv">10</span>), <span class="at">random =</span> <span class="sc">~</span><span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>)<span class="sc">/</span><span class="dv">10</span>), </span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>    <span class="at">subject =</span> <span class="st">"ID"</span>, <span class="at">link =</span> <span class="st">"5-quant-splines"</span>, <span class="at">data =</span> paquid, </span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a> </span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>Statistical Model<span class="sc">:</span> </span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>     Dataset<span class="sc">:</span> paquid </span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>     Number of subjects<span class="sc">:</span> <span class="dv">500</span> </span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>     Number of observations<span class="sc">:</span> <span class="dv">2214</span> </span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>     Number of observations deleted<span class="sc">:</span> <span class="dv">36</span> </span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>     Number of latent classes<span class="sc">:</span> <span class="dv">1</span> </span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>     Number of parameters<span class="sc">:</span> <span class="dv">11</span>  </span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>     Link <span class="cf">function</span><span class="sc">:</span> Quadratic I<span class="sc">-</span>splines with nodes  </span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="dv">0</span> <span class="dv">25</span> <span class="dv">27</span> <span class="dv">29</span> <span class="dv">30</span>  </span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a> </span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>Iteration process<span class="sc">:</span> </span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>     Convergence criteria satisfied </span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>     Number of iterations<span class="sc">:</span>  <span class="dv">32</span> </span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>     Convergence criteria<span class="sc">:</span> parameters<span class="ot">=</span> <span class="fl">1.5e-08</span> </span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>                         <span class="sc">:</span> likelihood<span class="ot">=</span> <span class="fl">1.4e-06</span> </span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a>                         <span class="sc">:</span> second derivatives<span class="ot">=</span> <span class="fl">1.2e-07</span> </span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a> </span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a>Goodness<span class="sc">-</span>of<span class="sc">-</span>fit statistics<span class="sc">:</span> </span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a>     maximum log<span class="sc">-</span>likelihood<span class="sc">:</span> <span class="sc">-</span><span class="fl">4687.54</span>  </span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a>     AIC<span class="sc">:</span> <span class="fl">9397.08</span>  </span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a>     BIC<span class="sc">:</span> <span class="fl">9443.45</span>  </span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a> </span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a>     Discrete posterior log<span class="sc">-</span>likelihood<span class="sc">:</span> <span class="sc">-</span><span class="fl">4677.75</span>  </span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a>     Discrete AIC<span class="sc">:</span> <span class="fl">9377.5</span>  </span>
<span id="cb1-35"><a href="#cb1-35" tabindex="-1"></a> </span>
<span id="cb1-36"><a href="#cb1-36" tabindex="-1"></a>     Mean discrete AIC per subject<span class="sc">:</span> <span class="fl">9.3775</span>  </span>
<span id="cb1-37"><a href="#cb1-37" tabindex="-1"></a>     Mean UACV per subject<span class="sc">:</span> <span class="fl">9.3762</span>  </span>
<span id="cb1-38"><a href="#cb1-38" tabindex="-1"></a>     Mean discrete LL per subject<span class="sc">:</span> <span class="sc">-</span><span class="fl">9.3555</span>  </span>
<span id="cb1-39"><a href="#cb1-39" tabindex="-1"></a> </span>
<span id="cb1-40"><a href="#cb1-40" tabindex="-1"></a>Maximum Likelihood Estimates<span class="sc">:</span> </span>
<span id="cb1-41"><a href="#cb1-41" tabindex="-1"></a> </span>
<span id="cb1-42"><a href="#cb1-42" tabindex="-1"></a>Fixed effects <span class="cf">in</span> the longitudinal model<span class="sc">:</span></span>
<span id="cb1-43"><a href="#cb1-43" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" tabindex="-1"></a>                              coef      Se    Wald p<span class="sc">-</span>value</span>
<span id="cb1-45"><a href="#cb1-45" tabindex="-1"></a><span class="fu">intercept</span> (not estimated)        <span class="dv">0</span>                        </span>
<span id="cb1-46"><a href="#cb1-46" tabindex="-1"></a><span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>)<span class="sc">/</span><span class="dv">10</span>)          <span class="sc">-</span><span class="fl">1.19894</span> <span class="fl">0.07188</span> <span class="sc">-</span><span class="fl">16.681</span> <span class="fl">0.00000</span></span>
<span id="cb1-47"><a href="#cb1-47" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" tabindex="-1"></a>Variance<span class="sc">-</span>covariance matrix of the random<span class="sc">-</span>effects<span class="sc">:</span></span>
<span id="cb1-50"><a href="#cb1-50" tabindex="-1"></a>                 intercept <span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>)<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb1-51"><a href="#cb1-51" tabindex="-1"></a>intercept          <span class="fl">2.23236</span>                 </span>
<span id="cb1-52"><a href="#cb1-52" tabindex="-1"></a><span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>)<span class="sc">/</span><span class="dv">10</span>)  <span class="sc">-</span><span class="fl">0.90184</span>          <span class="fl">0.86839</span></span>
<span id="cb1-53"><a href="#cb1-53" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" tabindex="-1"></a>Residual standard <span class="fu">error</span> (not estimated) <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb1-55"><a href="#cb1-55" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" tabindex="-1"></a>Parameters of the link <span class="cf">function</span><span class="sc">:</span></span>
<span id="cb1-57"><a href="#cb1-57" tabindex="-1"></a></span>
<span id="cb1-58"><a href="#cb1-58" tabindex="-1"></a>               coef      Se    Wald p<span class="sc">-</span>value</span>
<span id="cb1-59"><a href="#cb1-59" tabindex="-1"></a>I<span class="sc">-</span>splines1 <span class="sc">-</span><span class="fl">7.12837</span> <span class="fl">0.24342</span> <span class="sc">-</span><span class="fl">29.284</span> <span class="fl">0.00000</span></span>
<span id="cb1-60"><a href="#cb1-60" tabindex="-1"></a>I<span class="sc">-</span>splines2  <span class="fl">1.04836</span> <span class="fl">0.08124</span>  <span class="fl">12.905</span> <span class="fl">0.00000</span></span>
<span id="cb1-61"><a href="#cb1-61" tabindex="-1"></a>I<span class="sc">-</span>splines3 <span class="sc">-</span><span class="fl">0.00109</span> <span class="fl">0.03823</span>  <span class="sc">-</span><span class="fl">0.029</span> <span class="fl">0.97718</span></span>
<span id="cb1-62"><a href="#cb1-62" tabindex="-1"></a>I<span class="sc">-</span>splines4  <span class="fl">1.98400</span> <span class="fl">0.03385</span>  <span class="fl">58.609</span> <span class="fl">0.00000</span></span>
<span id="cb1-63"><a href="#cb1-63" tabindex="-1"></a>I<span class="sc">-</span>splines5  <span class="fl">1.25589</span> <span class="fl">0.03022</span>  <span class="fl">41.554</span> <span class="fl">0.00000</span></span>
<span id="cb1-64"><a href="#cb1-64" tabindex="-1"></a>I<span class="sc">-</span>splines6  <span class="fl">1.00133</span> <span class="fl">0.03617</span>  <span class="fl">27.681</span> <span class="fl">0.00000</span></span>
<span id="cb1-65"><a href="#cb1-65" tabindex="-1"></a>I<span class="sc">-</span>splines7  <span class="fl">0.91387</span> <span class="fl">0.02684</span>  <span class="fl">34.055</span> <span class="fl">0.00000</span></span></code></pre></div>
<p>¬†</p>
<p>We see in the summary that one of the I-splines parameters is very
small. To avoid numerical issues in more complex models, we fix this
parameter to zero :</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>binit <span class="ot">&lt;-</span> mMMSE<span class="sc">$</span>best</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>binit[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>mMMSE1 <span class="ot">&lt;-</span> <span class="fu">lcmm</span>(MMSE <span class="sc">~</span> <span class="fu">I</span>((age<span class="dv">-65</span>)<span class="sc">/</span><span class="dv">10</span>), <span class="at">random =</span><span class="sc">~</span><span class="fu">I</span>((age<span class="dv">-65</span>)<span class="sc">/</span><span class="dv">10</span>), <span class="at">subject=</span><span class="st">'ID'</span>, <span class="at">data =</span> paquid,</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>               <span class="at">link =</span><span class="st">"5-quant-splines"</span>, <span class="at">verbose=</span><span class="cn">FALSE</span>, <span class="at">B=</span>binit, <span class="at">posfix=</span><span class="dv">7</span>)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">summary</span>(mMMSE1)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>General latent class mixed model </span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>     fitted by maximum likelihood method </span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a> </span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="fu">lcmm</span>(<span class="at">fixed =</span> MMSE <span class="sc">~</span> <span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>)<span class="sc">/</span><span class="dv">10</span>), <span class="at">random =</span> <span class="sc">~</span><span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>)<span class="sc">/</span><span class="dv">10</span>), </span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>    <span class="at">subject =</span> <span class="st">"ID"</span>, <span class="at">link =</span> <span class="st">"5-quant-splines"</span>, <span class="at">data =</span> paquid, </span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>    <span class="at">posfix =</span> <span class="dv">7</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a> </span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>Statistical Model<span class="sc">:</span> </span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>     Dataset<span class="sc">:</span> paquid </span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>     Number of subjects<span class="sc">:</span> <span class="dv">500</span> </span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>     Number of observations<span class="sc">:</span> <span class="dv">2214</span> </span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>     Number of observations deleted<span class="sc">:</span> <span class="dv">36</span> </span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>     Number of latent classes<span class="sc">:</span> <span class="dv">1</span> </span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>     Number of parameters<span class="sc">:</span> <span class="dv">11</span>  </span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>     Number of estimated parameters<span class="sc">:</span> <span class="dv">10</span>  </span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>     Link <span class="cf">function</span><span class="sc">:</span> Quadratic I<span class="sc">-</span>splines with nodes  </span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="dv">0</span> <span class="dv">25</span> <span class="dv">27</span> <span class="dv">29</span> <span class="dv">30</span>  </span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a> </span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>Iteration process<span class="sc">:</span> </span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>     Convergence criteria satisfied </span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>     Number of iterations<span class="sc">:</span>  <span class="dv">1</span> </span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>     Convergence criteria<span class="sc">:</span> parameters<span class="ot">=</span> <span class="fl">1.1e-13</span> </span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>                         <span class="sc">:</span> likelihood<span class="ot">=</span> <span class="fl">2.3e-10</span> </span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a>                         <span class="sc">:</span> second derivatives<span class="ot">=</span> <span class="fl">1.7e-14</span> </span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a> </span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a>Goodness<span class="sc">-</span>of<span class="sc">-</span>fit statistics<span class="sc">:</span> </span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a>     maximum log<span class="sc">-</span>likelihood<span class="sc">:</span> <span class="sc">-</span><span class="fl">4687.54</span>  </span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a>     AIC<span class="sc">:</span> <span class="fl">9395.08</span>  </span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a>     BIC<span class="sc">:</span> <span class="fl">9437.23</span>  </span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a> </span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a>     Discrete posterior log<span class="sc">-</span>likelihood<span class="sc">:</span> <span class="sc">-</span><span class="fl">4677.75</span>  </span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a>     Discrete AIC<span class="sc">:</span> <span class="fl">9375.5</span>  </span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a> </span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a>     Mean discrete AIC per subject<span class="sc">:</span> <span class="fl">9.3755</span>  </span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a>     Mean UACV per subject<span class="sc">:</span> <span class="fl">9.3762</span>  </span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a>     Mean discrete LL per subject<span class="sc">:</span> <span class="sc">-</span><span class="fl">9.3555</span>  </span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a> </span>
<span id="cb2-43"><a href="#cb2-43" tabindex="-1"></a>Maximum Likelihood Estimates<span class="sc">:</span> </span>
<span id="cb2-44"><a href="#cb2-44" tabindex="-1"></a> </span>
<span id="cb2-45"><a href="#cb2-45" tabindex="-1"></a>Fixed effects <span class="cf">in</span> the longitudinal model<span class="sc">:</span></span>
<span id="cb2-46"><a href="#cb2-46" tabindex="-1"></a></span>
<span id="cb2-47"><a href="#cb2-47" tabindex="-1"></a>                              coef      Se    Wald p<span class="sc">-</span>value</span>
<span id="cb2-48"><a href="#cb2-48" tabindex="-1"></a><span class="fu">intercept</span> (not estimated)        <span class="dv">0</span>                        </span>
<span id="cb2-49"><a href="#cb2-49" tabindex="-1"></a><span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>)<span class="sc">/</span><span class="dv">10</span>)          <span class="sc">-</span><span class="fl">1.19894</span> <span class="fl">0.07188</span> <span class="sc">-</span><span class="fl">16.681</span> <span class="fl">0.00000</span></span>
<span id="cb2-50"><a href="#cb2-50" tabindex="-1"></a></span>
<span id="cb2-51"><a href="#cb2-51" tabindex="-1"></a></span>
<span id="cb2-52"><a href="#cb2-52" tabindex="-1"></a>Variance<span class="sc">-</span>covariance matrix of the random<span class="sc">-</span>effects<span class="sc">:</span></span>
<span id="cb2-53"><a href="#cb2-53" tabindex="-1"></a>                 intercept <span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>)<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb2-54"><a href="#cb2-54" tabindex="-1"></a>intercept          <span class="fl">2.23236</span>                 </span>
<span id="cb2-55"><a href="#cb2-55" tabindex="-1"></a><span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>)<span class="sc">/</span><span class="dv">10</span>)  <span class="sc">-</span><span class="fl">0.90184</span>          <span class="fl">0.86839</span></span>
<span id="cb2-56"><a href="#cb2-56" tabindex="-1"></a></span>
<span id="cb2-57"><a href="#cb2-57" tabindex="-1"></a>Residual standard <span class="fu">error</span> (not estimated) <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb2-58"><a href="#cb2-58" tabindex="-1"></a></span>
<span id="cb2-59"><a href="#cb2-59" tabindex="-1"></a>Parameters of the link <span class="cf">function</span><span class="sc">:</span></span>
<span id="cb2-60"><a href="#cb2-60" tabindex="-1"></a></span>
<span id="cb2-61"><a href="#cb2-61" tabindex="-1"></a>               coef       Se    Wald p<span class="sc">-</span>value</span>
<span id="cb2-62"><a href="#cb2-62" tabindex="-1"></a>I<span class="sc">-</span>splines1 <span class="sc">-</span><span class="fl">7.12837</span>  <span class="fl">0.24343</span> <span class="sc">-</span><span class="fl">29.283</span> <span class="fl">0.00000</span></span>
<span id="cb2-63"><a href="#cb2-63" tabindex="-1"></a>I<span class="sc">-</span>splines2  <span class="fl">1.04836</span>  <span class="fl">0.08124</span>  <span class="fl">12.905</span> <span class="fl">0.00000</span></span>
<span id="cb2-64"><a href="#cb2-64" tabindex="-1"></a>I<span class="sc">-</span>splines3  <span class="fl">0.00000</span><span class="sc">*</span>                        </span>
<span id="cb2-65"><a href="#cb2-65" tabindex="-1"></a>I<span class="sc">-</span>splines4  <span class="fl">1.98400</span>  <span class="fl">0.03385</span>  <span class="fl">58.607</span> <span class="fl">0.00000</span></span>
<span id="cb2-66"><a href="#cb2-66" tabindex="-1"></a>I<span class="sc">-</span>splines5  <span class="fl">1.25589</span>  <span class="fl">0.03022</span>  <span class="fl">41.554</span> <span class="fl">0.00000</span></span>
<span id="cb2-67"><a href="#cb2-67" tabindex="-1"></a>I<span class="sc">-</span>splines6  <span class="fl">1.00133</span>  <span class="fl">0.03617</span>  <span class="fl">27.681</span> <span class="fl">0.00000</span></span>
<span id="cb2-68"><a href="#cb2-68" tabindex="-1"></a>I<span class="sc">-</span>splines7  <span class="fl">0.91387</span>  <span class="fl">0.02684</span>  <span class="fl">34.055</span> <span class="fl">0.00000</span></span>
<span id="cb2-69"><a href="#cb2-69" tabindex="-1"></a></span>
<span id="cb2-70"><a href="#cb2-70" tabindex="-1"></a> <span class="sc">*</span> coefficient fixed by the user </span>
<span id="cb2-71"><a href="#cb2-71" tabindex="-1"></a> </span></code></pre></div>
<p>¬†</p>
<p>We use the same specification for CESD. Note however that the
specification can differ between the outcomes.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>mCESD1 <span class="ot">&lt;-</span> <span class="fu">lcmm</span>(CESD <span class="sc">~</span> <span class="fu">I</span>((age<span class="dv">-65</span>)<span class="sc">/</span><span class="dv">10</span>), <span class="at">random =</span><span class="sc">~</span><span class="fu">I</span>((age<span class="dv">-65</span>)<span class="sc">/</span><span class="dv">10</span>), <span class="at">subject=</span><span class="st">'ID'</span>, <span class="at">data =</span> paquid,</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>               <span class="at">link =</span><span class="st">"5-quant-splines"</span>, <span class="at">verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">summary</span>(mCESD1)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>General latent class mixed model </span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>     fitted by maximum likelihood method </span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a> </span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="fu">lcmm</span>(<span class="at">fixed =</span> CESD <span class="sc">~</span> <span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>)<span class="sc">/</span><span class="dv">10</span>), <span class="at">random =</span> <span class="sc">~</span><span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>)<span class="sc">/</span><span class="dv">10</span>), </span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>    <span class="at">subject =</span> <span class="st">"ID"</span>, <span class="at">link =</span> <span class="st">"5-quant-splines"</span>, <span class="at">data =</span> paquid, </span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a> </span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>Statistical Model<span class="sc">:</span> </span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>     Dataset<span class="sc">:</span> paquid </span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>     Number of subjects<span class="sc">:</span> <span class="dv">500</span> </span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>     Number of observations<span class="sc">:</span> <span class="dv">2104</span> </span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>     Number of observations deleted<span class="sc">:</span> <span class="dv">146</span> </span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>     Number of latent classes<span class="sc">:</span> <span class="dv">1</span> </span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>     Number of parameters<span class="sc">:</span> <span class="dv">11</span>  </span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>     Link <span class="cf">function</span><span class="sc">:</span> Quadratic I<span class="sc">-</span>splines with nodes  </span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="dv">0</span> <span class="dv">2</span> <span class="dv">6</span> <span class="dv">12</span> <span class="dv">52</span>  </span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a> </span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>Iteration process<span class="sc">:</span> </span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>     Convergence criteria satisfied </span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>     Number of iterations<span class="sc">:</span>  <span class="dv">21</span> </span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a>     Convergence criteria<span class="sc">:</span> parameters<span class="ot">=</span> <span class="fl">1.9e-10</span> </span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a>                         <span class="sc">:</span> likelihood<span class="ot">=</span> <span class="fl">8.1e-09</span> </span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a>                         <span class="sc">:</span> second derivatives<span class="ot">=</span> <span class="fl">3.9e-16</span> </span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a> </span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a>Goodness<span class="sc">-</span>of<span class="sc">-</span>fit statistics<span class="sc">:</span> </span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a>     maximum log<span class="sc">-</span>likelihood<span class="sc">:</span> <span class="sc">-</span><span class="fl">6331.04</span>  </span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a>     AIC<span class="sc">:</span> <span class="fl">12684.07</span>  </span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a>     BIC<span class="sc">:</span> <span class="fl">12730.43</span>  </span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a> </span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a>     Discrete posterior log<span class="sc">-</span>likelihood<span class="sc">:</span> <span class="sc">-</span><span class="fl">6320.34</span>  </span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a>     Discrete AIC<span class="sc">:</span> <span class="fl">12662.67</span>  </span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a> </span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a>     Mean discrete AIC per subject<span class="sc">:</span> <span class="fl">12.6627</span>  </span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a>     Mean UACV per subject<span class="sc">:</span> <span class="fl">12.6623</span>  </span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a>     Mean discrete LL per subject<span class="sc">:</span> <span class="sc">-</span><span class="fl">12.6407</span>  </span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a> </span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a>Maximum Likelihood Estimates<span class="sc">:</span> </span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a> </span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a>Fixed effects <span class="cf">in</span> the longitudinal model<span class="sc">:</span></span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a></span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a>                              coef      Se    Wald p<span class="sc">-</span>value</span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a><span class="fu">intercept</span> (not estimated)        <span class="dv">0</span>                        </span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a><span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>)<span class="sc">/</span><span class="dv">10</span>)           <span class="fl">0.53187</span> <span class="fl">0.05164</span>  <span class="fl">10.299</span> <span class="fl">0.00000</span></span>
<span id="cb3-47"><a href="#cb3-47" tabindex="-1"></a></span>
<span id="cb3-48"><a href="#cb3-48" tabindex="-1"></a></span>
<span id="cb3-49"><a href="#cb3-49" tabindex="-1"></a>Variance<span class="sc">-</span>covariance matrix of the random<span class="sc">-</span>effects<span class="sc">:</span></span>
<span id="cb3-50"><a href="#cb3-50" tabindex="-1"></a>                 intercept <span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>)<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb3-51"><a href="#cb3-51" tabindex="-1"></a>intercept          <span class="fl">2.08271</span>                 </span>
<span id="cb3-52"><a href="#cb3-52" tabindex="-1"></a><span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>)<span class="sc">/</span><span class="dv">10</span>)  <span class="sc">-</span><span class="fl">0.43992</span>          <span class="fl">0.18055</span></span>
<span id="cb3-53"><a href="#cb3-53" tabindex="-1"></a></span>
<span id="cb3-54"><a href="#cb3-54" tabindex="-1"></a>Residual standard <span class="fu">error</span> (not estimated) <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb3-55"><a href="#cb3-55" tabindex="-1"></a></span>
<span id="cb3-56"><a href="#cb3-56" tabindex="-1"></a>Parameters of the link <span class="cf">function</span><span class="sc">:</span></span>
<span id="cb3-57"><a href="#cb3-57" tabindex="-1"></a></span>
<span id="cb3-58"><a href="#cb3-58" tabindex="-1"></a>               coef      Se    Wald p<span class="sc">-</span>value</span>
<span id="cb3-59"><a href="#cb3-59" tabindex="-1"></a>I<span class="sc">-</span>splines1 <span class="sc">-</span><span class="fl">1.66789</span> <span class="fl">0.10563</span> <span class="sc">-</span><span class="fl">15.790</span> <span class="fl">0.00000</span></span>
<span id="cb3-60"><a href="#cb3-60" tabindex="-1"></a>I<span class="sc">-</span>splines2  <span class="fl">1.04688</span> <span class="fl">0.02463</span>  <span class="fl">42.503</span> <span class="fl">0.00000</span></span>
<span id="cb3-61"><a href="#cb3-61" tabindex="-1"></a>I<span class="sc">-</span>splines3  <span class="fl">0.74268</span> <span class="fl">0.03772</span>  <span class="fl">19.688</span> <span class="fl">0.00000</span></span>
<span id="cb3-62"><a href="#cb3-62" tabindex="-1"></a>I<span class="sc">-</span>splines4  <span class="fl">0.98353</span> <span class="fl">0.03239</span>  <span class="fl">30.363</span> <span class="fl">0.00000</span></span>
<span id="cb3-63"><a href="#cb3-63" tabindex="-1"></a>I<span class="sc">-</span>splines5  <span class="fl">1.55698</span> <span class="fl">0.04484</span>  <span class="fl">34.726</span> <span class="fl">0.00000</span></span>
<span id="cb3-64"><a href="#cb3-64" tabindex="-1"></a>I<span class="sc">-</span>splines6 <span class="sc">-</span><span class="fl">0.93391</span> <span class="fl">0.16623</span>  <span class="sc">-</span><span class="fl">5.618</span> <span class="fl">0.00000</span></span>
<span id="cb3-65"><a href="#cb3-65" tabindex="-1"></a>I<span class="sc">-</span>splines7  <span class="fl">1.38694</span> <span class="fl">0.17715</span>   <span class="fl">7.829</span> <span class="fl">0.00000</span></span></code></pre></div>
<p>¬†</p>
<p>Based on these two submodels, the multivariate model can then be
estimated.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE1</span>,<span class="va">mCESD1</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, data<span class="op">=</span><span class="va">paquid</span>, ng<span class="op">=</span><span class="fl">1</span>, posfix<span class="op">=</span><span class="fl">7</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>¬†</p>
<p>As the two outcomes are independent conditionaly to the latent
classes and that we only have one class, the multivariate model is
equivalent to the two separated submodel. We can check that the
estimations are the same :</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">cbind</span>(mm1<span class="sc">$</span>best, <span class="fu">c</span>(mMMSE1<span class="sc">$</span>best, mCESD1<span class="sc">$</span>best))</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>                       [,<span class="dv">1</span>]       [,<span class="dv">2</span>]</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>)<span class="sc">/</span><span class="dv">10</span>) <span class="sc">-</span><span class="fl">1.1989362</span> <span class="sc">-</span><span class="fl">1.1989355</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>varcov <span class="dv">1</span>          <span class="fl">2.2323591</span>  <span class="fl">2.2323555</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>varcov <span class="dv">2</span>         <span class="sc">-</span><span class="fl">0.9018448</span> <span class="sc">-</span><span class="fl">0.9018425</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>varcov <span class="dv">3</span>          <span class="fl">0.8683880</span>  <span class="fl">0.8683859</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>I<span class="sc">-</span>splines1       <span class="sc">-</span><span class="fl">7.1283743</span> <span class="sc">-</span><span class="fl">7.1283683</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>I<span class="sc">-</span>splines2        <span class="fl">1.0483658</span>  <span class="fl">1.0483646</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>I<span class="sc">-</span>splines3        <span class="fl">0.0000000</span>  <span class="fl">0.0000000</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>I<span class="sc">-</span>splines4        <span class="fl">1.9839961</span>  <span class="fl">1.9839953</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>I<span class="sc">-</span>splines5        <span class="fl">1.2558910</span>  <span class="fl">1.2558911</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>I<span class="sc">-</span>splines6        <span class="fl">1.0013254</span>  <span class="fl">1.0013252</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>I<span class="sc">-</span>splines7        <span class="fl">0.9138711</span>  <span class="fl">0.9138711</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>)<span class="sc">/</span><span class="dv">10</span>)  <span class="fl">0.5318709</span>  <span class="fl">0.5318708</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>varcov <span class="dv">1</span>          <span class="fl">2.0827139</span>  <span class="fl">2.0827132</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>varcov <span class="dv">2</span>         <span class="sc">-</span><span class="fl">0.4399163</span> <span class="sc">-</span><span class="fl">0.4399158</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>varcov <span class="dv">3</span>          <span class="fl">0.1805552</span>  <span class="fl">0.1805550</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>I<span class="sc">-</span>splines1       <span class="sc">-</span><span class="fl">1.6678879</span> <span class="sc">-</span><span class="fl">1.6678880</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>I<span class="sc">-</span>splines2        <span class="fl">1.0468796</span>  <span class="fl">1.0468796</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>I<span class="sc">-</span>splines3        <span class="fl">0.7426802</span>  <span class="fl">0.7426802</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>I<span class="sc">-</span>splines4        <span class="fl">0.9835325</span>  <span class="fl">0.9835324</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a>I<span class="sc">-</span>splines5        <span class="fl">1.5569752</span>  <span class="fl">1.5569752</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a>I<span class="sc">-</span>splines6       <span class="sc">-</span><span class="fl">0.9339131</span> <span class="sc">-</span><span class="fl">0.9339132</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a>I<span class="sc">-</span>splines7        <span class="fl">1.3869353</span>  <span class="fl">1.3869353</span></span></code></pre></div>
<p>¬†</p>
</div>
<div class="section level3">
<h3 id="estimate-the-model-with-more-than-one-class-g-1">Estimate the model with more than one class (G &gt; 1)<a class="anchor" aria-label="anchor" href="#estimate-the-model-with-more-than-one-class-g-1"></a>
</h3>
<p>¬†</p>
<p align="justify">
With more than one class, we begin also with univariate models and then
we estimate the multivariate model. The univariate models do not need to
be optimized here. We therefore use the option maxiter=0. We also fix
one I-spline parameter to zero as before.
</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mMMSE2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">MMSE</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,random<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,subject<span class="op">=</span><span class="st">"ID"</span>,</span>
<span> link<span class="op">=</span><span class="st">"5-quant-splines"</span>,data<span class="op">=</span><span class="va">paquid</span>,ng<span class="op">=</span><span class="fl">2</span>,mixture<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,</span>
<span> B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">mMMSE1</span><span class="op">)</span>,maxiter<span class="op">=</span><span class="fl">0</span>, posfix<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mCESD2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">CESD</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,random<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,subject<span class="op">=</span><span class="st">"ID"</span>,</span>
<span> link<span class="op">=</span><span class="st">"5-quant-splines"</span>,data<span class="op">=</span><span class="va">paquid</span>,ng<span class="op">=</span><span class="fl">2</span>,mixture<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,</span>
<span> B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">mCESD1</span><span class="op">)</span>,maxiter<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mm2_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE2</span>,<span class="va">mCESD2</span><span class="op">)</span>,subject<span class="op">=</span><span class="st">"ID"</span>,ng<span class="op">=</span><span class="fl">2</span>,data<span class="op">=</span><span class="va">paquid</span>,posfix<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>¬†</p>
<p>The later model does not specify initial values. They are then
extracted from the univariate models. Alternatively, we can use the one
class model as starting point, or use a grid search.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mm2_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE2</span>,<span class="va">mCESD2</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">2</span>, data<span class="op">=</span><span class="va">paquid</span>,</span>
<span>                 B<span class="op">=</span><span class="va">mm1</span>, posfix<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mm2_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gridsearch.html">gridsearch</a></span><span class="op">(</span><span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE2</span>,<span class="va">mCESD2</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">2</span>,</span>
<span>                    data<span class="op">=</span><span class="va">paquid</span>, posfix<span class="op">=</span><span class="fl">10</span><span class="op">)</span>, minit<span class="op">=</span><span class="va">mm1</span>, rep<span class="op">=</span><span class="fl">50</span>, maxiter<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<p>¬†</p>
<p align="justify">
We estimate in the following the same model with 3, 4, and 5 classes.
</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 3 classes</span></span>
<span></span>
<span><span class="va">mMMSE3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">MMSE</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, random<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>,</span>
<span> link<span class="op">=</span><span class="st">"5-quant-splines"</span>, data<span class="op">=</span><span class="va">paquid</span>, ng<span class="op">=</span><span class="fl">3</span>, mixture<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,</span>
<span> B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">mMMSE1</span><span class="op">)</span>, maxiter<span class="op">=</span><span class="fl">0</span>, posfix<span class="op">=</span><span class="fl">13</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mCESD3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">CESD</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, random<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>,</span>
<span> link<span class="op">=</span><span class="st">"5-quant-splines"</span>, data<span class="op">=</span><span class="va">paquid</span>, ng<span class="op">=</span><span class="fl">3</span>, mixture<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,</span>
<span> B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">mCESD1</span><span class="op">)</span>, maxiter<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mm3_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE3</span>,<span class="va">mCESD3</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">3</span>, data<span class="op">=</span><span class="va">paquid</span>, posfix<span class="op">=</span><span class="fl">13</span><span class="op">)</span></span>
<span><span class="va">mm3_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE3</span>,<span class="va">mCESD3</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">3</span>, data<span class="op">=</span><span class="va">paquid</span>, posfix<span class="op">=</span><span class="fl">13</span>, B<span class="op">=</span><span class="va">mm1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mm3_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gridsearch.html">gridsearch</a></span><span class="op">(</span><span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE3</span>,<span class="va">mCESD3</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">3</span>,</span>
<span> data<span class="op">=</span><span class="va">paquid</span>, posfix<span class="op">=</span><span class="fl">13</span><span class="op">)</span>, minit<span class="op">=</span><span class="va">mm1</span>, rep<span class="op">=</span><span class="fl">50</span>, maxiter<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span>                                                   </span>
<span><span class="co">## 4 classes</span></span>
<span></span>
<span><span class="va">mMMSE4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">MMSE</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, random<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>,</span>
<span> link<span class="op">=</span><span class="st">"5-quant-splines"</span>, data<span class="op">=</span><span class="va">paquid</span>, ng<span class="op">=</span><span class="fl">4</span>, mixture<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,</span>
<span> B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">mMMSE1</span><span class="op">)</span>, maxiter<span class="op">=</span><span class="fl">0</span>, posfix<span class="op">=</span><span class="fl">16</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mCESD4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">CESD</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, random<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>,</span>
<span> link<span class="op">=</span><span class="st">"5-quant-splines"</span>, data<span class="op">=</span><span class="va">paquid</span>, ng<span class="op">=</span><span class="fl">4</span>, mixture<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,</span>
<span> B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">mCESD1</span><span class="op">)</span>, maxiter<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mm4_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE4</span>,<span class="va">mCESD4</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">4</span>, data<span class="op">=</span><span class="va">paquid</span>, posfix<span class="op">=</span><span class="fl">16</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mm4_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE4</span>,<span class="va">mCESD4</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">4</span>, data<span class="op">=</span><span class="va">paquid</span>, posfix<span class="op">=</span><span class="fl">16</span>, B<span class="op">=</span><span class="va">mm1</span><span class="op">)</span></span>
<span>                                                                                       </span>
<span><span class="va">mm4_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gridsearch.html">gridsearch</a></span><span class="op">(</span><span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE4</span>,<span class="va">mCESD4</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">4</span>,</span>
<span>                    data<span class="op">=</span><span class="va">paquid</span>, posfix<span class="op">=</span><span class="fl">16</span><span class="op">)</span>, minit<span class="op">=</span><span class="va">mm1</span>, rep<span class="op">=</span><span class="fl">50</span>, maxiter<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## 5 classes</span></span>
<span></span>
<span><span class="va">mMMSE5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">MMSE</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, random<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>,</span>
<span> link<span class="op">=</span><span class="st">"5-quant-splines"</span>, data<span class="op">=</span><span class="va">paquid</span>, ng<span class="op">=</span><span class="fl">5</span>, mixture<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,</span>
<span> B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">mMMSE1</span><span class="op">)</span>, maxiter<span class="op">=</span><span class="fl">0</span> ,posfix<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mCESD5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">CESD</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, random<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>,</span>
<span> link<span class="op">=</span><span class="st">"5-quant-splines"</span>, data<span class="op">=</span><span class="va">paquid</span>, ng<span class="op">=</span><span class="fl">5</span>, mixture<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,</span>
<span> B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">mCESD1</span><span class="op">)</span>, maxiter<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mm5_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE5</span>,<span class="va">mCESD5</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">5</span>, data<span class="op">=</span><span class="va">paquid</span>, posfix<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mm5_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE5</span>,<span class="va">mCESD5</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">5</span>, data<span class="op">=</span><span class="va">paquid</span>, posfix<span class="op">=</span><span class="fl">19</span>, B<span class="op">=</span><span class="va">mm1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mm5_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gridsearch.html">gridsearch</a></span><span class="op">(</span><span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE5</span>,<span class="va">mCESD5</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">5</span>,</span>
<span>                    data<span class="op">=</span><span class="va">paquid</span>, posfix<span class="op">=</span><span class="fl">19</span><span class="op">)</span>, minit<span class="op">=</span><span class="va">mm1</span>, rep<span class="op">=</span><span class="fl">50</span>, maxiter<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<p>¬†</p>
<p>We summarize and compare all these estimations with summarytable
function :</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">summarytable</span>(mm1, mm2_a, mm2_b, mm2_c, mm3_a, mm3_b, mm3_c, mm4_a, mm4_b, mm4_c, mm5_a, mm5_b, mm5_c)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>      G    loglik npm      BIC <span class="sc">%class1 %</span>class2 <span class="sc">%class3 %</span>class4 %class5</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>mm1   <span class="dv">1</span> <span class="sc">-</span><span class="fl">11018.58</span>  <span class="dv">21</span> <span class="fl">22167.67</span>   <span class="fl">100.0</span>                                </span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>mm2_a <span class="dv">2</span> <span class="sc">-</span><span class="fl">11004.64</span>  <span class="dv">26</span> <span class="fl">22170.86</span>    <span class="fl">20.8</span>    <span class="fl">79.2</span>                        </span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>mm2_b <span class="dv">2</span> <span class="sc">-</span><span class="fl">10997.88</span>  <span class="dv">26</span> <span class="fl">22157.34</span>    <span class="fl">21.4</span>    <span class="fl">78.6</span>                        </span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>mm2_c <span class="dv">2</span> <span class="sc">-</span><span class="fl">10997.88</span>  <span class="dv">26</span> <span class="fl">22157.34</span>    <span class="fl">78.6</span>    <span class="fl">21.4</span>                        </span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>mm3_a <span class="dv">3</span> <span class="sc">-</span><span class="fl">10983.75</span>  <span class="dv">31</span> <span class="fl">22160.14</span>     <span class="fl">8.2</span>    <span class="fl">70.8</span>    <span class="fl">21.0</span>                </span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>mm3_b <span class="dv">3</span> <span class="sc">-</span><span class="fl">10983.75</span>  <span class="dv">31</span> <span class="fl">22160.14</span>     <span class="fl">8.2</span>    <span class="fl">70.8</span>    <span class="fl">21.0</span>                </span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>mm3_c <span class="dv">3</span> <span class="sc">-</span><span class="fl">10983.75</span>  <span class="dv">31</span> <span class="fl">22160.14</span>     <span class="fl">8.2</span>    <span class="fl">70.8</span>    <span class="fl">21.0</span>                </span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>mm4_a <span class="dv">4</span> <span class="sc">-</span><span class="fl">10976.16</span>  <span class="dv">36</span> <span class="fl">22176.04</span>    <span class="fl">65.0</span>    <span class="fl">19.0</span>     <span class="fl">7.8</span>     <span class="fl">8.2</span>        </span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>mm4_b <span class="dv">4</span> <span class="sc">-</span><span class="fl">10979.04</span>  <span class="dv">36</span> <span class="fl">22181.80</span>    <span class="fl">37.6</span>    <span class="fl">13.6</span>    <span class="fl">47.8</span>     <span class="fl">1.0</span>        </span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>mm4_c <span class="dv">4</span> <span class="sc">-</span><span class="fl">10976.16</span>  <span class="dv">36</span> <span class="fl">22176.04</span>    <span class="fl">12.6</span>    <span class="fl">26.0</span>    <span class="fl">48.6</span>    <span class="fl">12.8</span>        </span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>mm5_a <span class="dv">5</span> <span class="sc">-</span><span class="fl">10975.59</span>  <span class="dv">41</span> <span class="fl">22205.99</span>    <span class="fl">22.0</span>    <span class="fl">29.2</span>    <span class="fl">30.0</span>    <span class="fl">10.6</span>     <span class="fl">8.2</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>mm5_b <span class="dv">5</span> <span class="sc">-</span><span class="fl">10971.30</span>  <span class="dv">41</span> <span class="fl">22197.40</span>    <span class="fl">28.8</span>    <span class="fl">11.6</span>    <span class="fl">46.2</span>     <span class="fl">1.2</span>    <span class="fl">12.2</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>mm5_c <span class="dv">5</span> <span class="sc">-</span><span class="fl">10970.69</span>  <span class="dv">41</span> <span class="fl">22196.17</span>     <span class="fl">5.2</span>    <span class="fl">14.2</span>    <span class="fl">48.6</span>     <span class="fl">9.6</span>    <span class="fl">22.4</span></span></code></pre></div>
<p>¬†</p>
<p>We keep the best model for each number of latent classes and we plot
some statistical criteria used to select the optimal number of classes
:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summaryplot.html">summaryplot</a></span><span class="op">(</span><span class="va">mm1</span>, <span class="va">mm2_b</span>, <span class="va">mm3_b</span>, <span class="va">mm4_c</span>, <span class="va">mm5_c</span><span class="op">)</span></span></code></pre></div>
<p><img src="multivariate_latent_class_model_with_mpjlcmm_files/figure-html/unnamed-chunk-12-1.png" width="768"></p>
<p>In this application, we will select the 2-class model, which presents
better BIC.</p>
<p>¬†</p>
<p>We can represent the relation the classes and the flow of the
subjects with a sankey plot. This is not yet done automatically in the
package.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">library</span>(ggalluvial)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="do">## We merge the classification of the 5 models :</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>class12 <span class="ot">&lt;-</span> <span class="fu">merge</span>(mm1<span class="sc">$</span>pprob[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], mm2_b<span class="sc">$</span>pprob[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">by=</span><span class="st">"ID"</span>)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="fu">colnames</span>(class12) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ID"</span>,<span class="st">"mm1"</span>,<span class="st">"mm2_b"</span>)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>class123 <span class="ot">&lt;-</span> <span class="fu">merge</span>(class12, mm3_b<span class="sc">$</span>pprob[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">by=</span><span class="st">"ID"</span>)</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="fu">colnames</span>(class123) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ID"</span>,<span class="st">"mm1"</span>,<span class="st">"mm2_b"</span>,<span class="st">"mm3_b"</span>)</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>class1234 <span class="ot">&lt;-</span> <span class="fu">merge</span>(class123, mm4_c<span class="sc">$</span>pprob[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">by=</span><span class="st">"ID"</span>)</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="fu">colnames</span>(class1234) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ID"</span>,<span class="st">"mm1"</span>,<span class="st">"mm2_b"</span>,<span class="st">"mm3_b"</span>,<span class="st">"mm4_c"</span>)</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>class <span class="ot">&lt;-</span> <span class="fu">merge</span>(class1234, mm5_c<span class="sc">$</span>pprob[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">by=</span><span class="st">"ID"</span>)</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="fu">colnames</span>(class) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ID"</span>,<span class="st">"mm1"</span>,<span class="st">"mm2_b"</span>,<span class="st">"mm3_b"</span>,<span class="st">"mm4_c"</span>,<span class="st">"mm5_c"</span>)</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="do">## We plot the flows :</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="fu">ggplot</span>(class,</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">axis1 =</span> mm1, <span class="at">axis2 =</span> mm2_b, <span class="at">axis3 =</span> mm3_b, <span class="at">axis4 =</span> mm4_c, <span class="at">axis5 =</span> mm5_c, </span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>           <span class="at">fill =</span> <span class="fu">after_stat</span>(stratum), <span class="at">label =</span> <span class="fu">after_stat</span>(stratum))) <span class="sc">+</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"mm1"</span>,<span class="st">"mm2_b"</span>,<span class="st">"mm3_b"</span>,<span class="st">"mm4_c"</span>,<span class="st">"mm5_c"</span>)) <span class="sc">+</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>  <span class="fu">geom_flow</span>() <span class="sc">+</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>  <span class="fu">geom_stratum</span>() <span class="sc">+</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"stratum"</span>, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Number of subjects"</span>,</span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Model"</span>,</span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Class"</span>)</span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a>Warning <span class="cf">in</span> <span class="fu">to_lodes_form</span>(<span class="at">data =</span> data, <span class="at">axes =</span> axis_ind, <span class="at">discern =</span></span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a>params<span class="sc">$</span>discern)<span class="sc">:</span> Some strata appear at multiple axes.</span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a>Warning <span class="cf">in</span> <span class="fu">to_lodes_form</span>(<span class="at">data =</span> data, <span class="at">axes =</span> axis_ind, <span class="at">discern =</span></span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a>params<span class="sc">$</span>discern)<span class="sc">:</span> Some strata appear at multiple axes.</span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a>Warning <span class="cf">in</span> <span class="fu">to_lodes_form</span>(<span class="at">data =</span> data, <span class="at">axes =</span> axis_ind, <span class="at">discern =</span></span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a>params<span class="sc">$</span>discern)<span class="sc">:</span> Some strata appear at multiple axes.</span></code></pre></div>
<p><img src="multivariate_latent_class_model_with_mpjlcmm_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<p>¬†</p>
</div>
<div class="section level3">
<h3 id="description-of-the-2-class-model">Description of the 2-class model<a class="anchor" aria-label="anchor" href="#description-of-the-2-class-model"></a>
</h3>
<div class="section level4">
<h4 id="summary-of-the-model">Summary of the model<a class="anchor" aria-label="anchor" href="#summary-of-the-model"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">summary</span>(mm2_b)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>Multivariate joint latent class model <span class="cf">for</span> quantitative outcome and competing risks </span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>     fitted by maximum likelihood method </span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a> </span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="fu">mpjlcmm</span>(<span class="at">longitudinal =</span> <span class="fu">list</span>(mMMSE2, mCESD2), <span class="at">subject =</span> <span class="st">"ID"</span>, </span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>    <span class="at">ng =</span> <span class="dv">2</span>, <span class="at">data =</span> paquid, <span class="at">posfix =</span> <span class="dv">10</span>)</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a> </span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>Statistical Model<span class="sc">:</span> </span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>     Dataset<span class="sc">:</span> paquid </span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>     Number of subjects<span class="sc">:</span> <span class="dv">500</span> </span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>     Number of longitudinal models<span class="sc">:</span> <span class="dv">2</span> </span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>     Number of observations<span class="sc">:</span> <span class="dv">2214</span> <span class="dv">2104</span> </span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>     Number of latent classes<span class="sc">:</span> <span class="dv">2</span> </span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>     Number of parameters<span class="sc">:</span> <span class="dv">27</span>  </span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>     Number of estimated parameters<span class="sc">:</span> <span class="dv">26</span>  </span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>     Link functions<span class="sc">:</span> Quadratic I<span class="sc">-</span>splines with nodes <span class="dv">0</span> <span class="dv">25</span> <span class="dv">27</span> <span class="dv">29</span> <span class="dv">30</span>  <span class="cf">for</span>  MMSE </span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>                     Quadratic I<span class="sc">-</span>splines with nodes <span class="dv">0</span> <span class="dv">2</span> <span class="dv">6</span> <span class="dv">12</span> <span class="dv">52</span>  <span class="cf">for</span>  CESD </span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a> </span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a>Iteration process<span class="sc">:</span> </span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>     Convergence criteria satisfied </span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a>     Number of iterations<span class="sc">:</span>  <span class="dv">26</span> </span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a>     Convergence criteria<span class="sc">:</span> parameters<span class="ot">=</span> <span class="fl">4.2e-06</span> </span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a>                         <span class="sc">:</span> likelihood<span class="ot">=</span> <span class="fl">8.2e-05</span> </span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a>                         <span class="sc">:</span> second derivatives<span class="ot">=</span> <span class="fl">1.1e-08</span> </span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a> </span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a>Goodness<span class="sc">-</span>of<span class="sc">-</span>fit statistics<span class="sc">:</span> </span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a>     maximum log<span class="sc">-</span>likelihood<span class="sc">:</span> <span class="sc">-</span><span class="fl">10997.88</span>  </span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a>     AIC<span class="sc">:</span> <span class="fl">22047.76</span>  </span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a>     BIC<span class="sc">:</span> <span class="fl">22157.34</span>  </span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a> </span>
<span id="cb13-31"><a href="#cb13-31" tabindex="-1"></a> </span>
<span id="cb13-32"><a href="#cb13-32" tabindex="-1"></a> </span>
<span id="cb13-33"><a href="#cb13-33" tabindex="-1"></a>Maximum Likelihood Estimates<span class="sc">:</span> </span>
<span id="cb13-34"><a href="#cb13-34" tabindex="-1"></a> </span>
<span id="cb13-35"><a href="#cb13-35" tabindex="-1"></a>Fixed effects <span class="cf">in</span> the class<span class="sc">-</span>membership model<span class="sc">:</span></span>
<span id="cb13-36"><a href="#cb13-36" tabindex="-1"></a>(the class of reference is the last class) </span>
<span id="cb13-37"><a href="#cb13-37" tabindex="-1"></a></span>
<span id="cb13-38"><a href="#cb13-38" tabindex="-1"></a>                     coef      Se    Wald p<span class="sc">-</span>value</span>
<span id="cb13-39"><a href="#cb13-39" tabindex="-1"></a>intercept class1 <span class="sc">-</span><span class="fl">1.03757</span> <span class="fl">0.19494</span>  <span class="sc">-</span><span class="fl">5.322</span> <span class="fl">0.00000</span></span>
<span id="cb13-40"><a href="#cb13-40" tabindex="-1"></a></span>
<span id="cb13-41"><a href="#cb13-41" tabindex="-1"></a></span>
<span id="cb13-42"><a href="#cb13-42" tabindex="-1"></a>Longitudinal model <span class="cf">for</span> MMSE <span class="sc">:</span></span>
<span id="cb13-43"><a href="#cb13-43" tabindex="-1"></a></span>
<span id="cb13-44"><a href="#cb13-44" tabindex="-1"></a>Fixed effects <span class="cf">in</span> the longitudinal model<span class="sc">:</span></span>
<span id="cb13-45"><a href="#cb13-45" tabindex="-1"></a>                                     coef      Se    Wald p<span class="sc">-</span>value</span>
<span id="cb13-46"><a href="#cb13-46" tabindex="-1"></a>intercept <span class="fu">class1</span> (not estimated)  <span class="fl">0.00000</span>                        </span>
<span id="cb13-47"><a href="#cb13-47" tabindex="-1"></a>intercept class2                  <span class="fl">0.34847</span> <span class="fl">0.30384</span>   <span class="fl">1.147</span> <span class="fl">0.25143</span></span>
<span id="cb13-48"><a href="#cb13-48" tabindex="-1"></a><span class="fu">I</span>(...) class1                    <span class="sc">-</span><span class="fl">1.41500</span> <span class="fl">0.16752</span>  <span class="sc">-</span><span class="fl">8.447</span> <span class="fl">0.00000</span></span>
<span id="cb13-49"><a href="#cb13-49" tabindex="-1"></a><span class="fu">I</span>(...) class2                    <span class="sc">-</span><span class="fl">1.13436</span> <span class="fl">0.08760</span> <span class="sc">-</span><span class="fl">12.949</span> <span class="fl">0.00000</span></span>
<span id="cb13-50"><a href="#cb13-50" tabindex="-1"></a></span>
<span id="cb13-51"><a href="#cb13-51" tabindex="-1"></a>Variance<span class="sc">-</span>covariance matrix of the random<span class="sc">-</span>effects<span class="sc">:</span></span>
<span id="cb13-52"><a href="#cb13-52" tabindex="-1"></a>                 intercept <span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>)<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb13-53"><a href="#cb13-53" tabindex="-1"></a>intercept          <span class="fl">2.17911</span>                 </span>
<span id="cb13-54"><a href="#cb13-54" tabindex="-1"></a><span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>)<span class="sc">/</span><span class="dv">10</span>)  <span class="sc">-</span><span class="fl">0.89871</span>          <span class="fl">0.83935</span></span>
<span id="cb13-55"><a href="#cb13-55" tabindex="-1"></a></span>
<span id="cb13-56"><a href="#cb13-56" tabindex="-1"></a>Residual standard error<span class="sc">:</span> <span class="dv">1</span> (not estimated)</span>
<span id="cb13-57"><a href="#cb13-57" tabindex="-1"></a></span>
<span id="cb13-58"><a href="#cb13-58" tabindex="-1"></a>Parameters of the link functions<span class="sc">:</span></span>
<span id="cb13-59"><a href="#cb13-59" tabindex="-1"></a></span>
<span id="cb13-60"><a href="#cb13-60" tabindex="-1"></a>                    coef       Se    Wald p<span class="sc">-</span>value</span>
<span id="cb13-61"><a href="#cb13-61" tabindex="-1"></a>MMSE<span class="sc">-</span>I<span class="sc">-</span>splines1 <span class="sc">-</span><span class="fl">6.86640</span>  <span class="fl">0.32838</span> <span class="sc">-</span><span class="fl">20.910</span> <span class="fl">0.00000</span></span>
<span id="cb13-62"><a href="#cb13-62" tabindex="-1"></a>MMSE<span class="sc">-</span>I<span class="sc">-</span>splines2  <span class="fl">1.04368</span>  <span class="fl">0.08112</span>  <span class="fl">12.865</span> <span class="fl">0.00000</span></span>
<span id="cb13-63"><a href="#cb13-63" tabindex="-1"></a>MMSE<span class="sc">-</span>I<span class="sc">-</span>splines3  <span class="fl">0.00000</span><span class="sc">*</span>                        </span>
<span id="cb13-64"><a href="#cb13-64" tabindex="-1"></a>MMSE<span class="sc">-</span>I<span class="sc">-</span>splines4  <span class="fl">1.98366</span>  <span class="fl">0.03381</span>  <span class="fl">58.679</span> <span class="fl">0.00000</span></span>
<span id="cb13-65"><a href="#cb13-65" tabindex="-1"></a>MMSE<span class="sc">-</span>I<span class="sc">-</span>splines5  <span class="fl">1.25600</span>  <span class="fl">0.03019</span>  <span class="fl">41.597</span> <span class="fl">0.00000</span></span>
<span id="cb13-66"><a href="#cb13-66" tabindex="-1"></a>MMSE<span class="sc">-</span>I<span class="sc">-</span>splines6  <span class="fl">1.00043</span>  <span class="fl">0.03617</span>  <span class="fl">27.658</span> <span class="fl">0.00000</span></span>
<span id="cb13-67"><a href="#cb13-67" tabindex="-1"></a>MMSE<span class="sc">-</span>I<span class="sc">-</span>splines7  <span class="fl">0.91330</span>  <span class="fl">0.02682</span>  <span class="fl">34.050</span> <span class="fl">0.00000</span></span>
<span id="cb13-68"><a href="#cb13-68" tabindex="-1"></a></span>
<span id="cb13-69"><a href="#cb13-69" tabindex="-1"></a></span>
<span id="cb13-70"><a href="#cb13-70" tabindex="-1"></a>Longitudinal model <span class="cf">for</span> CESD <span class="sc">:</span></span>
<span id="cb13-71"><a href="#cb13-71" tabindex="-1"></a></span>
<span id="cb13-72"><a href="#cb13-72" tabindex="-1"></a>Fixed effects <span class="cf">in</span> the longitudinal model<span class="sc">:</span></span>
<span id="cb13-73"><a href="#cb13-73" tabindex="-1"></a>                                     coef      Se    Wald p<span class="sc">-</span>value</span>
<span id="cb13-74"><a href="#cb13-74" tabindex="-1"></a>intercept <span class="fu">class1</span> (not estimated)  <span class="fl">0.00000</span>                        </span>
<span id="cb13-75"><a href="#cb13-75" tabindex="-1"></a>intercept class2                 <span class="sc">-</span><span class="fl">2.84768</span> <span class="fl">0.21559</span> <span class="sc">-</span><span class="fl">13.209</span> <span class="fl">0.00000</span></span>
<span id="cb13-76"><a href="#cb13-76" tabindex="-1"></a><span class="fu">I</span>(...) class1                    <span class="sc">-</span><span class="fl">0.02509</span> <span class="fl">0.12124</span>  <span class="sc">-</span><span class="fl">0.207</span> <span class="fl">0.83605</span></span>
<span id="cb13-77"><a href="#cb13-77" tabindex="-1"></a><span class="fu">I</span>(...) class2                     <span class="fl">0.70735</span> <span class="fl">0.05778</span>  <span class="fl">12.243</span> <span class="fl">0.00000</span></span>
<span id="cb13-78"><a href="#cb13-78" tabindex="-1"></a></span>
<span id="cb13-79"><a href="#cb13-79" tabindex="-1"></a>Variance<span class="sc">-</span>covariance matrix of the random<span class="sc">-</span>effects<span class="sc">:</span></span>
<span id="cb13-80"><a href="#cb13-80" tabindex="-1"></a>                 intercept <span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>)<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb13-81"><a href="#cb13-81" tabindex="-1"></a>intercept          <span class="fl">0.31009</span>                 </span>
<span id="cb13-82"><a href="#cb13-82" tabindex="-1"></a><span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>)<span class="sc">/</span><span class="dv">10</span>)   <span class="fl">0.04817</span>          <span class="fl">0.04441</span></span>
<span id="cb13-83"><a href="#cb13-83" tabindex="-1"></a></span>
<span id="cb13-84"><a href="#cb13-84" tabindex="-1"></a>Residual standard error<span class="sc">:</span> <span class="dv">1</span> (not estimated)</span>
<span id="cb13-85"><a href="#cb13-85" tabindex="-1"></a></span>
<span id="cb13-86"><a href="#cb13-86" tabindex="-1"></a>Parameters of the link functions<span class="sc">:</span></span>
<span id="cb13-87"><a href="#cb13-87" tabindex="-1"></a></span>
<span id="cb13-88"><a href="#cb13-88" tabindex="-1"></a>                    coef      Se    Wald p<span class="sc">-</span>value</span>
<span id="cb13-89"><a href="#cb13-89" tabindex="-1"></a>CESD<span class="sc">-</span>I<span class="sc">-</span>splines1 <span class="sc">-</span><span class="fl">3.76547</span> <span class="fl">0.22277</span> <span class="sc">-</span><span class="fl">16.903</span> <span class="fl">0.00000</span></span>
<span id="cb13-90"><a href="#cb13-90" tabindex="-1"></a>CESD<span class="sc">-</span>I<span class="sc">-</span>splines2  <span class="fl">1.02786</span> <span class="fl">0.02458</span>  <span class="fl">41.825</span> <span class="fl">0.00000</span></span>
<span id="cb13-91"><a href="#cb13-91" tabindex="-1"></a>CESD<span class="sc">-</span>I<span class="sc">-</span>splines3  <span class="fl">0.72903</span> <span class="fl">0.03776</span>  <span class="fl">19.309</span> <span class="fl">0.00000</span></span>
<span id="cb13-92"><a href="#cb13-92" tabindex="-1"></a>CESD<span class="sc">-</span>I<span class="sc">-</span>splines4  <span class="fl">0.98285</span> <span class="fl">0.03241</span>  <span class="fl">30.328</span> <span class="fl">0.00000</span></span>
<span id="cb13-93"><a href="#cb13-93" tabindex="-1"></a>CESD<span class="sc">-</span>I<span class="sc">-</span>splines5  <span class="fl">1.57674</span> <span class="fl">0.04486</span>  <span class="fl">35.144</span> <span class="fl">0.00000</span></span>
<span id="cb13-94"><a href="#cb13-94" tabindex="-1"></a>CESD<span class="sc">-</span>I<span class="sc">-</span>splines6 <span class="sc">-</span><span class="fl">0.92716</span> <span class="fl">0.16796</span>  <span class="sc">-</span><span class="fl">5.520</span> <span class="fl">0.00000</span></span>
<span id="cb13-95"><a href="#cb13-95" tabindex="-1"></a>CESD<span class="sc">-</span>I<span class="sc">-</span>splines7  <span class="fl">1.36802</span> <span class="fl">0.17561</span>   <span class="fl">7.790</span> <span class="fl">0.00000</span></span>
<span id="cb13-96"><a href="#cb13-96" tabindex="-1"></a></span>
<span id="cb13-97"><a href="#cb13-97" tabindex="-1"></a> <span class="sc">*</span>  coefficient fixed by the user </span>
<span id="cb13-98"><a href="#cb13-98" tabindex="-1"></a> </span></code></pre></div>
</div>
<div class="section level4">
<h4 id="update-the-univariate-models">Update the univariate models<a class="anchor" aria-label="anchor" href="#update-the-univariate-models"></a>
</h4>
<p>The update function returns the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
univariate models used to specify the mpjlcmm model, with updated
outputs. The parameters and their estimated variance are replaced by the
one optimized in the multivariate framework.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">upd_mm2_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">mm2_b</span><span class="op">)</span></span>
<span><span class="va">mMMSE2_biv</span> <span class="op">&lt;-</span> <span class="va">upd_mm2_b</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">mCESD2_biv</span> <span class="op">&lt;-</span> <span class="va">upd_mm2_b</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>The prediction functions are called on the mMMSE2_biv and mCESD2_biv
objects.</p>
</div>
<div class="section level4">
<h4 id="predictions-of-the-trajectories">Predictions of the trajectories<a class="anchor" aria-label="anchor" href="#predictions-of-the-trajectories"></a>
</h4>
<p align="justify">
Class-specific predictions can be computed for any data contained in a
dataframe as soon as all the covariates specified in the model are
included in the dataframe. In the next lines, such a dataframe is
created by generating a vector of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>g</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">age</annotation></semantics></math>
values between 65 and 95. The predictions are computed with
<code>predictY</code> and plotted with the associated <code>plot</code>
function.
</p>
<p>¬†</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## predicted trajectories of the MMSE score</span></span>
<span><span class="va">pred_MMSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">mMMSE2_biv</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">65</span>,<span class="fl">95</span>,length.out<span class="op">=</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>, var.time <span class="op">=</span> <span class="st">"age"</span><span class="op">)</span></span>
<span><span class="co">## predicted trajectories of the CESD score</span></span>
<span><span class="va">pred_CESD</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">mCESD2_biv</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">65</span>,<span class="fl">95</span>,length.out<span class="op">=</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>, var.time <span class="op">=</span> <span class="st">"age"</span><span class="op">)</span></span></code></pre></div>
<p>¬†</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">pred_MMSE</span>, lwd<span class="op">=</span><span class="fl">3</span>, ylab<span class="op">=</span><span class="st">"MMSE"</span>, main<span class="op">=</span><span class="st">"Predicted trajectories for MMSE"</span>, legend.loc<span class="op">=</span><span class="st">"bottomleft"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">pred_CESD</span>, lwd<span class="op">=</span><span class="fl">3</span>, ylab<span class="op">=</span><span class="st">"CESD"</span>, main<span class="op">=</span><span class="st">"Predicted trajectories for CESD"</span>, legend<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p><img src="multivariate_latent_class_model_with_mpjlcmm_files/figure-html/unnamed-chunk-17-1.png" width="768"></p>
<p>To add point by point confidence bands, we use the option draws=TRUE
in the predictY call.</p>
<p>¬†</p>
</div>
</div>
<div class="section level3">
<h3 id="evaluation-of-the-model">Evaluation of the model<a class="anchor" aria-label="anchor" href="#evaluation-of-the-model"></a>
</h3>
<div class="section level4">
<h4 id="plot-of-the-residuals">Plot of the residuals<a class="anchor" aria-label="anchor" href="#plot-of-the-residuals"></a>
</h4>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mMMSE2_biv</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mCESD2_biv</span><span class="op">)</span></span></code></pre></div>
<p>¬†</p>
</div>
<div class="section level4">
<h4 id="graph-of-the-predictions-versus-observations">Graph of the predictions versus observations<a class="anchor" aria-label="anchor" href="#graph-of-the-predictions-versus-observations"></a>
</h4>
<p>¬†</p>
<p align="justify">
In order to evaluate the fit of the selected model, we plot
simultaneously the observations and the predicted values for each latent
class.
</p>
<p>¬†</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mMMSE2_biv</span>, which<span class="op">=</span><span class="st">"fit"</span>, var.time<span class="op">=</span><span class="st">"age"</span>, marg<span class="op">=</span><span class="cn">FALSE</span>, shades <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mCESD2_biv</span>, which<span class="op">=</span><span class="st">"fit"</span>, var.time<span class="op">=</span><span class="st">"age"</span>, marg<span class="op">=</span><span class="cn">FALSE</span>, shades <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>¬†</p>
</div>
<div class="section level4">
<h4 id="classification">Classification<a class="anchor" aria-label="anchor" href="#classification"></a>
</h4>
<p>The posterior classification of the model is obtained with:</p>
<p>¬†</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">postprob</span>(mm2_b) </span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a> </span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>Posterior classification based on longitudinal and time<span class="sc">-</span>to<span class="sc">-</span>event data<span class="sc">:</span> </span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  class1 class2</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>N  <span class="fl">107.0</span>  <span class="fl">393.0</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>%   <span class="fl">21.4</span>   <span class="fl">78.6</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a> </span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>Posterior classification table<span class="sc">:</span> </span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>     <span class="sc">-</span><span class="ot">-&gt;</span> mean of posterior probabilities <span class="cf">in</span> each class </span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>        prob1  prob2</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>class1 <span class="fl">0.8280</span> <span class="fl">0.1720</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>class2 <span class="fl">0.1074</span> <span class="fl">0.8926</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a> </span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>Posterior probabilities above a <span class="fu">threshold</span> (%)<span class="sc">:</span> </span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a>         class1 class2</span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a>prob<span class="sc">&gt;</span><span class="fl">0.7</span>  <span class="fl">70.09</span>  <span class="fl">87.02</span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a>prob<span class="sc">&gt;</span><span class="fl">0.8</span>  <span class="fl">65.42</span>  <span class="fl">78.12</span></span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a>prob<span class="sc">&gt;</span><span class="fl">0.9</span>  <span class="fl">46.73</span>  <span class="fl">64.38</span></span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a> </span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a> </span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a>Posterior classification based only on longitudinal data<span class="sc">:</span> </span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a>  class1 class2</span>
<span id="cb19-23"><a href="#cb19-23" tabindex="-1"></a>N  <span class="fl">107.0</span>  <span class="fl">393.0</span></span>
<span id="cb19-24"><a href="#cb19-24" tabindex="-1"></a>%   <span class="fl">21.4</span>   <span class="fl">78.6</span></span>
<span id="cb19-25"><a href="#cb19-25" tabindex="-1"></a> </span></code></pre></div>
<p>¬†</p>
<p align="justify">
</p>
<p><code>Class 1</code> is composed of 107 subjects (21.4%), whereas 393
are in the second class.</p>
<p>We can also see a good discrimination power of the model with a mean
posterior probability of 0.8280 for class 1 and 0.8926 for class 2. A
satisfactory proportion of subject are also classified with a posterior
probability above 0.7.</p>
<p>¬†</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="multivariate-joint-models">Multivariate joint models<a class="anchor" aria-label="anchor" href="#multivariate-joint-models"></a>
</h2>
<p>The mpjclmm function also allows the modelisation of a time-to-event
outcome with a proportional hazard model, possibly with competing
risks.</p>
<p>To add the time to dementia to the previous model, the call is :</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mmS2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mpjlcmm.html">mpjlcmm</a></span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE2</span>,<span class="va">mCESD2</span><span class="op">)</span>, subject<span class="op">=</span><span class="st">"ID"</span>, ng<span class="op">=</span><span class="fl">2</span>, data<span class="op">=</span><span class="va">paquid</span>,</span>
<span>                survival<span class="op">=</span><span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>,<span class="va">agedem</span>,<span class="va">dem</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cecile Proust-Lima, Viviane Philipps.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
