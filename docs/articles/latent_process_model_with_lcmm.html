<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="lcmm">
<title>How to estimate a latent process mixed model using lcmm function • lcmm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to estimate a latent process mixed model using lcmm function">
<meta property="og:description" content="lcmm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">lcmm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/lcmm.html">GET STARTED</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">VIGNETTES</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/latent_class_model_with_hlme.html">How to estimate a latent class mixed model using hlme function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_lcmm.html">How to estimate a latent process mixed model using lcmm function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm.html">How to estimate a latent process mixed model for multivariate markers using multlcmm function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm_IRT.html">Continuous-time longitudinal IRT model</a>
    <a class="dropdown-item" href="../articles/joint_latent_class_model_with_Jointlcmm.html">How to estimate a joint latent class mixed model using Jointlcmm function</a>
    <a class="dropdown-item" href="../articles/multivariate_latent_class_model_with_mpjlcmm.html">How to estimate a multivariate latent class mixed model using mpjlcmm function</a>
    <a class="dropdown-item" href="../articles/secondary_model_with_externVar.html">Accounting for latent class assignment uncertainty in subsequent analyses</a>
    <a class="dropdown-item" href="../articles/pre_normalizing.html">Pre-normalizing a dependent variable using lcmm</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/usual_problems.html">FAQ</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">REFERENCE</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">CHANGELOG</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/CecileProust-Lima/lcmm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">

<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>How to estimate a latent process mixed model using lcmm function</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CecileProust-Lima/lcmm/blob/HEAD/vignettes/latent_process_model_with_lcmm.Rmd" class="external-link"><code>vignettes/latent_process_model_with_lcmm.Rmd</code></a></small>
      <div class="d-none name"><code>latent_process_model_with_lcmm.Rmd</code></div>
    </div>

    
    
<p> </p>
<div class="section level2">
<h2 id="background-on-the-model">Background on the model<a class="anchor" aria-label="anchor" href="#background-on-the-model"></a>
</h2>
<p align="justify">
</p>
<p>Each dynamic phenomenon can be characterized by a latent process <span class="math inline">\((\Lambda(t))\)</span> which evolves in continuous time <span class="math inline">\(t\)</span>. When modeling repeated measures of marker, we usually don’t think of it as a latent process measured with error. Yet, this is the underlying assumption made by the mixed model theory. Function lcmm exploits this framework to extend the linear mixed model theory to any type of outcome (ordinal, binary, continuous with any distribution).</p>
<div class="section level3">
<h3 id="the-latent-process-mixed-model">The latent process mixed model<a class="anchor" aria-label="anchor" href="#the-latent-process-mixed-model"></a>
</h3>
<p>The latent process mixed model is introduced in Proust-Lima et al. (2006 - <a href="https://doi.org/10.1111/j.1541-0420.2006.00573.x" class="external-link uri">https://doi.org/10.1111/j.1541-0420.2006.00573.x</a> and 2013 - <a href="https://doi.org/10.1111/bmsp.12000" class="external-link uri">https://doi.org/10.1111/bmsp.12000</a> ).</p>
<p>The quantity of interest defined as a latent process is modeled according to time using a linear mixed model:</p>
<p><span class="math display">\[\Lambda(t) = X(t) \beta + Z(t)u_i +w_i(t)\]</span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(X(t)\)</span> and <span class="math inline">\(Z(t)\)</span> are vectors of covariates (<span class="math inline">\(Z(t)\)</span> is included in <span class="math inline">\(X(t)\)</span>);</li>
<li>
<span class="math inline">\(\beta\)</span> are the fixed effects (i.e., population mean effects);</li>
<li>
<span class="math inline">\(u_i\)</span> are the random effects (i.e., individual effects); they are distributed according to a zero-mean multivariate normal distribution with covariance matrix <span class="math inline">\(B\)</span>;</li>
<li>
<span class="math inline">\((w_i(t))\)</span> is a Gaussian process that might be added in the model to relax the intra-subject correlation structure.</li>
</ul>
<p>The relationship between the latent process of interest and the observations of the marker <span class="math inline">\(Y_{ij}\)</span> (for subject <span class="math inline">\(i\)</span> and occasion <span class="math inline">\(j\)</span>) is simultaneously defined in an equation of observation:</p>
<p><span class="math display">\[Y_{ij}  = H( ~ \Lambda(t_{ij})+\epsilon_{ij} ~ ; \eta)\]</span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(t_{ij}\)</span> is the time of measurement for subject <span class="math inline">\(i\)</span> and occasion <span class="math inline">\(j\)</span>;</li>
<li>
<span class="math inline">\(\epsilon_{ij}\)</span> is an independent zero-mean Gaussian error;</li>
<li>
<span class="math inline">\(H\)</span> is the link function (parameterized by <span class="math inline">\(\eta\)</span>) that transforms the latent process into the scale and metric of the marker.</li>
</ul>
<p>Different parametric families are used. <strong>When the marker is continuous</strong>, <span class="math inline">\(H^{-1}\)</span> is a parametric family of increasing monotonic functions among:</p>
<ul>
<li>the linear transformation: this reduces to the linear mixed model (2 parameters)</li>
<li>the Beta cumulative distribution family rescaled (4 parameters)</li>
<li>the basis of quadratic I-splines with m knots (m+2 parameters)</li>
</ul>
<p><strong>When the marker is discrete (binary or ordinal):</strong> <span class="math inline">\(H\)</span> is a threshold function, that is each level of Y corresponds to an interval of <span class="math inline">\(\Lambda(t_{ij})+\epsilon_{ij}\)</span> which boundaries are to be estimated.</p>
</div>
<div class="section level3">
<h3 id="identifiability">Identifiability<a class="anchor" aria-label="anchor" href="#identifiability"></a>
</h3>
<p>As in any latent variable model, the metric of the latent variable has to be defined. In lcmm, the variance of the errors is 1 and the mean intercept (in <span class="math inline">\(\beta\)</span>) is 0.</p>
<p> </p>
</div>
</div>
<div class="section level2">
<h2 id="example-with-ces-d">Example with CES-D<a class="anchor" aria-label="anchor" href="#example-with-ces-d"></a>
</h2>
<p align="justify">
In this vignette, the latent process mixed models implemented in <code>lcmm</code> are illustrated by the study of the linear trajectory of depressive symptoms (as measured by CES-D scale) according to <span class="math inline">\(age65\)</span> and adjusted for male. Correlated random effects for the intercept and <span class="math inline">\(age65\)</span> are included.
</p>
<div class="section level3">
<h3 id="model-considered">Model considered:<a class="anchor" aria-label="anchor" href="#model-considered"></a>
</h3>
<p><span class="math display">\[CESD_{ij} = H(~  \beta_{1}age65_{ij}+\beta_{2}male_{i}+\beta_{3}age65_{ij}male_{i} +u_{0i}+u_{1i}age65_{ij}+\epsilon_{ij} ~ ; ~ \eta)\]</span></p>
<p> </p>
<p><em>Where :</em> <span class="math inline">\(u_{i} \sim \mathcal{N}(0,B)\)</span> and <span class="math inline">\(\epsilon_{ij} \sim \mathcal{N}(0,1)\)</span></p>
<p> </p>
<p>The <em>Fixed part</em> is <span class="math inline">\(\beta_{1}age65_{ij}+\beta_{2}male_{i}+\beta_{3}age65_{ij}male_{i}\)</span> ; the <em>random part</em> is <span class="math inline">\(u_{0i}+u_{1i}age65_{ij}\)</span>.</p>
<p> </p>
</div>
<div class="section level3">
<h3 id="estimate-the-model-for-different-continuous-link-functions-h">Estimate the model for different continuous link functions <span class="math inline">\(H\)</span><a class="anchor" aria-label="anchor" href="#estimate-the-model-for-different-continuous-link-functions-h"></a>
</h3>
<p>We use the age variable recentered around 65 years old and in decades:</p>
<p>The latent process mixed model can be fitted with different link functions as shown below. This is done with argument link.</p>
<div class="section level4">
<h4 id="linear-link-function">Linear link function<a class="anchor" aria-label="anchor" href="#linear-link-function"></a>
</h4>
<p>When defining the linear link function, the model reduces to a standard linear mixed model. The model can be fitted with lcmm function (with the linear link function by default):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mlin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">CESD</span> <span class="op">~</span> <span class="va">age65</span><span class="op">*</span><span class="va">male</span>, random<span class="op">=</span><span class="op">~</span> <span class="va">age65</span>, subject<span class="op">=</span><span class="st">'ID'</span>, data<span class="op">=</span><span class="va">paquid</span><span class="op">)</span> <span class="co">#link= linear</span></span></code></pre></div>
<p align="justify">
It is the exact same model as one fitted by hlme. The only difference with a hlme object is the parameterization for the intercept and the residual standard error that are considered as rescaling parameters.
</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mlin2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hlme.html">hlme</a></span><span class="op">(</span><span class="va">CESD</span> <span class="op">~</span> <span class="va">age65</span><span class="op">*</span><span class="va">male</span>, random<span class="op">=</span><span class="op">~</span> <span class="va">age65</span>, subject<span class="op">=</span><span class="st">'ID'</span>, data<span class="op">=</span><span class="va">paquid</span><span class="op">)</span> <span class="co">#link= linear</span></span></code></pre></div>
<p>The log likelihood are the same but the estimated parameters <span class="math inline">\(\beta\)</span> are not in the same scale</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">mlin<span class="op">$</span>loglik</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">[<span class="dv">1</span>] <span class="fl">-7056.652</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">mlin2<span class="op">$</span>loglik</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">[<span class="dv">1</span>] <span class="fl">-7056.652</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">mlin<span class="op">$</span>best</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">               age65                 male           age65<span class="op">:</span>male </a>
<a class="sourceLine" id="cb3-7" data-line-number="7">           <span class="fl">0.3596478</span>           <span class="fl">-0.7416496</span>            <span class="fl">0.1647425</span> </a>
<a class="sourceLine" id="cb3-8" data-line-number="8">            varcov <span class="dv">1</span>             varcov <span class="dv">2</span>             varcov <span class="dv">3</span> </a>
<a class="sourceLine" id="cb3-9" data-line-number="9">           <span class="fl">1.7524938</span>           <span class="fl">-0.3179336</span>            <span class="fl">0.1973436</span> </a>
<a class="sourceLine" id="cb3-10" data-line-number="10">Linear <span class="dv">1</span> (intercept)   Linear <span class="dv">2</span> (std err) </a>
<a class="sourceLine" id="cb3-11" data-line-number="11">           <span class="fl">6.9846122</span>            <span class="fl">5.5489605</span> </a>
<a class="sourceLine" id="cb3-12" data-line-number="12">mlin2<span class="op">$</span>best</a>
<a class="sourceLine" id="cb3-13" data-line-number="13"> intercept      age65       male age65<span class="op">:</span>male   varcov <span class="dv">1</span>   varcov <span class="dv">2</span>   varcov <span class="dv">3</span> </a>
<a class="sourceLine" id="cb3-14" data-line-number="14"> <span class="fl">6.9846116</span>  <span class="fl">1.9956717</span> <span class="fl">-4.1153838</span>  <span class="fl">0.9141495</span> <span class="fl">53.9609787</span> <span class="fl">-9.7894861</span>  <span class="fl">6.0764003</span> </a>
<a class="sourceLine" id="cb3-15" data-line-number="15">    stderr </a>
<a class="sourceLine" id="cb3-16" data-line-number="16"> <span class="fl">5.5489602</span> </a></code></pre></div>
</div>
<div class="section level4">
<h4 id="nonlinear-link-function-1-beta-cumulative-distribution-function">Nonlinear link function 1: Beta cumulative distribution function<a class="anchor" aria-label="anchor" href="#nonlinear-link-function-1-beta-cumulative-distribution-function"></a>
</h4>
<p>The rescaled cumulative distribution function (CDF) of a Beta distribution provides concave, convex or sigmoïd transformations between the marker and its underlying latent process.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mbeta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">CESD</span> <span class="op">~</span> <span class="va">age65</span><span class="op">*</span><span class="va">male</span>, random<span class="op">=</span><span class="op">~</span> <span class="va">age65</span>, subject<span class="op">=</span><span class="st">'ID'</span>, data<span class="op">=</span><span class="va">paquid</span>, link<span class="op">=</span><span class="st">'beta'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="nonlinear-link-function-2-quadratic-i-splines">Nonlinear link function 2: Quadratic I-splines<a class="anchor" aria-label="anchor" href="#nonlinear-link-function-2-quadratic-i-splines"></a>
</h4>
<p>The family of quadratic I-splines approximates any continuous increasing link function. It involves nodes that are distributed within the range of the marker. By default, 5 equidistant knots located in the marker range are used :</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mspl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">CESD</span> <span class="op">~</span> <span class="va">age65</span><span class="op">*</span><span class="va">male</span>, random<span class="op">=</span><span class="op">~</span> <span class="va">age65</span>, subject<span class="op">=</span><span class="st">'ID'</span>, data<span class="op">=</span><span class="va">paquid</span>, link<span class="op">=</span><span class="st">'splines'</span><span class="op">)</span></span></code></pre></div>
The number of knots and their location may be specified. The number of nodes is first entered followed by <code>-</code>, then the location is specified with <code>equi</code>, <code>quant</code> or <code>manual</code> for respectively equidistant knots, knots at quantiles of the marker distribution or interior knots entered manually in argument intnodes. For example, <code>7-equi-splines</code> means I-splines with 7 equidistant nodes, <code>6-quant-splines</code> means I-splines with 6 nodes located at the quantiles of the marker distribution. The shortcut <code>splines</code> stands for <code>5-equi-splines</code>.

<p>For an example with 5 knots placed at the quantiles:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mspl5q</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">CESD</span> <span class="op">~</span> <span class="va">age65</span><span class="op">*</span><span class="va">male</span>, random<span class="op">=</span><span class="op">~</span> <span class="va">age65</span>, subject<span class="op">=</span><span class="st">'ID'</span>, data<span class="op">=</span><span class="va">paquid</span>, link<span class="op">=</span><span class="st">'5-quant-splines'</span><span class="op">)</span></span></code></pre></div>
<p> </p>
</div>
</div>
<div class="section level3">
<h3 id="select-the-best-model">Select the best model<a class="anchor" aria-label="anchor" href="#select-the-best-model"></a>
</h3>
<p align="justify">
Objects <code>mlin</code>, <code>mbeta</code>, <code>mspl</code> and <code>mspl5q</code> are latent process mixed models that assume the exact same trajectory for the underlying latent process but different link functions: <code>linear</code>,<code>BetaCDF</code>, <code>I-splines with 5 equidistant knots</code> (default with link=‘splines’) and <code>I-splines with 5 knots at percentiles</code>, respectively. To select the most appropriate link function, one can compare these different models. Usually this is achieved by comparing the models in terms of goodness-of-fit using measures such as <strong>AIC</strong> or <strong>UACV</strong>.
</p>
<p>The <code>summarytable</code> command gives the AIC (the UACV is in the output of each model):</p>
<p> </p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">summarytable</span>(mlin,mbeta,mspl,mspl5q,<span class="dt">which =</span> <span class="kw">c</span>(<span class="st">"loglik"</span>, <span class="st">"conv"</span>, <span class="st">"npm"</span>, <span class="st">"AIC"</span>))</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">          loglik conv npm      AIC</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">mlin   <span class="fl">-7056.652</span>    <span class="dv">1</span>   <span class="dv">8</span> <span class="fl">14129.30</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">mbeta  <span class="fl">-6306.962</span>    <span class="dv">1</span>  <span class="dv">10</span> <span class="fl">12633.92</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">mspl   <span class="fl">-6509.681</span>    <span class="dv">1</span>  <span class="dv">13</span> <span class="fl">13045.36</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6">mspl5q <span class="fl">-6320.085</span>    <span class="dv">1</span>  <span class="dv">13</span> <span class="fl">12666.17</span></a></code></pre></div>
<p> </p>
<p align="justify">
In this case, the model with a link function approximated by <code>I-splines with 5 knots</code> placed at the quantiles provides the best fit according to the AIC criterion.
</p>
<p> </p>
<p>The different estimated link functions can be compared in a plot:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mlin</span>, which<span class="op">=</span><span class="st">"linkfunction"</span>, bty<span class="op">=</span><span class="st">'l'</span>, ylab<span class="op">=</span><span class="st">"CES-D"</span>, col<span class="op">=</span><span class="va">col</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fl">2</span>, xlab<span class="op">=</span><span class="st">"underlying latent process"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mbeta</span>, which<span class="op">=</span><span class="st">"linkfunction"</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mspl</span>, which<span class="op">=</span><span class="st">"linkfunction"</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="va">col</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mspl5q</span>, which<span class="op">=</span><span class="st">"linkfunction"</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"topleft"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linear"</span>, <span class="st">"beta"</span>,<span class="st">"splines (5equidistant)"</span>,<span class="st">"splines (5 at quantiles)"</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">1</span>, col<span class="op">=</span><span class="va">col</span>, bty<span class="op">=</span><span class="st">"n"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_process_model_with_lcmm_files/figure-html/testprint-1.png" width="576"></p>
<p> </p>
<p align="justify">
We see that the 2 splines transformations are very close. The linear model does not seem to be appropriate, as shown by the gap betwwen the linear curve and the splines curves. The beta transformation departs from the splines only in the high values of the latent process.
</p>
<p> </p>
<p>Confidence bands of the transformations can be obtained by the Monte Carlo method :</p>
<p> </p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linkspl5q</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictlink.html">predictlink</a></span><span class="op">(</span><span class="va">mspl5q</span>,ndraws<span class="op">=</span><span class="fl">2000</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">linkspl5q</span>, col<span class="op">=</span><span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, lty<span class="op">=</span><span class="fl">2</span>, shades<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"left"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"95% confidence bands"</span>,<span class="st">"for splines at quantiles"</span><span class="op">)</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="cn">NA</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,<span class="cn">NA</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">"n"</span>, lwd<span class="op">=</span><span class="fl">1</span>, cex<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_process_model_with_lcmm_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<p> </p>
</div>
<div class="section level3">
<h3 id="estimate-the-model-with-a-discrete-link-function-h">Estimate the model with a discrete link function <span class="math inline">\(H\)</span><a class="anchor" aria-label="anchor" href="#estimate-the-model-with-a-discrete-link-function-h"></a>
</h3>
<p>Sometimes, with markers that have only a restricted number of different levels, continuous link functions are not appropriate and the ordinal nature of the marker has to be handled. lcmm function handles such a case by considering threshold link function. However, one has to know that numerical complexity of the model with threshold link function is much more important (due to a numerical integration over the random effect distribution). This has to be kept in mind when fitting this model and the number of random effects is to be chosen parcimoniously.</p>
<p><strong>Note that this model becomes a cumulative probit mixed model</strong>.</p>
<p>Here is an example with <span class="math inline">\(HIER\)</span> variable (4 levels) as considering a threshold link function for CESD would involve too many parameters given the range in 0-52 (e.g., 52 threshold parameters).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mthresholds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">HIER</span> <span class="op">~</span> <span class="va">age65</span><span class="op">*</span><span class="va">male</span>, random<span class="op">=</span><span class="op">~</span> <span class="va">age65</span>, subject<span class="op">=</span><span class="st">'ID'</span>, data<span class="op">=</span><span class="va">paquid</span>, link<span class="op">=</span><span class="st">'thresholds'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="postfit-outputs">Postfit outputs<a class="anchor" aria-label="anchor" href="#postfit-outputs"></a>
</h3>
<div class="section level4">
<h4 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h4>
<p>The summary of the model includes convergence, goodness of fit criteria and estimated parameters.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">summary</span>(mspl5q) </a>
<a class="sourceLine" id="cb11-2" data-line-number="2">General latent class mixed model </a>
<a class="sourceLine" id="cb11-3" data-line-number="3">     fitted by maximum likelihood method </a>
<a class="sourceLine" id="cb11-4" data-line-number="4"> </a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="kw">lcmm</span>(<span class="dt">fixed =</span> CESD <span class="op">~</span><span class="st"> </span>age65 <span class="op">*</span><span class="st"> </span>male, <span class="dt">random =</span> <span class="op">~</span>age65, <span class="dt">subject =</span> <span class="st">"ID"</span>, </a>
<a class="sourceLine" id="cb11-6" data-line-number="6">    <span class="dt">link =</span> <span class="st">"5-quant-splines"</span>, <span class="dt">data =</span> paquid)</a>
<a class="sourceLine" id="cb11-7" data-line-number="7"> </a>
<a class="sourceLine" id="cb11-8" data-line-number="8">Statistical Model<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="st">     </span>Dataset<span class="op">:</span><span class="st"> </span>paquid </a>
<a class="sourceLine" id="cb11-10" data-line-number="10">     Number of subjects<span class="op">:</span><span class="st"> </span><span class="dv">500</span> </a>
<a class="sourceLine" id="cb11-11" data-line-number="11">     Number of observations<span class="op">:</span><span class="st"> </span><span class="dv">2104</span> </a>
<a class="sourceLine" id="cb11-12" data-line-number="12">     Number of observations deleted<span class="op">:</span><span class="st"> </span><span class="dv">146</span> </a>
<a class="sourceLine" id="cb11-13" data-line-number="13">     Number of latent classes<span class="op">:</span><span class="st"> </span><span class="dv">1</span> </a>
<a class="sourceLine" id="cb11-14" data-line-number="14">     Number of parameters<span class="op">:</span><span class="st"> </span><span class="dv">13</span>  </a>
<a class="sourceLine" id="cb11-15" data-line-number="15">     Link <span class="cf">function</span><span class="op">:</span><span class="st"> </span>Quadratic I<span class="op">-</span>splines with nodes  </a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="dv">0</span> <span class="dv">2</span> <span class="dv">6</span> <span class="dv">12</span> <span class="dv">52</span>  </a>
<a class="sourceLine" id="cb11-17" data-line-number="17"> </a>
<a class="sourceLine" id="cb11-18" data-line-number="18">Iteration process<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="st">     </span>Convergence criteria satisfied </a>
<a class="sourceLine" id="cb11-20" data-line-number="20">     Number of iterations<span class="op">:</span><span class="st">  </span><span class="dv">19</span> </a>
<a class="sourceLine" id="cb11-21" data-line-number="21">     Convergence criteria<span class="op">:</span><span class="st"> </span>parameters=<span class="st"> </span><span class="fl">1.3e-08</span> </a>
<a class="sourceLine" id="cb11-22" data-line-number="22">                         <span class="op">:</span><span class="st"> </span>likelihood=<span class="st"> </span><span class="fl">1.5e-07</span> </a>
<a class="sourceLine" id="cb11-23" data-line-number="23">                         <span class="op">:</span><span class="st"> </span>second derivatives=<span class="st"> </span><span class="fl">3.1e-14</span> </a>
<a class="sourceLine" id="cb11-24" data-line-number="24"> </a>
<a class="sourceLine" id="cb11-25" data-line-number="25">Goodness<span class="op">-</span>of<span class="op">-</span>fit statistics<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-26" data-line-number="26"><span class="st">     </span>maximum log<span class="op">-</span>likelihood<span class="op">:</span><span class="st"> </span><span class="fl">-6320.08</span>  </a>
<a class="sourceLine" id="cb11-27" data-line-number="27">     AIC<span class="op">:</span><span class="st"> </span><span class="fl">12666.17</span>  </a>
<a class="sourceLine" id="cb11-28" data-line-number="28">     BIC<span class="op">:</span><span class="st"> </span><span class="fl">12720.96</span>  </a>
<a class="sourceLine" id="cb11-29" data-line-number="29"> </a>
<a class="sourceLine" id="cb11-30" data-line-number="30">     Discrete posterior log<span class="op">-</span>likelihood<span class="op">:</span><span class="st"> </span><span class="fl">-6309.09</span>  </a>
<a class="sourceLine" id="cb11-31" data-line-number="31">     Discrete AIC<span class="op">:</span><span class="st"> </span><span class="fl">12644.18</span>  </a>
<a class="sourceLine" id="cb11-32" data-line-number="32"> </a>
<a class="sourceLine" id="cb11-33" data-line-number="33">     Mean discrete AIC per subject<span class="op">:</span><span class="st"> </span><span class="fl">12.6442</span>  </a>
<a class="sourceLine" id="cb11-34" data-line-number="34">     Mean UACV per subject<span class="op">:</span><span class="st"> </span><span class="fl">12.6439</span>  </a>
<a class="sourceLine" id="cb11-35" data-line-number="35">     Mean discrete LL per subject<span class="op">:</span><span class="st"> </span><span class="fl">-12.6182</span>  </a>
<a class="sourceLine" id="cb11-36" data-line-number="36"> </a>
<a class="sourceLine" id="cb11-37" data-line-number="37">Maximum Likelihood Estimates<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-38" data-line-number="38"><span class="st"> </span></a>
<a class="sourceLine" id="cb11-39" data-line-number="39">Fixed effects <span class="cf">in</span> the longitudinal model<span class="op">:</span></a>
<a class="sourceLine" id="cb11-40" data-line-number="40"></a>
<a class="sourceLine" id="cb11-41" data-line-number="41"><span class="st">                              </span>coef      Se    Wald p<span class="op">-</span>value</a>
<a class="sourceLine" id="cb11-42" data-line-number="42"><span class="kw">intercept</span> (not estimated)        <span class="dv">0</span>                        </a>
<a class="sourceLine" id="cb11-43" data-line-number="43">age65                      <span class="fl">0.42421</span> <span class="fl">0.06279</span>   <span class="fl">6.756</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb11-44" data-line-number="44">male                      <span class="fl">-0.83140</span> <span class="fl">0.19742</span>  <span class="fl">-4.211</span> <span class="fl">0.00003</span></a>
<a class="sourceLine" id="cb11-45" data-line-number="45">age65<span class="op">:</span>male                 <span class="fl">0.23371</span> <span class="fl">0.10300</span>   <span class="fl">2.269</span> <span class="fl">0.02327</span></a>
<a class="sourceLine" id="cb11-46" data-line-number="46"></a>
<a class="sourceLine" id="cb11-47" data-line-number="47"></a>
<a class="sourceLine" id="cb11-48" data-line-number="48">Variance<span class="op">-</span>covariance matrix of the random<span class="op">-</span>effects<span class="op">:</span></a>
<a class="sourceLine" id="cb11-49" data-line-number="49"><span class="st">          </span>intercept  age65</a>
<a class="sourceLine" id="cb11-50" data-line-number="50">intercept   <span class="fl">1.89911</span>       </a>
<a class="sourceLine" id="cb11-51" data-line-number="51">age65      <span class="fl">-0.39567</span> <span class="fl">0.1711</span></a>
<a class="sourceLine" id="cb11-52" data-line-number="52"></a>
<a class="sourceLine" id="cb11-53" data-line-number="53">Residual standard <span class="kw">error</span> (not estimated) =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb11-54" data-line-number="54"></a>
<a class="sourceLine" id="cb11-55" data-line-number="55">Parameters of the link <span class="cf">function</span><span class="op">:</span></a>
<a class="sourceLine" id="cb11-56" data-line-number="56"></a>
<a class="sourceLine" id="cb11-57" data-line-number="57"><span class="st">               </span>coef      Se    Wald p<span class="op">-</span>value</a>
<a class="sourceLine" id="cb11-58" data-line-number="58">I<span class="op">-</span>splines1 <span class="fl">-2.03816</span> <span class="fl">0.13469</span> <span class="fl">-15.132</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb11-59" data-line-number="59">I<span class="op">-</span>splines2  <span class="fl">1.04627</span> <span class="fl">0.02461</span>  <span class="fl">42.510</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb11-60" data-line-number="60">I<span class="op">-</span>splines3  <span class="fl">0.74190</span> <span class="fl">0.03773</span>  <span class="fl">19.665</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb11-61" data-line-number="61">I<span class="op">-</span>splines4  <span class="fl">0.98399</span> <span class="fl">0.03237</span>  <span class="fl">30.400</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb11-62" data-line-number="62">I<span class="op">-</span>splines5  <span class="fl">1.55606</span> <span class="fl">0.04480</span>  <span class="fl">34.735</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb11-63" data-line-number="63">I<span class="op">-</span>splines6  <span class="fl">0.93273</span> <span class="fl">0.16614</span>   <span class="fl">5.614</span> <span class="fl">0.00000</span></a>
<a class="sourceLine" id="cb11-64" data-line-number="64">I<span class="op">-</span>splines7  <span class="fl">1.38790</span> <span class="fl">0.17687</span>   <span class="fl">7.847</span> <span class="fl">0.00000</span></a></code></pre></div>
</div>
<div class="section level4">
<h4 id="graph-of-predicted-trajectories-according-to-a-profile-of-covariates">Graph of predicted trajectories according to a profile of covariates<a class="anchor" aria-label="anchor" href="#graph-of-predicted-trajectories-according-to-a-profile-of-covariates"></a>
</h4>
<p>The predicted trajectories can be computed in the natural scale of the dependent variable and according to a profile of covariates:</p>
<p> </p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datnew</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">65</span>,<span class="fl">95</span>,length<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">age65</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">datnew</span><span class="op">$</span><span class="va">age</span> <span class="op">-</span> <span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">male</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">women</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">mspl5q</span>, newdata<span class="op">=</span><span class="va">datnew</span>, var.time<span class="op">=</span><span class="st">"age"</span>, draws<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">male</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">men</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">mspl5q</span>, newdata<span class="op">=</span><span class="va">datnew</span>, var.time<span class="op">=</span><span class="st">"age"</span>, draws<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p> </p>
<p>And then plotted:</p>
<p> </p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">women</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="fl">6</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">20</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"age in year"</span>,ylab<span class="op">=</span><span class="st">"CES-D"</span>,bty<span class="op">=</span><span class="st">"l"</span>, legend<span class="op">=</span><span class="cn">NULL</span>, shades <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">men</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="fl">4</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, shades<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"topleft"</span>, bty<span class="op">=</span><span class="st">"n"</span>, ncol<span class="op">=</span><span class="fl">2</span>, lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">4</span><span class="op">)</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"women"</span>,<span class="st">"men"</span>, <span class="st">"95% CI"</span>, <span class="st">"95% CI"</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><img src="latent_process_model_with_lcmm_files/figure-html/unnamed-chunk-9-1.png" width="576"></p>
<p> </p>
</div>
<div class="section level4">
<h4 id="goodness-of-fit-1-plot-of-residuals">Goodness of fit 1: plot of residuals<a class="anchor" aria-label="anchor" href="#goodness-of-fit-1-plot-of-residuals"></a>
</h4>
<p>The subject-specific residuals (qqplot in bottom right panel) should be Gaussian.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mspl5q</span>, cex.main<span class="op">=</span><span class="fl">0.9</span><span class="op">)</span></span></code></pre></div>
<p> </p>
</div>
</div>
<div class="section level3">
<h3 id="goodness-of-fit-2-plot-of-predictions-versus-observations">Goodness of fit 2: plot of predictions versus observations<a class="anchor" aria-label="anchor" href="#goodness-of-fit-2-plot-of-predictions-versus-observations"></a>
</h3>
<p>The mean predictions and observations can be plotted according to time. Note that the predictions and observations are in the scale of the latent process (observations are transformed with the estimated link function):</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mspl5q</span>, which<span class="op">=</span><span class="st">"fit"</span>, var.time<span class="op">=</span><span class="st">"age65"</span>, bty<span class="op">=</span><span class="st">"l"</span>, xlab<span class="op">=</span><span class="st">"(age-65)/10"</span>, break.times<span class="op">=</span><span class="fl">8</span>, ylab<span class="op">=</span><span class="st">"latent process"</span>, lwd<span class="op">=</span><span class="fl">2</span>, marg<span class="op">=</span><span class="cn">FALSE</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, shades<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_process_model_with_lcmm_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
<p> </p>
</div>
</div>
<div class="section level2">
<h2 id="to-go-further">To go further …<a class="anchor" aria-label="anchor" href="#to-go-further"></a>
</h2>
<div class="section level3">
<h3 id="heterogeneous-profiles-of-trajectories">heterogeneous profiles of trajectories<a class="anchor" aria-label="anchor" href="#heterogeneous-profiles-of-trajectories"></a>
</h3>
<p>The latent process mixed model extends to the heterogeneous case with latent classes. The same strategy as explained with hlme (see <a href="latent_class_model_with_hlme.html">vignette</a> ) can be used.</p>
</div>
<div class="section level3">
<h3 id="joint-analysis-of-a-time-to-event">joint analysis of a time to event<a class="anchor" aria-label="anchor" href="#joint-analysis-of-a-time-to-event"></a>
</h3>
<p>The latent process mixed model extends to the case of a joint model. This is done in Jointlcmm and mpjlcmm. See the <a href="joint_latent_class_model_with_Jointlcmm.html">Jointlcmm vignette</a>.</p>
</div>
<div class="section level3">
<h3 id="multiple-markers-of-the-same-latent-process">multiple markers of the same latent process<a class="anchor" aria-label="anchor" href="#multiple-markers-of-the-same-latent-process"></a>
</h3>
<p>In some cases, several markers of the same underlying latent process may be measured. The latent process mixed model extends to that case. This is the purpose of multlcmm (see the vignette for <a href="latent_process_model_with_multlcmm.html">continuous</a> and <a href="latent_process_model_with_multlcmm_IRT.html">ordinal</a> outcomes.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Cecile Proust-Lima, Viviane Philipps.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
