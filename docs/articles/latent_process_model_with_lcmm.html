<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>How to estimate a latent process mixed model using lcmm function • lcmm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to estimate a latent process mixed model using lcmm function">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lcmm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/lcmm.html">GET STARTED</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">VIGNETTES</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/latent_class_model_with_hlme.html">How to estimate a latent class mixed model using hlme function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_lcmm.html">How to estimate a latent process mixed model using lcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm.html">How to estimate a latent process mixed model for multivariate markers using multlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm_IRT.html">Continuous-time longitudinal IRT model</a></li>
    <li><a class="dropdown-item" href="../articles/joint_latent_class_model_with_Jointlcmm.html">How to estimate a joint latent class mixed model using Jointlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/multivariate_latent_class_model_with_mpjlcmm.html">How to estimate a multivariate latent class mixed model using mpjlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/secondary_model_with_externVar.html">Accounting for latent class assignment uncertainty in subsequent analyses</a></li>
    <li><a class="dropdown-item" href="../articles/pre_normalizing.html">Pre-normalizing a dependent variable using lcmm</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/usual_problems.html">FAQ</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">REFERENCE</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">CHANGELOG</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CecileProust-Lima/lcmm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>How to estimate a latent process mixed model using lcmm function</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CecileProust-Lima/lcmm/blob/HEAD/vignettes/latent_process_model_with_lcmm.Rmd" class="external-link"><code>vignettes/latent_process_model_with_lcmm.Rmd</code></a></small>
      <div class="d-none name"><code>latent_process_model_with_lcmm.Rmd</code></div>
    </div>

    
    
<p> </p>
<div class="section level2">
<h2 id="background-on-the-model">Background on the model<a class="anchor" aria-label="anchor" href="#background-on-the-model"></a>
</h2>
<p align="justify">
</p>
<p>Each dynamic phenomenon can be characterized by a latent process
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>Λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\Lambda(t))</annotation></semantics></math>
which evolves in continuous time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.
When modeling repeated measures of marker, we usually don’t think of it
as a latent process measured with error. Yet, this is the underlying
assumption made by the mixed model theory. Function lcmm exploits this
framework to extend the linear mixed model theory to any type of outcome
(ordinal, binary, continuous with any distribution).</p>
<div class="section level3">
<h3 id="the-latent-process-mixed-model">The latent process mixed model<a class="anchor" aria-label="anchor" href="#the-latent-process-mixed-model"></a>
</h3>
<p>The latent process mixed model is introduced in Proust-Lima et
al. (2006 - <a href="https://doi.org/10.1111/j.1541-0420.2006.00573.x" class="external-link uri">https://doi.org/10.1111/j.1541-0420.2006.00573.x</a> and
2013 - <a href="https://doi.org/10.1111/bmsp.12000" class="external-link uri">https://doi.org/10.1111/bmsp.12000</a> ).</p>
<p>The quantity of interest defined as a latent process is modeled
according to time using a linear mixed model:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>X</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>β</mi><mo>+</mo><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>u</mi><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Lambda(t) = X(t) \beta + Z(t)u_i +w_i(t)</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X(t)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Z(t)</annotation></semantics></math>
are vectors of covariates
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Z(t)</annotation></semantics></math>
is included in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X(t)</annotation></semantics></math>);</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
are the fixed effects (i.e., population mean effects);</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>u</mi><mi>i</mi></msub><annotation encoding="application/x-tex">u_i</annotation></semantics></math>
are the random effects (i.e., individual effects); they are distributed
according to a zero-mean multivariate normal distribution with
covariance matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>;</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(w_i(t))</annotation></semantics></math>
is a Gaussian process that might be added in the model to relax the
intra-subject correlation structure.</li>
</ul>
<p>The relationship between the latent process of interest and the
observations of the marker
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">Y_{ij}</annotation></semantics></math>
(for subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and occasion
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>)
is simultaneously defined in an equation of observation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>H</mi><mrow><mo stretchy="true" form="prefix">(</mo><mspace width="0.222em"></mspace><mi>Λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mspace width="0.222em"></mspace><mo>;</mo><mi>η</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y_{ij}  = H( ~ \Lambda(t_{ij})+\epsilon_{ij} ~ ; \eta)</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">t_{ij}</annotation></semantics></math>
is the time of measurement for subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and occasion
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>;</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\epsilon_{ij}</annotation></semantics></math>
is an independent zero-mean Gaussian error;</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
is the link function (parameterized by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>η</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>)
that transforms the latent process into the scale and metric of the
marker.</li>
</ul>
<p>Different parametric families are used. <strong>When the marker is
continuous</strong>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>H</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><annotation encoding="application/x-tex">H^{-1}</annotation></semantics></math>
is a parametric family of increasing monotonic functions among:</p>
<ul>
<li>the linear transformation: this reduces to the linear mixed model (2
parameters)</li>
<li>the Beta cumulative distribution family rescaled (4 parameters)</li>
<li>the basis of quadratic I-splines with m knots (m+2 parameters)</li>
</ul>
<p><strong>When the marker is discrete (binary or ordinal):</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
is a threshold function, that is each level of Y corresponds to an
interval of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\Lambda(t_{ij})+\epsilon_{ij}</annotation></semantics></math>
which boundaries are to be estimated.</p>
</div>
<div class="section level3">
<h3 id="identifiability">Identifiability<a class="anchor" aria-label="anchor" href="#identifiability"></a>
</h3>
<p>As in any latent variable model, the metric of the latent variable
has to be defined. In lcmm, the variance of the errors is 1 and the mean
intercept (in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>)
is 0.</p>
<p> </p>
</div>
</div>
<div class="section level2">
<h2 id="example-with-ces-d">Example with CES-D<a class="anchor" aria-label="anchor" href="#example-with-ces-d"></a>
</h2>
<p align="justify">
In this vignette, the latent process mixed models implemented in
<code>lcmm</code> are illustrated by the study of the linear trajectory
of depressive symptoms (as measured by CES-D scale) according to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>g</mi><mi>e</mi><mn>65</mn></mrow><annotation encoding="application/x-tex">age65</annotation></semantics></math>
and adjusted for male. Correlated random effects for the intercept and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>g</mi><mi>e</mi><mn>65</mn></mrow><annotation encoding="application/x-tex">age65</annotation></semantics></math>
are included.
</p>
<div class="section level3">
<h3 id="model-considered">Model considered:<a class="anchor" aria-label="anchor" href="#model-considered"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>E</mi><mi>S</mi><msub><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>H</mi><mrow><mo stretchy="true" form="prefix">(</mo><mspace width="0.222em"></mspace><msub><mi>β</mi><mn>1</mn></msub><mi>a</mi><mi>g</mi><mi>e</mi><msub><mn>65</mn><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mi>m</mi><mi>a</mi><mi>l</mi><msub><mi>e</mi><mi>i</mi></msub><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><mi>a</mi><mi>g</mi><mi>e</mi><msub><mn>65</mn><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>m</mi><mi>a</mi><mi>l</mi><msub><mi>e</mi><mi>i</mi></msub><mo>+</mo><msub><mi>u</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub><mo>+</mo><msub><mi>u</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><mi>a</mi><mi>g</mi><mi>e</mi><msub><mn>65</mn><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mspace width="0.222em"></mspace><mo>;</mo><mspace width="0.222em"></mspace><mi>η</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">CESD_{ij} = H(~  \beta_{1}age65_{ij}+\beta_{2}male_{i}+\beta_{3}age65_{ij}male_{i} +u_{0i}+u_{1i}age65_{ij}+\epsilon_{ij} ~ ; ~ \eta)</annotation></semantics></math></p>
<p> </p>
<p><em>Where :</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>i</mi></msub><mo>∼</mo><mi>𝒩</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">u_{i} \sim \mathcal{N}(0,B)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>∼</mo><mi>𝒩</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\epsilon_{ij} \sim \mathcal{N}(0,1)</annotation></semantics></math></p>
<p> </p>
<p>The <em>Fixed part</em> is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mi>a</mi><mi>g</mi><mi>e</mi><msub><mn>65</mn><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mi>m</mi><mi>a</mi><mi>l</mi><msub><mi>e</mi><mi>i</mi></msub><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><mi>a</mi><mi>g</mi><mi>e</mi><msub><mn>65</mn><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>m</mi><mi>a</mi><mi>l</mi><msub><mi>e</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\beta_{1}age65_{ij}+\beta_{2}male_{i}+\beta_{3}age65_{ij}male_{i}</annotation></semantics></math>
; the <em>random part</em> is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub><mo>+</mo><msub><mi>u</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><mi>a</mi><mi>g</mi><mi>e</mi><msub><mn>65</mn><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">u_{0i}+u_{1i}age65_{ij}</annotation></semantics></math>.</p>
<p> </p>
</div>
<div class="section level3">
<h3 id="estimate-the-model-for-different-continuous-link-functions-h">Estimate the model for different continuous link functions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#estimate-the-model-for-different-continuous-link-functions-h"></a>
</h3>
<p>We use the age variable recentered around 65 years old and in
decades:</p>
<p>The latent process mixed model can be fitted with different link
functions as shown below. This is done with argument link.</p>
<div class="section level4">
<h4 id="linear-link-function">Linear link function<a class="anchor" aria-label="anchor" href="#linear-link-function"></a>
</h4>
<p>When defining the linear link function, the model reduces to a
standard linear mixed model. The model can be fitted with lcmm function
(with the linear link function by default):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mlin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">CESD</span> <span class="op">~</span> <span class="va">age65</span><span class="op">*</span><span class="va">male</span>, random<span class="op">=</span><span class="op">~</span> <span class="va">age65</span>, subject<span class="op">=</span><span class="st">'ID'</span>, data<span class="op">=</span><span class="va">paquid</span><span class="op">)</span> <span class="co">#link= linear</span></span></code></pre></div>
<p align="justify">
It is the exact same model as one fitted by hlme. The only difference
with a hlme object is the parameterization for the intercept and the
residual standard error that are considered as rescaling parameters.
</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mlin2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hlme.html">hlme</a></span><span class="op">(</span><span class="va">CESD</span> <span class="op">~</span> <span class="va">age65</span><span class="op">*</span><span class="va">male</span>, random<span class="op">=</span><span class="op">~</span> <span class="va">age65</span>, subject<span class="op">=</span><span class="st">'ID'</span>, data<span class="op">=</span><span class="va">paquid</span><span class="op">)</span> <span class="co">#link= linear</span></span></code></pre></div>
<p>The log likelihood are the same but the estimated parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
are not in the same scale</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>mlin<span class="sc">$</span>loglik</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>[<span class="dv">1</span>] <span class="sc">-</span><span class="fl">7056.652</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>mlin2<span class="sc">$</span>loglik</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>[<span class="dv">1</span>] <span class="sc">-</span><span class="fl">7056.652</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>mlin<span class="sc">$</span>best</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>               age65                 male           age65<span class="sc">:</span>male </span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>           <span class="fl">0.3596478</span>           <span class="sc">-</span><span class="fl">0.7416496</span>            <span class="fl">0.1647425</span> </span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>            varcov <span class="dv">1</span>             varcov <span class="dv">2</span>             varcov <span class="dv">3</span> </span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>           <span class="fl">1.7524938</span>           <span class="sc">-</span><span class="fl">0.3179336</span>            <span class="fl">0.1973436</span> </span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>Linear <span class="dv">1</span> (intercept)   Linear <span class="dv">2</span> (std err) </span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>           <span class="fl">6.9846122</span>            <span class="fl">5.5489605</span> </span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>mlin2<span class="sc">$</span>best</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a> intercept      age65       male age65<span class="sc">:</span>male   varcov <span class="dv">1</span>   varcov <span class="dv">2</span>   varcov <span class="dv">3</span> </span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a> <span class="fl">6.9846118</span>  <span class="fl">1.9956716</span> <span class="sc">-</span><span class="fl">4.1153841</span>  <span class="fl">0.9141497</span> <span class="fl">53.9609797</span> <span class="sc">-</span><span class="fl">9.7894866</span>  <span class="fl">6.0764005</span> </span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>    stderr </span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a> <span class="fl">5.5489603</span> </span></code></pre></div>
</div>
<div class="section level4">
<h4 id="nonlinear-link-function-1-beta-cumulative-distribution-function">Nonlinear link function 1: Beta cumulative distribution
function<a class="anchor" aria-label="anchor" href="#nonlinear-link-function-1-beta-cumulative-distribution-function"></a>
</h4>
<p>The rescaled cumulative distribution function (CDF) of a Beta
distribution provides concave, convex or sigmoïd transformations between
the marker and its underlying latent process.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mbeta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">CESD</span> <span class="op">~</span> <span class="va">age65</span><span class="op">*</span><span class="va">male</span>, random<span class="op">=</span><span class="op">~</span> <span class="va">age65</span>, subject<span class="op">=</span><span class="st">'ID'</span>, data<span class="op">=</span><span class="va">paquid</span>, link<span class="op">=</span><span class="st">'beta'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="nonlinear-link-function-2-quadratic-i-splines">Nonlinear link function 2: Quadratic I-splines<a class="anchor" aria-label="anchor" href="#nonlinear-link-function-2-quadratic-i-splines"></a>
</h4>
<p>The family of quadratic I-splines approximates any continuous
increasing link function. It involves nodes that are distributed within
the range of the marker. By default, 5 equidistant knots located in the
marker range are used :</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mspl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">CESD</span> <span class="op">~</span> <span class="va">age65</span><span class="op">*</span><span class="va">male</span>, random<span class="op">=</span><span class="op">~</span> <span class="va">age65</span>, subject<span class="op">=</span><span class="st">'ID'</span>, data<span class="op">=</span><span class="va">paquid</span>, link<span class="op">=</span><span class="st">'splines'</span><span class="op">)</span></span></code></pre></div>
The number of knots and their location may be specified. The number of
nodes is first entered followed by <code>-</code>, then the location is
specified with <code>equi</code>, <code>quant</code> or
<code>manual</code> for respectively equidistant knots, knots at
quantiles of the marker distribution or interior knots entered manually
in argument intnodes. For example, <code>7-equi-splines</code> means
I-splines with 7 equidistant nodes, <code>6-quant-splines</code> means
I-splines with 6 nodes located at the quantiles of the marker
distribution. The shortcut <code>splines</code> stands for
<code>5-equi-splines</code>.

<p>For an example with 5 knots placed at the quantiles:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mspl5q</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">CESD</span> <span class="op">~</span> <span class="va">age65</span><span class="op">*</span><span class="va">male</span>, random<span class="op">=</span><span class="op">~</span> <span class="va">age65</span>, subject<span class="op">=</span><span class="st">'ID'</span>, data<span class="op">=</span><span class="va">paquid</span>, link<span class="op">=</span><span class="st">'5-quant-splines'</span><span class="op">)</span></span></code></pre></div>
<p> </p>
</div>
</div>
<div class="section level3">
<h3 id="select-the-best-model">Select the best model<a class="anchor" aria-label="anchor" href="#select-the-best-model"></a>
</h3>
<p align="justify">
Objects <code>mlin</code>, <code>mbeta</code>, <code>mspl</code> and
<code>mspl5q</code> are latent process mixed models that assume the
exact same trajectory for the underlying latent process but different
link functions: <code>linear</code>,<code>BetaCDF</code>,
<code>I-splines with 5 equidistant knots</code> (default with
link=‘splines’) and <code>I-splines with 5 knots at percentiles</code>,
respectively. To select the most appropriate link function, one can
compare these different models. Usually this is achieved by comparing
the models in terms of goodness-of-fit using measures such as
<strong>AIC</strong> or <strong>UACV</strong>.
</p>
<p>The <code>summarytable</code> command gives the AIC (the UACV is in
the output of each model):</p>
<p> </p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">summarytable</span>(mlin,mbeta,mspl,mspl5q,<span class="at">which =</span> <span class="fu">c</span>(<span class="st">"loglik"</span>, <span class="st">"conv"</span>, <span class="st">"npm"</span>, <span class="st">"AIC"</span>))</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>          loglik conv npm      AIC</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>mlin   <span class="sc">-</span><span class="fl">7056.652</span>    <span class="dv">1</span>   <span class="dv">8</span> <span class="fl">14129.30</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>mbeta  <span class="sc">-</span><span class="fl">6306.962</span>    <span class="dv">1</span>  <span class="dv">10</span> <span class="fl">12633.92</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>mspl   <span class="sc">-</span><span class="fl">6509.681</span>    <span class="dv">1</span>  <span class="dv">13</span> <span class="fl">13045.36</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>mspl5q <span class="sc">-</span><span class="fl">6320.085</span>    <span class="dv">1</span>  <span class="dv">13</span> <span class="fl">12666.17</span></span></code></pre></div>
<p> </p>
<p align="justify">
In this case, the model with a link function approximated by
<code>I-splines with 5 knots</code> placed at the quantiles provides the
best fit according to the AIC criterion.
</p>
<p> </p>
<p>The different estimated link functions can be compared in a plot:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mlin</span>, which<span class="op">=</span><span class="st">"linkfunction"</span>, bty<span class="op">=</span><span class="st">'l'</span>, ylab<span class="op">=</span><span class="st">"CES-D"</span>, col<span class="op">=</span><span class="va">col</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fl">2</span>, xlab<span class="op">=</span><span class="st">"underlying latent process"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mbeta</span>, which<span class="op">=</span><span class="st">"linkfunction"</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mspl</span>, which<span class="op">=</span><span class="st">"linkfunction"</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="va">col</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mspl5q</span>, which<span class="op">=</span><span class="st">"linkfunction"</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"topleft"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linear"</span>, <span class="st">"beta"</span>,<span class="st">"splines (5equidistant)"</span>,<span class="st">"splines (5 at quantiles)"</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">1</span>, col<span class="op">=</span><span class="va">col</span>, bty<span class="op">=</span><span class="st">"n"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_process_model_with_lcmm_files/figure-html/testprint-1.png" width="576"></p>
<p> </p>
<p align="justify">
We see that the 2 splines transformations are very close. The linear
model does not seem to be appropriate, as shown by the gap betwwen the
linear curve and the splines curves. The beta transformation departs
from the splines only in the high values of the latent process.
</p>
<p> </p>
<p>Confidence bands of the transformations can be obtained by the Monte
Carlo method :</p>
<p> </p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linkspl5q</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictlink.html">predictlink</a></span><span class="op">(</span><span class="va">mspl5q</span>,ndraws<span class="op">=</span><span class="fl">2000</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">linkspl5q</span>, col<span class="op">=</span><span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, lty<span class="op">=</span><span class="fl">2</span>, shades<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"left"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"95% confidence bands"</span>,<span class="st">"for splines at quantiles"</span><span class="op">)</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="cn">NA</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,<span class="cn">NA</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">"n"</span>, lwd<span class="op">=</span><span class="fl">1</span>, cex<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_process_model_with_lcmm_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<p> </p>
</div>
<div class="section level3">
<h3 id="estimate-the-model-with-a-discrete-link-function-h">Estimate the model with a discrete link function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#estimate-the-model-with-a-discrete-link-function-h"></a>
</h3>
<p>Sometimes, with markers that have only a restricted number of
different levels, continuous link functions are not appropriate and the
ordinal nature of the marker has to be handled. lcmm function handles
such a case by considering threshold link function. However, one has to
know that numerical complexity of the model with threshold link function
is much more important (due to a numerical integration over the random
effect distribution). This has to be kept in mind when fitting this
model and the number of random effects is to be chosen
parcimoniously.</p>
<p><strong>Note that this model becomes a cumulative probit mixed
model</strong>.</p>
<p>Here is an example with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>I</mi><mi>E</mi><mi>R</mi></mrow><annotation encoding="application/x-tex">HIER</annotation></semantics></math>
variable (4 levels) as considering a threshold link function for CESD
would involve too many parameters given the range in 0-52 (e.g., 52
threshold parameters).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mthresholds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">HIER</span> <span class="op">~</span> <span class="va">age65</span><span class="op">*</span><span class="va">male</span>, random<span class="op">=</span><span class="op">~</span> <span class="va">age65</span>, subject<span class="op">=</span><span class="st">'ID'</span>, data<span class="op">=</span><span class="va">paquid</span>, link<span class="op">=</span><span class="st">'thresholds'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="postfit-outputs">Postfit outputs<a class="anchor" aria-label="anchor" href="#postfit-outputs"></a>
</h3>
<div class="section level4">
<h4 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h4>
<p>The summary of the model includes convergence, goodness of fit
criteria and estimated parameters.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">summary</span>(mspl5q) </span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>General latent class mixed model </span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>     fitted by maximum likelihood method </span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a> </span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="fu">lcmm</span>(<span class="at">fixed =</span> CESD <span class="sc">~</span> age65 <span class="sc">*</span> male, <span class="at">random =</span> <span class="sc">~</span>age65, <span class="at">subject =</span> <span class="st">"ID"</span>, </span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>    <span class="at">link =</span> <span class="st">"5-quant-splines"</span>, <span class="at">data =</span> paquid)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a> </span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>Statistical Model<span class="sc">:</span> </span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>     Dataset<span class="sc">:</span> paquid </span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>     Number of subjects<span class="sc">:</span> <span class="dv">500</span> </span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>     Number of observations<span class="sc">:</span> <span class="dv">2104</span> </span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>     Number of observations deleted<span class="sc">:</span> <span class="dv">146</span> </span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>     Number of latent classes<span class="sc">:</span> <span class="dv">1</span> </span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>     Number of parameters<span class="sc">:</span> <span class="dv">13</span>  </span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>     Link <span class="cf">function</span><span class="sc">:</span> Quadratic I<span class="sc">-</span>splines with nodes  </span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="dv">0</span> <span class="dv">2</span> <span class="dv">6</span> <span class="dv">12</span> <span class="dv">52</span>  </span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a> </span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>Iteration process<span class="sc">:</span> </span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>     Convergence criteria satisfied </span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>     Number of iterations<span class="sc">:</span>  <span class="dv">19</span> </span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>     Convergence criteria<span class="sc">:</span> parameters<span class="ot">=</span> <span class="fl">1.3e-08</span> </span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>                         <span class="sc">:</span> likelihood<span class="ot">=</span> <span class="fl">1.5e-07</span> </span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>                         <span class="sc">:</span> second derivatives<span class="ot">=</span> <span class="fl">3.1e-14</span> </span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a> </span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>Goodness<span class="sc">-</span>of<span class="sc">-</span>fit statistics<span class="sc">:</span> </span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a>     maximum log<span class="sc">-</span>likelihood<span class="sc">:</span> <span class="sc">-</span><span class="fl">6320.08</span>  </span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a>     AIC<span class="sc">:</span> <span class="fl">12666.17</span>  </span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a>     BIC<span class="sc">:</span> <span class="fl">12720.96</span>  </span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a> </span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a>     Discrete posterior log<span class="sc">-</span>likelihood<span class="sc">:</span> <span class="sc">-</span><span class="fl">6309.09</span>  </span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a>     Discrete AIC<span class="sc">:</span> <span class="fl">12644.18</span>  </span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a> </span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a>     Mean discrete AIC per subject<span class="sc">:</span> <span class="fl">12.6442</span>  </span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a>     Mean UACV per subject<span class="sc">:</span> <span class="fl">12.6439</span>  </span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a>     Mean discrete LL per subject<span class="sc">:</span> <span class="sc">-</span><span class="fl">12.6182</span>  </span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a> </span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a>Maximum Likelihood Estimates<span class="sc">:</span> </span>
<span id="cb11-38"><a href="#cb11-38" tabindex="-1"></a> </span>
<span id="cb11-39"><a href="#cb11-39" tabindex="-1"></a>Fixed effects <span class="cf">in</span> the longitudinal model<span class="sc">:</span></span>
<span id="cb11-40"><a href="#cb11-40" tabindex="-1"></a></span>
<span id="cb11-41"><a href="#cb11-41" tabindex="-1"></a>                              coef      Se    Wald p<span class="sc">-</span>value</span>
<span id="cb11-42"><a href="#cb11-42" tabindex="-1"></a><span class="fu">intercept</span> (not estimated)        <span class="dv">0</span>                        </span>
<span id="cb11-43"><a href="#cb11-43" tabindex="-1"></a>age65                      <span class="fl">0.42421</span> <span class="fl">0.06279</span>   <span class="fl">6.756</span> <span class="fl">0.00000</span></span>
<span id="cb11-44"><a href="#cb11-44" tabindex="-1"></a>male                      <span class="sc">-</span><span class="fl">0.83140</span> <span class="fl">0.19742</span>  <span class="sc">-</span><span class="fl">4.211</span> <span class="fl">0.00003</span></span>
<span id="cb11-45"><a href="#cb11-45" tabindex="-1"></a>age65<span class="sc">:</span>male                 <span class="fl">0.23371</span> <span class="fl">0.10300</span>   <span class="fl">2.269</span> <span class="fl">0.02327</span></span>
<span id="cb11-46"><a href="#cb11-46" tabindex="-1"></a></span>
<span id="cb11-47"><a href="#cb11-47" tabindex="-1"></a></span>
<span id="cb11-48"><a href="#cb11-48" tabindex="-1"></a>Variance<span class="sc">-</span>covariance matrix of the random<span class="sc">-</span>effects<span class="sc">:</span></span>
<span id="cb11-49"><a href="#cb11-49" tabindex="-1"></a>          intercept  age65</span>
<span id="cb11-50"><a href="#cb11-50" tabindex="-1"></a>intercept   <span class="fl">1.89911</span>       </span>
<span id="cb11-51"><a href="#cb11-51" tabindex="-1"></a>age65      <span class="sc">-</span><span class="fl">0.39567</span> <span class="fl">0.1711</span></span>
<span id="cb11-52"><a href="#cb11-52" tabindex="-1"></a></span>
<span id="cb11-53"><a href="#cb11-53" tabindex="-1"></a>Residual standard <span class="fu">error</span> (not estimated) <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb11-54"><a href="#cb11-54" tabindex="-1"></a></span>
<span id="cb11-55"><a href="#cb11-55" tabindex="-1"></a>Parameters of the link <span class="cf">function</span><span class="sc">:</span></span>
<span id="cb11-56"><a href="#cb11-56" tabindex="-1"></a></span>
<span id="cb11-57"><a href="#cb11-57" tabindex="-1"></a>               coef      Se    Wald p<span class="sc">-</span>value</span>
<span id="cb11-58"><a href="#cb11-58" tabindex="-1"></a>I<span class="sc">-</span>splines1 <span class="sc">-</span><span class="fl">2.03816</span> <span class="fl">0.13469</span> <span class="sc">-</span><span class="fl">15.132</span> <span class="fl">0.00000</span></span>
<span id="cb11-59"><a href="#cb11-59" tabindex="-1"></a>I<span class="sc">-</span>splines2  <span class="fl">1.04627</span> <span class="fl">0.02461</span>  <span class="fl">42.510</span> <span class="fl">0.00000</span></span>
<span id="cb11-60"><a href="#cb11-60" tabindex="-1"></a>I<span class="sc">-</span>splines3  <span class="fl">0.74190</span> <span class="fl">0.03773</span>  <span class="fl">19.665</span> <span class="fl">0.00000</span></span>
<span id="cb11-61"><a href="#cb11-61" tabindex="-1"></a>I<span class="sc">-</span>splines4  <span class="fl">0.98399</span> <span class="fl">0.03237</span>  <span class="fl">30.400</span> <span class="fl">0.00000</span></span>
<span id="cb11-62"><a href="#cb11-62" tabindex="-1"></a>I<span class="sc">-</span>splines5  <span class="fl">1.55606</span> <span class="fl">0.04480</span>  <span class="fl">34.735</span> <span class="fl">0.00000</span></span>
<span id="cb11-63"><a href="#cb11-63" tabindex="-1"></a>I<span class="sc">-</span>splines6  <span class="fl">0.93273</span> <span class="fl">0.16614</span>   <span class="fl">5.614</span> <span class="fl">0.00000</span></span>
<span id="cb11-64"><a href="#cb11-64" tabindex="-1"></a>I<span class="sc">-</span>splines7  <span class="fl">1.38790</span> <span class="fl">0.17687</span>   <span class="fl">7.847</span> <span class="fl">0.00000</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="graph-of-predicted-trajectories-according-to-a-profile-of-covariates">Graph of predicted trajectories according to a profile of
covariates<a class="anchor" aria-label="anchor" href="#graph-of-predicted-trajectories-according-to-a-profile-of-covariates"></a>
</h4>
<p>The predicted trajectories can be computed in the natural scale of
the dependent variable and according to a profile of covariates:</p>
<p> </p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datnew</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">65</span>,<span class="fl">95</span>,length<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">age65</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">datnew</span><span class="op">$</span><span class="va">age</span> <span class="op">-</span> <span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">male</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">women</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">mspl5q</span>, newdata<span class="op">=</span><span class="va">datnew</span>, var.time<span class="op">=</span><span class="st">"age"</span>, draws<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">datnew</span><span class="op">$</span><span class="va">male</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">men</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictY.html">predictY</a></span><span class="op">(</span><span class="va">mspl5q</span>, newdata<span class="op">=</span><span class="va">datnew</span>, var.time<span class="op">=</span><span class="st">"age"</span>, draws<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p> </p>
<p>And then plotted:</p>
<p> </p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">women</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="fl">6</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">20</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"age in year"</span>,ylab<span class="op">=</span><span class="st">"CES-D"</span>,bty<span class="op">=</span><span class="st">"l"</span>, legend<span class="op">=</span><span class="cn">NULL</span>, shades <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">men</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="fl">4</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, shades<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"topleft"</span>, bty<span class="op">=</span><span class="st">"n"</span>, ncol<span class="op">=</span><span class="fl">2</span>, lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">4</span><span class="op">)</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"women"</span>,<span class="st">"men"</span>, <span class="st">"95% CI"</span>, <span class="st">"95% CI"</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><img src="latent_process_model_with_lcmm_files/figure-html/unnamed-chunk-9-1.png" width="576"></p>
<p> </p>
</div>
<div class="section level4">
<h4 id="goodness-of-fit-1-plot-of-residuals">Goodness of fit 1: plot of residuals<a class="anchor" aria-label="anchor" href="#goodness-of-fit-1-plot-of-residuals"></a>
</h4>
<p>The subject-specific residuals (qqplot in bottom right panel) should
be Gaussian.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mspl5q</span>, cex.main<span class="op">=</span><span class="fl">0.9</span><span class="op">)</span></span></code></pre></div>
<p> </p>
</div>
</div>
<div class="section level3">
<h3 id="goodness-of-fit-2-plot-of-predictions-versus-observations">Goodness of fit 2: plot of predictions versus observations<a class="anchor" aria-label="anchor" href="#goodness-of-fit-2-plot-of-predictions-versus-observations"></a>
</h3>
<p>The mean predictions and observations can be plotted according to
time. Note that the predictions and observations are in the scale of the
latent process (observations are transformed with the estimated link
function):</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mspl5q</span>, which<span class="op">=</span><span class="st">"fit"</span>, var.time<span class="op">=</span><span class="st">"age65"</span>, bty<span class="op">=</span><span class="st">"l"</span>, xlab<span class="op">=</span><span class="st">"(age-65)/10"</span>, break.times<span class="op">=</span><span class="fl">8</span>, ylab<span class="op">=</span><span class="st">"latent process"</span>, lwd<span class="op">=</span><span class="fl">2</span>, marg<span class="op">=</span><span class="cn">FALSE</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, shades<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent_process_model_with_lcmm_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
<p> </p>
</div>
</div>
<div class="section level2">
<h2 id="to-go-further">To go further …<a class="anchor" aria-label="anchor" href="#to-go-further"></a>
</h2>
<div class="section level3">
<h3 id="heterogeneous-profiles-of-trajectories">heterogeneous profiles of trajectories<a class="anchor" aria-label="anchor" href="#heterogeneous-profiles-of-trajectories"></a>
</h3>
<p>The latent process mixed model extends to the heterogeneous case with
latent classes. The same strategy as explained with hlme (see <a href="latent_class_model_with_hlme.html">vignette</a> ) can be used.</p>
</div>
<div class="section level3">
<h3 id="joint-analysis-of-a-time-to-event">joint analysis of a time to event<a class="anchor" aria-label="anchor" href="#joint-analysis-of-a-time-to-event"></a>
</h3>
<p>The latent process mixed model extends to the case of a joint model.
This is done in Jointlcmm and mpjlcmm. See the <a href="joint_latent_class_model_with_Jointlcmm.html">Jointlcmm
vignette</a>.</p>
</div>
<div class="section level3">
<h3 id="multiple-markers-of-the-same-latent-process">multiple markers of the same latent process<a class="anchor" aria-label="anchor" href="#multiple-markers-of-the-same-latent-process"></a>
</h3>
<p>In some cases, several markers of the same underlying latent process
may be measured. The latent process mixed model extends to that case.
This is the purpose of multlcmm (see the vignette for <a href="latent_process_model_with_multlcmm.html">continuous</a> and <a href="latent_process_model_with_multlcmm_IRT.html">ordinal</a>
outcomes.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cecile Proust-Lima, Viviane Philipps.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
