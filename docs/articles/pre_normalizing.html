<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="lcmm">
<title>Pre-normalizing a dependent variable using lcmm • lcmm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Pre-normalizing a dependent variable using lcmm">
<meta property="og:description" content="lcmm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">lcmm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/lcmm.html">GET STARTED</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">VIGNETTES</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/latent_class_model_with_hlme.html">How to estimate a latent class mixed model using hlme function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_lcmm.html">How to estimate a latent process mixed model using lcmm function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm.html">How to estimate a latent process mixed model for multivariate markers using multlcmm function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm_IRT.html">Continuous-time longitudinal IRT model</a>
    <a class="dropdown-item" href="../articles/joint_latent_class_model_with_Jointlcmm.html">How to estimate a joint latent class mixed model using Jointlcmm function</a>
    <a class="dropdown-item" href="../articles/multivariate_latent_class_model_with_mpjlcmm.html">How to estimate a multivariate latent class mixed model using mpjlcmm function</a>
    <a class="dropdown-item" href="../articles/pre_normalizing.html">Pre-normalizing a dependent variable using lcmm</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/usual_problems.html">FAQ</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">REFERENCE</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">CHANGELOG</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/CecileProust-Lima/lcmm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">

<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Pre-normalizing a dependent variable using lcmm</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CecileProust-Lima/lcmm/blob/HEAD/vignettes/pre_normalizing.Rmd" class="external-link"><code>vignettes/pre_normalizing.Rmd</code></a></small>
      <div class="d-none name"><code>pre_normalizing.Rmd</code></div>
    </div>

    
    
<p> </p>
<p>Functions lcmm, multlcmm, Jointlcmm and mpjlcmm handle dependent variables that are not necessarily Gaussian. These functions rely on the simultaneous normalization of the variable and estimation of the regression parameters using parameterized link functions (argument “link=”).</p>
<p>However in some cases, one may want to pre-normalize once for all a dependent variable so that standard methods for Gaussian outcomes can then be used without caution.</p>
<p>The methodology has been fully described and validated for MMSE in Philipps et al. (2014) (see <a href="https://doi.org/10.1159/000365637" class="external-link uri">https://doi.org/10.1159/000365637</a> )</p>
<p>We describe here how this can be done using CES-D example.</p>
<div class="section level2">
<h2 id="ces-d-example">CES-D example<a class="anchor" aria-label="anchor" href="#ces-d-example"></a>
</h2>
<p>CES-D is the scale of depressive symptomatology in the Paquid dataset made of 20 items. Its sumscore is extremely skewed with a large proportion of small values:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">summary</span>(paquid<span class="op">$</span>CESD)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA<span class="st">'s </span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="st">  0.000   2.000   6.000   8.488  12.000  52.000     146 </span></a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">CESD</span>, breaks<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<p><img src="pre_normalizing_files/figure-html/unnamed-chunk-2-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="normalizing-a-variable-with-lcmm">Normalizing a variable with lcmm<a class="anchor" aria-label="anchor" href="#normalizing-a-variable-with-lcmm"></a>
</h2>
<p>The first step is to normalize the variable by estimating a latent process mixed model. This model should roughly fit the data but does not need to be the perfect model or the exact same model as planned for the future complete analysis. One possibility is to define an “empty model” for the covariates (but not the time functions and random effects) :</p>
<p> </p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#We recenter and scale the time variable "age" in order to avoid numerical problems</span></span>
<span><span class="va">paquid</span><span class="op">$</span><span class="va">age65</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mpreH</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">CESD</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, random <span class="op">=</span> <span class="op">~</span> <span class="va">age65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, subject <span class="op">=</span> <span class="st">'ID'</span>, data<span class="op">=</span><span class="va">paquid</span>, link <span class="op">=</span> <span class="st">'5-quant-splines'</span><span class="op">)</span> </span></code></pre></div>
<p> </p>
<p>Here a splines link function with 5 knots placed at the quantiles is used.</p>
<p>The variable “obs” of output table “mpreH$pred” includes the normalized values of CES-D for all the observations of the dataset:</p>
<p> </p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">head</span>(mpreH<span class="op">$</span>pred)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">  ID     pred_m   resid_m   pred_ss   resid_ss      obs    pred_m1  pred_ss1</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="dv">1</span>  <span class="dv">1</span> <span class="fl">0.11087827</span> <span class="fl">1.3084181</span> <span class="fl">0.9342107</span>  <span class="fl">0.4850857</span> <span class="fl">1.419296</span> <span class="fl">0.11087827</span> <span class="fl">0.9342107</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="dv">2</span>  <span class="dv">2</span> <span class="fl">0.06084672</span> <span class="fl">1.2129369</span> <span class="fl">1.4361554</span> <span class="fl">-0.1623718</span> <span class="fl">1.273784</span> <span class="fl">0.06084672</span> <span class="fl">1.4361554</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="dv">3</span>  <span class="dv">2</span> <span class="fl">0.13130656</span> <span class="fl">1.8192134</span> <span class="fl">1.5798638</span>  <span class="fl">0.3706562</span> <span class="fl">1.950520</span> <span class="fl">0.13130656</span> <span class="fl">1.5798638</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="dv">4</span>  <span class="dv">2</span> <span class="fl">0.31339488</span> <span class="fl">1.9993097</span> <span class="fl">1.8557179</span>  <span class="fl">0.4569867</span> <span class="fl">2.312705</span> <span class="fl">0.31339488</span> <span class="fl">1.8557179</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="dv">5</span>  <span class="dv">2</span> <span class="fl">0.82900611</span> <span class="fl">1.9299118</span> <span class="fl">2.2349532</span>  <span class="fl">0.5239648</span> <span class="fl">2.758918</span> <span class="fl">0.82900611</span> <span class="fl">2.2349532</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="dv">7</span>  <span class="dv">3</span> <span class="fl">0.26327499</span> <span class="fl">0.8557632</span> <span class="fl">0.5912826</span>  <span class="fl">0.5277556</span> <span class="fl">1.119038</span> <span class="fl">0.26327499</span> <span class="fl">0.5912826</span></a></code></pre></div>
<p> </p>
<p>The normalized variable (to be called for instance “normCESD”) can now be added to the dataset</p>
<p> </p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paquid</span><span class="op">$</span><span class="va">normCESD</span> <span class="op">&lt;-</span> <span class="cn">NULL</span> </span>
<span><span class="va">paquid</span><span class="op">$</span><span class="va">normCESD</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">CESD</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">mpreH</span><span class="op">$</span><span class="va">pred</span><span class="op">$</span><span class="va">obs</span></span></code></pre></div>
<p>for further analysis.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">summary</span>(paquid[,<span class="kw">c</span>(<span class="st">"CESD"</span>,<span class="st">"normCESD"</span>)])</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">      CESD           normCESD      </a>
<a class="sourceLine" id="cb7-3" data-line-number="3"> Min.   <span class="op">:</span><span class="st"> </span><span class="fl">0.000</span>   Min.   <span class="op">:-</span><span class="fl">1.8700</span>  </a>
<a class="sourceLine" id="cb7-4" data-line-number="4"> 1st Qu.<span class="op">:</span><span class="st"> </span><span class="fl">2.000</span>   1st Qu.<span class="op">:-</span><span class="fl">0.3916</span>  </a>
<a class="sourceLine" id="cb7-5" data-line-number="5"> Median <span class="op">:</span><span class="st"> </span><span class="fl">6.000</span>   Median <span class="op">:</span><span class="st"> </span><span class="fl">0.5733</span>  </a>
<a class="sourceLine" id="cb7-6" data-line-number="6"> Mean   <span class="op">:</span><span class="st"> </span><span class="fl">8.488</span>   Mean   <span class="op">:</span><span class="st"> </span><span class="fl">0.6016</span>  </a>
<a class="sourceLine" id="cb7-7" data-line-number="7"> 3rd Qu.<span class="op">:</span><span class="fl">12.000</span>   3rd Qu.<span class="op">:</span><span class="st"> </span><span class="fl">1.5582</span>  </a>
<a class="sourceLine" id="cb7-8" data-line-number="8"> Max.   <span class="op">:</span><span class="fl">52.000</span>   Max.   <span class="op">:</span><span class="st"> </span><span class="fl">6.1425</span>  </a>
<a class="sourceLine" id="cb7-9" data-line-number="9"> NA<span class="st">'s   :146      NA'</span>s   <span class="op">:</span><span class="dv">146</span>      </a></code></pre></div>
</div>
<div class="section level2">
<h2 id="comparison-before-and-after-normalization">Comparison before and after normalization<a class="anchor" aria-label="anchor" href="#comparison-before-and-after-normalization"></a>
</h2>
<p>The transformation does not change the structure of the data. In particular, the spike at 0 is still present.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">CESD</span>, breaks<span class="op">=</span><span class="fl">50</span>, cex.main<span class="op">=</span><span class="fl">0.9</span>, main<span class="op">=</span><span class="st">"Distribution of CESD"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">normCESD</span>, breaks<span class="op">=</span><span class="fl">50</span>, cex.main<span class="op">=</span><span class="fl">0.9</span>, main<span class="op">=</span><span class="st">"Distribution of normCESD"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="pre_normalizing_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p> </p>
<p>From the histogram, this is not clear that the normalized CESD has a Gaussian distribution. Yet, this normalization makes the use of methods for Gaussian outcomes correct.</p>
<p>For instance, when fitting a linear mixed model including the variable male, the subject-specific residuals plots become correct (right part):</p>
<p> </p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normCESD</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hlme.html">hlme</a></span><span class="op">(</span><span class="va">normCESD</span> <span class="op">~</span> <span class="va">age65</span><span class="op">*</span><span class="va">male</span>, random <span class="op">=</span> <span class="op">~</span> <span class="va">age65</span>, subject <span class="op">=</span> <span class="st">'ID'</span>, data<span class="op">=</span><span class="va">paquid</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">normCESD</span>, cex.main<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p>In comparison, without the normalization step, the subject-specific residuals exhibited a departure from normality.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CESD</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hlme.html">hlme</a></span><span class="op">(</span><span class="va">CESD</span> <span class="op">~</span> <span class="va">age65</span><span class="op">*</span><span class="va">male</span>, random <span class="op">=</span> <span class="op">~</span> <span class="va">age65</span>, subject <span class="op">=</span> <span class="st">'ID'</span>, data<span class="op">=</span><span class="va">paquid</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">CESD</span>, cex.main<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="to-go-further">To go further<a class="anchor" aria-label="anchor" href="#to-go-further"></a>
</h2>
<p>For future use, it can be interesting to define the metric of normCESD. Indeed, for now, its scale in not easy to understand as it depends on the data structure. Two options are possible:</p>
<div class="section level3">
<h3 id="standardizing-normcesd">1. Standardizing normCESD<a class="anchor" aria-label="anchor" href="#standardizing-normcesd"></a>
</h3>
<p>The variable can be standardized (like for a Z-score) by removing the mean at a time and dividing by the standard deviation at the same time. This can be done if many data are observed at the same time, like at baseline. Here, with age as the time scale, we could not use that easily.</p>
<p>Unfortunately, baseline data is not available in the dataset! So here is a theoretical example of the computation:</p>
<p> </p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">normCESD</span><span class="op">[</span><span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">visit</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">normCESD</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">normCESD</span><span class="op">[</span><span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">visit</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">normCESD</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">paquid</span><span class="op">$</span><span class="va">ZnormCESD</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">normCESD</span> <span class="op">-</span> <span class="va">m</span><span class="op">)</span><span class="op">/</span><span class="va">s</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="rescaling-normcesd-into-0---100">2. Rescaling normCESD into 0 - 100<a class="anchor" aria-label="anchor" href="#rescaling-normcesd-into-0---100"></a>
</h3>
<p>The variable can be scaled in 0-100 with 0 corresponding to the minimum value observed in the sample (usually 0) and 100 the maximum observed value. This works whatever the timescale under study:</p>
<p> </p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">min &lt;-<span class="st"> </span><span class="kw">min</span>(paquid<span class="op">$</span>normCESD[<span class="op">!</span><span class="kw">is.na</span>(paquid<span class="op">$</span>normCESD)])</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">max &lt;-<span class="st"> </span><span class="kw">max</span>(paquid<span class="op">$</span>normCESD[<span class="op">!</span><span class="kw">is.na</span>(paquid<span class="op">$</span>normCESD)])</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">paquid<span class="op">$</span>normCESD100 &lt;-<span class="st"> </span>(paquid<span class="op">$</span>normCESD <span class="op">-</span><span class="st"> </span>min)<span class="op">/</span>(max<span class="op">-</span>min)<span class="op">*</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="kw">summary</span>(paquid<span class="op">$</span>normCESD100)</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA<span class="st">'s </span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="st">   0.00   18.45   30.49   30.85   42.79  100.00     146 </span></a></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-of-model-with-normcesd100">Example of model with normCESD100<a class="anchor" aria-label="anchor" href="#example-of-model-with-normcesd100"></a>
</h3>
<p>The statistical analysis can now be performed using one of the normalized variables, normCESD, ZnormCESD or normCESD100.</p>
<p>With normCESD100 for example, a linear mixed model with a linear trajectory according to age with adjustment for male, education and their interaction with time as well as the birth cohort effect (age at entry) can be fitted:</p>
<p> </p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hlme.html">hlme</a></span><span class="op">(</span><span class="va">normCESD100</span> <span class="op">~</span> <span class="va">age65</span><span class="op">*</span><span class="va">male</span> <span class="op">+</span> <span class="va">CEP</span><span class="op">*</span><span class="va">age65</span> <span class="op">+</span> <span class="va">age_init</span>, random<span class="op">=</span><span class="op">~</span><span class="va">age65</span>, subject<span class="op">=</span><span class="st">'ID'</span>,data<span class="op">=</span><span class="va">paquid</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span></code></pre></div>
<p> </p>
<p>Or a linear mixed model with a linear trajectory according to time since entry with adjustment for male, education and their interaction with time as well as the birth cohort effect (age at entry):</p>
<p> </p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paquid</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="va">paquid</span><span class="op">$</span><span class="va">age</span> <span class="op">-</span> <span class="va">paquid</span><span class="op">$</span><span class="va">age_init</span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hlme.html">hlme</a></span><span class="op">(</span><span class="va">normCESD100</span> <span class="op">~</span> <span class="va">time</span><span class="op">*</span><span class="va">male</span> <span class="op">+</span> <span class="va">CEP</span><span class="op">*</span><span class="va">time</span> <span class="op">+</span> <span class="va">age_init</span>, random<span class="op">=</span><span class="op">~</span><span class="va">time</span>, subject<span class="op">=</span><span class="st">'ID'</span>, data<span class="op">=</span><span class="va">paquid</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span></span></code></pre></div>
<p>Or any other statistical method assuming normality for the outcome!</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Cecile Proust-Lima, Viviane Philipps.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
