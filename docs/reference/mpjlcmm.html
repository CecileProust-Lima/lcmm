<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function fits joint latent class models for multivariate longitudinal markers
and competing causes of event. It is a multivariate
extension of the Jointlcmm function. It defines each longitudinal dimension as a 
latent process (mp in mpjlcmm is for multivariate processes), possibly
measured by sereval continuous markers (Gaussian or curvilinear). For the moment, 
theses processes are assumed independent given the latent classes. 
The (optional) survival part handles competing risks, right censoring and left truncation.
The specification of the function is similar to other estimating functions of the package."><title>Estimation of multivariate joint latent class mixed models — mpjlcmm • lcmm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimation of multivariate joint latent class mixed models — mpjlcmm"><meta property="og:description" content="This function fits joint latent class models for multivariate longitudinal markers
and competing causes of event. It is a multivariate
extension of the Jointlcmm function. It defines each longitudinal dimension as a 
latent process (mp in mpjlcmm is for multivariate processes), possibly
measured by sereval continuous markers (Gaussian or curvilinear). For the moment, 
theses processes are assumed independent given the latent classes. 
The (optional) survival part handles competing risks, right censoring and left truncation.
The specification of the function is similar to other estimating functions of the package."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">lcmm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/lcmm.html">GET STARTED</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">VIGNETTES</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/latent_class_model_with_hlme.html">How to estimate a latent class mixed model using hlme function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_lcmm.html">How to estimate a latent process mixed model using lcmm function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm.html">How to estimate a latent process mixed model for multivariate markers using multlcmm function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm_IRT.html">Continuous-time longitudinal IRT model</a>
    <a class="dropdown-item" href="../articles/joint_latent_class_model_with_Jointlcmm.html">How to estimate a joint latent class mixed model using Jointlcmm function</a>
    <a class="dropdown-item" href="../articles/multivariate_latent_class_model_with_mpjlcmm.html">How to estimate a multivariate latent class mixed model using mpjlcmm function</a>
    <a class="dropdown-item" href="../articles/secondary_model_with_externVar.html">Accounting for latent class assignment uncertainty in subsequent analyses</a>
    <a class="dropdown-item" href="../articles/pre_normalizing.html">Pre-normalizing a dependent variable using lcmm</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/usual_problems.html">FAQ</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">REFERENCE</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">CHANGELOG</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/CecileProust-Lima/lcmm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Estimation of multivariate joint latent class mixed models</h1>
      <small class="dont-index">Source: <a href="https://github.com/CecileProust-Lima/lcmm/blob/HEAD/R/mpjlcmm.R" class="external-link"><code>R/mpjlcmm.R</code></a></small>
      <div class="d-none name"><code>mpjlcmm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function fits joint latent class models for multivariate longitudinal markers
and competing causes of event. It is a multivariate
extension of the Jointlcmm function. It defines each longitudinal dimension as a 
latent process (mp in mpjlcmm is for multivariate processes), possibly
measured by sereval continuous markers (Gaussian or curvilinear). For the moment, 
theses processes are assumed independent given the latent classes. 
The (optional) survival part handles competing risks, right censoring and left truncation.
The specification of the function is similar to other estimating functions of the package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mpjlcmm</span><span class="op">(</span></span>
<span>  <span class="va">longitudinal</span>,</span>
<span>  <span class="va">subject</span>,</span>
<span>  <span class="va">classmb</span>,</span>
<span>  <span class="va">ng</span>,</span>
<span>  <span class="va">survival</span>,</span>
<span>  hazard <span class="op">=</span> <span class="st">"Weibull"</span>,</span>
<span>  hazardtype <span class="op">=</span> <span class="st">"Specific"</span>,</span>
<span>  hazardnodes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  TimeDepVar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">B</span>,</span>
<span>  convB <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  convL <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  convG <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  maxiter <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  <span class="va">prior</span>,</span>
<span>  logscale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.action <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  posfix <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  partialH <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nproc <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  clustertype <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>longitudinal</dt>
<dd><p>list of longitudinal models of type hlme, lcmm or multlcmm. Each
model defines the structure of one latent process.</p></dd>


<dt>subject</dt>
<dd><p>name of the covariate representing the grouping structure
(called subject identifier)</p></dd>


<dt>classmb</dt>
<dd><p>optional one-sided formula describing the covariates in the
class-membership multinomial logistic model</p></dd>


<dt>ng</dt>
<dd><p>number of latent classes considered</p></dd>


<dt>survival</dt>
<dd><p>two-sided formula object specifying the survival part of the model</p></dd>


<dt>hazard</dt>
<dd><p>optional family of hazard function assumed for the survival model
(Weibull, piecewise or splines)</p></dd>


<dt>hazardtype</dt>
<dd><p>optional indicator for the type of baseline risk function
(Specific, PH or Common)</p></dd>


<dt>hazardnodes</dt>
<dd><p>optional vector containing interior nodes if
<code>splines</code> or <code>piecewise</code> is specified for the baseline hazard
function in <code>hazard</code></p></dd>


<dt>TimeDepVar</dt>
<dd><p>optional vector specifying the name of the time-depending
covariate in the survival model</p></dd>


<dt>data</dt>
<dd><p>data frame containing all the variables used in the model</p></dd>


<dt>B</dt>
<dd><p>optional specification for the initial values of the parameters.
Three options are allowed: (1) a vector of initial values is entered (the
order in which the parameters are included is detailed in <code>details</code>
section).  (2) nothing is specified. Initial values are extracted from the models
specified in <code>longitudinal</code>, and default initial values are chosen for the
survival part (3) when ng&gt;1, a mpjlcmm object is entered. It should correspond to
the exact same structure of model but with ng=1. The program will
automatically generate initial values from this model. Note that due to possible
local maxima, the <code>B</code> vector should be specified and several different
starting points should be tried. This can be done automatically using 
gridsearch function.</p></dd>


<dt>convB</dt>
<dd><p>optional threshold for the convergence criterion based on the
parameter stability</p></dd>


<dt>convL</dt>
<dd><p>optional threshold for the convergence criterion based on the
log-likelihood stability</p></dd>


<dt>convG</dt>
<dd><p>optional threshold for the convergence criterion based on the
derivatives</p></dd>


<dt>maxiter</dt>
<dd><p>optional maximum number of iterations for the Marquardt
iterative algorithm</p></dd>


<dt>nsim</dt>
<dd><p>optional number of points for the predicted survival curves and
predicted baseline risk curves</p></dd>


<dt>prior</dt>
<dd><p>optional name of a covariate containing a prior information
about the latent class membership</p></dd>


<dt>logscale</dt>
<dd><p>optional boolean indicating whether an exponential
(logscale=TRUE) or a square (logscale=FALSE -by default) transformation is
used to ensure positivity of parameters in the baseline risk functions</p></dd>


<dt>subset</dt>
<dd><p>a specification of the rows to be used: defaults to all rows.
This can be any valid indexing vector for the rows of data or if that is not
supplied, a data frame made up of the variable used in formula.</p></dd>


<dt>na.action</dt>
<dd><p>Integer indicating how NAs are managed. The default is 1
for 'na.omit'. The alternative is 2 for 'na.fail'. Other options such as
'na.pass' or 'na.exclude' are not implemented in the current version.</p></dd>


<dt>posfix</dt>
<dd><p>Optional vector specifying the indices in vector B of the
parameters that should not be estimated. Default to NULL, all parameters are
estimated</p></dd>


<dt>partialH</dt>
<dd><p>optional logical for Piecewise and Splines baseline risk
functions and Splines link functions only. Indicates whether the parameters of the
baseline risk or link functions can be dropped from the Hessian matrix to define
convergence criteria (can solve non convergence due to estimates at the boundary 
of the parameter space - usually 0).</p></dd>


<dt>verbose</dt>
<dd><p>logical indicating whether information about computation should be
reported. Default to FALSE.</p></dd>


<dt>nproc</dt>
<dd><p>the number cores for parallel computation.
Default to 1 (sequential mode).</p></dd>


<dt>clustertype</dt>
<dd><p>optional character indicating the type of cluster for parallel computation.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Cecile Proust Lima and Viviane Philipps</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">paquid</span><span class="op">$</span><span class="va">age65</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">paquid</span><span class="op">$</span><span class="va">age</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##############################################################################</span></span></span>
<span class="r-in"><span><span class="co">###                          EXAMPLE 1 :                                   ###</span></span></span>
<span class="r-in"><span><span class="co">###two outcomes measuring the same latent process along with dementia onset###</span></span></span>
<span class="r-in"><span><span class="co">##############################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## multlcmm model for MMSE and BVRT for 1 class</span></span></span>
<span class="r-in"><span><span class="va">mult1</span> <span class="op">&lt;-</span> <span class="fu"><a href="multlcmm.html">multlcmm</a></span><span class="op">(</span><span class="va">MMSE</span><span class="op">+</span><span class="va">BVRT</span><span class="op">~</span><span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">CEP</span><span class="op">+</span><span class="va">male</span>,random<span class="op">=</span><span class="op">~</span><span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>subject<span class="op">=</span><span class="st">"ID"</span>,link<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"5-quant-splines"</span>,<span class="st">"4-quant-splines"</span><span class="op">)</span>,data<span class="op">=</span><span class="va">paquid</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mult1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## joint model for 1 class</span></span></span>
<span class="r-in"><span><span class="va">m1S</span> <span class="op">&lt;-</span> <span class="fu">mpjlcmm</span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mult1</span><span class="op">)</span>,subject<span class="op">=</span><span class="st">"ID"</span>,ng<span class="op">=</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">paquid</span>,</span></span>
<span class="r-in"><span>survival<span class="op">=</span><span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>,<span class="va">agedem</span>,<span class="va">dem</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1S</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##### joint model for 2 classes #####</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## specify longitudinal model for 2 classes, without estimation</span></span></span>
<span class="r-in"><span><span class="va">mult2</span> <span class="op">&lt;-</span> <span class="fu"><a href="multlcmm.html">multlcmm</a></span><span class="op">(</span><span class="va">MMSE</span><span class="op">+</span><span class="va">BVRT</span><span class="op">~</span><span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">CEP</span><span class="op">+</span><span class="va">male</span>,random<span class="op">=</span><span class="op">~</span><span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>subject<span class="op">=</span><span class="st">"ID"</span>,link<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"5-quant-splines"</span>,<span class="st">"4-quant-splines"</span><span class="op">)</span>,ng<span class="op">=</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>mixture<span class="op">=</span><span class="op">~</span><span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,data<span class="op">=</span><span class="va">paquid</span>,B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">mult1</span><span class="op">)</span>,maxiter<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## estimation of the associated joint model </span></span></span>
<span class="r-in"><span><span class="va">m2S</span> <span class="op">&lt;-</span> <span class="fu">mpjlcmm</span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mult2</span><span class="op">)</span>,subject<span class="op">=</span><span class="st">"ID"</span>,ng<span class="op">=</span><span class="fl">2</span>,data<span class="op">=</span><span class="va">paquid</span>,</span></span>
<span class="r-in"><span>survival<span class="op">=</span><span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>,<span class="va">agedem</span>,<span class="va">dem</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## estimation by a grid search with 50 replicates, initial values</span></span></span>
<span class="r-in"><span><span class="co">## randomly generated from m1S</span></span></span>
<span class="r-in"><span><span class="va">m2S_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="gridsearch.html">gridsearch</a></span><span class="op">(</span><span class="fu">mpjlcmm</span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mult2</span><span class="op">)</span>,subject<span class="op">=</span><span class="st">"ID"</span>,ng<span class="op">=</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>data<span class="op">=</span><span class="va">paquid</span>,survival<span class="op">=</span><span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>,<span class="va">agedem</span>,<span class="va">dem</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span><span class="op">)</span>, minit<span class="op">=</span><span class="va">m1S</span>, rep<span class="op">=</span><span class="fl">50</span>, maxiter<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##### joint model for 3 classes #####</span></span></span>
<span class="r-in"><span><span class="va">mult3</span> <span class="op">&lt;-</span> <span class="fu"><a href="multlcmm.html">multlcmm</a></span><span class="op">(</span><span class="va">MMSE</span><span class="op">+</span><span class="va">BVRT</span><span class="op">~</span><span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">CEP</span><span class="op">+</span><span class="va">male</span>,random<span class="op">=</span><span class="op">~</span><span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>subject<span class="op">=</span><span class="st">"ID"</span>,link<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"5-quant-splines"</span>,<span class="st">"4-quant-splines"</span><span class="op">)</span>,ng<span class="op">=</span><span class="fl">3</span>,</span></span>
<span class="r-in"><span>mixture<span class="op">=</span><span class="op">~</span><span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,data<span class="op">=</span><span class="va">paquid</span>,B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">mult1</span><span class="op">)</span>,maxiter<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m3S</span> <span class="op">&lt;-</span> <span class="fu">mpjlcmm</span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mult3</span><span class="op">)</span>,subject<span class="op">=</span><span class="st">"ID"</span>,ng<span class="op">=</span><span class="fl">3</span>,data<span class="op">=</span><span class="va">paquid</span>,</span></span>
<span class="r-in"><span>survival<span class="op">=</span><span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>,<span class="va">agedem</span>,<span class="va">dem</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m3S_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="gridsearch.html">gridsearch</a></span><span class="op">(</span><span class="fu">mpjlcmm</span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mult3</span><span class="op">)</span>,subject<span class="op">=</span><span class="st">"ID"</span>,ng<span class="op">=</span><span class="fl">3</span>,</span></span>
<span class="r-in"><span>data<span class="op">=</span><span class="va">paquid</span>,survival<span class="op">=</span><span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>,<span class="va">agedem</span>,<span class="va">dem</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span><span class="op">)</span>, minit<span class="op">=</span><span class="va">m1S</span>, rep<span class="op">=</span><span class="fl">50</span>, maxiter<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##### summary of the models #####</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="summarytable.html">summarytable</a></span><span class="op">(</span><span class="va">m1S</span>,<span class="va">m2S</span>,<span class="va">m2S_b</span>,<span class="va">m3S</span>,<span class="va">m3S_b</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##### post-fit #####</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## update longitudinal models :</span></span></span>
<span class="r-in"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">m2S</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mult2_post</span> <span class="op">&lt;-</span> <span class="va">mod2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="co">## -&gt; use the available functions for multlcmm on the mult2_post object</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## fit of the longitudinal trajectories</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">mult2_post</span>,<span class="st">"fit"</span>,<span class="st">"age65"</span>,marg<span class="op">=</span><span class="cn">TRUE</span>,shades<span class="op">=</span><span class="cn">TRUE</span>,outcome<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">mult2_post</span>,<span class="st">"fit"</span>,<span class="st">"age65"</span>,marg<span class="op">=</span><span class="cn">TRUE</span>,shades<span class="op">=</span><span class="cn">TRUE</span>,outcome<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">mult2_post</span>,<span class="st">"fit"</span>,<span class="st">"age65"</span>,marg<span class="op">=</span><span class="cn">FALSE</span>,shades<span class="op">=</span><span class="cn">TRUE</span>,outcome<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">mult2_post</span>,<span class="st">"fit"</span>,<span class="st">"age65"</span>,marg<span class="op">=</span><span class="cn">FALSE</span>,shades<span class="op">=</span><span class="cn">TRUE</span>,outcome<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## predicted trajectories</span></span></span>
<span class="r-in"><span><span class="va">dpred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age65<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">3</span>,<span class="fl">0.1</span><span class="op">)</span>,male<span class="op">=</span><span class="fl">0</span>,CEP<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">predL</span> <span class="op">&lt;-</span> <span class="fu"><a href="predictL.html">predictL</a></span><span class="op">(</span><span class="va">mult2_post</span>,newdata<span class="op">=</span><span class="va">dpred</span>,var.time<span class="op">=</span><span class="st">"age65"</span>,confint<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">predL</span>,shades<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="co"># in the latent process scale</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">predY</span> <span class="op">&lt;-</span> <span class="fu"><a href="predictY.html">predictY</a></span><span class="op">(</span><span class="va">mult2_post</span>,newdata<span class="op">=</span><span class="va">dpred</span>,var.time<span class="op">=</span><span class="st">"age65"</span>,draws<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">predY</span>,shades<span class="op">=</span><span class="cn">TRUE</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>,main<span class="op">=</span><span class="st">"MMSE"</span><span class="op">)</span> <span class="co">#in the 0-30 scale for MMSE</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">predY</span>,shades<span class="op">=</span><span class="cn">TRUE</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">15</span><span class="op">)</span>,outcome<span class="op">=</span><span class="fl">2</span>,main<span class="op">=</span><span class="st">"BVRT"</span><span class="op">)</span> <span class="co">#in 0-15 for BVRT</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## baseline hazard and survival curves :</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">m2S</span>,<span class="st">"hazard"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">m2S</span>,<span class="st">"survival"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## posteriori probabilities and classification :</span></span></span>
<span class="r-in"><span><span class="fu"><a href="postprob.html">postprob</a></span><span class="op">(</span><span class="va">m2S</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####################################################################################</span></span></span>
<span class="r-in"><span><span class="co">###                              EXAMPLE 2 :                                     ###</span></span></span>
<span class="r-in"><span><span class="co">### two latent processes measured each by one outcome along with dementia onset  ###</span></span></span>
<span class="r-in"><span><span class="co">####################################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## define the two longitudinal models</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mMMSE1</span> <span class="op">&lt;-</span> <span class="fu"><a href="lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">MMSE</span><span class="op">~</span><span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">CEP</span>,random<span class="op">=</span><span class="op">~</span><span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,subject<span class="op">=</span><span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>link<span class="op">=</span><span class="st">"5-quant-splines"</span>,data<span class="op">=</span><span class="va">paquid</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mCESD1</span> <span class="op">&lt;-</span> <span class="fu"><a href="lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">CESD</span><span class="op">~</span><span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">male</span>,random<span class="op">=</span><span class="op">~</span><span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,subject<span class="op">=</span><span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>link<span class="op">=</span><span class="st">"5-quant-splines"</span>,data<span class="op">=</span><span class="va">paquid</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## joint estimation</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mm1S</span> <span class="op">&lt;-</span> <span class="fu">mpjlcmm</span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE1</span>,<span class="va">mCESD1</span><span class="op">)</span>,subject<span class="op">=</span><span class="st">"ID"</span>,ng<span class="op">=</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">paquid</span>,</span></span>
<span class="r-in"><span>survival<span class="op">=</span><span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>,<span class="va">agedem</span>,<span class="va">dem</span><span class="op">)</span><span class="op">~</span><span class="va">CEP</span><span class="op">+</span><span class="va">male</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## with 2 latent classes</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mMMSE2</span> <span class="op">&lt;-</span> <span class="fu"><a href="lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">MMSE</span><span class="op">~</span><span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">CEP</span>,random<span class="op">=</span><span class="op">~</span><span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,subject<span class="op">=</span><span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>link<span class="op">=</span><span class="st">"5-quant-splines"</span>,data<span class="op">=</span><span class="va">paquid</span>,ng<span class="op">=</span><span class="fl">2</span>,mixture<span class="op">=</span><span class="op">~</span><span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">mMMSE1</span><span class="op">)</span>,maxiter<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mCESD2</span> <span class="op">&lt;-</span> <span class="fu"><a href="lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">CESD</span><span class="op">~</span><span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">male</span>,random<span class="op">=</span><span class="op">~</span><span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,subject<span class="op">=</span><span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>link<span class="op">=</span><span class="st">"5-quant-splines"</span>,data<span class="op">=</span><span class="va">paquid</span>,ng<span class="op">=</span><span class="fl">2</span>,mixture<span class="op">=</span><span class="op">~</span><span class="va">age65</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">mCESD1</span><span class="op">)</span>,maxiter<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mm2S</span> <span class="op">&lt;-</span> <span class="fu">mpjlcmm</span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE2</span>,<span class="va">mCESD2</span><span class="op">)</span>,subject<span class="op">=</span><span class="st">"ID"</span>,ng<span class="op">=</span><span class="fl">2</span>,data<span class="op">=</span><span class="va">paquid</span>,</span></span>
<span class="r-in"><span>survival<span class="op">=</span><span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>,<span class="va">agedem</span>,<span class="va">dem</span><span class="op">)</span><span class="op">~</span><span class="va">CEP</span><span class="op">+</span><span class="fu"><a href="ForInternalUse.html">mixture</a></span><span class="op">(</span><span class="va">male</span><span class="op">)</span>,classmb<span class="op">=</span><span class="op">~</span><span class="va">CEP</span><span class="op">+</span><span class="va">male</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mm2S_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="gridsearch.html">gridsearch</a></span><span class="op">(</span><span class="fu">mpjlcmm</span><span class="op">(</span>longitudinal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mMMSE2</span>,<span class="va">mCESD2</span><span class="op">)</span>,subject<span class="op">=</span><span class="st">"ID"</span>,ng<span class="op">=</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>data<span class="op">=</span><span class="va">paquid</span>,survival<span class="op">=</span><span class="fu">Surv</span><span class="op">(</span><span class="va">age_init</span>,<span class="va">agedem</span>,<span class="va">dem</span><span class="op">)</span><span class="op">~</span><span class="va">CEP</span><span class="op">+</span><span class="fu"><a href="ForInternalUse.html">mixture</a></span><span class="op">(</span><span class="va">male</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>classmb<span class="op">=</span><span class="op">~</span><span class="va">CEP</span><span class="op">+</span><span class="va">male</span><span class="op">)</span>,minit<span class="op">=</span><span class="va">mm1S</span>,rep<span class="op">=</span><span class="fl">50</span>,maxiter<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="summarytable.html">summarytable</a></span><span class="op">(</span><span class="va">mm1S</span>,<span class="va">mm2S</span>,<span class="va">mm2S_b</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod1_biv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">mm1S</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod2_biv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">mm2S</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## -&gt; use post-fit functions as in exemple 1</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Cecile Proust-Lima, Viviane Philipps.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

