<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimation of a secondary regression model after the estimation of a primary latent class model — externVar • lcmm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimation of a secondary regression model after the estimation of a primary latent class model — externVar"><meta name="description" content="This function fits regression models to relate a latent class structure (stemmed
from a latent class model estimated within lcmm package) with either an external
 outcome or external class predictors.
 Two inference techniques are implemented. They both account for the
 classification error in the posterior class assignment:
- a 2-stage estimation using the joint likelihood of the primary latent
 class model and of the secondary/ external regression;
- a conditional regression of the external outcome given the underlying
 latent class structure, or of the underlying class structure given external
  covariates.
It returns an object of one of the lcmm package classes."><meta property="og:description" content="This function fits regression models to relate a latent class structure (stemmed
from a latent class model estimated within lcmm package) with either an external
 outcome or external class predictors.
 Two inference techniques are implemented. They both account for the
 classification error in the posterior class assignment:
- a 2-stage estimation using the joint likelihood of the primary latent
 class model and of the secondary/ external regression;
- a conditional regression of the external outcome given the underlying
 latent class structure, or of the underlying class structure given external
  covariates.
It returns an object of one of the lcmm package classes."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lcmm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/lcmm.html">GET STARTED</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">VIGNETTES</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/latent_class_model_with_hlme.html">How to estimate a latent class mixed model using hlme function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_lcmm.html">How to estimate a latent process mixed model using lcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm.html">How to estimate a latent process mixed model for multivariate markers using multlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm_IRT.html">Continuous-time longitudinal IRT model</a></li>
    <li><a class="dropdown-item" href="../articles/joint_latent_class_model_with_Jointlcmm.html">How to estimate a joint latent class mixed model using Jointlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/multivariate_latent_class_model_with_mpjlcmm.html">How to estimate a multivariate latent class mixed model using mpjlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/secondary_model_with_externVar.html">Accounting for latent class assignment uncertainty in subsequent analyses</a></li>
    <li><a class="dropdown-item" href="../articles/pre_normalizing.html">Pre-normalizing a dependent variable using lcmm</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/usual_problems.html">FAQ</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">REFERENCE</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">CHANGELOG</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CecileProust-Lima/lcmm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimation of a secondary regression model after the estimation of a primary latent class model</h1>
      <small class="dont-index">Source: <a href="https://github.com/CecileProust-Lima/lcmm/blob/HEAD/R/externVar.R" class="external-link"><code>R/externVar.R</code></a></small>
      <div class="d-none name"><code>externVar.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function fits regression models to relate a latent class structure (stemmed
from a latent class model estimated within <code>lcmm</code> package) with either an external
 outcome or external class predictors.
 Two inference techniques are implemented. They both account for the
 classification error in the posterior class assignment:</p>
<p>- a 2-stage estimation using the joint likelihood of the primary latent
 class model and of the secondary/ external regression;</p>
<p>- a conditional regression of the external outcome given the underlying
 latent class structure, or of the underlying class structure given external
  covariates.</p>
<p>It returns an object of one of the <code>lcmm</code> package classes.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">externVar</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  <span class="va">fixed</span>,</span>
<span>  <span class="va">mixture</span>,</span>
<span>  <span class="va">random</span>,</span>
<span>  <span class="va">subject</span>,</span>
<span>  <span class="va">classmb</span>,</span>
<span>  <span class="va">survival</span>,</span>
<span>  hazard <span class="op">=</span> <span class="st">"Weibull"</span>,</span>
<span>  hazardtype <span class="op">=</span> <span class="st">"Specific"</span>,</span>
<span>  hazardnodes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  TimeDepVar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  logscale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  idiag <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nwg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  randomY <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  link <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  intnodes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  epsY <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nsim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  range <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">longitudinal</span>,</span>
<span>  <span class="va">method</span>,</span>
<span>  <span class="va">varest</span>,</span>
<span>  M <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  <span class="va">B</span>,</span>
<span>  convB <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  convL <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  convG <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  maxiter <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  <span class="va">posfix</span>,</span>
<span>  partialH <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nproc <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>an object inheriting from class <code>hlme</code>, <code>lcmm</code>,
<code>Jointlcmm</code>, <code>multlcmm</code> or <code>mpjlcmm</code> giving the primary latent
 class model.</p></dd>


<dt id="arg-fixed">fixed<a class="anchor" aria-label="anchor" href="#arg-fixed"></a></dt>
<dd><p>optional, for secondary analyses on an external outcome variable:
two-sided linear formula object for specifying the outcome and fixed-effect
part in the secondary model.
The response outcome is on the left of <code>~</code> and the covariates are separated
by <code>+</code> on the right of the <code>~</code>. The right side should be <code>~1</code> to
model the outcome according to the latent classes only.</p></dd>


<dt id="arg-mixture">mixture<a class="anchor" aria-label="anchor" href="#arg-mixture"></a></dt>
<dd><p>optional, for secondary analyses on an external outcome variable:
one-sided formula object for the class-specific fixed effects in the model
for the external outcome. Among the list of covariates included in fixed,
the covariates with class-specific regression parameters are entered in
mixture separated by <code>+</code>. By default, an intercept is included.
If no intercept, <code>-1</code> should be the first term included.</p></dd>


<dt id="arg-random">random<a class="anchor" aria-label="anchor" href="#arg-random"></a></dt>
<dd><p>optional, for secondary analyses on an external outcome variable:
one-sided linear formula object for specifying the
random effects in the secondary model, if appropriate.
By default, no random effect is included.</p></dd>


<dt id="arg-subject">subject<a class="anchor" aria-label="anchor" href="#arg-subject"></a></dt>
<dd><p>name of the covariate representing the grouping structure.
Even in the absence of a hierarchical structure.</p></dd>


<dt id="arg-classmb">classmb<a class="anchor" aria-label="anchor" href="#arg-classmb"></a></dt>
<dd><p>optional, for secondary analyses on latent class membership
according to external covariates:
optional one-sided formula specifying the external predictors of
latent class membership to be modeled in the secondary class-membership multinomial
logistic model. Covariates are separated by <code>+</code> on the right of the <code>~</code>.</p></dd>


<dt id="arg-survival">survival<a class="anchor" aria-label="anchor" href="#arg-survival"></a></dt>
<dd><p>optional, for secondary analyses on an external survival outcome:
 two-sided formula specifying the external survival part
of the model. The right side should be <code>~1</code> to get the survival associated to
each latent class without any other covariate.</p></dd>


<dt id="arg-hazard">hazard<a class="anchor" aria-label="anchor" href="#arg-hazard"></a></dt>
<dd><p>optional, for secondary analyses on an external survival outcome:
 family of hazard function assumed for the survival model
(Weibull, piecewise or splines)</p></dd>


<dt id="arg-hazardtype">hazardtype<a class="anchor" aria-label="anchor" href="#arg-hazardtype"></a></dt>
<dd><p>optional, for secondary analyses on an external survival outcome:
 indicator for the type of baseline risk function
(Specific, PH or Common)</p></dd>


<dt id="arg-hazardnodes">hazardnodes<a class="anchor" aria-label="anchor" href="#arg-hazardnodes"></a></dt>
<dd><p>optional, for secondary analyses on an external survival outcome:
  vector containing interior nodes if <code>splines</code> or
<code>piecewise</code> is specified for the baseline hazard function in <code>hazard</code></p></dd>


<dt id="arg-timedepvar">TimeDepVar<a class="anchor" aria-label="anchor" href="#arg-timedepvar"></a></dt>
<dd><p>optional, for secondary analyses on an external survival outcome:
  vector specifying the name of the time-dependent covariate
in the survival model (only a irreversible event time in allowed)</p></dd>


<dt id="arg-logscale">logscale<a class="anchor" aria-label="anchor" href="#arg-logscale"></a></dt>
<dd><p>optional, for secondary analyses on an external survival outcome:
  boolean indicating whether an exponential (logscale=TRUE) or
a square (logscale=FALSE -by default) transformation is used to
ensure positivity of parameters in the baseline risk functions</p></dd>


<dt id="arg-idiag">idiag<a class="anchor" aria-label="anchor" href="#arg-idiag"></a></dt>
<dd><p>optional, for secondary analyses on an external outcome:
  if appropriate, logical for the structure of the variance-covariance
matrix of the random-effects in the secondary model.
If <code>FALSE</code>, a non structured matrix of
variance-covariance is considered (by default). If <code>TRUE</code> a diagonal
matrix of variance-covariance is considered.</p></dd>


<dt id="arg-nwg">nwg<a class="anchor" aria-label="anchor" href="#arg-nwg"></a></dt>
<dd><p>optional, for secondary analyses on an external outcome:
  if appropriate, logical indicating if the variance-covariance of the
random-effects in the secondary model is class-specific. If <code>FALSE</code> the
variance-covariance matrix is common over latent classes (by default). If <code>TRUE</code> a
class-specific proportional parameter multiplies the variance-covariance
matrix in each class (the proportional parameter in the last latent class
equals 1 to ensure identifiability).</p></dd>


<dt id="arg-randomy">randomY<a class="anchor" aria-label="anchor" href="#arg-randomy"></a></dt>
<dd><p>optional, for secondary analyses on an external outcome:
  if appropriate, logical for including an outcome-specific random intercept.
If FALSE no outcome-specific random intercept is added (default). If TRUE independent
outcome-specific random intercept with parameterized variance are included</p></dd>


<dt id="arg-link">link<a class="anchor" aria-label="anchor" href="#arg-link"></a></dt>
<dd><p>optional, for secondary analyses on an external outcome:
  if appropriate, family of parameterized link functions for the external outcome
if appropriate. Defaults to NULL, corresponding to continuous Gaussian distribution
(hlme function).</p></dd>


<dt id="arg-intnodes">intnodes<a class="anchor" aria-label="anchor" href="#arg-intnodes"></a></dt>
<dd><p>optional, for secondary analyses on an external outcome:
  if appropriate, vector of interior nodes. This argument is only
required for a I-splines link function with nodes entered manually.</p></dd>


<dt id="arg-epsy">epsY<a class="anchor" aria-label="anchor" href="#arg-epsy"></a></dt>
<dd><p>optional, for secondary analyses on an external outcome:
  if appropriate, definite positive real used to rescale the marker in (0,1)
when the beta link function is used. By default, epsY=0.5.</p></dd>


<dt id="arg-cor">cor<a class="anchor" aria-label="anchor" href="#arg-cor"></a></dt>
<dd><p>optional, for secondary analyses on an external outcome:
  if appropriate, indicator for inclusion of an auto correlated Gaussian process
in the latent process linear (latent process) mixed model. Option "BM" indicates
a brownian motion with parameterized variance. Option "AR" specifies an
autoregressive process of order 1 with parameterized variance and correlation
intensity. Each option should be followed by the time variable in brackets as
<code>cor=BM(time)</code>. By default, no autocorrelated Gaussian process is added.</p></dd>


<dt id="arg-nsim">nsim<a class="anchor" aria-label="anchor" href="#arg-nsim"></a></dt>
<dd><p>optional, for secondary analyses on an external outcome:
  if appropriate, number of points to be used in the estimated link function. By default,
nsom=100.</p></dd>


<dt id="arg-range">range<a class="anchor" aria-label="anchor" href="#arg-range"></a></dt>
<dd><p>optional, for secondary analyses on an external outcome:
  if appropriate, vector indicating the range of the outcomes (that is the
minimum and maximum). By default, the range is defined according to the minimum
and maximum observed values of the outcome. The option should be used
only for Beta and Splines transformations.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Data frame containing the variables named in
<code>fixed</code>, <code>mixture</code>, <code>random</code>, <code>classmb</code> and <code>subject</code>,
for both the current function arguments and the primary model arguments
Check <code>details</code> to get information on the data structure, especially with
external outcomes.</p></dd>


<dt id="arg-longitudinal">longitudinal<a class="anchor" aria-label="anchor" href="#arg-longitudinal"></a></dt>
<dd><p>only with <code>mpjlcmm</code> primary models and "twoStageJoint"
method: mandatory list containing the longitudinal submodels used in the primary
latent class model.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>character indicating the inference technique to be used:
<code>"twoStageJoint"</code> corresponds to 2-stage estimation using the
joint log-likelihood. <code>"conditional"</code> corresponds to the conditional
regression using the underlying true latent class membership.</p></dd>


<dt id="arg-varest">varest<a class="anchor" aria-label="anchor" href="#arg-varest"></a></dt>
<dd><p>optional character indicating the method to be used to compute the
variance of the regression estimates in the secondary regression.
<code>"none"</code> does not account for the
uncertainty in the primary latent class model, <code>"paramBoot"</code> computes the
total variance using a parametric bootstrap technique, <code>"Hessian"</code> computes
the total Hessian of the joint likelihood (implemented for <code>"twoStageJoint"</code>
method only). Default to <code>"Hessian"</code> for <code>"twoStageJoint"</code> method and
<code>"paramBoot"</code> for <code>"conditional"</code> method.</p></dd>


<dt id="arg-m">M<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>option integer indicating the number of draws for the parametric boostrap
when <code>varest="paramBoot"</code>. Default to 200.</p></dd>


<dt id="arg-b">B<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>optional vector of initial parameter values for the secondary model.
With an external outcome, the vector has the same structure as a latent class model
estimated in the other functions of <code>lcmm</code> package for the same type of
outcome except that no parameters should be included for the latent class membership.
With external class predictors (of size p), the vector is of length
(ng-1)*(1+p). If <code>B=NULL</code> (by default), internal initial values are considered</p></dd>


<dt id="arg-convb">convB<a class="anchor" aria-label="anchor" href="#arg-convb"></a></dt>
<dd><p>optional threshold for the convergence criterion based on the
parameter stability. By default, convB=0.0001.</p></dd>


<dt id="arg-convl">convL<a class="anchor" aria-label="anchor" href="#arg-convl"></a></dt>
<dd><p>optional threshold for the convergence criterion based on the
log-likelihood stability. By default, convL=0.0001.</p></dd>


<dt id="arg-convg">convG<a class="anchor" aria-label="anchor" href="#arg-convg"></a></dt>
<dd><p>optional threshold for the convergence criterion based on the
derivatives. By default, convG=0.0001.</p></dd>


<dt id="arg-maxiter">maxiter<a class="anchor" aria-label="anchor" href="#arg-maxiter"></a></dt>
<dd><p>optional maximum number of iterations for the secondary model
estimation using Marquardt iterative algorithm. Defaults to 100</p></dd>


<dt id="arg-posfix">posfix<a class="anchor" aria-label="anchor" href="#arg-posfix"></a></dt>
<dd><p>optional vector specifying indices in parameter vector B the
secondary model that should not be estimated. Default to NULL, all the
parameters of the secondary regression are estimated.</p></dd>


<dt id="arg-partialh">partialH<a class="anchor" aria-label="anchor" href="#arg-partialh"></a></dt>
<dd><p>optional logical for Piecewise and Splines baseline risk functions and
Splines link functions only. Indicates whether the parameters of the baseline risk or
link functions can be dropped from the Hessian matrix to define convergence criteria
(can solve non convergence due to estimates at the boundary of the parameter space - usually 0).</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical indicating whether information about computation should be
reported. Default to FALSE.</p></dd>


<dt id="arg-nproc">nproc<a class="anchor" aria-label="anchor" href="#arg-nproc"></a></dt>
<dd><p>the number cores for parallel computation. Default to 1 (sequential mode).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>an object of class <code>externVar</code> and
<code>externSurv</code> for external survival outcomes,
<code>externX</code> for external class predictors, and
<code>hlme</code>, <code>lcmm</code>, or <code>multlcmm</code> for external longitudinal or cross-sectional outcomes.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>A. DATA STRUCTURE</p>
<p>The <code>data</code> argument must follow specific structure. It must include all
the data necessary to compute the posterior classification probabilities
 (so a longitudinal format usually) as well as the information for the
 secondary analysis.
For time-invariant variables in the secondary analyses:
- if used as an external outcome: the information should not be duplicated
at each row of the subject. It should appear once for each individual.
- if used as an external covariate: the information can be duplicated at
each row of the subject (as usual)</p>
<p>B. VARIANCE ESTIMATION</p>
<p>The two techniques rely on a sequential analysis (two-stage analysis) so the
variance calculation should account for both the uncertainty in the first and
the second stage.
Not taking into account the first-stage uncertainty by specifying
<code>varest="none"</code> may lead to the underestimation of the final variance.
When possible, Method <code>varest="Hessian"</code> which relies on the
combination of Hessians from the primary and secondary models is recommended.
However, it may become numerically intensive when the primary latent class
model includes a high number of parameters. As an alternative, especially
when the primary model is complex and the second model includes a limited
number of parameters, the parametric Bootstrap method
<code>varest="paramBoot"</code> can be favored.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Maris Dussartre, Cecile Proust-Lima and Viviane Philipps</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###### Estimation of the primary latent class model                   ######</span></span></span>
<span class="r-in"><span><span class="co"># this is a linear latent class mixed model for Ydep1</span></span></span>
<span class="r-in"><span><span class="co"># with 2 classes and a linear trajectory</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">PrimMod</span> <span class="op">&lt;-</span> <span class="fu"><a href="hlme.html">hlme</a></span><span class="op">(</span><span class="va">Ydep1</span><span class="op">~</span><span class="va">Time</span>,random<span class="op">=</span><span class="op">~</span><span class="va">Time</span>,subject<span class="op">=</span><span class="st">'ID'</span>,ng<span class="op">=</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">data_lcmm</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">PrimMod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="hlme.html">hlme</a></span><span class="op">(</span><span class="va">Ydep1</span><span class="op">~</span><span class="va">Time</span>,mixture<span class="op">=</span><span class="op">~</span><span class="va">Time</span>,random<span class="op">=</span><span class="op">~</span><span class="va">Time</span>,subject<span class="op">=</span><span class="st">'ID'</span>,</span></span>
<span class="r-in"><span>                 ng<span class="op">=</span><span class="fl">2</span>,data<span class="op">=</span><span class="va">data_lcmm</span>,B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">PrimMod</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###### Example 1: Relationship between the latent class structure and       #</span></span></span>
<span class="r-in"><span><span class="co">#                   external class predictors                          ######</span></span></span>
<span class="r-in"><span>      </span></span>
<span class="r-in"><span><span class="co"># We consider here 4 external predictors X1-X4.       </span></span></span>
<span class="r-in"><span>                  </span></span>
<span class="r-in"><span><span class="co"># estimation of the secondary multinomial logistic model with total variance</span></span></span>
<span class="r-in"><span><span class="co"># computed with the Hessian</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">XextHess</span> <span class="op">&lt;-</span> <span class="fu">externVar</span><span class="op">(</span><span class="va">PrimMod2</span>,</span></span>
<span class="r-in"><span>                      classmb <span class="op">=</span> <span class="op">~</span><span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span> <span class="op">+</span> <span class="va">X4</span>, </span></span>
<span class="r-in"><span>                      subject <span class="op">=</span> <span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>                      data <span class="op">=</span> <span class="va">data_lcmm</span>,</span></span>
<span class="r-in"><span>                      method <span class="op">=</span> <span class="st">"twoStageJoint"</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">XextHess</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimation of a secondary multinomial logistic model with total variance</span></span></span>
<span class="r-in"><span><span class="co"># computed with parametric Bootstrap (much longer). When planning to use</span></span></span>
<span class="r-in"><span><span class="co"># the bootstrap estimator, we recommend running first the analysis </span></span></span>
<span class="r-in"><span><span class="co"># with option varest = "none" which is faster but which underestimates </span></span></span>
<span class="r-in"><span><span class="co"># the variance. And then use these values as plausible initial values when </span></span></span>
<span class="r-in"><span><span class="co"># running the estimation with varest = "paramBoot" to obtain  a valid </span></span></span>
<span class="r-in"><span><span class="co"># variance of the parameters. </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">XextNone</span> <span class="op">&lt;-</span> <span class="fu">externVar</span><span class="op">(</span><span class="va">PrimMod2</span>,</span></span>
<span class="r-in"><span>                      classmb <span class="op">=</span> <span class="op">~</span><span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span> <span class="op">+</span> <span class="va">X4</span>, </span></span>
<span class="r-in"><span>                      subject <span class="op">=</span> <span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>                      data <span class="op">=</span> <span class="va">data_lcmm</span>,</span></span>
<span class="r-in"><span>                      varest <span class="op">=</span> <span class="st">"none"</span>,</span></span>
<span class="r-in"><span>                      method <span class="op">=</span> <span class="st">"twoStageJoint"</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">XextBoot</span> <span class="op">&lt;-</span> <span class="fu">externVar</span><span class="op">(</span><span class="va">PrimMod2</span>,</span></span>
<span class="r-in"><span>                      classmb <span class="op">=</span> <span class="op">~</span><span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span> <span class="op">+</span> <span class="va">X4</span>, </span></span>
<span class="r-in"><span>                      subject <span class="op">=</span> <span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>                      data <span class="op">=</span> <span class="va">data_lcmm</span>,</span></span>
<span class="r-in"><span>                      varest <span class="op">=</span> <span class="st">"paramBoot"</span>,</span></span>
<span class="r-in"><span>                      method <span class="op">=</span> <span class="st">"twoStageJoint"</span>,</span></span>
<span class="r-in"><span>                      B <span class="op">=</span> <span class="va">XextNone</span><span class="op">$</span><span class="va">best</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">XextBoot</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co">###### Example 2: Relationship between a latent class structure and         #</span></span></span>
<span class="r-in"><span><span class="co">#                external outcome (repeatedly measured over time)     ######</span></span></span>
<span class="r-in"><span>                </span></span>
<span class="r-in"><span>                </span></span>
<span class="r-in"><span><span class="co"># We want to estimate a linear mixed model for Ydep2 with a linear trajectory</span></span></span>
<span class="r-in"><span><span class="co"># adjusted on X1. </span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co"># estimation of the secondary linear mixed model with total variance</span></span></span>
<span class="r-in"><span><span class="co"># computed with the Hessian</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">YextHess</span> <span class="op">=</span> <span class="fu">externVar</span><span class="op">(</span><span class="va">PrimMod2</span>,   <span class="co">#primary model</span></span></span>
<span class="r-in"><span>                     fixed <span class="op">=</span> <span class="va">Ydep2</span> <span class="op">~</span> <span class="va">Time</span><span class="op">*</span><span class="va">X1</span>,  <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     random <span class="op">=</span> <span class="op">~</span><span class="va">Time</span>, <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     mixture <span class="op">=</span> <span class="op">~</span><span class="va">Time</span>,  <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     subject<span class="op">=</span><span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>                     data<span class="op">=</span><span class="va">data_lcmm</span>,</span></span>
<span class="r-in"><span>                     method <span class="op">=</span> <span class="st">"twoStageJoint"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                     </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimation of a secondary linear mixed model with total variance</span></span></span>
<span class="r-in"><span><span class="co"># computed with parametric Bootstrap (much longer). When planning to use</span></span></span>
<span class="r-in"><span><span class="co"># the bootstrap estimator, we recommend running first the analysis </span></span></span>
<span class="r-in"><span><span class="co"># with option varest = "none" which is faster but which underestimates </span></span></span>
<span class="r-in"><span><span class="co"># the variance. And then use these values as plausible initial values when </span></span></span>
<span class="r-in"><span><span class="co"># running the estimation with varest = "paramBoot" to obtain  a valid </span></span></span>
<span class="r-in"><span><span class="co"># variance of the parameters. </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">YextNone</span> <span class="op">=</span> <span class="fu">externVar</span><span class="op">(</span><span class="va">PrimMod2</span>,   <span class="co">#primary model</span></span></span>
<span class="r-in"><span>                     fixed <span class="op">=</span> <span class="va">Ydep2</span> <span class="op">~</span> <span class="va">Time</span><span class="op">*</span><span class="va">X1</span>,  <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     random <span class="op">=</span> <span class="op">~</span><span class="va">Time</span>, <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     mixture <span class="op">=</span> <span class="op">~</span><span class="va">Time</span>,  <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     subject<span class="op">=</span><span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>                     data<span class="op">=</span><span class="va">data_lcmm</span>,</span></span>
<span class="r-in"><span>                     varest <span class="op">=</span> <span class="st">"none"</span>,</span></span>
<span class="r-in"><span>                     method <span class="op">=</span> <span class="st">"twoStageJoint"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">YextBoot</span> <span class="op">=</span> <span class="fu">externVar</span><span class="op">(</span><span class="va">PrimMod2</span>,   <span class="co">#primary model</span></span></span>
<span class="r-in"><span>                     fixed <span class="op">=</span> <span class="va">Ydep2</span> <span class="op">~</span> <span class="va">Time</span><span class="op">*</span><span class="va">X1</span>,  <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     random <span class="op">=</span> <span class="op">~</span><span class="va">Time</span>, <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     mixture <span class="op">=</span> <span class="op">~</span><span class="va">Time</span>,  <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     subject<span class="op">=</span><span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>                     data<span class="op">=</span><span class="va">data_lcmm</span>,</span></span>
<span class="r-in"><span>                     method <span class="op">=</span> <span class="st">"twoStageJoint"</span>,</span></span>
<span class="r-in"><span>                     B <span class="op">=</span> <span class="va">YextNone</span><span class="op">$</span><span class="va">best</span>,</span></span>
<span class="r-in"><span>                     varest<span class="op">=</span> <span class="st">"paramBoot"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">YextBoot</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###### Example 3: Relationship between a latent class structure and         #</span></span></span>
<span class="r-in"><span><span class="co">#                      external outcome (survival)                     ######</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We want to estimate a proportional hazard model (with proportional hazard </span></span></span>
<span class="r-in"><span><span class="co"># across classes) for time to event Tevent (indicator Event) and assuming </span></span></span>
<span class="r-in"><span><span class="co"># a splines baseline risk with 3 knots.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimation of the secondary survival model with total variance</span></span></span>
<span class="r-in"><span><span class="co"># computed with the Hessian</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">YextHess</span> <span class="op">=</span> <span class="fu">externVar</span><span class="op">(</span><span class="va">PrimMod2</span>,   <span class="co">#primary model</span></span></span>
<span class="r-in"><span>                     survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">Tevent</span>,<span class="va">Event</span><span class="op">)</span><span class="op">~</span> <span class="va">X1</span><span class="op">+</span><span class="fu"><a href="ForInternalUse.html">mixture</a></span><span class="op">(</span><span class="va">X2</span><span class="op">)</span>, <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     hazard<span class="op">=</span><span class="st">"3-quant-splines"</span>, <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     hazardtype<span class="op">=</span><span class="st">"PH"</span>, <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     subject<span class="op">=</span><span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>                     data<span class="op">=</span><span class="va">data_lcmm</span>,</span></span>
<span class="r-in"><span>                     method <span class="op">=</span> <span class="st">"twoStageJoint"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">YextHess</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimation of a secondary survival model with total variance</span></span></span>
<span class="r-in"><span><span class="co"># computed with parametric Bootstrap (much longer). When planning to use</span></span></span>
<span class="r-in"><span><span class="co"># the bootstrap estimator, we recommend running first the analysis </span></span></span>
<span class="r-in"><span><span class="co"># with option varest = "none" which is faster but which underestimates </span></span></span>
<span class="r-in"><span><span class="co"># the variance. And then use these values as plausible initial values when </span></span></span>
<span class="r-in"><span><span class="co"># running the estimation with varest = "paramBoot" to obtain  a valid </span></span></span>
<span class="r-in"><span><span class="co"># variance of the parameters. </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">YextNone</span> <span class="op">=</span> <span class="fu">externVar</span><span class="op">(</span><span class="va">PrimMod2</span>,   <span class="co">#primary model</span></span></span>
<span class="r-in"><span>                     survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">Tevent</span>,<span class="va">Event</span><span class="op">)</span><span class="op">~</span> <span class="va">X1</span><span class="op">+</span><span class="fu"><a href="ForInternalUse.html">mixture</a></span><span class="op">(</span><span class="va">X2</span><span class="op">)</span>, <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     hazard<span class="op">=</span><span class="st">"3-quant-splines"</span>, <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     hazardtype<span class="op">=</span><span class="st">"PH"</span>, <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     subject<span class="op">=</span><span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>                     data<span class="op">=</span><span class="va">data_lcmm</span>,</span></span>
<span class="r-in"><span>                     varest <span class="op">=</span> <span class="st">"none"</span>,</span></span>
<span class="r-in"><span>                     method <span class="op">=</span> <span class="st">"twoStageJoint"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">YextBoot</span> <span class="op">=</span> <span class="fu">externVar</span><span class="op">(</span><span class="va">PrimMod2</span>,   <span class="co">#primary model</span></span></span>
<span class="r-in"><span>                     survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">Tevent</span>,<span class="va">Event</span><span class="op">)</span><span class="op">~</span> <span class="va">X1</span><span class="op">+</span><span class="fu"><a href="ForInternalUse.html">mixture</a></span><span class="op">(</span><span class="va">X2</span><span class="op">)</span>, <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     hazard<span class="op">=</span><span class="st">"3-quant-splines"</span>, <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     hazardtype<span class="op">=</span><span class="st">"PH"</span>, <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     subject<span class="op">=</span><span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>                     data<span class="op">=</span><span class="va">data_lcmm</span>,</span></span>
<span class="r-in"><span>                     method <span class="op">=</span> <span class="st">"twoStageJoint"</span>,</span></span>
<span class="r-in"><span>                     B <span class="op">=</span> <span class="va">YextNone</span><span class="op">$</span><span class="va">best</span>,</span></span>
<span class="r-in"><span>                     varest<span class="op">=</span> <span class="st">"paramBoot"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">YextBoot</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cecile Proust-Lima, Viviane Philipps.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer></div>





  </body></html>

