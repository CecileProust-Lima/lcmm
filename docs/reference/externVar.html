<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function fits regression models to relate a latent class structure (stemmed 
from a latent class model estimated within lcmm package) with either an external
 outcome or external class predictors. 
 Two inference techniques are implemented to account for the classification error: 
- a 2-stage estimation of the joint likelihood of the primary latent class model 
 and the secondary/ external regression; 
- a regression between the posterior latent class assignment and the external variable 
 which internally corrects for the assignment misclassification. 
It returns an object from one of the lcmm package classes."><title>Estimation of secondary regression models after the estimation of a primary latent class model — externVar • lcmm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimation of secondary regression models after the estimation of a primary latent class model — externVar"><meta property="og:description" content="This function fits regression models to relate a latent class structure (stemmed 
from a latent class model estimated within lcmm package) with either an external
 outcome or external class predictors. 
 Two inference techniques are implemented to account for the classification error: 
- a 2-stage estimation of the joint likelihood of the primary latent class model 
 and the secondary/ external regression; 
- a regression between the posterior latent class assignment and the external variable 
 which internally corrects for the assignment misclassification. 
It returns an object from one of the lcmm package classes."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">lcmm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/lcmm.html">GET STARTED</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">VIGNETTES</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/latent_class_model_with_hlme.html">How to estimate a latent class mixed model using hlme function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_lcmm.html">How to estimate a latent process mixed model using lcmm function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm.html">How to estimate a latent process mixed model for multivariate markers using multlcmm function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm_IRT.html">Continuous-time longitudinal IRT model</a>
    <a class="dropdown-item" href="../articles/joint_latent_class_model_with_Jointlcmm.html">How to estimate a joint latent class mixed model using Jointlcmm function</a>
    <a class="dropdown-item" href="../articles/multivariate_latent_class_model_with_mpjlcmm.html">How to estimate a multivariate latent class mixed model using mpjlcmm function</a>
    <a class="dropdown-item" href="../articles/pre_normalizing.html">Pre-normalizing a dependent variable using lcmm</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/usual_problems.html">FAQ</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">REFERENCE</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">CHANGELOG</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/CecileProust-Lima/lcmm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Estimation of secondary regression models after the estimation of a primary latent class model</h1>
      <small class="dont-index">Source: <a href="https://github.com/CecileProust-Lima/lcmm/blob/HEAD/R/externVar.R" class="external-link"><code>R/externVar.R</code></a></small>
      <div class="d-none name"><code>externVar.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function fits regression models to relate a latent class structure (stemmed 
from a latent class model estimated within <code>lcmm</code> package) with either an external
 outcome or external class predictors. 
 Two inference techniques are implemented to account for the classification error:</p> 
<p>- a 2-stage estimation of the joint likelihood of the primary latent class model 
 and the secondary/ external regression;</p> 
<p>- a regression between the posterior latent class assignment and the external variable 
 which internally corrects for the assignment misclassification.</p> 
<p>It returns an object from one of the <code>lcmm</code> package classes.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">externVar</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  <span class="va">fixed</span>,</span>
<span>  <span class="va">mixture</span>,</span>
<span>  <span class="va">random</span>,</span>
<span>  <span class="va">subject</span>,</span>
<span>  <span class="va">classmb</span>,</span>
<span>  <span class="va">survival</span>,</span>
<span>  hazard <span class="op">=</span> <span class="st">"Weibull"</span>,</span>
<span>  hazardtype <span class="op">=</span> <span class="st">"Specific"</span>,</span>
<span>  hazardnodes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  TimeDepVar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  logscale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  idiag <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nwg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  link <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  intnodes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  epsY <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">longitudinal</span>,</span>
<span>  <span class="va">method</span>,</span>
<span>  varest <span class="op">=</span> <span class="st">"Hessian"</span>,</span>
<span>  M <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  <span class="va">B</span>,</span>
<span>  convB <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  convL <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  convG <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  maxiter <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  <span class="va">posfix</span>,</span>
<span>  partialH <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nproc <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>model</dt>
<dd><p>an object inheriting from class <code>lcmm</code>, 
<code>Jointlcmm</code>, <code>multlcmm</code> or <code>mpjlcmm</code> giving the primary latent
 class model.</p></dd>


<dt>fixed</dt>
<dd><p>optional two sided linear formula object for specifying the
fixed-effects in the secondary model with an external outcome variable.
The response outcome is on the left of <code>~</code> and the covariates are separated
by <code>+</code> on the right of the <code>~</code>. By default, an intercept is included.</p></dd>


<dt>mixture</dt>
<dd><p>optional one-sided formula object for the class-specific fixed effects
in the model for the external outcome. Among the list of covariates included in fixed,
the covariates with class-specific regression parameters are entered in
mixture separated by <code>+</code>. By default, an intercept is included.
If no intercept, <code>-1</code> should be the first term included.</p></dd>


<dt>random</dt>
<dd><p>optional one-sided linear formula object for specifying the
random-effects on external outcome in the secondary model, if appropriate. 
By default, no random effect is included.</p></dd>


<dt>subject</dt>
<dd><p>name of the covariate representing the grouping structure.
Even in the absence of a hierarchical structure. By default, the function will try to retrieve it
from <code>model</code> argument.</p></dd>


<dt>classmb</dt>
<dd><p>optional one-sided formula specifying the external predictors of 
latent class membership to be modelled in the secondary class-membership multinomial 
logistic model. Covariates are separated by <code>+</code> on the right of the <code>~</code>. 
By default, an intercept is included.</p></dd>


<dt>idiag</dt>
<dd><p>if appropriate, optional logical for the structure of the variance-covariance
matrix of the random-effects in the secondary model. 
If <code>FALSE</code>, a non structured matrix of
variance-covariance is considered (by default). If <code>TRUE</code> a diagonal
matrix of variance-covariance is considered.</p></dd>


<dt>nwg</dt>
<dd><p>if appropriate, optional logical indicating if the variance-covariance of the
random-effects in the secondary model is class-specific. If <code>FALSE</code> the variance-covariance
matrix is common over latent classes (by default). If <code>TRUE</code> a
class-specific proportional parameter multiplies the variance-covariance
matrix in each class (the proportional parameter in the last latent class
equals 1 to ensure identifiability).</p></dd>


<dt>link</dt>
<dd><p>optional family of parameterized link functions for the external outcome if appropriate.
Defaults to NULL, corresponding to continuous Gaussian distribution (hlme function).</p></dd>


<dt>intnodes</dt>
<dd><p>optional vector of interior nodes. This argument is only
required for a I-splines link function with nodes entered manually.</p></dd>


<dt>epsY</dt>
<dd><p>optional definite positive real used to rescale the marker in (0,1)
when the beta link function is used. By default, epsY=0.5.</p></dd>


<dt>data</dt>
<dd><p>Data frame containing the variables named in
<code>fixed</code>, <code>mixture</code>, <code>random</code>, <code>classmb</code> and <code>subject</code>,
for both the current function arguments and the primary model arguments
Check <code>details</code> to get information on the data structure, especially with
external outcomes.</p></dd>


<dt>longitudinal</dt>
<dd><p>only with <code>mpjlcmm</code> primary models and "twoStageJoint" method:
mandatory list containing the longitudinal submodels used in the primary latent class model.</p></dd>


<dt>method</dt>
<dd><p>character indicating the inference technique to be used:
only "twoStageJoint" for 2-stage estimation from the joint likelihood 
is implemented at the moment.</p></dd>


<dt>varest</dt>
<dd><p>optional character indicating the method to be used to compute the variance of 
the regression estimates. <code>"none"</code> does not account for the uncertainty in the primary latent 
class model, <code>"paramBoot"</code> computes the total variance using a parametric bootstrap technique, 
<code>"Hessian"</code> computes the total Hessian of the joint likelihood (implemented for <code>"twoStageJoint"</code>
method only). Default to <code>"Hessian"</code> for <code>"twoStageJoint"</code> method</p></dd>


<dt>M</dt>
<dd><p>option integer indicating the number of draws for the parametric boostrap when <code>varest="paramBoot"</code>.
Default to 200.</p></dd>


<dt>B</dt>
<dd><p>optional vector of initial parameter values for the secondary model. 
If external outcome, the vector has the same structure as a latent class model
estimated in the other functions of <code>lcmm</code> package for the same type of 
outcome. If external class predictors (of size p), the vector is of length 
(ng-1)*(1+p). If <code>B=NULL</code> (by default), internal initial values are selected.</p></dd>


<dt>convB</dt>
<dd><p>optional threshold for the convergence criterion based on the
parameter stability. By default, convB=0.0001.</p></dd>


<dt>convL</dt>
<dd><p>optional threshold for the convergence criterion based on the
log-likelihood stability. By default, convL=0.0001.</p></dd>


<dt>convG</dt>
<dd><p>optional threshold for the convergence criterion based on the
derivatives. By default, convG=0.0001.</p></dd>


<dt>maxiter</dt>
<dd><p>optional maximum number of iterations for the secondary model estimation using 
Marquardt iterative algorithm. Defaults to 100</p></dd>


<dt>posfix</dt>
<dd><p>optional vector specifying indices in parameter vector B the 
secondary model that should not be estimated. Default to NULL, all the 
parameters of the secondary regression are estimated.</p></dd>


<dt>partialH</dt>
<dd><p>optional logical for Piecewise and Splines baseline risk functions and
Splines link functions only. Indicates whether the parameters of the baseline risk or
link functions can be dropped from the Hessian matrix to define convergence criteria
(can solve non convergence due to estimates at the boundary of the parameter space - usually 0).</p></dd>


<dt>verbose</dt>
<dd><p>logical indicating whether information about computation should be
reported. Default to FALSE.</p></dd>


<dt>nproc</dt>
<dd><p>the number cores for parallel computation. Default to 1 (sequential mode).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>A. DATA STRUCTURE</p>
<p>The <code>data</code> argument must follow specific structure for individual variables,
i.e. variables with a unique constant value for each subject. For an individual variable
given as external outcome, data value must be present only once per subject,
independently of any time variable used in the primary latent class.
For an individual variable given as external class predictor,
data values must be given for every row of every individual (as usual)</p>
<p>B. VARIANCE ESTIMATION</p>
<p>Not taking into account first stage variance with specifing <code>"none"</code> may lead to
underestimation of the final variance. When possible, Method <code>"Hessian"</code> 
which relies on the combination of Hessians from the primary and secondary
model is recommended. However, it may become numerically intensive in the event 
of very high number of parameters in the primary latent class model. As an 
alternative, especially in situations with a complex primary model but rather 
parcimonious secondary model, method <code>"paramBoot"</code> which implements a 
parametric bootstrap can be used.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###### Estimation of the primary latent class model                   ######</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">PrimMod</span> <span class="op">&lt;-</span> <span class="fu"><a href="hlme.html">hlme</a></span><span class="op">(</span><span class="va">Ydep1</span><span class="op">~</span><span class="va">Time</span>,random<span class="op">=</span><span class="op">~</span><span class="va">Time</span>,subject<span class="op">=</span><span class="st">'ID'</span>,ng<span class="op">=</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">data_lcmm</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">PrimMod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="hlme.html">hlme</a></span><span class="op">(</span><span class="va">Ydep1</span><span class="op">~</span><span class="va">Time</span>,mixture<span class="op">=</span><span class="op">~</span><span class="va">Time</span>,random<span class="op">=</span><span class="op">~</span><span class="va">Time</span>,subject<span class="op">=</span><span class="st">'ID'</span>,</span></span>
<span class="r-in"><span>                 ng<span class="op">=</span><span class="fl">2</span>,data<span class="op">=</span><span class="va">data_lcmm</span>,B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">PrimMod</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###### Example 1: Relationship between a latent class structure and         #</span></span></span>
<span class="r-in"><span><span class="co">#                   external class predictors                          ######</span></span></span>
<span class="r-in"><span>                  </span></span>
<span class="r-in"><span><span class="co"># estimation of the secondary multinomial logistic model with total variance</span></span></span>
<span class="r-in"><span><span class="co"># computed with the Hessian</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">XextHess</span> <span class="op">&lt;-</span> <span class="fu">externVar</span><span class="op">(</span><span class="va">PrimMod2</span>,</span></span>
<span class="r-in"><span>                      classmb <span class="op">=</span> <span class="op">~</span><span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span> <span class="op">+</span> <span class="va">X4</span>, </span></span>
<span class="r-in"><span>                      subject <span class="op">=</span> <span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>                      data <span class="op">=</span> <span class="va">data_lcmm</span>,</span></span>
<span class="r-in"><span>                      method <span class="op">=</span> <span class="st">"twoStageJoint"</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">XextHess</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimation of a secondary multinomial logistic model with total variance</span></span></span>
<span class="r-in"><span><span class="co"># computed with parametric Bootstrap (much longer). When using the bootstrap </span></span></span>
<span class="r-in"><span><span class="co"># estimator, we recommend running first the analysis with option varest = "none" </span></span></span>
<span class="r-in"><span><span class="co"># which is faster but which underestimates the variance. And then use these values</span></span></span>
<span class="r-in"><span><span class="co"># as initial values when running the model with varest = "paramBoot" to obtain </span></span></span>
<span class="r-in"><span><span class="co"># a valid variance of the parameters. </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">XextNone</span> <span class="op">&lt;-</span> <span class="fu">externVar</span><span class="op">(</span><span class="va">PrimMod2</span>,</span></span>
<span class="r-in"><span>                      classmb <span class="op">=</span> <span class="op">~</span><span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span> <span class="op">+</span> <span class="va">X4</span>, </span></span>
<span class="r-in"><span>                      subject <span class="op">=</span> <span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>                      data <span class="op">=</span> <span class="va">data_lcmm</span>,</span></span>
<span class="r-in"><span>                      varest <span class="op">=</span> <span class="st">"none"</span>,</span></span>
<span class="r-in"><span>                      method <span class="op">=</span> <span class="st">"twoStageJoint"</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">XextBoot</span> <span class="op">&lt;-</span> <span class="fu">externVar</span><span class="op">(</span><span class="va">PrimMod2</span>,</span></span>
<span class="r-in"><span>                      classmb <span class="op">=</span> <span class="op">~</span><span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span> <span class="op">+</span> <span class="va">X4</span>, </span></span>
<span class="r-in"><span>                      subject <span class="op">=</span> <span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>                      data <span class="op">=</span> <span class="va">data_lcmm</span>,</span></span>
<span class="r-in"><span>                      varest <span class="op">=</span> <span class="st">"paramBoot"</span>,</span></span>
<span class="r-in"><span>                      method <span class="op">=</span> <span class="st">"twoStageJoint"</span>,</span></span>
<span class="r-in"><span>                      B <span class="op">=</span> <span class="va">XextNone</span><span class="op">$</span><span class="va">best</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">XextBoot</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co">###### Example 2: Relationship between a latent class structure and         #</span></span></span>
<span class="r-in"><span><span class="co">#                external outcome (repeatedly measured over time)     ######</span></span></span>
<span class="r-in"><span>                  </span></span>
<span class="r-in"><span><span class="co"># estimation of the secondary linear mixed model with total variance</span></span></span>
<span class="r-in"><span><span class="co"># computed with the Hessian</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">YextHess</span> <span class="op">=</span> <span class="fu">externVar</span><span class="op">(</span><span class="va">PrimMod2</span>,   <span class="co">#primary model</span></span></span>
<span class="r-in"><span>                     fixed <span class="op">=</span> <span class="va">Ydep2</span> <span class="op">~</span> <span class="va">Time</span><span class="op">*</span><span class="va">X1</span>,  <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     random <span class="op">=</span> <span class="op">~</span><span class="va">Time</span>, <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     mixture <span class="op">=</span> <span class="op">~</span><span class="va">Time</span>,  <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     subject<span class="op">=</span><span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>                     data<span class="op">=</span><span class="va">data_lcmm</span>,</span></span>
<span class="r-in"><span>                     method <span class="op">=</span> <span class="st">"twoStageJoint"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                     </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimation of a secondary linear mixed model with total variance</span></span></span>
<span class="r-in"><span><span class="co"># computed with parametric Bootstrap (much longer). When using the bootstrap </span></span></span>
<span class="r-in"><span><span class="co"># estimator, we recommend running first the analysis with option varest = "none" </span></span></span>
<span class="r-in"><span><span class="co"># which is faster but which underestimates the variance. And then use these values</span></span></span>
<span class="r-in"><span><span class="co"># as initial values when running the model with varest = "paramBoot" to obtain </span></span></span>
<span class="r-in"><span><span class="co"># a valid variance of the parameters. </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">YextNone</span> <span class="op">=</span> <span class="fu">externVar</span><span class="op">(</span><span class="va">PrimMod2</span>,   <span class="co">#primary model</span></span></span>
<span class="r-in"><span>                     fixed <span class="op">=</span> <span class="va">Ydep2</span> <span class="op">~</span> <span class="va">Time</span><span class="op">*</span><span class="va">X1</span>,  <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     random <span class="op">=</span> <span class="op">~</span><span class="va">Time</span>, <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     mixture <span class="op">=</span> <span class="op">~</span><span class="va">Time</span>,  <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     subject<span class="op">=</span><span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>                     data<span class="op">=</span><span class="va">data_lcmm</span>,</span></span>
<span class="r-in"><span>                     varest <span class="op">=</span> <span class="st">"none"</span>,</span></span>
<span class="r-in"><span>                     method <span class="op">=</span> <span class="st">"twoStageJoint"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">YextBoot</span> <span class="op">=</span> <span class="fu">externVar</span><span class="op">(</span><span class="va">PrimMod2</span>,   <span class="co">#primary model</span></span></span>
<span class="r-in"><span>                     fixed <span class="op">=</span> <span class="va">Ydep2</span> <span class="op">~</span> <span class="va">Time</span><span class="op">*</span><span class="va">X1</span>,  <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     random <span class="op">=</span> <span class="op">~</span><span class="va">Time</span>, <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     mixture <span class="op">=</span> <span class="op">~</span><span class="va">Time</span>,  <span class="co">#secondary model</span></span></span>
<span class="r-in"><span>                     subject<span class="op">=</span><span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>                     data<span class="op">=</span><span class="va">data_lcmm</span>,</span></span>
<span class="r-in"><span>                     method <span class="op">=</span> <span class="st">"twoStageJoint"</span>,</span></span>
<span class="r-in"><span>                     B <span class="op">=</span> <span class="va">YextNone</span><span class="op">$</span><span class="va">best</span>,</span></span>
<span class="r-in"><span>                     varest<span class="op">=</span> <span class="st">"paramBoot"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">YextBoot</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Cecile Proust-Lima, Viviane Philipps.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

