<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function fits linear mixed models and latent class linear mixed models
(LCLMM) also known as growth mixture models or heterogeneous linear mixed
models.  The LCLMM consists in assuming that the population is divided in a
finite number of latent classes. Each latent class is characterised by a
specific trajectory modelled by a class-specific linear mixed model.  Both
the latent class membership and the trajectory can be explained according to
covariates.  This function is limited to a mixture of Gaussian outcomes. For
other types of outcomes, please see function lcmm. For multivariate
longitudinal outcomes, please see multlcmm."><title>Estimation of latent class linear mixed models — hlme • lcmm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimation of latent class linear mixed models — hlme"><meta property="og:description" content="This function fits linear mixed models and latent class linear mixed models
(LCLMM) also known as growth mixture models or heterogeneous linear mixed
models.  The LCLMM consists in assuming that the population is divided in a
finite number of latent classes. Each latent class is characterised by a
specific trajectory modelled by a class-specific linear mixed model.  Both
the latent class membership and the trajectory can be explained according to
covariates.  This function is limited to a mixture of Gaussian outcomes. For
other types of outcomes, please see function lcmm. For multivariate
longitudinal outcomes, please see multlcmm."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">lcmm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/lcmm.html">GET STARTED</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">VIGNETTES</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/latent_class_model_with_hlme.html">How to estimate a latent class mixed model using hlme function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_lcmm.html">How to estimate a latent process mixed model using lcmm function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm.html">How to estimate a latent process mixed model for multivariate markers using multlcmm function</a>
    <a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm_IRT.html">Continuous-time longitudinal IRT model</a>
    <a class="dropdown-item" href="../articles/joint_latent_class_model_with_Jointlcmm.html">How to estimate a joint latent class mixed model using Jointlcmm function</a>
    <a class="dropdown-item" href="../articles/multivariate_latent_class_model_with_mpjlcmm.html">How to estimate a multivariate latent class mixed model using mpjlcmm function</a>
    <a class="dropdown-item" href="../articles/pre_normalizing.html">Pre-normalizing a dependent variable using lcmm</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/usual_problems.html">FAQ</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">REFERENCE</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">CHANGELOG</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/CecileProust-Lima/lcmm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Estimation of latent class linear mixed models</h1>
      <small class="dont-index">Source: <a href="https://github.com/CecileProust-Lima/lcmm/blob/HEAD/R/hlme.R" class="external-link"><code>R/hlme.R</code></a></small>
      <div class="d-none name"><code>hlme.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function fits linear mixed models and latent class linear mixed models
(LCLMM) also known as growth mixture models or heterogeneous linear mixed
models.  The LCLMM consists in assuming that the population is divided in a
finite number of latent classes. Each latent class is characterised by a
specific trajectory modelled by a class-specific linear mixed model.  Both
the latent class membership and the trajectory can be explained according to
covariates.  This function is limited to a mixture of Gaussian outcomes. For
other types of outcomes, please see function <code>lcmm</code>. For multivariate
longitudinal outcomes, please see <code>multlcmm</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hlme</span><span class="op">(</span></span>
<span>  <span class="va">fixed</span>,</span>
<span>  <span class="va">mixture</span>,</span>
<span>  <span class="va">random</span>,</span>
<span>  <span class="va">subject</span>,</span>
<span>  <span class="va">classmb</span>,</span>
<span>  ng <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  idiag <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nwg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">B</span>,</span>
<span>  convB <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  convL <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  convG <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  <span class="va">prior</span>,</span>
<span>  pprior <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxiter <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.action <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  posfix <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  returndata <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  var.time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  partialH <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nproc <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  clustertype <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>fixed</dt>
<dd><p>two-sided linear formula object for the fixed-effects in the
linear mixed model. The response outcome is on the left of <code>~</code> and the
covariates are separated by <code>+</code> on the right of <code>~</code>.  By default,
an intercept is included. If no intercept, <code>-1</code> should be the first
term included on the right of <code>~</code>.</p></dd>


<dt>mixture</dt>
<dd><p>one-sided formula object for the class-specific fixed effects
in the linear mixed model (to specify only for a number of latent classes
greater than 1).  Among the list of covariates included in <code>fixed</code>, the
covariates with class-specific regression parameters are entered in
<code>mixture</code> separated by <code>+</code>.  By default, an intercept is included.
If no intercept, <code>-1</code> should be the first term included.</p></dd>


<dt>random</dt>
<dd><p>optional one-sided formula for the random-effects in the
linear mixed model. Covariates with a random-effect are separated by
<code>+</code>.  By default, an intercept is included. If no intercept, <code>-1</code>
should be the first term included.</p></dd>


<dt>subject</dt>
<dd><p>name of the covariate representing the grouping structure
specified with ''.</p></dd>


<dt>classmb</dt>
<dd><p>optional one-sided formula describing the covariates in the
class-membership multinomial logistic model. Covariates included are
separated by <code>+</code>. By default, classmb=~1 if ng&gt;1.</p></dd>


<dt>ng</dt>
<dd><p>optional number of latent classes considered. If <code>ng=1</code> (by
default) no <code>mixture</code> nor <code>classmb</code> should be specified. If
<code>ng&gt;1</code>, <code>mixture</code> is required.</p></dd>


<dt>idiag</dt>
<dd><p>optional logical for the structure of the variance-covariance
matrix of the random-effects. If <code>FALSE</code>, a non structured matrix of
variance-covariance is considered (by default).  If <code>TRUE</code> a diagonal
matrix of variance-covariance is considered.</p></dd>


<dt>nwg</dt>
<dd><p>optional logical indicating if the variance-covariance of the
random-effects is class-specific. If <code>FALSE</code> the variance-covariance
matrix is common over latent classes (by default). If <code>TRUE</code> a
class-specific proportional parameter multiplies the variance-covariance
matrix in each class (the proportional parameter in the last latent class
equals 1 to ensure identifiability).</p></dd>


<dt>cor</dt>
<dd><p>optional brownian motion or autoregressive process modeling the
correlation between the observations.  "BM" or "AR" should be specified,
followed by the time variable between brackets. By default, no correlation
is added.</p></dd>


<dt>data</dt>
<dd><p>optional data frame containing the variables named in
<code>fixed</code>, <code>mixture</code>, <code>random</code>, <code>classmb</code> and
<code>subject</code>.</p></dd>


<dt>B</dt>
<dd><p>optional specification for the initial values for the parameters.
Three options are allowed: (1) a vector of initial values is entered (the
order in which the parameters are included is detailed in <code>details</code>
section).  (2) nothing is specified. A preliminary analysis involving the
estimation of a standard linear mixed model is performed to choose initial
values.  (3) when ng&gt;1, a hlme object is entered. It should correspond to
the exact same structure of model but with ng=1. The program will
automatically generate initial values from this model. This specification
avoids the preliminary analysis indicated in (2). Note that due to possible
local maxima, the <code>B</code> vector should be specified and several different
starting points should be tried.</p></dd>


<dt>convB</dt>
<dd><p>optional threshold for the convergence criterion based on the
parameter stability. By default, convB=0.0001.</p></dd>


<dt>convL</dt>
<dd><p>optional threshold for the convergence criterion based on the
log-likelihood stability. By default, convL=0.0001.</p></dd>


<dt>convG</dt>
<dd><p>optional threshold for the convergence criterion based on the
derivatives. By default, convG=0.0001.</p></dd>


<dt>prior</dt>
<dd><p>optional name of a covariate containing a prior information
about the latent class membership. The covariate should be an integer with
values in 0,1,...,ng. Value 0 indicates no prior for the subject while a
value in 1,...,ng indicates that the subject belongs to the corresponding
latent class.</p></dd>


<dt>pprior</dt>
<dd><p>optional vector specifying the names of the covariates containing the
prior probabilities to belong to each latent class. These probabilities should be
between 0 and 1 and should sum up to 1 for each subject.</p></dd>


<dt>maxiter</dt>
<dd><p>optional maximum number of iterations for the Marquardt
iterative algorithm. By default, maxiter=500.</p></dd>


<dt>subset</dt>
<dd><p>a specification of the rows to be used: defaults to all rows.
This can be any valid indexing vector for the rows of data or if that is not
supplied, a data frame made up of the variable used in formula.</p></dd>


<dt>na.action</dt>
<dd><p>Integer indicating how NAs are managed. The default is 1
for 'na.omit'. The alternative is 2 for 'na.fail'. Other options such as
'na.pass' or 'na.exclude' are not implemented in the current version.</p></dd>


<dt>posfix</dt>
<dd><p>Optional vector specifying the indices in vector B of the
parameters that should not be estimated. Default to NULL, all parameters are
estimated.</p></dd>


<dt>verbose</dt>
<dd><p>logical indicating if information about computation should be
reported. Default to TRUE.</p></dd>


<dt>returndata</dt>
<dd><p>logical indicating if data used for computation should be
returned. Default to FALSE, data are not returned.</p></dd>


<dt>var.time</dt>
<dd><p>optional character indicating the name of the time variable.</p></dd>


<dt>partialH</dt>
<dd><p>optional logical indicating if parameters can be dropped from the
Hessian matrix to define convergence criteria.</p></dd>


<dt>nproc</dt>
<dd><p>the number cores for parallel computation.
Default to 1 (sequential mode).</p></dd>


<dt>clustertype</dt>
<dd><p>optional character indicating the type of cluster for parallel computation.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The list returned is:</p>
<dl><dt>ns</dt>
<dd><p>number of grouping units in the dataset</p></dd>

<dt>ng</dt>
<dd><p>number of latent classes</p></dd>

<dt>loglik</dt>
<dd><p>log-likelihood of the model</p></dd>
</dl><p>\
itembestvector of parameter estimates in the same order as
specified in <code>B</code> and detailed in section <code>details</code></p>
<dl><dt>V</dt>
<dd><p>if the model converged (conv=1 or 3), vector containing the upper triangle
matrix of variance-covariance estimates of <code>Best</code> with exception for
variance-covariance parameters of the random-effects for which <code>V</code> contains
the variance-covariance estimates of the Cholesky transformed parameters displayed in
<code>cholesky</code>.
If conv=2, <code>V</code> contains the second derivatives of the log-likelihood.</p></dd>

<dt>gconv</dt>
<dd><p>vector of convergence criteria: 1. on the parameters, 2. on the
likelihood, 3. on the derivatives</p></dd>

<dt>conv</dt>
<dd><p>status of convergence: =1 if the convergence criteria were satisfied,
=2 if the maximum number of iterations was reached, =3 if the convergence criteria were
satisfied with a partial Hessian matrix, =4 or 5 if a problem occured
during optimisation</p></dd>

<dt>call</dt>
<dd><p>the matched call</p></dd>

<dt>niter</dt>
<dd><p>number of Marquardt iterations</p></dd>

<dt>N</dt>
<dd><p>internal information used in related functions</p></dd>

<dt>idiag</dt>
<dd><p>internal information used in related functions</p></dd>

<dt>pred</dt>
<dd><p>table of individual predictions and residuals; it
includes marginal predictions (pred_m), marginal residuals (resid_m),
subject-specific predictions (pred_ss) and subject-specific residuals
(resid_ss) averaged over classes, the observation (obs) and finally the
class-specific marginal and subject-specific predictions (with the number of
the latent class: pred_m_1,pred_m_2,...,pred_ss_1,pred_ss_2,...). If <code>var.time</code>
is specified, the corresponding measurement time is also included.</p></dd>

<dt>pprob</dt>
<dd><p>table of posterior classification and posterior individual
class-membership probabilities</p></dd>

<dt>Xnames</dt>
<dd><p>list of covariates included in the model</p></dd>
 
<dt>predRE</dt>
<dd><p>table containing individual predictions of the random-effects
: a column per random-effect, a line per subject</p></dd>

<dt>cholesky</dt>
<dd><p>vector containing the estimates of the Cholesky transformed
parameters of the variance-covariance matrix of the random-effects</p></dd>

<dt>data</dt>
<dd><p>the original data set (if returndata is TRUE)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>A. THE VECTOR OF PARAMETERS B</p>
<p>The parameters in the vector of initial values <code>B</code> or equivalently in
the vector of maximum likelihood estimates <code>best</code> are included in the
following order:</p>
<p>(1) ng-1 parameters are required for intercepts in the latent class
membership model, and when covariates are included in <code>classmb</code>, ng-1
paramaters should be entered for each covariate;</p>
<p>(2) for all covariates in <code>fixed</code>, one parameter is required if the
covariate is not in <code>mixture</code>, ng paramaters are required if the
covariate is also in <code>mixture</code>;</p>
<p>(3) the variance of each random-effect specified in <code>random</code> (including
the intercept) when <code>idiag=TRUE</code>, or the inferior triangular
variance-covariance matrix of all the random-effects when
<code>idiag=FALSE</code>;</p>
<p>(4) only when <code>nwg=TRUE</code>, ng-1 parameters are required for the ng-1
class-specific proportional coefficients in the variance covariance matrix
of the random-effects;</p>
<p>(5) when <code>cor</code> is specified, 1 parameter corresponding to the variance
of the Brownian motion should be entered with <code>cor=BM</code> and 2 parameters
corresponding to the correlation and the variance parameters of the
autoregressive process should be entered</p>
<p>(6) the standard error of the residual error.</p>
<p>B. CAUTIONS</p>
<p>Some caution should be made when using the program:</p>
<p>(1) As the log-likelihood of a latent class model can have multiple maxima,
a careful choice of the initial values is crucial for ensuring convergence
toward the global maximum.  The program can be run without entering the
vector of initial values (see point 2).  However, we recommend to
systematically enter initial values in <code>B</code> and try different sets of
initial values.</p>
<p>(2) The automatic choice of initial values we provide requires the
estimation of a preliminary linear mixed model. The user should be aware
that first, this preliminary analysis can take time for large datatsets and
second, that the generated initial values can be very not likely and even
may converge slowly to a local maximum.  This is the reason why several
alternatives exist. The vector of initial values can be directly specified
in <code>B</code> the initial values can be generated (automatically or randomly)
from a model with <code>ng=</code>. Finally, function <code>gridsearch</code> performs
an automatic grid search.</p>
<p>(3) Convergence criteria are very strict as they are based on the
derivatives of the log-likelihood in addition to the parameter stability and
log-likelihood stability.  In some cases, the program may not converge and
reach the maximum number of iterations fixed at 100.  In this case, the user
should check that parameter estimates at the last iteration are not on the
boundaries of the parameter space.  If the parameters are on the boundaries
of the parameter space, the identifiability of the model is critical. This
may happen especially with splines parameters that may be too close to 0
(lower boundary) or classmb parameters that are too high or low (perfect
classification). When identifiability of some parameters is suspected, the
program can be run again from the former estimates by fixing the suspected
parameters to their value with option posfix. This usually solves the
problem. An alternative is to remove the parameters of the Beta of Splines
link function from the inverse of the Hessian with option partialH.  If not,
the program should be run again with other initial values, with a higher
maximum number of iterations or less strict convergence tolerances.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Proust-Lima C, Philipps V, Liquet B (2017). Estimation of Extended Mixed 
Models Using Latent Classes and Latent Processes: The R Package lcmm. 
Journal of Statistical Software, 78(2), 1-56. doi:10.18637/jss.v078.i02</p>
<p>Verbeke G and Lesaffre E (1996). A linear mixed-effects model with
heterogeneity in the random-effects population. Journal of the American
Statistical Association 91, 217-21</p>
<p>Muthen B and Shedden K (1999). Finite mixture modeling with mixture outcomes
using the EM algorithm. Biometrics 55, 463-9</p>
<p>Proust C and Jacqmin-Gadda H (2005). Estimation of linear mixed models with
a mixture of distribution for the random-effects. Computer Methods Programs
Biomedicine 78, 165-73</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="postprob.html">postprob</a></code>, <code><a href="plot.html">plot.hlme</a></code>,
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></code>, <code><a href="predictY.html">predictY</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Cecile Proust-Lima, Benoit Liquet and Viviane Philipps</p>
<p><a href="mailto:cecile.proust-lima@inserm.fr">cecile.proust-lima@inserm.fr</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##### Example of a latent class model estimated for a varying number</span></span></span>
<span class="r-in"><span><span class="co"># of latent classes: </span></span></span>
<span class="r-in"><span><span class="co"># The model includes a subject- (ID) and class-specific linear </span></span></span>
<span class="r-in"><span><span class="co"># trend (intercept and Time in fixed, random and mixture components)</span></span></span>
<span class="r-in"><span><span class="co"># and a common effect of X1 and its interaction with time over classes </span></span></span>
<span class="r-in"><span><span class="co"># (in fixed). </span></span></span>
<span class="r-in"><span><span class="co"># The variance of the random intercept and slope are assumed to be equal </span></span></span>
<span class="r-in"><span><span class="co"># over classes (nwg=F).</span></span></span>
<span class="r-in"><span><span class="co"># The covariate X3 predicts the class membership (in classmb).</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># !CAUTION: initialization of mixed models with latent classes is </span></span></span>
<span class="r-in"><span><span class="co"># of most importance because of the problem of multimodality of the likelihood.</span></span></span>
<span class="r-in"><span><span class="co"># Calls m2a-m2d illustrate the different implementations for the </span></span></span>
<span class="r-in"><span><span class="co"># initial values.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### homogeneous linear mixed model (standard linear mixed model) </span></span></span>
<span class="r-in"><span><span class="co">### with correlated random-effects</span></span></span>
<span class="r-in"><span><span class="va">m1</span><span class="op">&lt;-</span><span class="fu">hlme</span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">Time</span><span class="op">*</span><span class="va">X1</span>,random<span class="op">=</span><span class="op">~</span><span class="va">Time</span>,subject<span class="op">=</span><span class="st">'ID'</span>,ng<span class="op">=</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">data_hlme</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Heterogenous linear mixed model </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      fitted by maximum likelihood method </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hlme(fixed = Y ~ Time * X1, random = ~Time, subject = "ID", ng = 1, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = data_hlme)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Statistical Model: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Dataset: data_hlme </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Number of subjects: 100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Number of observations: 326 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Number of latent classes: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Number of parameters: 8  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration process: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Convergence criteria satisfied </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Number of iterations:  10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Convergence criteria: parameters= 5e-10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          : likelihood= 1.4e-09 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          : second derivatives= 1.3e-16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit statistics: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      maximum log-likelihood: -790.51  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      AIC: 1597.02  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      BIC: 1617.86  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum Likelihood Estimates: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fixed effects in the longitudinal model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               coef      Se   Wald p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intercept 25.86093 0.77175 33.509 0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time      -0.32877 0.17121 -1.920 0.05482</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1         1.69460 1.00508  1.686 0.09179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time:X1   -0.39408 0.22293 -1.768 0.07710</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variance-covariance matrix of the random-effects:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           intercept    Time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intercept  23.13781        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time        2.79713 1.10558</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              coef      Se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error:  0.96892 0.06095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### latent class linear mixed model with 2 classes</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># a. automatic specification from G=1 model estimates:</span></span></span>
<span class="r-in"><span><span class="va">m2a</span><span class="op">&lt;-</span><span class="fu">hlme</span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">Time</span><span class="op">*</span><span class="va">X1</span>,mixture<span class="op">=</span><span class="op">~</span><span class="va">Time</span>,random<span class="op">=</span><span class="op">~</span><span class="va">Time</span>,classmb<span class="op">=</span><span class="op">~</span><span class="va">X2</span><span class="op">+</span><span class="va">X3</span>,subject<span class="op">=</span><span class="st">'ID'</span>,</span></span>
<span class="r-in"><span>         ng<span class="op">=</span><span class="fl">2</span>,data<span class="op">=</span><span class="va">data_hlme</span>,B<span class="op">=</span><span class="va">m1</span><span class="op">)</span></span></span>
<span class="r-in"><span>         </span></span>
<span class="r-in"><span><span class="co"># b. vector of initial values provided by the user:</span></span></span>
<span class="r-in"><span><span class="va">m2b</span><span class="op">&lt;-</span><span class="fu">hlme</span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">Time</span><span class="op">*</span><span class="va">X1</span>,mixture<span class="op">=</span><span class="op">~</span><span class="va">Time</span>,random<span class="op">=</span><span class="op">~</span><span class="va">Time</span>,classmb<span class="op">=</span><span class="op">~</span><span class="va">X2</span><span class="op">+</span><span class="va">X3</span>,subject<span class="op">=</span><span class="st">'ID'</span>,</span></span>
<span class="r-in"><span>         ng<span class="op">=</span><span class="fl">2</span>,data<span class="op">=</span><span class="va">data_hlme</span>,B<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.11</span>,<span class="op">-</span><span class="fl">0.74</span>,<span class="op">-</span><span class="fl">0.07</span>,<span class="fl">20.71</span>,</span></span>
<span class="r-in"><span>                                 <span class="fl">29.39</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">0.13</span>,<span class="fl">2.45</span>,<span class="op">-</span><span class="fl">0.29</span>,<span class="fl">4.5</span>,<span class="fl">0.36</span>,<span class="fl">0.79</span>,<span class="fl">0.97</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># c. random draws from G = 1 model estimates:</span></span></span>
<span class="r-in"><span><span class="va">m2c</span><span class="op">&lt;-</span><span class="fu">hlme</span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">Time</span><span class="op">*</span><span class="va">X1</span>,mixture<span class="op">=</span><span class="op">~</span><span class="va">Time</span>,random<span class="op">=</span><span class="op">~</span><span class="va">Time</span>,classmb<span class="op">=</span><span class="op">~</span><span class="va">X2</span><span class="op">+</span><span class="va">X3</span>,subject<span class="op">=</span><span class="st">'ID'</span>,</span></span>
<span class="r-in"><span>          ng<span class="op">=</span><span class="fl">2</span>,data<span class="op">=</span><span class="va">data_hlme</span>,B<span class="op">=</span><span class="fu">random</span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(cl$B[[2]], parent.env(environment())):</span> object 'm1' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># d. gridsearch with 50 departures and 10 iterations of the algorithm </span></span></span>
<span class="r-in"><span><span class="co">#     (see function gridsearch for details)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">m2d</span> <span class="op">&lt;-</span> <span class="fu"><a href="gridsearch.html">gridsearch</a></span><span class="op">(</span>rep <span class="op">=</span> <span class="fl">50</span>, maxiter <span class="op">=</span> <span class="fl">10</span>, minit <span class="op">=</span> <span class="va">m1</span>, <span class="fu">hlme</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">*</span> <span class="va">X1</span>, </span></span>
<span class="r-in"><span>mixture <span class="op">=</span><span class="op">~</span> <span class="va">Time</span>, random <span class="op">=</span><span class="op">~</span> <span class="va">Time</span>, classmb <span class="op">=</span><span class="op">~</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span>, subject <span class="op">=</span> <span class="st">'ID'</span>, ng <span class="op">=</span> <span class="fl">2</span>, </span></span>
<span class="r-in"><span>data <span class="op">=</span> <span class="va">data_hlme</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span>  </span></span>
<span class="r-in"><span>          </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># summary of the estimation process</span></span></span>
<span class="r-in"><span><span class="fu"><a href="summarytable.html">summarytable</a></span><span class="op">(</span><span class="va">m1</span>, <span class="va">m2a</span>, <span class="va">m2b</span>, <span class="va">m2c</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in summarytable(m1, m2a, m2b, m2c):</span> object 'm2c' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># summary of m2a</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2a</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Heterogenous linear mixed model </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      fitted by maximum likelihood method </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hlme(fixed = Y ~ Time * X1, mixture = ~Time, random = ~Time, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     subject = "ID", classmb = ~X2 + X3, ng = 2, data = data_hlme)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Statistical Model: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Dataset: data_hlme </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Number of subjects: 100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Number of observations: 326 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Number of latent classes: 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Number of parameters: 13  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration process: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Convergence criteria satisfied </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Number of iterations:  21 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Convergence criteria: parameters= 3.9e-05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          : likelihood= 3.4e-05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          : second derivatives= 1.6e-10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit statistics: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      maximum log-likelihood: -773.82  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      AIC: 1573.64  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      BIC: 1607.51  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum Likelihood Estimates: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fixed effects in the class-membership model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (the class of reference is the last class) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      coef      Se   Wald p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intercept class1  0.10518 0.33392  0.315 0.75276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2 class1        -0.73939 0.48976 -1.510 0.13112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3 class1        -0.06818 0.19282 -0.354 0.72364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fixed effects in the longitudinal model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      coef      Se   Wald p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intercept class1 20.70606 0.64002 32.352 0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intercept class2 29.39253 0.54893 53.546 0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time class1      -1.00426 0.19584 -5.128 0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time class2       0.13102 0.17259  0.759 0.44778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1                2.45174 0.64546  3.798 0.00015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time:X1          -0.28770 0.20015 -1.437 0.15060</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variance-covariance matrix of the random-effects:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           intercept    Time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intercept   4.50085        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time        0.35984 0.79338</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              coef      Se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error:  0.96808 0.06065</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># posterior classification</span></span></span>
<span class="r-in"><span><span class="fu"><a href="postprob.html">postprob</a></span><span class="op">(</span><span class="va">m2a</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Posterior classification: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   class1 class2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> N     46     54</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> %     46     54</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Posterior classification table: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      --&gt; mean of posterior probabilities in each class </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         prob1  prob2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class1 0.9588 0.0412</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class2 0.0325 0.9675</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Posterior probabilities above a threshold (%): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          class1 class2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> prob&gt;0.7  93.48 100.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> prob&gt;0.8  93.48  92.59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> prob&gt;0.9  86.96  83.33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot of predicted trajectories using some newdata</span></span></span>
<span class="r-in"><span><span class="va">newdata</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span>,length<span class="op">=</span><span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>X1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span>,X2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span>,X3<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="predictY.html">predictY</a></span><span class="op">(</span><span class="va">m2a</span>,<span class="va">newdata</span>,var.time<span class="op">=</span><span class="st">"Time"</span><span class="op">)</span>,legend.loc<span class="op">=</span><span class="st">"right"</span>,bty<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="hlme-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Cecile Proust-Lima, Viviane Philipps.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

