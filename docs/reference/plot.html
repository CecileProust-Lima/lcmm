<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot of a fitted model — plot • lcmm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot of a fitted model — plot"><meta name="description" content="This function produces different plots (residuals, goodness-of-fit,
estimated link functions, estimated baseline risk/survival and posterior
probabilities distributions) of a fitted object of class hlme, lcmm,
multlcmm or Jointlcmm."><meta property="og:description" content="This function produces different plots (residuals, goodness-of-fit,
estimated link functions, estimated baseline risk/survival and posterior
probabilities distributions) of a fitted object of class hlme, lcmm,
multlcmm or Jointlcmm."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lcmm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/lcmm.html">GET STARTED</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">VIGNETTES</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/latent_class_model_with_hlme.html">How to estimate a latent class mixed model using hlme function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_lcmm.html">How to estimate a latent process mixed model using lcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm.html">How to estimate a latent process mixed model for multivariate markers using multlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/latent_process_model_with_multlcmm_IRT.html">Continuous-time longitudinal IRT model</a></li>
    <li><a class="dropdown-item" href="../articles/joint_latent_class_model_with_Jointlcmm.html">How to estimate a joint latent class mixed model using Jointlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/multivariate_latent_class_model_with_mpjlcmm.html">How to estimate a multivariate latent class mixed model using mpjlcmm function</a></li>
    <li><a class="dropdown-item" href="../articles/secondary_model_with_externVar.html">Accounting for latent class assignment uncertainty in subsequent analyses</a></li>
    <li><a class="dropdown-item" href="../articles/pre_normalizing.html">Pre-normalizing a dependent variable using lcmm</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/usual_problems.html">FAQ</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">REFERENCE</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">CHANGELOG</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CecileProust-Lima/lcmm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot of a fitted model</h1>
      <small class="dont-index">Source: <a href="https://github.com/CecileProust-Lima/lcmm/blob/HEAD/R/plot.R" class="external-link"><code>R/plot.R</code></a></small>
      <div class="d-none name"><code>plot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function produces different plots (residuals, goodness-of-fit,
estimated link functions, estimated baseline risk/survival and posterior
probabilities distributions) of a fitted object of class hlme, lcmm,
multlcmm or Jointlcmm.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'hlme'</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">x</span>, which <span class="op">=</span> <span class="st">"residuals"</span>, <span class="va">var.time</span>, <span class="va">break.times</span>, <span class="va">marg</span>, <span class="va">subset</span>, <span class="va">shades</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'lcmm'</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">x</span>, which <span class="op">=</span> <span class="st">"residuals"</span>, <span class="va">var.time</span>, <span class="va">break.times</span>, <span class="va">marg</span>, <span class="va">subset</span>, <span class="va">shades</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'multlcmm'</span></span>
<span><span class="fu">plot</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  which <span class="op">=</span> <span class="st">"residuals"</span>,</span>
<span>  <span class="va">var.time</span>,</span>
<span>  <span class="va">break.times</span>,</span>
<span>  <span class="va">marg</span>,</span>
<span>  <span class="va">outcome</span>,</span>
<span>  <span class="va">subset</span>,</span>
<span>  <span class="va">shades</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'Jointlcmm'</span></span>
<span><span class="fu">plot</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  which <span class="op">=</span> <span class="st">"residuals"</span>,</span>
<span>  <span class="va">var.time</span>,</span>
<span>  <span class="va">break.times</span>,</span>
<span>  <span class="va">marg</span>,</span>
<span>  <span class="va">event</span>,</span>
<span>  <span class="va">subset</span>,</span>
<span>  <span class="va">shades</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'mpjlcmm'</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">x</span>, <span class="va">which</span>, <span class="va">event</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'externSurv'</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">x</span>, which <span class="op">=</span> <span class="st">"hazard"</span>, <span class="va">event</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'externX'</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">x</span>, which <span class="op">=</span> <span class="st">"postprob"</span>, <span class="va">event</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an object inheriting from classes <code>hlme</code>, <code>lcmm</code>,
<code>multlcmm</code> or <code>Jointlcmm</code>, representing respectively a fitted
latent class linear mixed model, a more general latent class mixed model or
a joint latent class model</p></dd>


<dt id="arg-which">which<a class="anchor" aria-label="anchor" href="#arg-which"></a></dt>
<dd><p>a character string indicating the type of plot to produce. For
<code>hlme</code> objects, are available "residuals", "postprob","fit". For
<code>lcmm</code> and <code>multlcmm</code> objects, are available "residuals",
"postprob", "link", "linkfunction", "fit".  For <code>Jointlcmm</code> objects,
are avaiable "residuals", "postprob", "link", "linkfunction", "fit",
"hazard", "baselinerisk", "survival". Default to "residuals"</p></dd>


<dt id="arg-var-time">var.time<a class="anchor" aria-label="anchor" href="#arg-var-time"></a></dt>
<dd><p>for <code>which="fit"</code> only, a character string containing
the name of the variable that corresponds to time in the longitudinal model.</p></dd>


<dt id="arg-break-times">break.times<a class="anchor" aria-label="anchor" href="#arg-break-times"></a></dt>
<dd><p>for <code>which="fit"</code> only, either a numeric vector
containing the cuts-off defining the time-intervals or an integer giving the
number of cut-offs. In the latter case, the cut-offs are placed at the
quantiles of the observed times distribution.</p></dd>


<dt id="arg-marg">marg<a class="anchor" aria-label="anchor" href="#arg-marg"></a></dt>
<dd><p>for <code>which="fit"</code> only, a logical indicating the type of
prediction. If <code>marg=TRUE</code> (the default), the marginal predictions are
provided. If <code>marg=FALSE</code>, the subject-specific predictions are
provided.</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>for <code>which="fit"</code> only, a subset of the data used to
estimate the model, defining the data on which the fit is evaluated. By
default, all the data are used.</p></dd>


<dt id="arg-shades">shades<a class="anchor" aria-label="anchor" href="#arg-shades"></a></dt>
<dd><p>logical indicating if confidence intervals should be
represented with shades. Default to FALSE, confidence intervals are
represented as dotted lines.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>other parameters to be passed through to plotting functions.
This includes graphical parameters described in par function and further arguments
legend (character or expression
to appear in the legend. If no legend should be added, <code>"legend"</code>
should be NULL. ),
legend.loc (keyword for the position of the legend from the list
<code>"bottomright"</code>, <code>"bottom"</code>, <code>"bottomleft"</code>,
<code>"left"</code>, <code>"topleft"</code>,<code>"top"</code>, <code>"topright"</code>,
<code>"right"</code> and <code>"center"</code>. By default, the legend is located in
the top left of the plot. ) and
add (logical indicating if the curves
should be added to an existing plot. Default to FALSE.).</p></dd>


<dt id="arg-outcome">outcome<a class="anchor" aria-label="anchor" href="#arg-outcome"></a></dt>
<dd><p>for <code>which="fit"</code> and <code>multlcmm</code> objects only, the
outcome to consider.</p></dd>


<dt id="arg-event">event<a class="anchor" aria-label="anchor" href="#arg-event"></a></dt>
<dd><p>for <code>which="baselinerisk"</code> or <code>which="hazard"</code> only,
an integer corresponding to the numeric code (in the indicator variable) of
the event for which the baseline risk functions are to be plotted. By
default, the first event is considered.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>With <code>which="residuals"</code>, this function provides the marginal residuals
against the marginal predictions, the subject-specific residuals against the
subject-specific predictions, a normal QQ-plot with confidence bands for the
marginal residuals and a normal QQ-plot with confidence bands for the
subject-specific residuals.</p>
<p>With <code>which="postprob"</code>, the function provides the histograms of the
posterior class-membership probabilities stemmed from a <code>Jointlcmm</code>,
<code>lcmm</code>, <code>hlme</code> or <code>multlcmm</code> object.</p>
<p>With <code>which="link"</code> or <code>which="linkfunction"</code>, the function
displays the estimated transformation(s) specified in the option <code>link</code>
of <code>lcmm</code> and <code>multlcmm</code> functions. It corresponds to the
(non)linear parameterized link estimated between the oberved longitudinal
outcome and the underlying latent process.</p>
<p>With <code>which="fit"</code>, the function provides the class-specific weighted
marginal and subject-specific mean predicted trajectories with time and the
class-specific weighted mean observed trajectories and their 95% confidence
bounds. The predicted and observed class-specific values are weighted means
within each time interval; For each observation or prediction (in the
transformed scale if appropriate), the weights are the class-specific
(posterior with subject-specific or marginal otherwise) probabilities to
belong to the latent class.</p>
<p>With <code>which="baselinerisk"</code> or <code>which="hazard"</code>, the function
displays the estimated baseline risk functions for the time-to-event of
interest in each latent class.</p>
<p>With <code>which="survival"</code>, the function displays the estimated event-free
probabilities (survival functions) for the time-to-event of interest in each
latent class.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="hlme.html">hlme</a></code>, <code><a href="lcmm.html">lcmm</a></code>, <code><a href="multlcmm.html">multlcmm</a></code>,
<code><a href="Jointlcmm.html">Jointlcmm</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Cecile Proust-Lima, Viviane Philipps and Benoit Liquet</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###################### fit, residuals and postprob </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimation of the model</span></span></span>
<span class="r-in"><span><span class="va">m</span><span class="op">&lt;-</span><span class="fu"><a href="lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">Time</span><span class="op">*</span><span class="va">X1</span>,mixture<span class="op">=</span><span class="op">~</span><span class="va">Time</span>,random<span class="op">=</span><span class="op">~</span><span class="va">Time</span>,classmb<span class="op">=</span><span class="op">~</span><span class="va">X2</span><span class="op">+</span><span class="va">X3</span>,</span></span>
<span class="r-in"><span>subject<span class="op">=</span><span class="st">'ID'</span>,ng<span class="op">=</span><span class="fl">2</span>,data<span class="op">=</span><span class="va">data_hlme</span>,B<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.41</span>,<span class="fl">0.55</span>,<span class="op">-</span><span class="fl">0.18</span>,<span class="op">-</span><span class="fl">0.41</span>,</span></span>
<span class="r-in"><span><span class="op">-</span><span class="fl">14.26</span>,<span class="op">-</span><span class="fl">0.34</span>,<span class="fl">1.33</span>,<span class="fl">13.51</span>,<span class="fl">24.65</span>,<span class="fl">2.98</span>,<span class="fl">1.18</span>,<span class="fl">26.26</span>,<span class="fl">0.97</span><span class="op">)</span><span class="op">)</span>  </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit</span></span></span>
<span class="r-in"><span><span class="fu">plot</span><span class="op">(</span><span class="va">m</span>,which<span class="op">=</span><span class="st">"fit"</span>,marg<span class="op">=</span><span class="cn">FALSE</span>,var.time<span class="op">=</span><span class="st">"Time"</span>,bty<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># residuals plot</span></span></span>
<span class="r-in"><span><span class="fu">plot</span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># postprob plot</span></span></span>
<span class="r-in"><span><span class="fu">plot</span><span class="op">(</span><span class="va">m</span>,which<span class="op">=</span><span class="st">"postprob"</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="plot-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###################### fit, linkfunctions</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Estimation of homogeneous mixed models with different assumed link</span></span></span>
<span class="r-in"><span><span class="co">#### functions, a quadratic mean trajectory for the latent process with </span></span></span>
<span class="r-in"><span><span class="co">#### independent random intercept, slope and quadratic slope</span></span></span>
<span class="r-in"><span><span class="co">#### (comparison of linear, Beta and 3 and 5 splines link functions)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># linear link function</span></span></span>
<span class="r-in"><span><span class="va">m10</span><span class="op">&lt;-</span><span class="fu"><a href="lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">Ydep2</span><span class="op">~</span><span class="va">Time</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">Time</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,random<span class="op">=</span><span class="op">~</span><span class="va">Time</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">Time</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,subject<span class="op">=</span><span class="st">'ID'</span>,ng<span class="op">=</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>          data<span class="op">=</span><span class="va">data_lcmm</span>,link<span class="op">=</span><span class="st">"linear"</span>,</span></span>
<span class="r-in"><span>          B<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.7454</span>, <span class="op">-</span><span class="fl">0.2031</span>,  <span class="fl">0.2715</span>,  <span class="fl">0.2916</span> , <span class="fl">0.6114</span>, <span class="op">-</span><span class="fl">0.0064</span>,  <span class="fl">0.0545</span>,</span></span>
<span class="r-in"><span>              <span class="fl">0.0128</span>, <span class="fl">25.3795</span>, <span class="fl">2.2371</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>            </span></span>
<span class="r-in"><span><span class="co"># Beta link function</span></span></span>
<span class="r-in"><span><span class="va">m11</span><span class="op">&lt;-</span><span class="fu"><a href="lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">Ydep2</span><span class="op">~</span><span class="va">Time</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">Time</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,random<span class="op">=</span><span class="op">~</span><span class="va">Time</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">Time</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,subject<span class="op">=</span><span class="st">'ID'</span>,ng<span class="op">=</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>          data<span class="op">=</span><span class="va">data_lcmm</span>,link<span class="op">=</span><span class="st">"beta"</span>,B<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.9109</span>, <span class="op">-</span><span class="fl">0.0831</span>,  <span class="fl">0.5194</span>,  <span class="fl">0.1910</span> ,</span></span>
<span class="r-in"><span>          <span class="fl">0.8984</span>, <span class="op">-</span><span class="fl">0.0179</span>, <span class="op">-</span><span class="fl">0.0636</span>,  <span class="fl">0.0045</span>,  <span class="fl">0.5514</span>, <span class="op">-</span><span class="fl">0.7692</span>,  <span class="fl">0.7037</span>,  <span class="fl">0.0899</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>          </span></span>
<span class="r-in"><span><span class="co"># fit </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot</span><span class="op">(</span><span class="va">m11</span>,which<span class="op">=</span><span class="st">"fit"</span>,var.time<span class="op">=</span><span class="st">"Time"</span>,bty<span class="op">=</span><span class="st">"l"</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot</span><span class="op">(</span><span class="va">m11</span>,which<span class="op">=</span><span class="st">"fit"</span>,var.time<span class="op">=</span><span class="st">"Time"</span>,marg<span class="op">=</span><span class="cn">FALSE</span>,bty<span class="op">=</span><span class="st">"l"</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># I-splines with 3 equidistant nodes</span></span></span>
<span class="r-in"><span><span class="va">m12</span><span class="op">&lt;-</span><span class="fu"><a href="lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">Ydep2</span><span class="op">~</span><span class="va">Time</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">Time</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,random<span class="op">=</span><span class="op">~</span><span class="va">Time</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">Time</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,subject<span class="op">=</span><span class="st">'ID'</span>,ng<span class="op">=</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>          data<span class="op">=</span><span class="va">data_lcmm</span>,link<span class="op">=</span><span class="st">"3-equi-splines"</span>,B<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.9272</span>, <span class="op">-</span><span class="fl">0.0753</span> , <span class="fl">0.5304</span>, </span></span>
<span class="r-in"><span>          <span class="fl">0.1950</span>,  <span class="fl">0.9260</span>, <span class="op">-</span><span class="fl">0.0204</span>, <span class="op">-</span><span class="fl">0.0739</span> , <span class="fl">0.0059</span>, <span class="op">-</span><span class="fl">7.8369</span>,  <span class="fl">0.9228</span> ,<span class="op">-</span><span class="fl">1.4689</span>,</span></span>
<span class="r-in"><span>          <span class="fl">2.0396</span>,  <span class="fl">1.8102</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># I-splines with 5 nodes, and interior nodes entered manually</span></span></span>
<span class="r-in"><span><span class="va">m13</span><span class="op">&lt;-</span><span class="fu"><a href="lcmm.html">lcmm</a></span><span class="op">(</span><span class="va">Ydep2</span><span class="op">~</span><span class="va">Time</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">Time</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,random<span class="op">=</span><span class="op">~</span><span class="va">Time</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">Time</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,subject<span class="op">=</span><span class="st">'ID'</span>,ng<span class="op">=</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>          data<span class="op">=</span><span class="va">data_lcmm</span>,link<span class="op">=</span><span class="st">"5-manual-splines"</span>,intnodes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">25</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          B<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.9315</span>, <span class="op">-</span><span class="fl">0.0739</span> , <span class="fl">0.5254</span> , <span class="fl">0.1933</span>,  <span class="fl">0.9418</span>, <span class="op">-</span><span class="fl">0.0206</span>, <span class="op">-</span><span class="fl">0.0776</span>,</span></span>
<span class="r-in"><span>          <span class="fl">0.0064</span>, <span class="op">-</span><span class="fl">7.8645</span>, <span class="fl">0.7470</span>,  <span class="fl">1.2080</span>,  <span class="fl">1.5537</span> , <span class="fl">1.7558</span> , <span class="fl">1.3386</span> , <span class="fl">1.0982</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot of estimated different link functions:</span></span></span>
<span class="r-in"><span><span class="co"># (applicable for models that only differ in the "link function" used. </span></span></span>
<span class="r-in"><span><span class="co"># Otherwise, the latent process scale is different and a rescaling</span></span></span>
<span class="r-in"><span><span class="co"># is necessary)</span></span></span>
<span class="r-in"><span><span class="fu">plot</span><span class="op">(</span><span class="va">m10</span>,which<span class="op">=</span><span class="st">"linkfunction"</span>,bty<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot</span><span class="op">(</span><span class="va">m11</span>,which<span class="op">=</span><span class="st">"linkfunction"</span>,bty<span class="op">=</span><span class="st">"l"</span>,add<span class="op">=</span><span class="cn">TRUE</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot</span><span class="op">(</span><span class="va">m12</span>,which<span class="op">=</span><span class="st">"linkfunction"</span>,bty<span class="op">=</span><span class="st">"l"</span>,add<span class="op">=</span><span class="cn">TRUE</span>,col<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot</span><span class="op">(</span><span class="va">m13</span>,which<span class="op">=</span><span class="st">"linkfunction"</span>,bty<span class="op">=</span><span class="st">"l"</span>,add<span class="op">=</span><span class="cn">TRUE</span>,col<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linear"</span>,<span class="st">"beta"</span>,<span class="st">"3-Isplines"</span>,<span class="st">"5-Isplines"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>col<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,lty<span class="op">=</span><span class="fl">1</span>,bty<span class="op">=</span><span class="st">'n'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###################### fit, baselinerisk and survival</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">#### estimation with 3 latent classes (ng=3) - see Jointlcmm </span></span></span>
<span class="r-in"><span><span class="co">#### help for details on the model</span></span></span>
<span class="r-in"><span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="Jointlcmm.html">Jointlcmm</a></span><span class="op">(</span>fixed<span class="op">=</span> <span class="va">Ydep1</span><span class="op">~</span><span class="va">Time</span><span class="op">*</span><span class="va">X1</span>,mixture<span class="op">=</span><span class="op">~</span><span class="va">Time</span>,random<span class="op">=</span><span class="op">~</span><span class="va">Time</span>,</span></span>
<span class="r-in"><span>classmb<span class="op">=</span><span class="op">~</span><span class="va">X3</span>,subject<span class="op">=</span><span class="st">'ID'</span>,survival <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">Tevent</span>,<span class="va">Event</span><span class="op">)</span><span class="op">~</span> <span class="va">X1</span><span class="op">+</span><span class="fu"><a href="ForInternalUse.html">mixture</a></span><span class="op">(</span><span class="va">X2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>hazard<span class="op">=</span><span class="st">"3-quant-splines"</span>,hazardtype<span class="op">=</span><span class="st">"PH"</span>,ng<span class="op">=</span><span class="fl">3</span>,data<span class="op">=</span><span class="va">data_lcmm</span>,</span></span>
<span class="r-in"><span>B<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7576</span>, <span class="fl">0.4095</span>, <span class="op">-</span><span class="fl">0.8232</span>, <span class="op">-</span><span class="fl">0.2737</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.2838</span>, <span class="op">-</span><span class="fl">0.6338</span>, </span></span>
<span class="r-in"><span><span class="fl">2.6324</span>, <span class="fl">5.3963</span>, <span class="op">-</span><span class="fl">0.0273</span>, <span class="fl">1.3979</span>, <span class="fl">0.8168</span>, <span class="op">-</span><span class="fl">15.041</span>, <span class="fl">10.164</span>, <span class="fl">10.2394</span>, </span></span>
<span class="r-in"><span><span class="fl">11.5109</span>, <span class="op">-</span><span class="fl">2.6219</span>, <span class="op">-</span><span class="fl">0.4553</span>, <span class="op">-</span><span class="fl">0.6055</span>, <span class="fl">1.473</span>, <span class="op">-</span><span class="fl">0.0383</span>, <span class="fl">0.8512</span>, <span class="fl">0.0389</span>, </span></span>
<span class="r-in"><span><span class="fl">0.2624</span>, <span class="fl">1.4982</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit</span></span></span>
<span class="r-in"><span><span class="fu">plot</span><span class="op">(</span><span class="va">m3</span>,which<span class="op">=</span><span class="st">"fit"</span>,var.time<span class="op">=</span><span class="st">"Time"</span>,bty<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot</span><span class="op">(</span><span class="va">m3</span>,which<span class="op">=</span><span class="st">"fit"</span>,var.time<span class="op">=</span><span class="st">"Time"</span>,marg<span class="op">=</span><span class="cn">FALSE</span>,bty<span class="op">=</span><span class="st">"l"</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">15</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Class-specific predicted baseline risk &amp; survival functions in the </span></span></span>
<span class="r-in"><span><span class="co"># 3-class model retained (for the reference value of the covariates) </span></span></span>
<span class="r-in"><span><span class="fu">plot</span><span class="op">(</span><span class="va">m3</span>,which<span class="op">=</span><span class="st">"baselinerisk"</span>,bty<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot</span><span class="op">(</span><span class="va">m3</span>,which<span class="op">=</span><span class="st">"baselinerisk"</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>,bty<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot</span><span class="op">(</span><span class="va">m3</span>,which<span class="op">=</span><span class="st">"survival"</span>,bty<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cecile Proust-Lima, Viviane Philipps.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer></div>





  </body></html>

